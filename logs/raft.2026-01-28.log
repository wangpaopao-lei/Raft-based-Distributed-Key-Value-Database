15:35:32.691 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:32.696 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:32.697 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:32.697 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:32.697 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:32.697 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:32.697 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:32.697 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:32.697 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:32.697 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:32.697 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:32.697 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:32.922 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:32.922 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:32.927 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:32.927 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:32.930 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:32.930 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:32.934 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
15:35:32.934 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
15:35:32.934 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:32.934 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:32.934 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
15:35:32.934 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
15:35:32.935 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
15:35:32.935 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=false)
15:35:32.935 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
15:35:32.935 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
15:35:32.935 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
15:35:32.939 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:32.939 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
15:35:32.939 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=false)
15:35:32.939 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=false)
15:35:32.939 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:32.939 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:32.939 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:33.014 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:33.015 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key3, value3)
15:35:33.022 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
15:35:33.022 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
15:35:33.022 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:33.022 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:33.023 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:33.023 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:33.023 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
15:35:33.023 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
15:35:33.023 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:33.023 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:33.023 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
15:35:33.047 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
15:35:33.047 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:33.047 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:33.048 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(key3)
15:35:33.048 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
15:35:33.048 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
15:35:33.048 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
15:35:33.048 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:33.048 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
15:35:33.048 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:33.048 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:33.048 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
15:35:33.048 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:33.048 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
15:35:33.048 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
15:35:33.048 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
15:35:33.097 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:33.097 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:33.097 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
15:35:33.097 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
15:35:33.157 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:33.157 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:33.158 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:33.158 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:33.158 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:33.158 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:33.158 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:33.158 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:33.158 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:33.158 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:33.158 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:33.158 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:33.158 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:33.158 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:33.159 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:33.163 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:33.164 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:33.164 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:33.164 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:33.164 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:33.164 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:33.164 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:33.164 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:33.164 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:33.164 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:33.164 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:33.164 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:33.378 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:33.378 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:33.379 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:33.379 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
15:35:33.379 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
15:35:33.379 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:33.379 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:33.379 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:33.379 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:33.379 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
15:35:33.379 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
15:35:33.380 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
15:35:33.380 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
15:35:33.380 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:33.380 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:33.380 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:33.380 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:33.479 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:33.479 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-0, value-0)
15:35:33.479 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
15:35:33.479 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
15:35:33.479 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-1, value-1)
15:35:33.479 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=1)
15:35:33.479 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:33.480 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
15:35:33.480 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
15:35:33.480 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:33.480 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-2, value-2)
15:35:33.480 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
15:35:33.480 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
15:35:33.480 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
15:35:33.480 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
15:35:33.480 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
15:35:33.480 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-3, value-3)
15:35:33.480 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
15:35:33.480 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=1)
15:35:33.480 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=2)
15:35:33.480 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
15:35:33.480 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
15:35:33.481 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-4, value-4)
15:35:33.481 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=2)
15:35:33.481 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 4
15:35:33.481 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
15:35:33.481 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
15:35:33.481 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=3)
15:35:33.481 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
15:35:33.481 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=3)
15:35:33.481 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
15:35:33.481 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
15:35:33.481 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-5, value-5)
15:35:33.481 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=3)
15:35:33.481 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 4
15:35:33.481 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=5)
15:35:33.481 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
15:35:33.481 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
15:35:33.481 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 4
15:35:33.481 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=3)
15:35:33.481 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 6
15:35:33.481 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
15:35:33.481 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:33.481 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
15:35:33.481 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 5
15:35:33.481 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-6, value-6)
15:35:33.481 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
15:35:33.482 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
15:35:33.482 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
15:35:33.482 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
15:35:33.482 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 6
15:35:33.481 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=5)
15:35:33.482 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-7, value-7)
15:35:33.481 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=5)
15:35:33.481 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
15:35:33.482 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
15:35:33.481 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=5)
15:35:33.482 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 6
15:35:33.482 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
15:35:33.482 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 7
15:35:33.482 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 6
15:35:33.482 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:33.482 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
15:35:33.482 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
15:35:33.482 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 6
15:35:33.482 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
15:35:33.482 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=5)
15:35:33.482 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
15:35:33.483 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
15:35:33.483 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
15:35:33.483 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 7
15:35:33.482 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=7)
15:35:33.482 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
15:35:33.483 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
15:35:33.482 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-8, value-8)
15:35:33.482 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=7)
15:35:33.483 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=7)
15:35:33.482 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
15:35:33.483 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
15:35:33.482 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
15:35:33.483 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=7)
15:35:33.483 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
15:35:33.483 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
15:35:33.483 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
15:35:33.483 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
15:35:33.483 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 8
15:35:33.483 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
15:35:33.483 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
15:35:33.483 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
15:35:33.483 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
15:35:33.483 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
15:35:33.483 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
15:35:33.484 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-9, value-9)
15:35:33.484 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 8
15:35:33.484 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 8
15:35:33.483 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
15:35:33.484 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=9)
15:35:33.483 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
15:35:33.484 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
15:35:33.483 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
15:35:33.483 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
15:35:33.484 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
15:35:33.484 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
15:35:33.483 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 9
15:35:33.484 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=7)
15:35:33.484 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
15:35:33.484 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=8)
15:35:33.484 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
15:35:33.484 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
15:35:33.484 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
15:35:33.484 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
15:35:33.484 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=10)
15:35:33.484 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
15:35:33.484 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
15:35:33.485 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
15:35:33.485 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
15:35:33.484 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
15:35:33.484 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
15:35:33.485 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
15:35:33.485 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 10
15:35:33.484 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
15:35:33.484 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
15:35:33.484 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
15:35:33.484 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
15:35:33.484 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
15:35:33.485 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=10)
15:35:33.485 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
15:35:33.485 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 10
15:35:33.485 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
15:35:33.485 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
15:35:33.485 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 10
15:35:33.485 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=10)
15:35:33.485 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 11
15:35:33.485 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
15:35:33.486 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
15:35:33.485 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
15:35:33.486 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
15:35:33.486 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
15:35:33.485 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 11
15:35:33.485 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
15:35:33.486 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
15:35:33.486 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
15:35:33.486 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
15:35:33.486 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 10
15:35:33.486 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
15:35:33.486 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
15:35:33.486 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 11
15:35:33.486 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=11)
15:35:33.486 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
15:35:33.486 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
15:35:33.486 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
15:35:33.486 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
15:35:33.486 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
15:35:33.486 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
15:35:33.486 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=12)
15:35:33.486 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
15:35:33.486 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
15:35:33.486 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
15:35:33.487 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
15:35:33.486 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
15:35:33.487 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
15:35:33.486 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
15:35:33.487 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=12)
15:35:33.487 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
15:35:33.487 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
15:35:33.487 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
15:35:33.487 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=12)
15:35:33.487 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
15:35:33.487 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-13, value-13)
15:35:33.487 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 13
15:35:33.487 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
15:35:33.487 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
15:35:33.487 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
15:35:33.487 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
15:35:33.487 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 14
15:35:33.487 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 14
15:35:33.487 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
15:35:33.487 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
15:35:33.487 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
15:35:33.487 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
15:35:33.487 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
15:35:33.487 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 13
15:35:33.487 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
15:35:33.488 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
15:35:33.488 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
15:35:33.487 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
15:35:33.487 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
15:35:33.487 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
15:35:33.488 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
15:35:33.488 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
15:35:33.487 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-14, value-14)
15:35:33.488 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
15:35:33.488 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 13
15:35:33.488 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=12)
15:35:33.488 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
15:35:33.488 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
15:35:33.488 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
15:35:33.488 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=15)
15:35:33.488 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
15:35:33.488 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=14
15:35:33.488 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
15:35:33.488 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
15:35:33.488 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-16, value-16)
15:35:33.488 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
15:35:33.488 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=15)
15:35:33.488 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
15:35:33.488 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 15
15:35:33.488 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=15)
15:35:33.489 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
15:35:33.488 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
15:35:33.489 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
15:35:33.488 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=15)
15:35:33.489 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 16
15:35:33.489 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 16
15:35:33.488 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
15:35:33.489 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
15:35:33.489 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=15
15:35:33.489 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-17, value-17)
15:35:33.489 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=16
15:35:33.489 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
15:35:33.489 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=15)
15:35:33.489 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 16
15:35:33.489 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
15:35:33.489 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
15:35:33.489 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
15:35:33.489 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=15)
15:35:33.489 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
15:35:33.489 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
15:35:33.489 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
15:35:33.489 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 16
15:35:33.489 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
15:35:33.489 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 16
15:35:33.489 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
15:35:33.489 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
15:35:33.490 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-18, value-18)
15:35:33.490 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=17)
15:35:33.489 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 18
15:35:33.489 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 17
15:35:33.489 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
15:35:33.490 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
15:35:33.490 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=17)
15:35:33.490 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
15:35:33.489 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 18
15:35:33.490 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
15:35:33.490 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
15:35:33.490 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=18
15:35:33.490 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=17)
15:35:33.490 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=17)
15:35:33.490 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
15:35:33.490 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=17)
15:35:33.490 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
15:35:33.490 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=18
15:35:33.490 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
15:35:33.490 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
15:35:33.490 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 18
15:35:33.490 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
15:35:33.490 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
15:35:33.490 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=17
15:35:33.490 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
15:35:33.490 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-19, value-19)
15:35:33.491 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
15:35:33.490 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
15:35:33.490 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 18
15:35:33.490 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
15:35:33.490 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
15:35:33.491 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
15:35:33.491 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
15:35:33.491 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
15:35:33.491 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 19
15:35:33.491 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=19)
15:35:33.491 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
15:35:33.491 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
15:35:33.491 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
15:35:33.491 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 20
15:35:33.491 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
15:35:33.491 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
15:35:33.491 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
15:35:33.491 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 20
15:35:33.491 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
15:35:33.491 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
15:35:33.491 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
15:35:33.491 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
15:35:33.491 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
15:35:33.491 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
15:35:33.492 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
15:35:33.492 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
15:35:33.492 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
15:35:33.492 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
15:35:33.492 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
15:35:33.492 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
15:35:33.492 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
15:35:33.535 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
15:35:33.535 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
15:35:33.536 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
15:35:33.536 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
15:35:33.536 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
15:35:33.536 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
15:35:33.599 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:33.599 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:33.600 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:33.600 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:33.600 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:33.600 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:33.600 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:33.600 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:33.600 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:33.600 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:33.600 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:33.600 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:33.601 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:33.601 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:33.601 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:33.603 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:33.603 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:33.604 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:33.604 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:33.604 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:33.604 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:33.604 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:33.604 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:33.604 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:33.604 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:33.604 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:33.605 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:33.762 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:33.762 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:33.762 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:33.762 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
15:35:33.762 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
15:35:33.762 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:33.762 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:33.762 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:33.762 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
15:35:33.762 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:33.762 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
15:35:33.762 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
15:35:33.762 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:33.762 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
15:35:33.763 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:33.763 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:33.763 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:33.815 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:33.815 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key2, value2)
15:35:33.816 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
15:35:33.816 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
15:35:33.816 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:33.816 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:33.816 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:33.816 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
15:35:33.816 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
15:35:33.816 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:33.816 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:33.816 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
15:35:33.816 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:33.816 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:33.816 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:33.816 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:33.816 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
15:35:33.816 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
15:35:33.868 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:33.868 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:33.869 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
15:35:33.869 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
15:35:33.923 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:33.923 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:33.923 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:33.923 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:33.924 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:33.924 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:33.924 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:33.924 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:33.924 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:33.924 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:33.924 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:33.924 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:33.924 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:33.924 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:33.924 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:33.927 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:33.927 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:33.927 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:33.927 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:33.927 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:33.927 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:33.927 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:33.927 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:33.927 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:33.927 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:33.928 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:33.928 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:34.116 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:34.116 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:34.116 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:34.116 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
15:35:34.116 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:34.116 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
15:35:34.116 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:34.116 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:34.116 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
15:35:34.116 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:34.117 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
15:35:34.117 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
15:35:34.117 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:34.117 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
15:35:34.117 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:34.117 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:34.117 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:34.136 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:34.136 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
15:35:34.136 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
15:35:34.136 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
15:35:34.136 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
15:35:34.136 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
15:35:34.136 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:34.136 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
15:35:34.136 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:34.136 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:34.137 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
15:35:34.137 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
15:35:34.170 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:34.169 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:34.170 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
15:35:34.170 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
15:35:34.239 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - Killing leader: node-2
15:35:34.239 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:34.239 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:34.239 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:34.239 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:34.239 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:34.379 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:34.380 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
15:35:34.380 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:34.382 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=2)
15:35:34.382 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
15:35:34.382 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:34.382 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:34.382 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
15:35:34.382 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
15:35:34.382 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:34.383 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
15:35:34.383 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
15:35:34.383 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:34.442 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - New leader: node-1
15:35:34.443 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
15:35:34.443 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
15:35:34.444 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
15:35:34.444 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
15:35:34.444 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=2, entries=1)
15:35:34.444 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:34.444 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
15:35:34.444 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
15:35:34.445 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
15:35:34.486 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
15:35:34.486 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:34.487 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
15:35:34.534 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
15:35:34.550 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:34.550 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:34.550 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:34.550 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:34.551 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:34.551 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:34.551 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:34.551 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:34.551 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:34.551 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:34.553 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:34.553 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:34.553 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:34.554 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:34.554 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:34.554 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:34.554 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:34.554 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:34.554 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:34.554 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:34.554 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:34.554 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:34.731 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:34.732 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:34.732 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:34.732 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
15:35:34.732 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
15:35:34.732 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:34.732 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:34.733 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:34.733 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:34.733 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:35:34.733 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:35:34.733 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
15:35:34.733 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
15:35:34.733 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:34.733 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:34.733 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:34.733 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:34.764 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:34.765 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
15:35:34.765 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
15:35:34.766 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
15:35:34.766 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:34.766 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:34.766 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
15:35:34.766 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:34.767 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:34.767 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:34.767 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
15:35:34.768 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
15:35:34.768 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
15:35:34.768 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
15:35:34.768 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
15:35:34.768 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
15:35:34.768 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:34.768 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:34.769 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:34.769 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:34.769 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:34.769 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:34.769 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
15:35:34.769 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
15:35:34.769 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
15:35:34.769 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
15:35:34.769 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
15:35:34.769 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
15:35:34.769 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
15:35:34.769 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
15:35:34.769 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
15:35:34.769 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
15:35:34.770 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
15:35:34.770 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:34.770 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
15:35:34.770 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:34.770 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:34.770 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
15:35:34.770 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
15:35:34.770 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
15:35:34.770 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
15:35:34.770 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
15:35:34.770 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:34.770 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
15:35:34.770 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
15:35:34.770 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
15:35:34.770 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
15:35:34.770 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
15:35:34.770 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
15:35:34.770 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:34.770 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
15:35:34.770 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
15:35:34.770 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:34.770 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
15:35:34.770 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
15:35:34.770 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
15:35:34.770 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
15:35:34.770 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
15:35:34.770 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
15:35:34.771 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
15:35:34.771 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
15:35:34.771 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
15:35:34.771 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
15:35:34.771 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
15:35:34.771 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:34.771 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
15:35:34.771 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
15:35:34.771 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:34.771 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
15:35:34.771 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
15:35:34.771 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
15:35:34.771 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
15:35:34.771 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
15:35:34.771 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
15:35:34.771 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
15:35:34.771 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
15:35:34.771 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
15:35:34.771 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
15:35:34.771 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
15:35:34.771 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
15:35:34.771 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
15:35:34.771 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:34.772 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
15:35:34.772 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
15:35:34.772 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:34.772 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
15:35:34.772 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
15:35:34.772 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
15:35:34.772 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
15:35:34.772 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
15:35:34.772 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
15:35:34.772 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
15:35:34.772 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
15:35:34.772 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
15:35:34.772 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
15:35:34.772 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
15:35:34.772 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
15:35:34.772 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:34.772 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
15:35:34.772 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
15:35:34.772 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:34.772 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
15:35:34.772 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
15:35:34.772 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
15:35:34.772 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
15:35:34.772 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
15:35:34.772 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
15:35:34.772 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
15:35:34.772 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
15:35:34.772 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
15:35:34.772 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
15:35:34.773 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
15:35:34.773 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
15:35:34.773 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:34.773 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:34.773 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
15:35:34.773 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
15:35:34.773 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
15:35:34.773 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
15:35:34.773 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
15:35:34.773 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
15:35:34.773 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
15:35:34.773 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
15:35:34.773 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
15:35:34.773 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
15:35:34.773 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
15:35:34.773 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
15:35:34.773 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
15:35:34.773 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
15:35:34.773 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:34.773 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
15:35:34.773 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:34.773 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
15:35:34.773 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
15:35:34.773 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
15:35:34.773 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
15:35:34.774 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
15:35:34.774 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
15:35:34.774 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
15:35:34.774 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
15:35:34.774 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
15:35:34.774 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
15:35:34.774 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
15:35:34.774 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
15:35:34.774 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
15:35:34.774 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:34.774 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
15:35:34.774 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
15:35:34.774 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
15:35:34.774 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
15:35:34.774 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:34.774 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
15:35:34.774 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
15:35:34.774 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
15:35:34.774 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
15:35:34.774 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
15:35:34.774 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
15:35:34.786 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
15:35:34.786 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
15:35:34.786 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
15:35:34.786 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
15:35:34.880 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:34.880 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:34.881 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:34.881 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:34.881 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:34.881 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:34.881 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:34.881 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:34.881 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:34.881 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:34.881 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:34.881 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:34.881 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:34.881 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:34.881 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:34.882 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:34.882 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:34.882 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:34.882 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:34.882 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:34.882 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:34.882 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:34.882 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:34.882 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:34.882 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:34.882 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:34.882 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:35.090 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:35.090 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:35.090 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:35.090 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
15:35:35.090 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:35.090 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
15:35:35.090 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.090 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:35.090 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.090 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:35:35.090 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:35:35.090 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
15:35:35.090 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
15:35:35.090 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:35.090 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:35.090 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:35.090 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:35.191 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Leader: node-3
15:35:35.191 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:35.191 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
15:35:35.191 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
15:35:35.191 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
15:35:35.191 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
15:35:35.191 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:35.191 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
15:35:35.191 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:35.191 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:35.191 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:35.192 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:35.192 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
15:35:35.192 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
15:35:35.192 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:35.191 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:35.192 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:35.192 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:35.192 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:35.192 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
15:35:35.192 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - PUT committed
15:35:35.241 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:35.241 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:35.241 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
15:35:35.241 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
15:35:35.298 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Data replicated to all nodes
15:35:35.298 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:35.298 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.298 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:35.298 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:35.298 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:35.298 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:35.298 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.298 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:35.298 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:35.299 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:35.299 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:35.299 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.299 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:35.299 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:35.299 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:35.300 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:35.300 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:35.300 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:35.300 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:35.300 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:35.300 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:35.300 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:35.300 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:35.300 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:35.300 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:35.300 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:35.300 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:35.456 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:35.457 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:35.457 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:35.457 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
15:35:35.458 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:35.458 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
15:35:35.458 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.458 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:35.458 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
15:35:35.458 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.458 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
15:35:35.458 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
15:35:35.458 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:35.458 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
15:35:35.458 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:35.458 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:35.458 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:35.514 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:35.515 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.515 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:35.515 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:35.515 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:35.515 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:35.515 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.515 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:35.515 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:35.515 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:35.515 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:35.515 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.515 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:35.515 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:35.515 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:35.518 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:35.518 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:35.518 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:35.518 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:35.518 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:35.518 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:35.518 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:35.518 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:35.518 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:35.518 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:35.518 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:35.518 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:35.518 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
15:35:35.518 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
15:35:35.518 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:35.519 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
15:35:35.519 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
15:35:35.519 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
15:35:35.519 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:35.519 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
15:35:35.708 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:35.708 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:35.708 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
15:35:35.708 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
15:35:35.708 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 VoteRequest(term=1)
15:35:35.708 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
15:35:35.708 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 VoteRequest(term=1)
15:35:35.708 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:35.708 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:35.708 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:35.708 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.708 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:35.708 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.709 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.708 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.709 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
15:35:35.709 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
15:35:35.709 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
15:35:35.709 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
15:35:35.709 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-5 VoteResponse(granted=true)
15:35:35.709 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-4 VoteResponse(granted=true)
15:35:35.709 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
15:35:35.709 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
15:35:35.709 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
15:35:35.709 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
15:35:35.709 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:35.709 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:35.709 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:35.724 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:35.725 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(stable-key, initial)
15:35:35.725 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
15:35:35.726 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
15:35:35.726 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:35.726 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
15:35:35.726 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:35.726 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:35.726 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
15:35:35.726 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
15:35:35.726 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:35.726 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
15:35:35.726 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:35.726 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
15:35:35.727 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
15:35:35.727 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
15:35:35.727 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:35.727 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:35.727 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:35.727 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
15:35:35.727 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
15:35:35.767 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:35.767 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:35.768 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:35.768 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:35.769 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
15:35:35.769 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
15:35:35.772 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
15:35:35.773 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
15:35:35.835 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
15:35:35.836 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-0, value-0)
15:35:35.836 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
15:35:35.836 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
15:35:35.836 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
15:35:35.836 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
15:35:35.836 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:35.836 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:35.836 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:35.836 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
15:35:35.836 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
15:35:35.836 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
15:35:35.836 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:35.836 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:35.836 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
15:35:35.836 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
15:35:35.836 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:35.836 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
15:35:35.837 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
15:35:35.837 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
15:35:35.837 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
15:35:35.837 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-1, value-1)
15:35:35.837 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
15:35:35.837 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
15:35:35.837 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:35.837 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
15:35:35.837 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:35.837 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
15:35:35.837 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=3)
15:35:35.837 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:35.837 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
15:35:35.837 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
15:35:35.837 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
15:35:35.837 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:35.837 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
15:35:35.837 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=3)
15:35:35.837 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
15:35:35.837 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
15:35:35.837 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
15:35:35.837 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:35.837 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
15:35:35.837 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
15:35:35.837 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=3
15:35:35.837 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
15:35:35.837 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:35.837 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
15:35:35.837 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=3
15:35:35.837 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
15:35:35.837 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
15:35:35.837 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-2, value-2)
15:35:35.838 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
15:35:35.838 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
15:35:35.838 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:35.838 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=4)
15:35:35.838 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:35.838 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
15:35:35.838 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
15:35:35.838 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
15:35:35.838 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=4)
15:35:35.838 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
15:35:35.838 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
15:35:35.838 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
15:35:35.838 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
15:35:35.838 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
15:35:35.838 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
15:35:35.838 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
15:35:35.838 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
15:35:35.838 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
15:35:35.838 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=4
15:35:35.838 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
15:35:35.838 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
15:35:35.838 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
15:35:35.838 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
15:35:35.838 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
15:35:35.838 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
15:35:35.838 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=4
15:35:35.838 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-3, value-3)
15:35:35.838 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
15:35:35.838 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
15:35:35.838 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
15:35:35.838 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=5)
15:35:35.838 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:35.838 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:35.838 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
15:35:35.838 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=5)
15:35:35.838 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
15:35:35.838 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
15:35:35.838 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
15:35:35.838 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
15:35:35.838 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
15:35:35.838 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
15:35:35.838 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
15:35:35.838 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=5
15:35:35.838 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
15:35:35.838 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
15:35:35.838 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
15:35:35.838 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
15:35:35.838 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
15:35:35.839 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
15:35:35.839 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
15:35:35.839 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
15:35:35.839 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
15:35:35.839 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
15:35:35.839 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-4, value-4)
15:35:35.839 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=5
15:35:35.839 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
15:35:35.839 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
15:35:35.839 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
15:35:35.839 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=6)
15:35:35.839 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:35.839 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
15:35:35.839 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:35.839 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=6)
15:35:35.839 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
15:35:35.839 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
15:35:35.839 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
15:35:35.839 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
15:35:35.839 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
15:35:35.839 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
15:35:35.839 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
15:35:35.839 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
15:35:35.839 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
15:35:35.839 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
15:35:35.839 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
15:35:35.839 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=6
15:35:35.839 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
15:35:35.839 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
15:35:35.839 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
15:35:35.839 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
15:35:35.839 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=6
15:35:35.839 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
15:35:35.839 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
15:35:35.839 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
15:35:35.863 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
15:35:35.863 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
15:35:35.863 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
15:35:35.863 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
15:35:35.863 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
15:35:35.864 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
15:35:35.864 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
15:35:35.864 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
15:35:35.945 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:35.945 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.945 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:35.946 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:35.946 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:35.946 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:35.946 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.946 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:35.946 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:35.946 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:35.946 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:35.946 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.946 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:35.946 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:35.946 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:35.946 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
15:35:35.946 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.946 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:35.946 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
15:35:35.946 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
15:35:35.946 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
15:35:35.946 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:35.946 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:35.946 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
15:35:35.946 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
15:35:35.951 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:35.951 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
15:35:35.952 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
15:35:35.952 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:35.952 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:35.952 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:35.952 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:36.136 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:36.141 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:36.142 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
15:35:36.142 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:36.142 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
15:35:36.142 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:36.142 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:36.142 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:36.262 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:36.262 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test, data)
15:35:36.262 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:36.263 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test, data)
15:35:36.264 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Data files created at target/test-data/node-1
15:35:36.265 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:36.265 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:36.265 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:36.265 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:36.265 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:36.273 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:36.273 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
15:35:36.274 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
15:35:36.274 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:36.274 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:36.274 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:36.274 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:36.274 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:36.274 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
15:35:36.274 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
15:35:36.274 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:36.274 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:36.274 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:36.274 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:36.274 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:36.275 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
15:35:36.275 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
15:35:36.275 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:36.275 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:36.275 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:36.275 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:36.498 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:36.501 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:36.501 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
15:35:36.501 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:36.501 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:36.502 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
15:35:36.502 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:36.502 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:36.502 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:36.503 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
15:35:36.503 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
15:35:36.503 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
15:35:36.503 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:36.503 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:36.503 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:36.503 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:36.503 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
15:35:36.503 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:36.503 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:36.503 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:36.503 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
15:35:36.503 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
15:35:36.503 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
15:35:36.590 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Leader: node-2
15:35:36.590 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:36.590 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
15:35:36.591 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
15:35:36.591 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
15:35:36.591 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
15:35:36.591 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
15:35:36.591 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:36.591 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:36.591 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:36.591 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
15:35:36.591 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:36.591 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:36.591 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
15:35:36.591 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
15:35:36.592 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
15:35:36.592 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key2, value2)
15:35:36.592 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
15:35:36.592 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
15:35:36.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
15:35:36.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
15:35:36.592 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:36.592 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:36.592 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:36.592 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
15:35:36.592 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
15:35:36.592 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
15:35:36.592 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:36.592 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:36.592 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
15:35:36.592 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:36.592 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
15:35:36.592 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
15:35:36.592 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
15:35:36.592 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key3, value3)
15:35:36.592 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
15:35:36.592 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
15:35:36.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
15:35:36.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
15:35:36.593 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:36.593 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
15:35:36.593 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:36.593 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:36.593 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
15:35:36.593 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
15:35:36.593 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
15:35:36.593 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:36.593 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
15:35:36.593 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
15:35:36.593 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
15:35:36.593 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
15:35:36.604 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
15:35:36.604 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
15:35:36.604 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
15:35:36.604 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
15:35:36.698 [main] [node-2] INFO  c.raftdb.integration.PersistenceTest - Stopping all nodes...
15:35:36.699 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:36.699 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:36.699 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:36.699 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:36.699 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:36.699 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:36.699 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:36.699 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:36.699 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:36.699 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:36.699 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:36.699 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:36.699 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:36.699 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:36.699 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:36.699 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting all nodes...
15:35:36.699 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:36.700 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-2
15:35:36.700 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
15:35:36.700 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
15:35:36.701 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
15:35:36.701 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
15:35:36.701 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
15:35:36.701 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
15:35:36.701 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-2, lastLogIndex=3
15:35:36.701 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:36.701 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:36.701 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:36.701 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:36.701 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-2
15:35:36.701 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
15:35:36.701 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
15:35:36.701 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
15:35:36.701 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
15:35:36.701 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
15:35:36.701 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
15:35:36.701 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-2, lastLogIndex=3
15:35:36.701 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:36.701 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:36.701 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:36.701 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:36.702 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-2
15:35:36.702 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
15:35:36.702 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
15:35:36.702 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
15:35:36.702 [main] [node-3] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
15:35:36.702 [main] [node-3] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
15:35:36.702 [main] [node-3] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
15:35:36.702 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-2, lastLogIndex=3
15:35:36.702 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:36.702 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:36.702 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:36.943 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:36.945 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
15:35:36.945 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
15:35:36.945 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:36.946 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=2)
15:35:36.946 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=2)
15:35:36.947 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
15:35:36.947 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:36.947 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
15:35:36.947 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:36.947 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:36.947 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:36.947 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
15:35:36.947 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
15:35:36.948 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
15:35:36.948 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
15:35:36.948 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
15:35:36.948 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
15:35:36.948 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:36.948 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
15:35:36.948 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
15:35:36.948 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:37.015 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - New leader after restart: node-3
15:35:37.018 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - All nodes recovered successfully
15:35:37.019 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:37.019 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:37.019 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:37.019 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:37.019 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:37.019 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:37.019 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:37.019 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:37.019 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:37.019 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:37.019 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:37.019 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:37.019 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:37.019 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:37.019 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:37.025 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:37.026 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
15:35:37.026 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
15:35:37.026 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:37.026 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:37.026 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:37.026 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:37.026 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:37.027 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
15:35:37.027 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
15:35:37.027 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:37.027 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:37.027 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:37.027 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:37.027 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:37.027 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
15:35:37.027 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
15:35:37.027 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:37.027 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:37.027 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:37.027 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:37.227 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:37.228 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:37.228 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
15:35:37.228 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:37.228 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:37.228 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
15:35:37.228 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
15:35:37.228 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:37.228 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:37.228 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:37.229 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:37.229 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:37.229 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:37.229 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
15:35:37.229 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:35:37.229 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
15:35:37.229 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:37.229 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:37.229 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:37.229 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:37.229 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
15:35:37.229 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:35:37.229 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
15:35:37.238 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:37.238 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, restart)
15:35:37.238 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
15:35:37.239 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
15:35:37.239 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:37.239 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:37.239 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:37.239 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:37.239 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:37.239 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
15:35:37.239 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:37.239 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:37.239 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
15:35:37.239 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
15:35:37.284 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:37.284 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:37.285 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
15:35:37.285 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
15:35:37.347 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting follower: node-1
15:35:37.348 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:37.348 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:37.348 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:37.348 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:37.348 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:37.451 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
15:35:37.452 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during, downtime)
15:35:37.452 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
15:35:37.452 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
15:35:37.452 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
15:35:37.452 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:37.452 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:37.452 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
15:35:37.452 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
15:35:37.452 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
15:35:37.454 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:37.454 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
15:35:37.454 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
15:35:37.455 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
15:35:37.455 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
15:35:37.455 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
15:35:37.455 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 1 to recover state machine
15:35:37.455 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
15:35:37.455 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=1
15:35:37.455 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:37.455 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:37.455 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:37.484 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
15:35:37.485 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
15:35:37.485 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:37.485 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
15:35:37.485 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:37.485 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:37.485 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:37.485 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
15:35:37.485 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
15:35:37.557 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Follower node-1 caught up after restart
15:35:37.558 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:37.558 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:37.558 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:37.558 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:37.558 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:37.558 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:37.558 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:37.558 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:37.558 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:37.558 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:37.558 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:37.558 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:37.558 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:37.558 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:37.558 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:37.564 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:37.564 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
15:35:37.564 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
15:35:37.564 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:37.564 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:37.564 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:37.564 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:37.760 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:37.761 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:37.761 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
15:35:37.761 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:37.761 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
15:35:37.761 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:37.761 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:37.761 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:37.774 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:37.774 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:37.774 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:37.774 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:37.774 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:37.774 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:37.774 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
15:35:37.774 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
15:35:37.774 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
15:35:37.774 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=0
15:35:37.774 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:37.774 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:37.774 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:37.774 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Term persisted: 1 -> 1
15:35:37.775 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:37.775 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:37.775 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:37.775 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:37.775 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:37.777 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:37.777 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
15:35:37.777 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
15:35:37.777 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:37.777 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:37.777 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:37.777 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:38.013 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:38.018 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:38.019 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
15:35:38.019 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:38.019 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
15:35:38.019 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:38.019 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:38.019 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:38.098 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:38.098 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
15:35:38.099 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:38.099 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
15:35:38.099 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
15:35:38.100 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
15:35:38.100 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
15:35:38.100 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
15:35:38.100 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
15:35:38.100 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
15:35:38.100 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
15:35:38.100 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
15:35:38.101 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
15:35:38.101 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
15:35:38.101 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
15:35:38.101 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
15:35:38.101 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
15:35:38.101 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
15:35:38.101 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
15:35:38.101 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
15:35:38.102 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
15:35:38.102 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
15:35:38.102 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
15:35:38.102 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
15:35:38.102 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
15:35:38.102 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
15:35:38.102 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
15:35:38.102 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
15:35:38.103 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
15:35:38.103 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
15:35:38.103 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
15:35:38.103 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
15:35:38.103 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
15:35:38.103 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
15:35:38.103 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
15:35:38.103 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
15:35:38.104 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
15:35:38.104 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
15:35:38.104 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
15:35:38.104 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
15:35:38.104 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 10, term 1
15:35:38.105 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
15:35:38.106 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=10, lastTerm=1, size=184 bytes
15:35:38.107 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 10, 0 entries remaining
15:35:38.107 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
15:35:38.107 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 0 log entries remaining
15:35:38.108 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Snapshot test passed
15:35:38.108 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:38.108 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:38.108 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:38.108 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:38.109 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:38.112 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:38.112 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
15:35:38.112 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
15:35:38.112 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:38.112 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:38.112 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:38.112 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:38.332 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:38.335 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:38.336 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
15:35:38.336 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:38.336 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
15:35:38.336 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:38.337 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:38.337 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:38.428 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:38.428 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
15:35:38.429 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:38.429 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
15:35:38.429 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
15:35:38.429 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
15:35:38.429 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
15:35:38.429 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
15:35:38.430 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
15:35:38.430 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
15:35:38.430 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
15:35:38.430 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
15:35:38.430 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
15:35:38.430 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
15:35:38.430 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
15:35:38.430 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
15:35:38.430 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
15:35:38.430 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
15:35:38.430 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
15:35:38.431 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
15:35:38.431 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
15:35:38.431 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
15:35:38.431 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
15:35:38.431 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
15:35:38.431 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
15:35:38.431 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
15:35:38.431 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
15:35:38.431 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
15:35:38.431 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
15:35:38.431 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
15:35:38.431 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
15:35:38.431 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
15:35:38.431 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
15:35:38.431 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
15:35:38.431 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
15:35:38.431 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
15:35:38.432 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
15:35:38.432 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
15:35:38.432 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
15:35:38.432 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
15:35:38.432 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 9, term 1
15:35:38.432 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
15:35:38.433 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=9, lastTerm=1, size=184 bytes
15:35:38.433 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 9, 1 entries remaining
15:35:38.433 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 1 entries
15:35:38.433 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 1 log entries remaining
15:35:38.434 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
15:35:38.434 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
15:35:38.434 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
15:35:38.434 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
15:35:38.434 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
15:35:38.434 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
15:35:38.434 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
15:35:38.434 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
15:35:38.434 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
15:35:38.434 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
15:35:38.434 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
15:35:38.434 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
15:35:38.434 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
15:35:38.434 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
15:35:38.435 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
15:35:38.435 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
15:35:38.435 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
15:35:38.435 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
15:35:38.435 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
15:35:38.435 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
15:35:38.435 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:38.435 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:38.435 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:38.435 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:38.435 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:38.435 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:38.435 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
15:35:38.435 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
15:35:38.436 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=9, lastTerm=1
15:35:38.436 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
15:35:38.436 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 184 bytes
15:35:38.436 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 10 entries
15:35:38.436 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=9, term=1
15:35:38.436 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=9, term=1
15:35:38.437 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 6 log entries from disk
15:35:38.437 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 6 log entries, lastIndex=15
15:35:38.437 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 10 to 15 to recover state machine
15:35:38.437 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=15
15:35:38.437 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=15
15:35:38.437 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:38.437 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:38.437 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:38.619 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:38.622 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
15:35:38.623 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
15:35:38.623 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
15:35:38.623 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
15:35:38.623 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
15:35:38.623 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
15:35:38.623 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:38.649 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Recovery from snapshot test passed
15:35:38.650 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:38.650 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:38.650 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:38.650 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:38.650 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:38.653 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:38.654 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
15:35:38.654 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
15:35:38.654 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:38.654 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:38.654 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:38.655 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:38.655 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:38.655 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
15:35:38.655 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
15:35:38.655 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:38.655 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:38.655 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:38.655 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:38.655 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:38.656 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
15:35:38.656 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
15:35:38.656 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:38.656 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:38.656 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:38.656 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:38.817 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:38.819 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:38.820 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
15:35:38.820 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:38.820 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:38.820 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
15:35:38.820 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
15:35:38.821 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:38.821 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:38.821 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:38.821 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:38.821 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:38.821 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:38.822 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
15:35:38.822 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
15:35:38.822 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
15:35:38.822 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
15:35:38.822 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:38.822 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
15:35:38.822 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:38.822 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
15:35:38.822 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:38.822 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:38.868 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:38.868 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
15:35:38.868 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
15:35:38.868 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
15:35:38.869 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:38.869 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.869 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:38.870 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.870 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:38.870 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
15:35:38.870 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:38.869 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
15:35:38.870 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
15:35:38.871 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
15:35:38.871 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
15:35:38.871 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
15:35:38.871 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
15:35:38.871 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
15:35:38.872 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:38.872 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:38.872 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.872 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:38.872 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:38.872 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
15:35:38.872 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
15:35:38.872 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
15:35:38.872 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.872 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
15:35:38.872 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
15:35:38.872 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
15:35:38.872 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
15:35:38.872 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
15:35:38.872 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
15:35:38.872 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
15:35:38.872 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
15:35:38.872 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
15:35:38.872 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:38.872 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:38.872 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
15:35:38.872 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
15:35:38.872 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.872 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.872 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:38.872 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:38.873 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
15:35:38.873 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:38.872 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
15:35:38.873 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
15:35:38.873 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
15:35:38.873 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
15:35:38.873 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
15:35:38.873 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
15:35:38.873 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
15:35:38.873 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
15:35:38.872 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
15:35:38.873 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
15:35:38.873 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
15:35:38.873 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
15:35:38.873 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
15:35:38.873 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
15:35:38.873 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
15:35:38.873 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:38.873 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:38.873 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.873 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
15:35:38.873 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
15:35:38.873 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
15:35:38.873 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
15:35:38.873 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
15:35:38.873 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
15:35:38.873 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
15:35:38.873 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
15:35:38.873 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.873 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
15:35:38.873 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
15:35:38.873 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
15:35:38.874 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
15:35:38.874 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
15:35:38.874 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
15:35:38.874 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:38.874 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:38.874 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.874 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
15:35:38.874 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
15:35:38.874 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
15:35:38.874 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
15:35:38.874 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
15:35:38.874 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
15:35:38.874 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.874 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
15:35:38.874 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
15:35:38.874 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
15:35:38.874 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
15:35:38.874 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
15:35:38.874 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
15:35:38.874 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
15:35:38.874 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
15:35:38.874 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:38.874 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:38.874 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.874 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
15:35:38.874 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
15:35:38.874 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.874 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
15:35:38.874 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
15:35:38.874 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
15:35:38.874 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
15:35:38.874 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
15:35:38.874 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
15:35:38.874 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
15:35:38.874 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
15:35:38.875 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
15:35:38.875 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
15:35:38.875 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
15:35:38.875 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
15:35:38.875 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:38.875 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:38.875 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.875 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
15:35:38.875 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
15:35:38.875 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
15:35:38.875 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.875 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
15:35:38.875 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
15:35:38.875 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
15:35:38.875 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
15:35:38.875 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
15:35:38.875 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
15:35:38.875 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
15:35:38.875 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
15:35:38.875 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
15:35:38.875 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
15:35:38.875 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
15:35:38.875 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:38.875 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:38.875 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.875 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.875 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
15:35:38.875 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
15:35:38.875 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
15:35:38.875 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
15:35:38.875 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
15:35:38.875 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
15:35:38.875 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
15:35:38.875 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
15:35:38.875 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
15:35:38.875 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
15:35:38.875 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
15:35:38.875 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
15:35:38.875 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
15:35:38.875 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
15:35:38.875 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
15:35:38.875 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:38.875 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:38.875 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.875 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
15:35:38.875 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.875 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
15:35:38.875 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
15:35:38.875 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
15:35:38.875 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
15:35:38.875 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
15:35:38.875 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
15:35:38.875 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
15:35:38.875 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
15:35:38.875 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
15:35:38.876 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
15:35:38.876 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
15:35:38.876 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
15:35:38.876 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
15:35:38.876 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:38.876 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
15:35:38.876 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:38.876 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.876 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
15:35:38.876 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
15:35:38.876 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:38.876 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
15:35:38.876 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
15:35:38.876 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
15:35:38.876 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
15:35:38.876 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
15:35:38.876 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
15:35:38.876 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
15:35:38.876 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
15:35:38.928 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
15:35:38.928 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
15:35:38.928 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
15:35:38.928 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
15:35:38.982 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:38.982 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:38.982 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:38.982 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:38.982 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:39.089 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
15:35:39.089 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
15:35:39.089 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=11)
15:35:39.089 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
15:35:39.089 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:39.089 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:39.089 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
15:35:39.089 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
15:35:39.089 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
15:35:39.089 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
15:35:39.089 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
15:35:39.089 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
15:35:39.090 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
15:35:39.090 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=12)
15:35:39.090 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:39.090 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:39.090 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
15:35:39.090 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
15:35:39.090 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
15:35:39.090 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
15:35:39.090 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
15:35:39.090 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
15:35:39.090 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
15:35:39.090 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
15:35:39.090 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=11)
15:35:39.090 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=13)
15:35:39.090 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:39.090 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:39.090 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
15:35:39.090 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
15:35:39.090 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
15:35:39.090 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
15:35:39.090 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
15:35:39.090 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
15:35:39.090 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
15:35:39.090 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
15:35:39.090 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=11)
15:35:39.090 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=14)
15:35:39.090 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:39.090 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:39.090 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
15:35:39.090 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
15:35:39.090 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
15:35:39.090 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
15:35:39.090 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
15:35:39.090 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
15:35:39.091 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
15:35:39.091 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
15:35:39.091 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=11)
15:35:39.091 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=15)
15:35:39.091 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:39.091 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:39.091 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
15:35:39.091 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
15:35:39.091 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
15:35:39.091 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
15:35:39.091 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
15:35:39.091 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
15:35:39.091 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
15:35:39.091 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(key15, value15)
15:35:39.091 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-2 (nextIndex=11)
15:35:39.091 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
15:35:39.091 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:39.091 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:39.091 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
15:35:39.091 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
15:35:39.091 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
15:35:39.091 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
15:35:39.091 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
15:35:39.091 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
15:35:39.091 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
15:35:39.091 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(key16, value16)
15:35:39.091 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 7 entries to node-2 (nextIndex=11)
15:35:39.091 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
15:35:39.091 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:39.091 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:39.091 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
15:35:39.091 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
15:35:39.091 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
15:35:39.091 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
15:35:39.091 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
15:35:39.091 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
15:35:39.092 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
15:35:39.092 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(key17, value17)
15:35:39.092 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 8 entries to node-2 (nextIndex=11)
15:35:39.092 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=18)
15:35:39.092 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:39.092 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:39.092 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
15:35:39.092 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
15:35:39.092 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=18
15:35:39.092 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
15:35:39.092 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
15:35:39.092 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
15:35:39.092 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
15:35:39.092 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(key18, value18)
15:35:39.092 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 9 entries to node-2 (nextIndex=11)
15:35:39.092 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=19)
15:35:39.092 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:39.092 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:39.092 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
15:35:39.092 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
15:35:39.092 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
15:35:39.092 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
15:35:39.092 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
15:35:39.092 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
15:35:39.092 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
15:35:39.092 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(key19, value19)
15:35:39.092 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 10 entries to node-2 (nextIndex=11)
15:35:39.092 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
15:35:39.092 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
15:35:39.092 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:39.092 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
15:35:39.092 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
15:35:39.092 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
15:35:39.092 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
15:35:39.092 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
15:35:39.092 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
15:35:39.092 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 19, term 1
15:35:39.092 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 20 entries, 384 bytes
15:35:39.093 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=19, lastTerm=1, size=384 bytes
15:35:39.093 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 19, 1 entries remaining
15:35:39.093 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 1 entries
15:35:39.093 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 384 bytes, 1 log entries remaining
15:35:39.093 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:39.093 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
15:35:39.094 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
15:35:39.094 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:39.094 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:39.094 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:39.094 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:39.127 [replication-node-1] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 384 bytes
15:35:39.129 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Sending snapshot to node-2 (lastIndex=19, size=384)
15:35:39.130 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 InstallSnapshot(term=1, lastIndex=19, size=384)
15:35:39.130 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
15:35:39.130 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
15:35:39.130 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:39.130 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:39.130 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:39.130 [] [node-2] INFO  com.raftdb.core.RaftNode - Installing snapshot: lastIndex=19, lastTerm=1, size=384
15:35:39.131 [] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=19, lastTerm=1, size=384 bytes
15:35:39.131 [] [node-2] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 20 entries
15:35:39.131 [] [node-2] INFO  com.raftdb.log.LogManager - Reset log to snapshot: index=19, term=1
15:35:39.131 [] [node-2] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
15:35:39.131 [] [node-2] INFO  com.raftdb.core.RaftNode - Snapshot installed successfully
15:35:39.132 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 InstallSnapshotResponse(term=1)
15:35:39.132 [] [node-1] INFO  c.r.replication.ReplicationManager - Snapshot to node-2 complete, nextIndex=20
15:35:39.172 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=20)
15:35:39.172 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
15:35:39.173 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
15:35:39.173 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
15:35:39.173 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
15:35:39.173 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
15:35:39.173 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
15:35:39.199 [main] [node-2] INFO  com.raftdb.integration.SnapshotTest - Snapshot replication test passed
15:35:39.199 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:39.199 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:39.199 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:39.199 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:39.199 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:39.199 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:39.199 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:39.199 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:39.199 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:39.199 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:39.199 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:39.199 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:39.199 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:39.199 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:39.199 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:39.202 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:39.203 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
15:35:39.203 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
15:35:39.203 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
15:35:39.203 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:39.203 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:39.203 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:39.370 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:39.371 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
15:35:39.372 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
15:35:39.372 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:39.372 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
15:35:39.372 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:39.372 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:39.372 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:39.414 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
15:35:39.414 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(string, hello)
15:35:39.414 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
15:35:39.415 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(string, hello)
15:35:39.415 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
15:35:39.415 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(number, 12345)
15:35:39.415 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
15:35:39.415 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(number, 12345)
15:35:39.415 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
15:35:39.415 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(special, )
15:35:39.416 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
15:35:39.416 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(special, )
15:35:39.416 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
15:35:39.416 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(empty, )
15:35:39.416 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
15:35:39.416 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(empty, )
15:35:39.417 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
15:35:39.417 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: DELETE(empty)
15:35:39.417 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
15:35:39.417 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: DELETE(empty)
15:35:39.417 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 4, term 1
15:35:39.417 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 3 entries, 69 bytes
15:35:39.418 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=4, lastTerm=1, size=69 bytes
15:35:39.418 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 4, 1 entries remaining
15:35:39.418 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 1 entries
15:35:39.418 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 69 bytes, 1 log entries remaining
15:35:39.419 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:39.419 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:39.419 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:39.419 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:39.419 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:39.419 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:39.419 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
15:35:39.419 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
15:35:39.419 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=4, lastTerm=1
15:35:39.419 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
15:35:39.420 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 69 bytes
15:35:39.420 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 3 entries
15:35:39.420 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=4, term=1
15:35:39.420 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=4, term=1
15:35:39.420 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
15:35:39.420 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=5
15:35:39.420 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 5 to 5 to recover state machine
15:35:39.420 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=5
15:35:39.420 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=5
15:35:39.420 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:39.420 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:39.420 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:39.679 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:39.683 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
15:35:39.684 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
15:35:39.684 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
15:35:39.684 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
15:35:39.684 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
15:35:39.684 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
15:35:39.684 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:39.731 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - State machine snapshot test passed
15:35:39.732 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:39.732 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:39.732 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:39.732 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:39.732 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:39.739 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:39.739 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:39.739 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:39.739 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:39.739 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:39.739 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:39.739 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:39.739 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:39.739 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:39.739 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:39.739 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:39.739 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:39.902 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:39.903 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:39.903 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:39.903 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
15:35:39.903 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
15:35:39.903 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:39.903 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:39.903 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:39.903 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:39.903 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:35:39.903 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:35:39.903 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
15:35:39.903 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
15:35:39.903 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:39.903 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:39.903 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:39.903 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:39.952 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-3 (term 1)
15:35:40.162 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - All nodes agree on leader: node-3
15:35:40.164 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:40.164 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.164 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:40.164 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:40.164 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:40.164 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:40.164 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.164 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:40.164 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:40.164 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:40.164 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:40.164 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.164 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:40.164 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:40.164 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:40.168 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:40.168 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:40.168 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:40.168 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:40.168 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:40.169 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:40.169 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:40.169 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:40.169 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:40.169 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:40.169 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:40.169 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:40.169 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
15:35:40.169 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
15:35:40.169 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:40.169 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
15:35:40.169 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
15:35:40.169 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
15:35:40.169 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:40.169 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
15:35:40.361 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:40.362 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:40.362 [election-node-4] [node-4] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
15:35:40.363 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 VoteRequest(term=1)
15:35:40.363 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:40.363 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.363 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 VoteRequest(term=1)
15:35:40.363 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
15:35:40.363 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-1 VoteResponse(granted=true)
15:35:40.363 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:40.363 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
15:35:40.363 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.363 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
15:35:40.363 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-2 VoteResponse(granted=true)
15:35:40.363 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 VoteRequest(term=1)
15:35:40.364 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 VoteRequest(term=1)
15:35:40.364 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:40.364 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.364 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
15:35:40.364 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
15:35:40.364 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-3 VoteResponse(granted=true)
15:35:40.364 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:40.364 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.364 [] [node-4] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:40.364 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
15:35:40.364 [] [node-4] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:40.364 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-5 VoteResponse(granted=true)
15:35:40.364 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:40.380 [main] [node-5] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-4 (term 1)
15:35:40.381 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:40.381 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.381 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:40.382 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:40.382 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:40.382 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:40.382 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.382 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:40.382 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:40.382 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:40.382 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:40.382 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.382 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:40.382 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:40.382 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:40.382 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
15:35:40.382 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.382 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:40.382 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
15:35:40.382 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
15:35:40.382 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
15:35:40.382 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.382 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:40.382 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
15:35:40.383 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
15:35:40.386 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:40.386 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:40.386 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:40.386 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:40.386 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:40.386 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:40.386 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:40.387 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:40.387 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:40.387 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:40.387 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:40.387 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:40.600 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:40.600 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:40.601 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:40.601 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
15:35:40.602 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:40.602 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
15:35:40.602 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:40.602 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.602 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:40.602 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
15:35:40.602 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
15:35:40.602 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
15:35:40.602 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
15:35:40.602 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:40.602 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:40.602 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:40.602 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:41.202 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader node-2 maintained leadership for 500ms
15:35:41.203 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:41.203 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:41.203 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:41.203 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:41.203 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:41.203 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:41.203 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:41.203 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:41.203 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:41.203 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:35:41.203 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:41.203 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:41.203 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:41.203 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:41.204 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:41.206 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:35:41.206 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:35:41.206 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:41.207 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:35:41.207 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:35:41.207 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:35:41.207 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:41.207 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:35:41.207 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:35:41.207 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:35:41.207 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:35:41.207 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:35:41.463 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:41.463 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:35:41.464 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:41.464 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
15:35:41.464 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:41.464 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
15:35:41.464 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:41.464 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:41.464 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:41.464 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:35:41.464 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:35:41.464 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
15:35:41.464 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
15:35:41.464 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:41.464 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:35:41.464 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:35:41.464 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:41.524 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Initial leader: node-3 (term 1)
15:35:41.525 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:35:41.525 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:41.525 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:41.525 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:35:41.525 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:35:41.712 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:35:41.712 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
15:35:41.712 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:35:41.712 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=2)
15:35:41.712 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:35:41.712 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:41.712 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
15:35:41.712 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
15:35:41.712 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
15:35:41.712 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:35:41.712 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
15:35:41.712 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
15:35:41.712 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
15:35:41.735 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - New leader: node-2 (term 2)
15:35:41.735 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:35:41.735 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:41.735 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:41.735 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:35:41.735 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:35:41.735 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:35:41.735 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
15:35:41.735 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:35:41.735 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:35:41.735 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped

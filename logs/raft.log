18:35:49.384 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:49.388 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-115785647828117107206
18:35:49.389 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-115785647828117107206
18:35:49.389 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:49.389 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:49.390 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:49.390 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:35:49.391 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:35:49.391 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:49.391 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-115785647828117107206
18:35:49.391 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-115785647828117107206
18:35:49.391 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:49.391 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:49.391 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:49.391 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:49.391 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-214658455505838935927
18:35:49.392 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-214658455505838935927
18:35:49.392 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:49.392 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:49.392 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:49.392 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:35:49.392 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:35:49.392 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:49.393 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-214658455505838935927
18:35:49.393 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-214658455505838935927
18:35:49.393 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:49.393 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:49.393 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:49.393 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:49.393 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-314829294819025384000
18:35:49.393 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-314829294819025384000
18:35:49.393 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:49.393 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:49.394 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:49.394 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:35:49.394 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:35:49.394 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:49.394 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-314829294819025384000
18:35:49.394 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-314829294819025384000
18:35:49.394 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:49.394 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:49.394 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:49.644 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:35:49.650 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:35:49.650 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:49.651 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:49.652 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:35:49.652 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:35:49.652 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:35:49.652 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:35:49.664 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:35:49.664 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:35:49.667 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
18:35:49.668 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
18:35:49.668 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
18:35:49.668 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:49.668 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:35:49.669 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:49.669 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=false)
18:35:49.669 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:35:49.669 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:35:49.669 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
18:35:49.669 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
18:35:49.669 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
18:35:49.670 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
18:35:49.670 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:35:49.670 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
18:35:49.670 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=false)
18:35:49.670 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:35:49.673 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=false)
18:35:49.674 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:35:49.674 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:35:49.724 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:35:49.725 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test-key, test-value)
18:35:49.730 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:35:49.730 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:35:49.730 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:35:49.730 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:35:49.730 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:35:49.730 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:35:49.730 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:35:49.730 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:35:49.731 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:49.731 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:49.731 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:35:49.731 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:35:49.731 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:35:49.731 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:35:49.731 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:35:49.731 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:35:49.731 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:35:49.732 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test-key, test-value)
18:35:49.781 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:35:49.781 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:35:49.781 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test-key, test-value)
18:35:49.781 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test-key, test-value)
18:35:49.935 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
18:35:49.936 [main] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:49.937 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=test-key, found=true
18:35:49.938 [main] [node-1] INFO  c.r.integration.LinearizableReadTest - ✓ Linearizable read returned committed value
18:35:49.941 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:35:49.941 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:49.941 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:49.941 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:35:49.941 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:35:49.941 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:35:49.941 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:49.941 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:49.941 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:35:49.941 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:35:49.941 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:35:49.942 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:49.942 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:49.942 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:35:49.942 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:35:49.950 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:49.951 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-112389926702235490643
18:35:49.951 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-112389926702235490643
18:35:49.951 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:49.951 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:49.951 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:49.951 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:35:49.951 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:35:49.951 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:49.951 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-112389926702235490643
18:35:49.952 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-112389926702235490643
18:35:49.952 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:49.952 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:49.952 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:49.952 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:49.952 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-24119425809606880624
18:35:49.952 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-24119425809606880624
18:35:49.952 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:49.952 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:49.952 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:49.952 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:35:49.952 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:35:49.952 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:49.953 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-24119425809606880624
18:35:49.953 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-24119425809606880624
18:35:49.953 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:49.953 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:49.953 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:49.953 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:49.953 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-32762609000934914530
18:35:49.953 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-32762609000934914530
18:35:49.953 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:49.953 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:49.953 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:49.953 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:35:49.953 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:35:49.953 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:49.954 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-32762609000934914530
18:35:49.954 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-32762609000934914530
18:35:49.954 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:49.954 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:49.954 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:50.156 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:35:50.157 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:50.158 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:35:50.158 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:35:50.158 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:35:50.158 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
18:35:50.158 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
18:35:50.159 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:50.159 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:50.159 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:35:50.159 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:35:50.159 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:50.159 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:50.160 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:35:50.160 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:35:50.160 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:35:50.160 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:35:50.160 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
18:35:50.160 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
18:35:50.160 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:35:50.160 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:35:50.160 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:35:50.160 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:35:50.172 [main] [node-1] INFO  c.r.integration.LinearizableReadTest - ✓ Linearizable read on follower correctly rejected
18:35:50.172 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:35:50.172 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:50.172 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:50.172 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:35:50.173 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:35:50.173 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:35:50.173 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:50.173 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:50.173 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:35:50.173 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:35:50.173 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:35:50.173 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:50.173 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:50.173 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:35:50.173 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:35:50.177 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:50.177 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-12955558460195323244
18:35:50.177 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-12955558460195323244
18:35:50.177 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:50.177 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:50.178 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:50.178 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:35:50.178 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:35:50.178 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:50.178 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-12955558460195323244
18:35:50.178 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-12955558460195323244
18:35:50.179 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:50.179 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:50.179 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:50.179 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:50.179 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-22205920532904415208
18:35:50.179 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-22205920532904415208
18:35:50.179 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:50.179 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:50.179 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:50.179 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:35:50.179 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:35:50.180 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:50.180 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-22205920532904415208
18:35:50.180 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-22205920532904415208
18:35:50.180 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:50.180 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:50.180 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:50.180 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:50.180 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-33195997282877420743
18:35:50.180 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-33195997282877420743
18:35:50.180 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:50.180 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:50.181 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:50.181 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:35:50.181 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:35:50.181 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:50.181 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-33195997282877420743
18:35:50.181 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-33195997282877420743
18:35:50.181 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:50.181 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:50.181 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:50.395 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:35:50.397 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:50.398 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:35:50.398 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:35:50.398 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:35:50.398 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
18:35:50.399 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
18:35:50.399 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:50.399 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:35:50.399 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:50.400 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:50.400 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:35:50.400 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:50.400 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:35:50.400 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:35:50.400 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
18:35:50.400 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:35:50.400 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:35:50.400 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:35:50.400 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:35:50.401 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:35:50.401 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:35:50.401 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
18:35:50.457 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:35:50.457 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(counter, value-1)
18:35:50.458 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:35:50.458 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:35:50.458 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:35:50.459 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:35:50.459 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:50.459 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:50.459 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:35:50.459 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:35:50.459 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:35:50.459 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:35:50.459 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:35:50.459 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:35:50.460 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(counter, value-1)
18:35:50.460 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:35:50.460 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(counter, value-2)
18:35:50.461 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:35:50.461 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:35:50.461 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:35:50.461 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:35:50.461 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:50.462 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:35:50.462 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:50.462 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:35:50.462 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:35:50.462 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:35:50.462 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
18:35:50.462 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(counter, value-1)
18:35:50.462 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:35:50.462 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
18:35:50.462 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(counter, value-2)
18:35:50.462 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(counter, value-1)
18:35:50.463 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:35:50.463 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(counter, value-3)
18:35:50.463 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
18:35:50.463 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
18:35:50.463 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:35:50.464 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:35:50.464 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:50.464 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:35:50.464 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:35:50.464 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:50.464 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:35:50.464 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(counter, value-2)
18:35:50.464 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
18:35:50.464 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:35:50.464 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:35:50.464 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
18:35:50.464 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(counter, value-2)
18:35:50.464 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(counter, value-3)
18:35:50.465 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
18:35:50.465 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(counter, value-4)
18:35:50.465 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
18:35:50.465 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
18:35:50.465 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:35:50.465 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:35:50.466 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:50.466 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:35:50.466 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:50.466 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:35:50.466 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:35:50.466 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
18:35:50.466 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:35:50.466 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(counter, value-3)
18:35:50.466 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
18:35:50.466 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:35:50.466 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:35:50.466 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(counter, value-3)
18:35:50.467 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(counter, value-4)
18:35:50.467 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
18:35:50.467 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(counter, value-5)
18:35:50.467 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
18:35:50.468 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:35:50.468 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
18:35:50.468 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:35:50.468 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:50.468 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:50.468 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:35:50.468 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:35:50.468 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:35:50.468 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:35:50.468 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
18:35:50.468 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
18:35:50.468 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(counter, value-4)
18:35:50.468 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(counter, value-4)
18:35:50.468 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:35:50.469 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:35:50.469 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(counter, value-5)
18:35:50.469 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=5
18:35:50.469 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:35:50.469 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:35:50.469 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:50.469 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(counter, value-5)
18:35:50.469 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(counter, value-5)
18:35:50.469 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=counter, found=true
18:35:50.471 [main] [node-3] INFO  c.r.integration.LinearizableReadTest - ✓ Linearizable read sees latest write
18:35:50.471 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:35:50.471 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:50.471 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:50.472 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:35:50.472 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:35:50.472 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:35:50.472 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:50.472 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:50.472 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:35:50.472 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:35:50.472 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:35:50.472 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:50.472 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:50.472 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:35:50.472 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:35:50.476 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:50.476 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-113358548318553585153
18:35:50.476 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-113358548318553585153
18:35:50.476 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:50.476 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:50.477 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:50.477 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:35:50.477 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:35:50.477 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:50.477 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-113358548318553585153
18:35:50.477 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-113358548318553585153
18:35:50.477 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:50.477 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:50.477 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:50.477 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:50.477 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-213242562478174330656
18:35:50.477 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-213242562478174330656
18:35:50.478 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:50.478 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:50.478 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:50.478 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:35:50.478 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:35:50.478 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:50.478 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-213242562478174330656
18:35:50.478 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-213242562478174330656
18:35:50.478 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:50.478 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:50.478 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:50.478 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:50.478 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-3331716077533613307
18:35:50.479 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-3331716077533613307
18:35:50.479 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:50.479 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:50.479 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:50.479 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:35:50.479 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:35:50.479 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:50.479 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-3331716077533613307
18:35:50.479 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-3331716077533613307
18:35:50.479 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:50.479 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:50.480 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:50.638 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:35:50.638 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:50.639 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:35:50.639 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:35:50.639 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:35:50.639 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
18:35:50.639 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
18:35:50.640 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:50.640 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:50.640 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:35:50.640 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:35:50.640 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:50.640 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:50.640 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:35:50.640 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:35:50.640 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:35:50.640 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:35:50.641 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
18:35:50.641 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
18:35:50.641 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:35:50.641 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:35:50.641 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:35:50.641 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:35:51.147 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=0
18:35:51.149 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:51.150 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=non-existent-key, found=false
18:35:51.151 [main] [node-2] INFO  c.r.integration.LinearizableReadTest - ✓ Linearizable read for non-existent key returns null
18:35:51.152 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:35:51.153 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:51.153 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:51.153 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:35:51.153 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:35:51.153 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:35:51.153 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:51.153 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:51.153 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:35:51.153 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:35:51.153 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:35:51.154 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:51.154 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:51.154 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:35:51.154 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:35:51.160 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:51.161 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-14489440407148002743
18:35:51.161 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-14489440407148002743
18:35:51.161 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:51.161 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:51.161 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:51.162 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:35:51.162 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:35:51.162 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:51.162 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-14489440407148002743
18:35:51.162 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-14489440407148002743
18:35:51.162 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:51.162 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:51.162 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:51.162 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:51.163 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-216247181090003960372
18:35:51.163 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-216247181090003960372
18:35:51.163 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:51.163 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:51.163 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:51.163 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:35:51.163 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:35:51.163 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:51.163 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-216247181090003960372
18:35:51.164 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-216247181090003960372
18:35:51.164 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:51.164 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:51.164 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:51.164 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:51.164 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-39031111227772185924
18:35:51.164 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-39031111227772185924
18:35:51.164 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:51.164 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:51.165 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:51.165 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:35:51.165 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:35:51.165 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:51.165 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-39031111227772185924
18:35:51.165 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-39031111227772185924
18:35:51.165 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:51.165 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:51.165 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:51.340 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:35:51.342 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:51.343 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:35:51.343 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:35:51.343 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:35:51.343 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:35:51.343 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
18:35:51.343 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
18:35:51.344 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:35:51.344 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:51.344 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:35:51.344 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:35:51.344 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:51.344 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
18:35:51.345 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:35:51.345 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:35:51.345 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:35:51.345 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:35:51.345 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:35:51.345 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:35:51.345 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
18:35:51.344 [election-node-1] [node-1] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-14489440407148002743/meta.dat.tmp -> /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-14489440407148002743/meta.dat
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixFileSystem.move(UnixFileSystem.java:823)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:289)
	at java.base/java.nio.file.Files.move(Files.java:1319)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:98)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:219)
	at com.raftdb.core.RaftState.persist(RaftState.java:85)
	at com.raftdb.core.RaftState.incrementTerm(RaftState.java:136)
	at com.raftdb.election.ElectionManager.startElection(ElectionManager.java:147)
	at com.raftdb.election.ElectionManager.onElectionTimeout(ElectionManager.java:139)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:545)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:309)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
18:35:51.382 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:35:51.383 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(leadership-test, confirmed)
18:35:51.383 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:35:51.383 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:35:51.383 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:35:51.383 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:35:51.383 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:51.383 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:35:51.383 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:35:51.384 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:35:51.384 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:51.384 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:35:51.384 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:35:51.384 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(leadership-test, confirmed)
18:35:51.398 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:35:51.398 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:35:51.398 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(leadership-test, confirmed)
18:35:51.399 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(leadership-test, confirmed)
18:35:51.589 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
18:35:51.589 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:51.589 [] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=leadership-test, found=true
18:35:51.590 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
18:35:51.590 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:51.590 [] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=leadership-test, found=true
18:35:51.590 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
18:35:51.590 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:51.590 [] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=leadership-test, found=true
18:35:51.590 [main] [node-3] INFO  c.r.integration.LinearizableReadTest - ✓ Multiple linearizable reads succeeded, leadership confirmed
18:35:51.590 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:35:51.590 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:51.590 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:51.590 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:35:51.590 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:35:51.590 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:35:51.590 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:51.590 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:51.590 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:35:51.590 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:35:51.590 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:35:51.590 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:51.591 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:51.591 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:35:51.591 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:35:51.593 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:51.593 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-114978151035544857967
18:35:51.593 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-114978151035544857967
18:35:51.593 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:51.593 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:51.594 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:51.594 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:35:51.594 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:35:51.594 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:51.594 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-114978151035544857967
18:35:51.594 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-114978151035544857967
18:35:51.594 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:51.594 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:51.594 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:51.804 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:35:51.804 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:51.805 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:35:51.805 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:35:51.805 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
18:35:51.805 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:35:51.805 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:35:51.805 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:35:52.599 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:35:52.599 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(single-node-key, single-node-value)
18:35:52.599 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:35:52.600 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(single-node-key, single-node-value)
18:35:52.600 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
18:35:52.600 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=single-node-key, found=true
18:35:52.600 [main] [node-1] INFO  c.r.integration.LinearizableReadTest - ✓ Single node linearizable read succeeded
18:35:52.601 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:35:52.601 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:52.601 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:52.601 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:35:52.601 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:35:52.605 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:52.605 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-112419485197168769448
18:35:52.605 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-112419485197168769448
18:35:52.605 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:52.605 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:52.605 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:52.605 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:35:52.605 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:35:52.605 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:52.605 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-112419485197168769448
18:35:52.605 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-112419485197168769448
18:35:52.605 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:52.605 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:52.605 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:52.605 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:52.606 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-29503563004453820436
18:35:52.606 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-29503563004453820436
18:35:52.606 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:52.606 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:52.606 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:52.606 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:35:52.606 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:35:52.606 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:52.606 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-29503563004453820436
18:35:52.606 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-29503563004453820436
18:35:52.606 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:52.606 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:52.606 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:52.606 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:52.607 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-314171171050737946038
18:35:52.607 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-314171171050737946038
18:35:52.607 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:52.607 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:52.607 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:52.607 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:35:52.607 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:35:52.607 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:52.608 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-314171171050737946038
18:35:52.608 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-314171171050737946038
18:35:52.608 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:52.608 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:52.608 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:52.788 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:35:52.789 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:52.789 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:35:52.789 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:35:52.789 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:35:52.790 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
18:35:52.790 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
18:35:52.790 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:52.790 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:35:52.790 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:52.790 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:52.790 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:35:52.790 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:52.791 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:35:52.791 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:35:52.791 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:35:52.791 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
18:35:52.791 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:35:52.791 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:35:52.791 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
18:35:52.791 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:35:52.791 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:35:52.791 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:35:52.829 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:35:52.829 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-key, 0)
18:35:52.829 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:35:52.829 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:35:52.829 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:35:52.829 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:35:52.830 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:52.830 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:35:52.830 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:52.830 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:35:52.830 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:35:52.830 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:35:52.830 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:35:52.830 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-key, 0)
18:35:52.844 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:35:52.844 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:35:52.844 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-key, 0)
18:35:52.844 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-key, 0)
18:35:53.040 [pool-3-thread-1] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:35:53.040 [pool-3-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-key, 1)
18:35:53.040 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:35:53.041 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:35:53.041 [pool-3-thread-2] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:35:53.041 [pool-3-thread-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-key, 2)
18:35:53.041 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=2)
18:35:53.041 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:53.041 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
18:35:53.041 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=2)
18:35:53.041 [pool-3-thread-3] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
18:35:53.041 [pool-3-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-key, 3)
18:35:53.041 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:35:53.041 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=2)
18:35:53.041 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
18:35:53.041 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
18:35:53.041 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=2)
18:35:53.042 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
18:35:53.042 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
18:35:53.042 [pool-3-thread-4] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
18:35:53.042 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
18:35:53.042 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 3
18:35:53.042 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=3)
18:35:53.042 [pool-3-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-key, 4)
18:35:53.042 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
18:35:53.042 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 3
18:35:53.042 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
18:35:53.042 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=4)
18:35:53.042 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 3
18:35:53.042 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=3)
18:35:53.042 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
18:35:53.042 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=2)
18:35:53.042 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-key, 1)
18:35:53.042 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
18:35:53.042 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:53.042 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=4)
18:35:53.042 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 3
18:35:53.042 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-key, 2)
18:35:53.042 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
18:35:53.043 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
18:35:53.042 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:53.043 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
18:35:53.043 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 4
18:35:53.043 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 5
18:35:53.043 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:35:53.043 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
18:35:53.043 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 5
18:35:53.043 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:35:53.043 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
18:35:53.043 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
18:35:53.043 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:53.043 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-key, 3)
18:35:53.043 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-key, 1)
18:35:53.043 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
18:35:53.043 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 5
18:35:53.043 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-key, 2)
18:35:53.043 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
18:35:53.043 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
18:35:53.043 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:35:53.043 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:35:53.043 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
18:35:53.043 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-key, 4)
18:35:53.043 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:35:53.043 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-key, 1)
18:35:53.044 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-key, 2)
18:35:53.096 [pool-3-thread-2] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
18:35:53.096 [pool-3-thread-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-key, 6)
18:35:53.097 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
18:35:53.097 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
18:35:53.097 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
18:35:53.098 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
18:35:53.098 [pool-3-thread-3] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
18:35:53.098 [pool-3-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-key, 5)
18:35:53.098 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:35:53.099 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:53.099 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:35:53.099 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:35:53.099 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
18:35:53.099 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
18:35:53.099 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:35:53.099 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:35:53.099 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:35:53.100 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:53.100 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:35:53.100 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:35:53.100 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
18:35:53.100 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:35:53.100 [pool-3-thread-4] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
18:35:53.100 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-key, 3)
18:35:53.100 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:35:53.100 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-key, 3)
18:35:53.100 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-key, 4)
18:35:53.100 [pool-3-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-key, 7)
18:35:53.100 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-key, 6)
18:35:53.100 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=7)
18:35:53.100 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-key, 4)
18:35:53.101 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=7)
18:35:53.101 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
18:35:53.101 [pool-3-thread-1] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
18:35:53.101 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
18:35:53.101 [pool-3-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-key, 8)
18:35:53.101 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=7)
18:35:53.101 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=7)
18:35:53.101 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=7)
18:35:53.101 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
18:35:53.101 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
18:35:53.101 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
18:35:53.101 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 8
18:35:53.101 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
18:35:53.101 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=7)
18:35:53.101 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:35:53.101 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 8
18:35:53.102 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
18:35:53.102 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 3 log entries
18:35:53.102 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:53.102 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
18:35:53.102 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:35:53.102 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
18:35:53.102 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
18:35:53.102 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
18:35:53.102 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
18:35:53.102 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 9
18:35:53.102 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 9
18:35:53.102 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
18:35:53.102 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-key, 5)
18:35:53.102 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-key, 6)
18:35:53.102 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-key, 7)
18:35:53.102 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
18:35:53.102 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-key, 6)
18:35:53.102 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-key, 8)
18:35:53.147 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
18:35:53.147 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
18:35:53.149 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-key, 5)
18:35:53.150 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-key, 7)
18:35:53.150 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-key, 8)
18:35:53.150 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-key, 5)
18:35:53.151 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-key, 7)
18:35:53.151 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-key, 8)
18:35:53.155 [pool-3-thread-1] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
18:35:53.155 [pool-3-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-key, 9)
18:35:53.155 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
18:35:53.155 [pool-3-thread-2] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
18:35:53.155 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:35:53.155 [pool-3-thread-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-key, 10)
18:35:53.155 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=10)
18:35:53.155 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=10)
18:35:53.156 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
18:35:53.156 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:53.156 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
18:35:53.156 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=10)
18:35:53.156 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
18:35:53.156 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
18:35:53.156 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
18:35:53.156 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
18:35:53.156 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
18:35:53.156 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:53.156 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 11
18:35:53.156 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-key, 9)
18:35:53.156 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 11
18:35:53.156 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
18:35:53.156 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
18:35:53.156 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 11
18:35:53.156 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
18:35:53.156 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
18:35:53.156 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-key, 10)
18:35:53.182 [pool-3-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:35:53.182 [pool-3-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:35:53.182 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
18:35:53.182 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
18:35:53.182 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
18:35:53.183 [] [node-3] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:53.183 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:53.183 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-key, 9)
18:35:53.183 [] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:35:53.183 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:35:53.183 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-key, 9)
18:35:53.183 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-key, 10)
18:35:53.183 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-key, 10)
18:35:53.207 [pool-3-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:35:53.208 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:53.208 [pool-3-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:35:53.208 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:35:53.208 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:53.208 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:35:53.232 [pool-3-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:35:53.232 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:53.232 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:35:53.233 [pool-3-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:35:53.233 [pool-3-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:35:53.233 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:53.233 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:35:53.233 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:53.233 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:35:53.235 [pool-3-thread-2] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:35:53.235 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:53.235 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:35:53.256 [pool-3-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:35:53.256 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:53.256 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:35:53.257 [pool-3-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:35:53.257 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:53.258 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:35:53.258 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:35:53.258 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:53.258 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:35:53.258 [main] [node-1] INFO  c.r.integration.LinearizableReadTest - ✓ Concurrent writes and linearizable reads completed successfully
18:35:53.258 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:35:53.258 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:53.258 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:53.258 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:35:53.258 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:35:53.258 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:35:53.258 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:53.258 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:53.259 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:35:53.259 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:35:53.259 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:35:53.259 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:53.259 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:53.259 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:35:53.259 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:35:53.262 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:53.262 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-16546394050633273690
18:35:53.262 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-16546394050633273690
18:35:53.262 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:53.262 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:53.262 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:53.262 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:35:53.262 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:35:53.262 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:35:53.262 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-16546394050633273690
18:35:53.262 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-16546394050633273690
18:35:53.262 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:53.262 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:53.262 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:35:53.262 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:53.263 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-2429914300492401186
18:35:53.263 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-2429914300492401186
18:35:53.263 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:53.263 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:53.263 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:53.263 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:35:53.263 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:35:53.263 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:35:53.263 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-2429914300492401186
18:35:53.263 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-2429914300492401186
18:35:53.263 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:53.263 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:53.263 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:35:53.263 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:53.263 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312464967484956205656
18:35:53.263 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312464967484956205656
18:35:53.263 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:53.263 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:53.263 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:53.263 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:35:53.263 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:35:53.263 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:35:53.263 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312464967484956205656
18:35:53.263 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312464967484956205656
18:35:53.263 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:35:53.263 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:35:53.264 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:35:53.285 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:35:53.285 [election-node-3] [node-3] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-314171171050737946038/meta.dat.tmp
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:213)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:244)
	at java.base/java.nio.file.spi.FileSystemProvider.newOutputStream(FileSystemProvider.java:426)
	at java.base/java.nio.file.Files.newOutputStream(Files.java:215)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:89)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:219)
	at com.raftdb.core.RaftState.persist(RaftState.java:85)
	at com.raftdb.core.RaftState.incrementTerm(RaftState.java:136)
	at com.raftdb.election.ElectionManager.startElection(ElectionManager.java:147)
	at com.raftdb.election.ElectionManager.onElectionTimeout(ElectionManager.java:139)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:545)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:309)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
18:35:53.383 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:35:53.384 [election-node-3] [node-3] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-314171171050737946038/meta.dat.tmp
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:213)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:244)
	at java.base/java.nio.file.spi.FileSystemProvider.newOutputStream(FileSystemProvider.java:426)
	at java.base/java.nio.file.Files.newOutputStream(Files.java:215)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:89)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:219)
	at com.raftdb.core.RaftState.persist(RaftState.java:85)
	at com.raftdb.core.RaftState.incrementTerm(RaftState.java:136)
	at com.raftdb.election.ElectionManager.startElection(ElectionManager.java:147)
	at com.raftdb.election.ElectionManager.onElectionTimeout(ElectionManager.java:139)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:545)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:309)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
18:35:53.404 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:35:53.405 [election-node-2] [node-2] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-29503563004453820436/meta.dat.tmp
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:213)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:244)
	at java.base/java.nio.file.spi.FileSystemProvider.newOutputStream(FileSystemProvider.java:426)
	at java.base/java.nio.file.Files.newOutputStream(Files.java:215)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:89)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:219)
	at com.raftdb.core.RaftState.persist(RaftState.java:85)
	at com.raftdb.core.RaftState.incrementTerm(RaftState.java:136)
	at com.raftdb.election.ElectionManager.startElection(ElectionManager.java:147)
	at com.raftdb.election.ElectionManager.onElectionTimeout(ElectionManager.java:139)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:545)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:309)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
18:35:53.538 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:35:53.538 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:53.539 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:35:53.539 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:35:53.539 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:35:53.539 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
18:35:53.539 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
18:35:53.539 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:53.539 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:35:53.539 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:53.540 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:35:53.540 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:35:53.540 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:53.540 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:35:53.540 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:35:53.540 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
18:35:53.540 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:35:53.540 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:35:53.540 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:35:53.540 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:35:53.540 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:35:53.540 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:35:53.540 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
18:35:53.580 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:35:53.580 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(compare-key, latest-value)
18:35:53.580 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:35:53.580 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:35:53.580 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:35:53.581 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:35:53.581 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:53.581 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:35:53.581 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:35:53.581 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:35:53.581 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:35:53.581 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:35:53.581 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:35:53.581 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:35:53.581 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(compare-key, latest-value)
18:35:53.593 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:35:53.593 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:35:53.593 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(compare-key, latest-value)
18:35:53.593 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(compare-key, latest-value)
18:35:53.786 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
18:35:53.787 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:35:53.787 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=compare-key, found=true
18:35:53.787 [main] [node-1] INFO  c.r.integration.LinearizableReadTest - ✓ Both stale and linearizable reads returned correct value
18:35:53.787 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:35:53.788 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:53.788 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:53.788 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:35:53.788 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:35:53.788 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:35:53.788 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:53.788 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:53.788 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:35:53.788 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:35:53.788 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:35:53.788 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:35:53.788 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:35:53.788 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:35:53.788 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:04.365 [main] [] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
18:36:04.367 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:04.368 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
18:36:04.368 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
18:36:04.369 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:04.369 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:04.369 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:04.369 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
18:36:04.370 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
18:36:04.370 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:04.370 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
18:36:04.370 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
18:36:04.370 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:04.370 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:04.370 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:04.371 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
18:36:04.371 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
18:36:04.371 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:04.371 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
18:36:04.371 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
18:36:04.371 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:04.371 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:04.372 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:04.372 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
18:36:04.553 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:04.556 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:04.556 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:04.556 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:04.558 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:04.562 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
18:36:04.563 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
18:36:04.659 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:04.659 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:04.660 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:04.660 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:04.660 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:04.660 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
18:36:04.660 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
18:36:04.662 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:04.662 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:04.662 [grpc-default-executor-0] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:04.662 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:04.663 [grpc-default-executor-0] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:04.665 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
18:36:04.666 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
18:36:04.666 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
18:36:04.667 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=false
18:36:04.667 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=false
18:36:04.667 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=false
18:36:04.668 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
18:36:04.668 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:04.668 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:04.668 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:04.668 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:04.690 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=name
18:36:04.690 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:04.691 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(name, Alice)
18:36:04.691 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:04.692 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:04.693 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:04.693 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:04.694 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:04.694 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:04.694 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
18:36:04.694 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
18:36:04.695 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:04.695 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:04.695 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:04.695 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:04.695 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(name, Alice)
18:36:04.698 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=age
18:36:04.698 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:04.698 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(age, 25)
18:36:04.698 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:04.699 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:04.700 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:04.700 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:04.700 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:04.700 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:04.700 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:04.700 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:04.700 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(name, Alice)
18:36:04.700 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(name, Alice)
18:36:04.701 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
18:36:04.701 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
18:36:04.701 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
18:36:04.701 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
18:36:04.701 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:04.701 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:04.701 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(age, 25)
18:36:04.703 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=name
18:36:04.726 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=age
18:36:04.727 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:04.727 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(age, 25)
18:36:04.727 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:04.727 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(age, 25)
18:36:04.728 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=nonexistent
18:36:04.729 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Basic put/get test passed
18:36:04.732 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:04.732 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:04.732 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:04.735 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
18:36:04.735 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:04.735 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:04.736 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:04.736 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:04.737 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
18:36:04.737 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:04.737 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:04.737 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:04.737 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:04.737 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
18:36:04.737 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:04.851 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
18:36:04.851 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:04.851 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
18:36:04.851 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
18:36:04.851 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:04.851 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:04.852 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:04.852 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
18:36:04.852 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
18:36:04.852 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:04.852 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
18:36:04.853 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
18:36:04.853 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:04.853 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:04.853 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:04.853 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
18:36:04.853 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
18:36:04.853 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:04.854 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
18:36:04.854 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
18:36:04.854 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:04.854 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:04.854 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:04.854 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
18:36:05.061 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:05.063 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:05.064 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:05.064 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:05.064 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:05.064 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
18:36:05.064 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
18:36:05.067 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:05.068 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:05.069 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:05.069 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:05.069 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:05.069 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
18:36:05.069 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
18:36:05.071 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
18:36:05.072 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:05.072 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:05.072 [grpc-default-executor-3] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:05.073 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:05.073 [grpc-default-executor-3] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:05.073 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=false
18:36:05.074 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
18:36:05.074 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
18:36:05.074 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
18:36:05.074 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:05.074 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:05.074 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:05.074 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:05.075 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=false
18:36:05.075 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=false
18:36:05.168 [grpc-default-executor-6] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=temp
18:36:05.169 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
18:36:05.170 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:05.172 [grpc-default-executor-6] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=temp
18:36:05.173 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:05.173 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(temp, value)
18:36:05.173 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:05.173 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:05.174 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:05.174 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:05.174 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:05.174 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:05.175 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:05.175 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:05.175 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:05.175 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:05.175 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:05.175 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:05.175 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(temp, value)
18:36:05.176 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:05.176 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:05.176 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(temp, value)
18:36:05.176 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(temp, value)
18:36:05.177 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=temp
18:36:05.178 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=DELETE, key=temp
18:36:05.178 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:05.178 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(temp)
18:36:05.178 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:05.178 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:05.179 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:05.179 [grpc-default-executor-6] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:05.179 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:05.179 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:05.180 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:05.180 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:05.180 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
18:36:05.180 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
18:36:05.180 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:05.180 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:05.180 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(temp)
18:36:05.181 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=temp
18:36:05.182 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Delete test passed
18:36:05.182 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:05.182 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:05.182 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:05.183 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
18:36:05.183 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:05.184 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:05.184 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:05.184 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:05.184 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
18:36:05.184 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:05.184 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:05.184 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:05.184 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:05.184 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
18:36:05.184 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:05.292 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
18:36:05.293 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:05.293 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
18:36:05.293 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
18:36:05.293 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:05.293 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:05.293 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:05.293 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
18:36:05.294 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
18:36:05.294 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:05.294 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
18:36:05.294 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
18:36:05.294 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:05.294 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:05.295 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:05.295 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
18:36:05.295 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
18:36:05.295 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:05.295 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
18:36:05.295 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
18:36:05.295 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:05.295 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:05.296 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:05.296 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
18:36:05.488 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:05.490 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:05.491 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:36:05.491 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:05.491 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:05.491 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:05.491 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
18:36:05.492 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
18:36:05.492 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:05.493 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:05.494 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:05.494 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:05.494 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
18:36:05.494 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
18:36:05.498 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
18:36:05.498 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:05.498 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
18:36:05.498 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:05.498 [grpc-default-executor-7] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:05.498 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
18:36:05.499 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:36:05.499 [grpc-default-executor-7] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:05.499 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=false
18:36:05.499 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=false
18:36:05.499 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=false
18:36:05.500 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=true
18:36:05.500 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:05.500 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:05.500 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:05.500 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:05.510 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=redirect-test
18:36:05.511 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:05.511 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:05.512 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=redirect-test
18:36:05.513 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:05.513 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:05.516 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=redirect-test
18:36:05.517 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:05.517 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:05.520 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=redirect-test
18:36:05.520 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:05.520 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(redirect-test, value)
18:36:05.520 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:05.520 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:05.522 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:05.522 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:05.522 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:05.522 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:05.522 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
18:36:05.522 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
18:36:05.523 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:05.523 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:05.523 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:05.523 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:05.523 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(redirect-test, value)
18:36:05.524 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=redirect-test
18:36:05.525 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Auto-redirect test passed
18:36:05.526 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:05.526 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:05.526 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:05.527 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
18:36:05.527 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:05.527 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:05.527 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:05.527 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:05.528 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
18:36:05.528 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:05.528 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:05.528 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:05.528 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:05.528 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
18:36:05.528 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:05.632 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
18:36:05.633 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:05.633 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
18:36:05.633 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
18:36:05.633 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:05.633 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:05.633 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:05.633 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
18:36:05.634 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
18:36:05.634 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:05.634 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
18:36:05.634 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
18:36:05.634 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:05.634 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:05.634 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:05.634 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
18:36:05.635 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
18:36:05.635 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:05.635 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
18:36:05.635 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
18:36:05.635 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:05.635 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:05.635 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:05.635 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
18:36:05.791 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:05.792 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:05.793 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:05.793 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:05.793 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:05.793 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
18:36:05.793 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
18:36:05.797 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:05.797 [grpc-default-executor-7] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:05.797 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:05.797 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:05.797 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:05.797 [grpc-default-executor-7] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:05.798 [grpc-default-executor-7] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:05.798 [grpc-default-executor-7] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:05.798 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:05.798 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:05.799 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
18:36:05.799 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
18:36:05.799 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:05.799 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:05.799 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:05.799 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:05.849 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=before
18:36:05.849 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
18:36:05.850 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:05.852 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=before
18:36:05.852 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:05.852 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, leader-change)
18:36:05.852 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:05.852 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:05.852 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:05.853 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:05.853 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:05.853 [grpc-default-executor-7] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:05.854 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:05.854 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:05.854 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:05.854 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:05.854 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:05.854 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:05.854 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:05.854 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:05.854 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:05.854 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:05.854 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:05.854 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:05.855 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, leader-change)
18:36:05.856 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=before
18:36:05.856 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:05.856 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:05.857 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:05.858 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
18:36:05.858 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:06.086 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:06.090 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
18:36:06.090 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
18:36:06.090 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:06.090 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
18:36:06.090 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
18:36:06.097 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
18:36:06.097 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:06.097 [grpc-default-executor-0] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:06.098 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
18:36:06.098 [grpc-default-executor-0] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
18:36:06.099 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: Vote request to node-2 failed
18:36:06.100 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=2) -> granted=true
18:36:06.100 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:06.100 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
18:36:06.100 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
18:36:06.100 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:06.173 [main] [node-2] DEBUG com.raftdb.client.RaftKVClient - Request to localhost:18002 failed: UNAVAILABLE: io exception
18:36:06.177 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=after
18:36:06.178 [main] [node-2] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-1
18:36:06.178 [main] [node-2] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:06.179 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=after
18:36:06.180 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
18:36:06.180 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after, leader-change)
18:36:06.180 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:06.180 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:06.181 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:06.181 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:06.182 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
18:36:06.182 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
18:36:06.182 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
18:36:06.182 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, leader-change)
18:36:06.182 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after, leader-change)
18:36:06.184 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=after
18:36:06.185 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=before
18:36:06.186 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Leader change retry test passed
18:36:06.186 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:06.187 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:06.187 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:06.187 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
18:36:06.187 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:06.187 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:06.187 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:06.187 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:06.188 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
18:36:06.188 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:06.297 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
18:36:06.297 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:06.298 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
18:36:06.298 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
18:36:06.298 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:06.298 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:06.298 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:06.298 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
18:36:06.299 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
18:36:06.299 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:06.299 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
18:36:06.299 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
18:36:06.299 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:06.299 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:06.300 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:06.300 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
18:36:06.300 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
18:36:06.300 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:06.301 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
18:36:06.301 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
18:36:06.301 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:06.301 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:06.301 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:06.301 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
18:36:06.465 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:06.469 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:06.470 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:36:06.470 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:06.470 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:06.470 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
18:36:06.470 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
18:36:06.478 [grpc-default-executor-7] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:06.478 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:06.478 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:06.478 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:06.478 [grpc-default-executor-7] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:06.478 [grpc-default-executor-0] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:06.479 [grpc-default-executor-7] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:36:06.479 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:36:06.479 [grpc-default-executor-7] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:06.479 [grpc-default-executor-0] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:06.480 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=true
18:36:06.480 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=true
18:36:06.480 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:06.480 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:06.480 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:06.481 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:07.036 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-2
18:36:07.036 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-3
18:36:07.041 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-0
18:36:07.036 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-1
18:36:07.041 [grpc-default-executor-8] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-4
18:36:07.042 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.042 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.042 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.042 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.042 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.042 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.042 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.042 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.042 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.042 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.046 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-1
18:36:07.046 [grpc-default-executor-8] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-4
18:36:07.046 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-2
18:36:07.046 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-3
18:36:07.046 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-0
18:36:07.046 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:07.047 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-1, value-1)
18:36:07.047 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:07.047 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.047 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-4, value-4)
18:36:07.047 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.047 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=1)
18:36:07.047 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.047 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.047 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.047 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=1)
18:36:07.047 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.047 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=1)
18:36:07.047 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=1)
18:36:07.048 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-2
18:36:07.048 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-3
18:36:07.048 [grpc-default-executor-5] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-0
18:36:07.048 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
18:36:07.048 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
18:36:07.048 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:36:07.049 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
18:36:07.049 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
18:36:07.049 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
18:36:07.049 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-3, value-3)
18:36:07.049 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
18:36:07.049 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=1)
18:36:07.049 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=1)
18:36:07.049 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.049 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.049 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.049 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.049 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
18:36:07.049 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
18:36:07.049 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
18:36:07.049 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
18:36:07.049 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
18:36:07.049 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
18:36:07.049 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
18:36:07.049 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
18:36:07.049 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-2
18:36:07.050 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-1, value-1)
18:36:07.050 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-4, value-4)
18:36:07.050 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.050 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.050 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
18:36:07.050 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
18:36:07.050 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-0
18:36:07.050 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.050 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.050 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=3) -> success=true
18:36:07.050 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=3) -> success=true
18:36:07.050 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
18:36:07.050 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
18:36:07.050 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:36:07.051 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:36:07.051 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-3, value-3)
18:36:07.051 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.051 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.051 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-2
18:36:07.051 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
18:36:07.051 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-2, value-2)
18:36:07.051 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-5
18:36:07.051 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-0
18:36:07.051 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-6
18:36:07.051 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
18:36:07.051 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
18:36:07.051 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-5, value-5)
18:36:07.051 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=4)
18:36:07.051 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=4)
18:36:07.051 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
18:36:07.051 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-6, value-6)
18:36:07.051 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=4)
18:36:07.051 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=4)
18:36:07.052 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=4)
18:36:07.052 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.052 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.052 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-7
18:36:07.052 [pool-4-thread-1] [] WARN  com.raftdb.integration.KVClientTest - Concurrent write 0 failed: Failed after 5 retries
18:36:07.052 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
18:36:07.052 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
18:36:07.052 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:07.052 [grpc-default-executor-6] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.052 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.052 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-1, value-1)
18:36:07.052 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:36:07.052 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.052 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-4, value-4)
18:36:07.052 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.052 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.052 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 6
18:36:07.052 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-8
18:36:07.052 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
18:36:07.052 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 6
18:36:07.053 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:07.053 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-3, value-3)
18:36:07.053 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:07.053 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.053 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 6
18:36:07.053 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
18:36:07.053 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-1, value-1)
18:36:07.053 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
18:36:07.053 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-4, value-4)
18:36:07.053 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 5
18:36:07.053 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-3, value-3)
18:36:07.053 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-2, value-2)
18:36:07.053 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-5, value-5)
18:36:07.053 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=3) -> success=true
18:36:07.053 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
18:36:07.053 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
18:36:07.053 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-7
18:36:07.053 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=3) -> success=true
18:36:07.053 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
18:36:07.053 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
18:36:07.053 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-7, value-7)
18:36:07.053 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
18:36:07.053 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-6, value-6)
18:36:07.053 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=6)
18:36:07.053 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.053 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=3) -> success=true
18:36:07.053 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
18:36:07.053 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
18:36:07.053 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.054 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
18:36:07.054 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.054 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
18:36:07.054 [grpc-default-executor-11] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.054 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:07.054 [grpc-default-executor-11] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 7
18:36:07.054 [grpc-default-executor-11] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:07.054 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-8
18:36:07.054 [grpc-default-executor-10] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-10
18:36:07.054 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-2, value-2)
18:36:07.054 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-2, value-2)
18:36:07.054 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-9
18:36:07.054 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-5, value-5)
18:36:07.054 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-5, value-5)
18:36:07.055 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-6, value-6)
18:36:07.055 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-6, value-6)
18:36:07.055 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
18:36:07.055 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-11
18:36:07.055 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
18:36:07.055 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
18:36:07.055 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
18:36:07.055 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
18:36:07.055 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.055 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.055 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-7, value-7)
18:36:07.055 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.055 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.055 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.055 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.055 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.055 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.055 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-8
18:36:07.055 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-10
18:36:07.056 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-9
18:36:07.056 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
18:36:07.056 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.056 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.056 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-9, value-9)
18:36:07.056 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.056 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
18:36:07.056 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.056 [grpc-default-executor-10] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-12
18:36:07.056 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-11
18:36:07.056 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
18:36:07.056 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-8
18:36:07.056 [grpc-default-executor-10] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-10
18:36:07.056 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
18:36:07.056 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.056 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-8, value-8)
18:36:07.056 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.056 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.056 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.056 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
18:36:07.057 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=8)
18:36:07.057 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.057 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
18:36:07.057 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=8)
18:36:07.057 [grpc-default-executor-11] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.057 [grpc-default-executor-11] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
18:36:07.057 [grpc-default-executor-11] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
18:36:07.057 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-7, value-7)
18:36:07.057 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-7, value-7)
18:36:07.057 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.057 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.057 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
18:36:07.057 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
18:36:07.057 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
18:36:07.057 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-11
18:36:07.057 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-9, value-9)
18:36:07.057 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
18:36:07.057 [grpc-default-executor-11] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-12
18:36:07.057 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
18:36:07.057 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
18:36:07.057 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.057 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-11, value-11)
18:36:07.057 [grpc-default-executor-11] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-10
18:36:07.057 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 9
18:36:07.058 [grpc-default-executor-10] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.058 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 9
18:36:07.058 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=9)
18:36:07.058 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=9)
18:36:07.058 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.058 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.058 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.058 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.058 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
18:36:07.058 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
18:36:07.058 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
18:36:07.058 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
18:36:07.058 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
18:36:07.058 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
18:36:07.058 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
18:36:07.059 [grpc-default-executor-11] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.059 [grpc-default-executor-6] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.059 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 10
18:36:07.059 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-10
18:36:07.059 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
18:36:07.059 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-9, value-9)
18:36:07.059 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 10
18:36:07.059 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-13
18:36:07.059 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
18:36:07.059 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-12
18:36:07.059 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-9, value-9)
18:36:07.059 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
18:36:07.059 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
18:36:07.059 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=10)
18:36:07.059 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
18:36:07.059 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
18:36:07.059 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
18:36:07.059 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=10)
18:36:07.059 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.059 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
18:36:07.059 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.059 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
18:36:07.059 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-11, value-11)
18:36:07.060 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.060 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-14
18:36:07.060 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.060 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
18:36:07.060 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-14, value-14)
18:36:07.060 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=11)
18:36:07.060 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
18:36:07.060 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-13
18:36:07.060 [grpc-default-executor-10] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.060 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.060 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 11
18:36:07.060 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 11
18:36:07.060 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
18:36:07.060 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
18:36:07.060 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
18:36:07.060 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
18:36:07.060 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.060 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-12
18:36:07.060 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.061 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.061 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
18:36:07.061 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
18:36:07.061 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
18:36:07.061 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-15
18:36:07.061 [grpc-default-executor-10] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.061 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
18:36:07.061 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
18:36:07.061 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
18:36:07.061 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
18:36:07.061 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=11
18:36:07.061 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
18:36:07.061 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.061 [grpc-default-executor-9] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-13
18:36:07.061 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.061 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-11, value-11)
18:36:07.061 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
18:36:07.061 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-11, value-11)
18:36:07.061 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-13, value-13)
18:36:07.061 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
18:36:07.061 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.061 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.061 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=12)
18:36:07.061 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
18:36:07.061 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
18:36:07.061 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=12)
18:36:07.062 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
18:36:07.062 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
18:36:07.061 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=12
18:36:07.062 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-12
18:36:07.062 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-14, value-14)
18:36:07.062 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-15
18:36:07.062 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.062 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.062 [pool-4-thread-4] [] WARN  com.raftdb.integration.KVClientTest - Concurrent write 12 failed: Failed after 5 retries
18:36:07.062 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.062 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.062 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 13
18:36:07.062 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-16
18:36:07.062 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 13
18:36:07.062 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
18:36:07.062 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
18:36:07.062 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
18:36:07.062 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.062 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
18:36:07.063 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.063 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-17
18:36:07.063 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.063 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.063 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-18
18:36:07.063 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
18:36:07.063 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
18:36:07.063 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
18:36:07.063 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=13
18:36:07.063 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=13
18:36:07.063 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-18, value-18)
18:36:07.063 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
18:36:07.063 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-15
18:36:07.063 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
18:36:07.063 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-13, value-13)
18:36:07.063 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=14)
18:36:07.063 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.063 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=14)
18:36:07.063 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.063 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-16
18:36:07.063 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.063 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.064 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.064 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.064 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.064 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
18:36:07.064 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
18:36:07.064 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-14, value-14)
18:36:07.064 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-17
18:36:07.064 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-13, value-13)
18:36:07.064 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
18:36:07.064 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-19
18:36:07.064 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-15
18:36:07.064 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.064 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-17, value-17)
18:36:07.064 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
18:36:07.064 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-16
18:36:07.064 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
18:36:07.064 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-14, value-14)
18:36:07.064 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-13, value-13)
18:36:07.064 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=14)
18:36:07.064 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=14)
18:36:07.064 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
18:36:07.064 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=14
18:36:07.064 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
18:36:07.065 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-18, value-18)
18:36:07.065 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
18:36:07.065 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=14
18:36:07.065 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.065 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.065 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.065 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.065 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.065 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.065 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-19
18:36:07.065 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.066 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 15
18:36:07.066 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
18:36:07.066 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-19, value-19)
18:36:07.066 [grpc-default-executor-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.066 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 15
18:36:07.066 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=15)
18:36:07.066 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=15)
18:36:07.066 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-15
18:36:07.066 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-16
18:36:07.066 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
18:36:07.066 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=15
18:36:07.066 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
18:36:07.067 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
18:36:07.067 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=15
18:36:07.067 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-17, value-17)
18:36:07.067 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.067 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
18:36:07.067 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.067 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
18:36:07.067 [pool-4-thread-5] [] WARN  com.raftdb.integration.KVClientTest - Concurrent write 15 failed: Failed after 5 retries
18:36:07.067 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.067 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 16
18:36:07.068 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
18:36:07.068 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:07.068 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-18, value-18)
18:36:07.068 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 16
18:36:07.068 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
18:36:07.068 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-18, value-18)
18:36:07.069 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
18:36:07.069 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=16
18:36:07.069 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
18:36:07.070 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-19, value-19)
18:36:07.070 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
18:36:07.070 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-16
18:36:07.070 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=16
18:36:07.071 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
18:36:07.071 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
18:36:07.071 [pool-4-thread-2] [] WARN  com.raftdb.integration.KVClientTest - Concurrent write 16 failed: Failed after 5 retries
18:36:07.082 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:07.082 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:07.082 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:07.083 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
18:36:07.083 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-17, value-17)
18:36:07.083 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-19, value-19)
18:36:07.083 [grpc-default-executor-4] [node-1] ERROR com.raftdb.rpc.GrpcTransport - Error handling AppendEntries
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@7a442f02[Not completed, task = java.util.concurrent.Executors$RunnableAdapter@6564f61e[Wrapped task = com.raftdb.election.ElectionManager$$Lambda/0x0000007c01217398@5c987b63]] rejected from java.util.concurrent.ScheduledThreadPoolExecutor@7caa550[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 10]
	at java.base/java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2032)
	at java.base/java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:787)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:345)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:549)
	at java.base/java.util.concurrent.Executors$DelegatedScheduledExecutorService.schedule(Executors.java:780)
	at com.raftdb.election.ElectionManager.resetElectionTimer(ElectionManager.java:109)
	at com.raftdb.core.RaftNode.handleAppendEntries(RaftNode.java:699)
	at com.raftdb.rpc.GrpcTransport$RaftServiceImpl.appendEntries(GrpcTransport.java:279)
	at com.raftdb.rpc.proto.RaftServiceGrpc$MethodHandlers.invoke(RaftServiceGrpc.java:374)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:351)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
18:36:07.085 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
18:36:07.085 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:07.085 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:07.085 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:07.085 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:07.087 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
18:36:07.087 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:07.087 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:07.087 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:07.087 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:07.087 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
18:36:07.088 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:07.198 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
18:36:07.198 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:07.198 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
18:36:07.198 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
18:36:07.198 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:07.198 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:07.198 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:07.198 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
18:36:07.474 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:07.475 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:07.476 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:07.476 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:07.476 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
18:36:07.476 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:07.476 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:07.476 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:07.518 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=single
18:36:07.519 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:07.519 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(single, node)
18:36:07.519 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:07.519 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(single, node)
18:36:07.521 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=single
18:36:07.521 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Single node client test passed
18:36:07.522 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:07.522 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:07.522 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:07.522 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
18:36:07.522 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:07.634 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:07.635 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:07.635 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:07.635 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:07.635 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:07.635 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:07.635 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:07.635 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:07.635 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:07.635 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:07.635 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:07.635 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:07.635 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:07.635 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:07.635 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:07.788 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:07.788 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:07.788 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:07.788 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
18:36:07.788 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:07.788 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
18:36:07.788 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:07.788 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:07.788 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:07.788 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:07.788 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:07.788 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
18:36:07.788 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
18:36:07.788 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:07.789 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:07.789 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:07.789 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:07.849 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:07.849 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key3, value3)
18:36:07.849 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:07.849 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:07.849 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
18:36:07.849 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
18:36:07.849 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:07.849 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:07.849 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:07.849 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:07.850 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:07.850 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:07.850 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
18:36:07.850 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:07.850 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(key3)
18:36:07.850 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:07.850 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:07.850 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
18:36:07.850 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
18:36:07.850 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:07.850 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:07.850 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:07.850 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:07.850 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
18:36:07.850 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:07.850 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
18:36:07.850 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
18:36:07.850 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
18:36:07.850 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
18:36:07.894 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:07.894 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:07.894 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
18:36:07.894 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
18:36:07.959 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:07.959 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:07.959 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:07.959 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:07.959 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:07.959 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:07.960 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:07.960 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:07.960 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:07.960 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:07.960 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:07.960 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:07.960 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:07.960 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:07.960 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:07.961 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:07.961 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:07.961 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:07.961 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:07.961 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:07.962 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:07.962 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:07.962 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:07.962 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:07.962 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:07.962 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:07.962 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:07.962 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:07.962 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:07.962 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:08.154 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:08.155 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:08.155 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:08.156 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
18:36:08.156 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:08.156 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:08.156 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:08.156 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
18:36:08.156 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:08.156 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:08.156 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:08.156 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:08.157 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:08.157 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:08.157 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
18:36:08.157 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:08.157 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
18:36:08.175 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:08.175 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-0, value-0)
18:36:08.177 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:08.177 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:08.177 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:08.177 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:08.177 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:08.177 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:08.177 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:08.178 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-1, value-1)
18:36:08.178 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:08.178 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:08.178 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:08.178 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:08.178 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
18:36:08.178 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:36:08.178 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:08.178 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-2, value-2)
18:36:08.178 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:08.178 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:08.179 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
18:36:08.179 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-3, value-3)
18:36:08.179 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:08.179 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:08.179 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:08.179 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=2)
18:36:08.179 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
18:36:08.179 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:08.179 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-4, value-4)
18:36:08.179 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=2)
18:36:08.179 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
18:36:08.179 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=2)
18:36:08.179 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
18:36:08.179 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:08.179 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
18:36:08.179 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
18:36:08.179 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
18:36:08.179 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 5
18:36:08.179 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
18:36:08.179 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
18:36:08.179 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
18:36:08.179 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-5, value-5)
18:36:08.179 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=2)
18:36:08.179 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=3)
18:36:08.179 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 5
18:36:08.180 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
18:36:08.179 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
18:36:08.180 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=5)
18:36:08.180 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
18:36:08.179 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
18:36:08.180 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=6)
18:36:08.179 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 5
18:36:08.180 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 6
18:36:08.180 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
18:36:08.180 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
18:36:08.179 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 5
18:36:08.180 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=3)
18:36:08.180 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-6, value-6)
18:36:08.180 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
18:36:08.180 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:08.180 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
18:36:08.180 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
18:36:08.180 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 6
18:36:08.180 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=5)
18:36:08.180 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:08.180 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
18:36:08.180 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
18:36:08.180 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 7
18:36:08.180 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
18:36:08.180 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-7, value-7)
18:36:08.180 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 7
18:36:08.181 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:08.180 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
18:36:08.180 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
18:36:08.181 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=6)
18:36:08.181 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
18:36:08.181 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
18:36:08.181 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:08.181 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
18:36:08.181 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
18:36:08.181 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
18:36:08.181 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
18:36:08.181 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-8, value-8)
18:36:08.181 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=6)
18:36:08.181 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
18:36:08.181 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
18:36:08.181 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
18:36:08.181 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=7)
18:36:08.181 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
18:36:08.181 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
18:36:08.181 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
18:36:08.181 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
18:36:08.181 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
18:36:08.181 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
18:36:08.181 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:08.181 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
18:36:08.182 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
18:36:08.182 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
18:36:08.182 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-9, value-9)
18:36:08.181 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
18:36:08.182 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=8)
18:36:08.182 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
18:36:08.182 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
18:36:08.182 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
18:36:08.182 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=8)
18:36:08.182 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
18:36:08.182 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
18:36:08.181 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
18:36:08.182 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
18:36:08.182 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
18:36:08.182 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
18:36:08.182 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 10
18:36:08.182 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
18:36:08.182 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:08.182 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
18:36:08.182 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 10
18:36:08.182 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
18:36:08.182 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=8)
18:36:08.182 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
18:36:08.182 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
18:36:08.182 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=9)
18:36:08.182 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
18:36:08.182 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=9)
18:36:08.182 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
18:36:08.182 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
18:36:08.182 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
18:36:08.182 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=10)
18:36:08.182 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
18:36:08.182 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
18:36:08.182 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 11
18:36:08.182 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
18:36:08.182 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
18:36:08.183 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
18:36:08.183 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 12
18:36:08.183 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
18:36:08.182 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
18:36:08.183 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
18:36:08.182 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
18:36:08.182 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
18:36:08.183 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
18:36:08.182 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 10
18:36:08.182 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 11
18:36:08.183 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
18:36:08.183 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
18:36:08.183 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 12
18:36:08.183 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 12
18:36:08.183 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
18:36:08.183 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=12
18:36:08.183 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 12
18:36:08.183 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
18:36:08.183 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 12
18:36:08.183 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
18:36:08.183 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=11)
18:36:08.183 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
18:36:08.183 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
18:36:08.183 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=13)
18:36:08.183 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
18:36:08.183 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
18:36:08.183 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
18:36:08.184 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-13, value-13)
18:36:08.184 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=13)
18:36:08.184 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
18:36:08.184 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
18:36:08.183 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
18:36:08.183 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
18:36:08.184 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:08.184 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
18:36:08.184 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
18:36:08.184 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
18:36:08.184 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=13)
18:36:08.184 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-14, value-14)
18:36:08.184 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=13)
18:36:08.184 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
18:36:08.184 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=13)
18:36:08.184 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
18:36:08.184 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
18:36:08.184 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
18:36:08.184 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 14
18:36:08.184 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
18:36:08.184 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=13
18:36:08.184 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 14
18:36:08.184 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
18:36:08.184 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
18:36:08.184 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=14
18:36:08.184 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
18:36:08.184 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
18:36:08.184 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
18:36:08.184 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
18:36:08.184 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
18:36:08.185 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
18:36:08.184 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=13)
18:36:08.184 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
18:36:08.185 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
18:36:08.185 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
18:36:08.184 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
18:36:08.185 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
18:36:08.185 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=15)
18:36:08.184 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=13)
18:36:08.185 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
18:36:08.185 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
18:36:08.185 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=16)
18:36:08.185 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
18:36:08.185 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=15
18:36:08.185 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
18:36:08.185 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
18:36:08.185 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
18:36:08.185 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
18:36:08.185 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 17
18:36:08.185 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-16, value-16)
18:36:08.185 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
18:36:08.185 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
18:36:08.185 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=16
18:36:08.185 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
18:36:08.185 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
18:36:08.185 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
18:36:08.185 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=16)
18:36:08.185 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
18:36:08.185 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 17
18:36:08.185 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
18:36:08.185 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
18:36:08.185 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=15
18:36:08.185 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
18:36:08.185 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 17
18:36:08.185 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
18:36:08.185 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
18:36:08.185 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
18:36:08.185 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-17, value-17)
18:36:08.185 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 17
18:36:08.185 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
18:36:08.185 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=17)
18:36:08.186 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
18:36:08.185 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=17
18:36:08.186 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
18:36:08.186 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
18:36:08.186 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
18:36:08.185 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
18:36:08.185 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 17
18:36:08.185 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=17
18:36:08.185 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
18:36:08.185 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
18:36:08.186 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-18, value-18)
18:36:08.186 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
18:36:08.186 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=18)
18:36:08.186 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
18:36:08.186 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
18:36:08.186 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
18:36:08.186 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
18:36:08.186 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-19, value-19)
18:36:08.186 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 18
18:36:08.186 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
18:36:08.186 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=18)
18:36:08.186 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
18:36:08.186 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=18)
18:36:08.186 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 19
18:36:08.186 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
18:36:08.186 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=18)
18:36:08.186 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
18:36:08.186 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=18)
18:36:08.186 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
18:36:08.186 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=18)
18:36:08.186 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
18:36:08.186 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=18
18:36:08.186 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
18:36:08.186 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
18:36:08.186 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
18:36:08.186 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 19
18:36:08.186 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
18:36:08.186 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=19
18:36:08.186 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
18:36:08.186 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
18:36:08.186 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
18:36:08.187 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
18:36:08.186 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
18:36:08.187 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
18:36:08.186 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
18:36:08.187 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
18:36:08.187 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
18:36:08.187 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
18:36:08.187 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
18:36:08.187 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
18:36:08.187 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
18:36:08.187 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
18:36:08.187 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
18:36:08.187 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
18:36:08.187 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
18:36:08.212 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
18:36:08.212 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
18:36:08.212 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
18:36:08.212 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
18:36:08.212 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
18:36:08.212 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
18:36:08.212 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
18:36:08.212 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
18:36:08.293 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:08.294 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:08.294 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:08.294 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:08.294 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:08.294 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:08.294 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:08.294 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:08.294 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:08.294 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:08.294 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:08.294 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:08.294 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:08.294 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:08.294 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:08.296 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:08.296 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:08.296 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:08.296 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:08.296 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:08.296 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:08.296 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:08.296 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:08.296 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:08.296 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:08.296 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:08.296 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:08.296 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:08.296 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:08.296 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:08.472 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:08.472 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:08.472 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:08.473 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
18:36:08.473 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
18:36:08.473 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:08.473 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:08.473 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:08.473 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:08.473 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:08.473 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:08.473 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
18:36:08.473 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
18:36:08.473 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:08.473 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:08.473 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:08.473 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:08.504 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:08.504 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key2, value2)
18:36:08.504 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:08.504 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:08.504 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:36:08.504 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:36:08.504 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:08.504 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:08.504 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:08.504 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:08.504 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:08.504 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:08.504 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
18:36:08.533 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:08.533 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:08.534 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
18:36:08.534 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
18:36:08.610 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:08.611 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:08.611 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:08.611 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:08.611 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:08.611 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:08.611 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:08.611 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:08.611 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:08.611 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:08.611 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:08.611 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:08.611 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:08.611 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:08.611 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:08.613 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:08.613 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:08.613 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:08.613 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:08.613 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:08.613 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:08.613 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:08.613 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:08.613 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:08.613 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:08.613 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:08.613 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:08.613 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:08.613 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:08.613 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:08.782 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:08.783 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:08.783 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:08.783 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
18:36:08.783 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:08.783 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
18:36:08.783 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:08.783 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:08.783 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:08.783 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:08.783 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:08.783 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
18:36:08.783 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
18:36:08.783 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:08.783 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:08.783 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:08.783 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:08.820 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:08.820 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
18:36:08.820 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:08.820 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:08.820 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:08.820 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:08.820 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:08.820 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:08.820 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:08.820 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:08.820 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:08.820 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
18:36:08.837 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:08.837 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:08.837 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
18:36:08.837 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
18:36:08.922 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Killing leader: node-3
18:36:08.923 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:08.923 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:08.923 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:08.923 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:08.923 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:09.051 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:09.051 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
18:36:09.051 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:09.052 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=2)
18:36:09.052 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:09.052 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:09.052 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
18:36:09.052 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
18:36:09.052 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:09.053 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
18:36:09.053 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
18:36:09.053 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:09.053 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
18:36:09.136 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - New leader: node-1
18:36:09.137 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
18:36:09.137 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
18:36:09.137 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:09.137 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:09.137 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=2, entries=1)
18:36:09.138 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:09.138 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
18:36:09.138 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:09.138 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
18:36:09.157 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:09.157 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:09.157 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
18:36:09.208 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:09.244 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:09.244 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:09.244 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:09.244 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:09.245 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:09.245 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:09.245 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:09.245 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:09.245 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:09.245 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:09.249 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:09.250 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:09.250 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:09.250 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:09.250 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:09.250 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:09.250 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:09.250 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:09.250 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:09.250 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:09.250 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:09.250 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:09.250 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:09.250 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:09.250 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:09.412 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:09.413 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:09.413 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:09.413 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
18:36:09.413 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:09.413 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:09.413 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
18:36:09.414 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:09.414 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:09.414 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:09.413 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:09.414 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
18:36:09.414 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
18:36:09.414 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:09.414 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:09.414 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:09.414 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:09.462 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:09.462 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
18:36:09.463 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:09.463 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:09.463 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:09.463 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:09.463 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:09.463 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:09.463 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:09.463 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:09.463 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:09.464 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
18:36:09.464 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:09.464 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
18:36:09.464 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:09.464 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:09.464 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:09.464 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:09.464 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:09.464 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:09.464 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:09.464 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:09.464 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:09.465 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:09.465 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:09.465 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:09.465 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:09.465 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
18:36:09.465 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:09.465 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:09.465 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
18:36:09.465 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
18:36:09.465 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
18:36:09.465 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
18:36:09.465 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:36:09.465 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
18:36:09.465 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
18:36:09.465 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
18:36:09.465 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:09.466 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:09.466 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:09.466 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:09.466 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:09.466 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:09.466 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
18:36:09.466 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
18:36:09.466 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:36:09.466 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
18:36:09.466 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
18:36:09.466 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
18:36:09.466 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
18:36:09.466 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
18:36:09.466 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
18:36:09.466 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
18:36:09.466 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:09.466 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:09.466 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:36:09.467 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:09.467 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:36:09.467 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
18:36:09.467 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:09.467 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
18:36:09.467 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:36:09.467 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
18:36:09.467 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
18:36:09.467 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
18:36:09.467 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
18:36:09.467 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
18:36:09.467 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
18:36:09.467 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
18:36:09.467 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:09.467 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:09.467 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:36:09.467 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:36:09.467 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:36:09.467 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
18:36:09.467 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
18:36:09.467 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:36:09.467 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:36:09.468 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
18:36:09.468 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
18:36:09.468 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
18:36:09.468 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
18:36:09.468 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
18:36:09.468 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
18:36:09.468 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
18:36:09.468 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:09.468 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:36:09.468 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:09.468 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:09.468 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
18:36:09.468 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
18:36:09.468 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
18:36:09.468 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:36:09.468 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
18:36:09.468 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:09.469 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
18:36:09.469 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
18:36:09.469 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
18:36:09.469 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
18:36:09.469 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
18:36:09.469 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
18:36:09.469 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:09.469 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:09.469 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
18:36:09.469 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
18:36:09.469 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:09.469 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:09.469 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
18:36:09.469 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
18:36:09.469 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
18:36:09.469 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
18:36:09.469 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
18:36:09.469 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
18:36:09.469 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
18:36:09.469 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
18:36:09.470 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
18:36:09.470 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
18:36:09.470 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:09.470 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:09.470 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
18:36:09.470 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
18:36:09.470 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
18:36:09.470 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
18:36:09.470 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
18:36:09.470 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
18:36:09.470 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
18:36:09.470 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
18:36:09.470 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
18:36:09.470 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
18:36:09.470 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
18:36:09.470 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
18:36:09.470 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
18:36:09.470 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
18:36:09.470 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:09.471 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:09.471 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
18:36:09.471 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
18:36:09.471 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
18:36:09.471 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
18:36:09.471 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
18:36:09.471 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
18:36:09.471 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
18:36:09.471 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
18:36:09.471 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
18:36:09.471 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
18:36:09.471 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
18:36:09.471 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
18:36:09.471 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
18:36:09.471 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
18:36:09.471 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:09.471 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:09.471 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
18:36:09.471 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
18:36:09.471 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
18:36:09.471 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
18:36:09.471 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
18:36:09.471 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
18:36:09.471 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
18:36:09.471 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
18:36:09.471 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
18:36:09.471 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
18:36:09.471 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
18:36:09.520 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
18:36:09.520 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
18:36:09.520 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
18:36:09.520 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
18:36:09.576 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:09.577 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:09.577 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:09.577 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:09.577 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:09.577 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:09.577 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:09.577 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:09.577 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:09.577 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:09.577 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:09.577 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:09.577 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:09.577 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:09.577 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:09.579 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:09.579 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:09.579 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:09.579 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:09.579 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:09.579 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:09.579 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:09.579 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:09.579 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:09.579 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:09.579 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:09.579 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:09.579 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:09.579 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:09.579 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:09.739 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:09.739 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:09.740 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:09.740 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
18:36:09.740 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:09.740 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:09.740 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
18:36:09.740 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:09.740 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:09.740 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:09.740 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
18:36:09.740 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:09.740 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:09.740 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
18:36:09.740 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:09.740 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:09.740 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:09.785 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Leader: node-1
18:36:09.785 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:09.785 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
18:36:09.785 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:09.785 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:09.785 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:36:09.785 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:36:09.785 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:09.785 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:09.785 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:09.785 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:09.785 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:09.785 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:09.785 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
18:36:09.785 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - PUT committed
18:36:09.791 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:09.791 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:09.792 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
18:36:09.792 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
18:36:09.892 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - Data replicated to all nodes
18:36:09.892 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:09.892 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:09.892 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:09.893 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:09.893 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:09.893 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:09.893 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:09.893 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:09.893 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:09.893 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:09.893 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:09.893 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:09.893 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:09.893 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:09.893 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:09.895 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:09.895 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:09.895 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:09.895 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:09.895 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:09.895 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:09.895 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:09.895 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:09.895 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:09.895 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:09.895 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:09.895 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:09.895 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:09.895 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:09.896 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:10.084 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:10.084 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:10.084 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:10.085 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
18:36:10.085 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
18:36:10.085 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:10.085 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:10.085 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.085 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:10.085 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
18:36:10.085 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:10.085 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:10.085 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:10.085 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:10.085 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.086 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:10.086 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
18:36:10.113 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:10.113 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.114 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:10.114 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:10.114 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:10.114 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:10.114 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.114 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:10.114 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:10.114 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:10.114 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:10.114 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.114 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:10.114 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:10.114 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:10.116 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:10.116 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:10.116 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:10.116 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:10.117 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:10.117 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:10.117 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:10.117 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:10.117 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:10.117 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:10.117 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:10.117 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:10.117 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:10.117 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:10.117 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:10.117 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
18:36:10.117 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
18:36:10.117 [main] [node-4] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-4
18:36:10.117 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:10.117 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 initialized as FOLLOWER
18:36:10.117 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
18:36:10.117 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
18:36:10.117 [main] [node-5] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-5
18:36:10.117 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:10.117 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 initialized as FOLLOWER
18:36:10.312 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:10.313 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:10.313 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
18:36:10.314 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
18:36:10.314 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:10.314 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.314 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
18:36:10.314 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:10.314 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:10.314 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.314 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:10.314 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
18:36:10.314 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
18:36:10.314 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
18:36:10.314 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
18:36:10.314 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:10.314 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 VoteRequest(term=1)
18:36:10.314 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:10.314 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:10.314 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.314 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:10.315 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:10.315 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-5 VoteResponse(granted=true)
18:36:10.314 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 VoteRequest(term=1)
18:36:10.315 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:10.315 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.315 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:10.315 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-4 VoteResponse(granted=true)
18:36:10.324 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:10.324 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(stable-key, initial)
18:36:10.324 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:10.325 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:10.325 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:10.325 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
18:36:10.325 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:10.325 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:10.325 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 AppendEntries(term=1, entries=1)
18:36:10.325 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
18:36:10.325 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:10.325 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 AppendEntries(term=1, entries=1)
18:36:10.325 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
18:36:10.325 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:10.325 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:10.325 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:10.325 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:10.325 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:10.325 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
18:36:10.325 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:10.326 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
18:36:10.372 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:10.373 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:10.373 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:10.373 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:10.374 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
18:36:10.374 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
18:36:10.374 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
18:36:10.374 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
18:36:10.428 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:10.428 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-0, value-0)
18:36:10.428 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:10.429 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:10.429 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:10.429 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
18:36:10.429 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:10.429 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
18:36:10.429 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:10.429 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 AppendEntries(term=1, entries=1)
18:36:10.429 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
18:36:10.429 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:10.429 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 AppendEntries(term=1, entries=1)
18:36:10.429 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
18:36:10.429 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:10.429 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:10.429 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:10.429 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
18:36:10.429 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
18:36:10.429 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
18:36:10.429 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:36:10.429 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-1, value-1)
18:36:10.430 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
18:36:10.430 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
18:36:10.430 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:10.430 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:10.430 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=3)
18:36:10.430 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:10.430 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:10.430 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 AppendEntries(term=1, entries=1)
18:36:10.430 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:10.430 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:10.430 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=3)
18:36:10.430 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:10.430 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
18:36:10.430 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
18:36:10.430 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:36:10.430 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
18:36:10.430 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:10.430 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 AppendEntries(term=1, entries=1)
18:36:10.430 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
18:36:10.430 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
18:36:10.430 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=3
18:36:10.430 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:10.430 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
18:36:10.430 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:36:10.430 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:10.430 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
18:36:10.430 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=3
18:36:10.430 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
18:36:10.430 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-2, value-2)
18:36:10.430 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
18:36:10.431 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
18:36:10.431 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:10.431 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=4)
18:36:10.431 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:10.431 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:36:10.431 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=4)
18:36:10.431 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:36:10.431 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:10.431 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 AppendEntries(term=1, entries=1)
18:36:10.431 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
18:36:10.431 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:10.431 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:36:10.431 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
18:36:10.431 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
18:36:10.431 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
18:36:10.431 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:36:10.431 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 AppendEntries(term=1, entries=1)
18:36:10.431 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:10.431 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
18:36:10.431 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:36:10.431 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=4
18:36:10.431 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:10.431 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
18:36:10.431 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
18:36:10.431 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=4
18:36:10.431 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
18:36:10.431 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-3, value-3)
18:36:10.431 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
18:36:10.431 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
18:36:10.431 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=5)
18:36:10.431 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:10.431 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:10.431 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=5)
18:36:10.431 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 AppendEntries(term=1, entries=1)
18:36:10.431 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:36:10.431 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:36:10.431 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:36:10.431 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 AppendEntries(term=1, entries=1)
18:36:10.431 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:36:10.431 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:36:10.431 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:36:10.432 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=5
18:36:10.432 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:36:10.432 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
18:36:10.432 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
18:36:10.432 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
18:36:10.432 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:36:10.432 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
18:36:10.432 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:36:10.432 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
18:36:10.432 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:36:10.432 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
18:36:10.432 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=5
18:36:10.432 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
18:36:10.432 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
18:36:10.432 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-4, value-4)
18:36:10.432 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
18:36:10.432 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
18:36:10.432 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:10.432 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=6)
18:36:10.432 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:10.432 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:36:10.432 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=6)
18:36:10.432 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:10.432 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:36:10.432 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 AppendEntries(term=1, entries=1)
18:36:10.432 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:10.432 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 AppendEntries(term=1, entries=1)
18:36:10.432 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:36:10.432 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
18:36:10.432 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
18:36:10.432 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
18:36:10.432 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
18:36:10.432 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
18:36:10.432 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:10.432 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:36:10.432 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
18:36:10.432 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:10.432 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=6
18:36:10.432 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=6
18:36:10.432 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
18:36:10.432 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
18:36:10.467 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:10.467 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:10.467 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:10.467 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:10.467 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
18:36:10.467 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
18:36:10.467 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
18:36:10.467 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
18:36:10.537 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:10.537 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.537 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:10.537 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:10.537 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:10.537 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:10.537 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.537 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:10.537 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:10.537 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:10.537 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:10.537 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.537 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:10.537 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:10.537 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:10.537 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
18:36:10.537 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.538 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:10.538 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
18:36:10.538 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
18:36:10.538 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
18:36:10.538 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.538 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:10.538 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
18:36:10.538 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
18:36:10.546 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:10.546 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:10.546 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:10.547 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:10.547 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:10.547 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:10.547 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:10.547 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:10.767 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:10.770 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:10.771 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:10.771 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:10.771 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
18:36:10.771 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:10.771 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:10.771 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:10.969 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:10.970 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test, data)
18:36:10.970 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:10.970 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test, data)
18:36:10.971 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Data files created at target/test-data/node-1
18:36:10.972 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:10.972 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:10.972 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:10.972 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:10.972 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:10.976 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:10.976 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:10.976 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:10.976 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:10.976 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:10.976 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:10.976 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:10.976 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:10.976 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:10.976 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:10.976 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:10.977 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
18:36:10.977 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
18:36:10.977 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:10.977 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:10.977 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:10.977 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:10.977 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:10.977 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:10.977 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
18:36:10.977 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
18:36:10.978 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:10.978 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:10.978 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:11.165 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:11.169 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:11.170 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:11.170 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:11.170 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:11.171 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
18:36:11.171 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
18:36:11.172 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:11.173 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:11.173 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:11.173 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:11.173 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:11.173 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:11.174 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:11.174 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:11.174 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:11.174 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:11.174 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
18:36:11.174 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
18:36:11.174 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:11.174 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:11.174 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:11.174 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:11.187 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Leader: node-1
18:36:11.187 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:11.187 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
18:36:11.188 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:11.188 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:11.188 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:36:11.188 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:36:11.188 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:11.188 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:11.189 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:11.189 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:11.189 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:11.189 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:11.189 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:11.189 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
18:36:11.189 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:11.189 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key2, value2)
18:36:11.189 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:11.189 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:11.189 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:36:11.189 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:36:11.189 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:11.190 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:11.190 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:11.190 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
18:36:11.190 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:11.190 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
18:36:11.190 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
18:36:11.190 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:11.190 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:11.190 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:11.190 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:36:11.190 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
18:36:11.190 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
18:36:11.190 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key3, value3)
18:36:11.190 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
18:36:11.190 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
18:36:11.190 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:36:11.190 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:36:11.190 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:11.190 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:11.190 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:11.190 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:11.191 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:11.191 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
18:36:11.191 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:11.191 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:36:11.191 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
18:36:11.191 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
18:36:11.191 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
18:36:11.191 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
18:36:11.228 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:11.228 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:11.228 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
18:36:11.228 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
18:36:11.294 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Stopping all nodes...
18:36:11.294 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:11.294 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:11.295 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:11.295 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:11.295 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:11.295 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:11.295 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:11.295 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:11.295 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:11.295 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:11.295 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:11.295 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:11.295 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:11.295 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:11.295 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:11.295 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting all nodes...
18:36:11.296 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:11.296 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:11.296 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:11.296 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
18:36:11.297 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:11.297 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:11.297 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
18:36:11.297 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
18:36:11.297 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
18:36:11.298 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
18:36:11.298 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
18:36:11.298 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:11.298 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:11.298 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:11.298 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:11.298 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:11.298 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
18:36:11.298 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
18:36:11.298 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
18:36:11.298 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
18:36:11.298 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
18:36:11.298 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
18:36:11.298 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
18:36:11.298 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
18:36:11.298 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:11.298 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:11.298 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:11.298 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:11.298 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:11.299 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
18:36:11.299 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
18:36:11.299 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
18:36:11.299 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
18:36:11.299 [main] [node-3] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
18:36:11.299 [main] [node-3] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
18:36:11.299 [main] [node-3] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
18:36:11.299 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
18:36:11.299 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:11.299 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:11.549 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:11.549 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
18:36:11.550 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
18:36:11.550 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
18:36:11.550 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:11.550 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=2)
18:36:11.550 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=2)
18:36:11.550 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
18:36:11.550 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:11.550 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:11.551 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
18:36:11.551 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:11.551 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:11.551 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
18:36:11.551 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
18:36:11.551 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
18:36:11.551 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:11.551 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
18:36:11.551 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
18:36:11.551 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:11.551 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
18:36:11.551 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
18:36:11.551 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
18:36:11.614 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - New leader after restart: node-1
18:36:11.615 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - All nodes recovered successfully
18:36:11.615 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:11.615 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:11.615 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:11.615 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:11.615 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:11.615 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:11.615 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:11.615 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:11.615 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:11.615 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:11.615 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:11.615 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:11.615 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:11.615 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:11.615 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:11.618 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:11.618 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:11.618 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:11.618 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:11.618 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:11.618 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:11.618 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:11.618 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:11.618 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:11.618 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:11.618 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:11.618 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
18:36:11.618 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
18:36:11.618 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:11.618 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:11.618 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:11.618 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:11.619 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:11.619 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:11.619 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
18:36:11.619 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
18:36:11.619 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:11.619 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:11.619 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:11.814 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:11.815 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:11.815 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:11.815 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:11.815 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:11.815 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
18:36:11.815 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
18:36:11.816 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:11.816 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:11.816 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:11.816 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:11.816 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:11.816 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:11.816 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:11.816 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:11.816 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
18:36:11.816 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:11.816 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:11.816 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:11.816 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:11.816 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:11.816 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:11.816 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
18:36:11.826 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:11.826 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, restart)
18:36:11.826 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:11.827 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:11.827 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
18:36:11.827 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
18:36:11.827 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:11.827 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:11.827 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:11.827 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:11.827 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:11.827 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:11.827 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:11.827 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
18:36:11.870 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:11.870 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:11.870 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
18:36:11.870 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
18:36:11.935 [main] [node-2] INFO  c.raftdb.integration.PersistenceTest - Restarting follower: node-1
18:36:11.935 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:11.935 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:11.935 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:11.935 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:11.935 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:12.041 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:12.042 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during, downtime)
18:36:12.042 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:12.042 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:12.043 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
18:36:12.043 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:12.043 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:12.043 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
18:36:12.043 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:12.043 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
18:36:12.045 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:12.045 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:12.045 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:12.046 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-2
18:36:12.046 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:12.046 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:12.046 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
18:36:12.046 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
18:36:12.046 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 1 to recover state machine
18:36:12.046 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
18:36:12.046 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-2, lastLogIndex=1
18:36:12.046 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:12.046 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:12.069 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:12.070 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
18:36:12.070 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:12.070 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
18:36:12.070 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:12.070 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:12.070 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:12.070 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
18:36:12.070 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
18:36:12.153 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Follower node-1 caught up after restart
18:36:12.155 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:12.155 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:12.155 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:12.155 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:12.155 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:12.155 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:12.156 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:12.156 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:12.156 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:12.156 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:12.156 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:12.156 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:12.156 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:12.156 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:12.156 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:12.161 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:12.161 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:12.161 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:12.161 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:12.161 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:12.161 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:12.162 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:12.162 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:12.348 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:12.349 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:12.349 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:12.349 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:12.349 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
18:36:12.349 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:12.349 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:12.349 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:12.371 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:12.371 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:12.371 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:12.371 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:12.371 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:12.371 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:12.371 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:12.371 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:12.372 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
18:36:12.372 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:12.372 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:12.372 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=0
18:36:12.372 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:12.372 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:12.372 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Term persisted: 1 -> 1
18:36:12.372 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:12.372 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:12.372 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:12.372 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:12.372 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:12.377 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:12.377 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:12.377 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:12.377 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:12.377 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:12.377 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:12.377 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:12.377 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:12.623 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:12.626 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:12.628 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:12.628 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:12.629 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
18:36:12.629 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:12.629 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:12.629 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:12.694 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:12.694 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
18:36:12.694 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:12.695 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
18:36:12.695 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:12.695 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
18:36:12.695 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:12.695 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
18:36:12.695 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:36:12.695 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
18:36:12.695 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:36:12.695 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
18:36:12.696 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
18:36:12.696 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
18:36:12.696 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:36:12.696 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
18:36:12.696 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
18:36:12.696 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
18:36:12.696 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:36:12.696 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
18:36:12.696 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
18:36:12.696 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
18:36:12.696 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
18:36:12.696 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
18:36:12.696 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
18:36:12.696 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
18:36:12.697 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
18:36:12.697 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
18:36:12.697 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
18:36:12.697 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
18:36:12.697 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
18:36:12.697 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
18:36:12.697 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
18:36:12.697 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
18:36:12.697 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
18:36:12.697 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
18:36:12.697 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
18:36:12.697 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
18:36:12.697 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
18:36:12.697 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
18:36:12.697 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 10, term 1
18:36:12.698 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
18:36:12.699 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=10, lastTerm=1, size=184 bytes
18:36:12.699 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 10, 0 entries remaining
18:36:12.699 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
18:36:12.699 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 0 log entries remaining
18:36:12.700 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Snapshot test passed
18:36:12.700 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:12.700 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:12.700 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:12.700 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:12.700 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:12.703 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:12.703 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:12.703 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:12.704 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:12.704 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:12.704 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:12.704 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:12.704 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:12.962 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:12.965 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:12.966 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:12.966 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:12.966 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
18:36:12.966 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:12.966 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:12.966 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:13.019 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:13.019 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
18:36:13.021 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:13.021 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
18:36:13.022 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:13.022 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
18:36:13.022 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:13.022 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
18:36:13.022 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:36:13.022 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
18:36:13.022 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:36:13.022 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
18:36:13.022 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
18:36:13.022 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
18:36:13.022 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:36:13.023 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
18:36:13.023 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
18:36:13.023 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
18:36:13.023 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:36:13.023 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
18:36:13.023 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
18:36:13.023 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
18:36:13.023 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
18:36:13.023 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
18:36:13.023 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
18:36:13.023 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
18:36:13.023 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
18:36:13.024 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
18:36:13.024 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
18:36:13.024 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
18:36:13.024 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
18:36:13.024 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
18:36:13.024 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
18:36:13.024 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
18:36:13.024 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
18:36:13.024 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
18:36:13.024 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
18:36:13.024 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
18:36:13.024 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
18:36:13.024 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
18:36:13.024 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 10, term 1
18:36:13.024 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
18:36:13.025 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=10, lastTerm=1, size=184 bytes
18:36:13.025 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 10, 0 entries remaining
18:36:13.026 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
18:36:13.026 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 0 log entries remaining
18:36:13.026 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
18:36:13.026 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
18:36:13.026 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
18:36:13.026 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
18:36:13.026 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
18:36:13.026 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
18:36:13.026 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
18:36:13.026 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
18:36:13.026 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
18:36:13.026 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
18:36:13.026 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
18:36:13.026 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
18:36:13.027 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
18:36:13.027 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
18:36:13.027 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
18:36:13.027 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
18:36:13.027 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
18:36:13.027 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
18:36:13.027 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
18:36:13.027 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
18:36:13.027 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:13.027 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:13.027 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:13.027 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:13.027 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:13.027 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:13.027 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:13.027 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:13.028 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
18:36:13.028 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:13.028 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=10, lastTerm=1
18:36:13.028 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:13.029 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 184 bytes
18:36:13.029 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 10 entries
18:36:13.029 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=10, term=1
18:36:13.029 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=10, term=1
18:36:13.029 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 5 log entries from disk
18:36:13.029 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 5 log entries, lastIndex=15
18:36:13.029 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 11 to 15 to recover state machine
18:36:13.029 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=15
18:36:13.029 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=15
18:36:13.029 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:13.029 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:13.315 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:13.316 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
18:36:13.317 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
18:36:13.317 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
18:36:13.317 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
18:36:13.317 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
18:36:13.317 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
18:36:13.317 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:13.346 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Recovery from snapshot test passed
18:36:13.346 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:13.346 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:13.346 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:13.346 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:13.346 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:13.348 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:13.348 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:13.348 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:13.348 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:13.348 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:13.348 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:13.348 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:13.349 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:13.349 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:13.349 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:13.349 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:13.349 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
18:36:13.349 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
18:36:13.349 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:13.349 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:13.349 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:13.349 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:13.349 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:13.349 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:13.349 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
18:36:13.349 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
18:36:13.349 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:13.349 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:13.350 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:13.551 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:13.552 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:13.552 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:36:13.552 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:13.552 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:13.553 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
18:36:13.553 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
18:36:13.553 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:13.553 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:13.553 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:13.553 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:13.553 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:13.553 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:13.553 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:36:13.553 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:13.553 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:36:13.553 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
18:36:13.553 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:13.553 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:13.553 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
18:36:13.553 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:13.553 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:13.553 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:13.556 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:13.556 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
18:36:13.556 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:13.556 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:13.556 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:13.556 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.556 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.556 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:13.556 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:13.556 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:13.556 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.556 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:13.556 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:13.556 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
18:36:13.556 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:13.556 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
18:36:13.556 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:13.556 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:13.556 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:13.557 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.557 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.557 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:13.557 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:13.557 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.557 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
18:36:13.557 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:13.557 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
18:36:13.557 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:13.557 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:13.557 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
18:36:13.557 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
18:36:13.557 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
18:36:13.557 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:36:13.557 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
18:36:13.557 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
18:36:13.557 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
18:36:13.557 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:13.557 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.557 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.557 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:13.557 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:13.557 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
18:36:13.557 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
18:36:13.557 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.557 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:13.557 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:13.557 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:36:13.557 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
18:36:13.557 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
18:36:13.557 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
18:36:13.558 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
18:36:13.558 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
18:36:13.558 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
18:36:13.558 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
18:36:13.558 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:13.558 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.558 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.558 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:36:13.558 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:13.558 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.558 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
18:36:13.558 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
18:36:13.558 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:36:13.558 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:36:13.558 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:13.558 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
18:36:13.558 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
18:36:13.558 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
18:36:13.558 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
18:36:13.558 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
18:36:13.558 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
18:36:13.558 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
18:36:13.558 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:13.558 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.558 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.558 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:36:13.558 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.558 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:36:13.558 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:36:13.558 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:36:13.558 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
18:36:13.558 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
18:36:13.558 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
18:36:13.558 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
18:36:13.558 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:36:13.558 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:36:13.559 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
18:36:13.559 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
18:36:13.559 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
18:36:13.559 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
18:36:13.559 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
18:36:13.559 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:13.559 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.559 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.559 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:36:13.559 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:13.559 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.559 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
18:36:13.559 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
18:36:13.559 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:36:13.559 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
18:36:13.559 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:13.559 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
18:36:13.559 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
18:36:13.559 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
18:36:13.559 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
18:36:13.559 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
18:36:13.559 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
18:36:13.559 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:13.559 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
18:36:13.559 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.559 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.559 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
18:36:13.559 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:13.559 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
18:36:13.559 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
18:36:13.559 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
18:36:13.559 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.559 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
18:36:13.559 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
18:36:13.559 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:13.559 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
18:36:13.559 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
18:36:13.560 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
18:36:13.560 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
18:36:13.560 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
18:36:13.560 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
18:36:13.560 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:13.560 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.560 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.560 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
18:36:13.560 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
18:36:13.560 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.560 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
18:36:13.560 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
18:36:13.560 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
18:36:13.560 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
18:36:13.560 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
18:36:13.560 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
18:36:13.560 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
18:36:13.560 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
18:36:13.560 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
18:36:13.560 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
18:36:13.560 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
18:36:13.560 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
18:36:13.560 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:13.560 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.560 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.560 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
18:36:13.560 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
18:36:13.560 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.560 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
18:36:13.560 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
18:36:13.560 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
18:36:13.560 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
18:36:13.560 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
18:36:13.560 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
18:36:13.560 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
18:36:13.560 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
18:36:13.561 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
18:36:13.561 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
18:36:13.561 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
18:36:13.561 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
18:36:13.561 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
18:36:13.561 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
18:36:13.561 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.561 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.561 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
18:36:13.561 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
18:36:13.561 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
18:36:13.561 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.561 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
18:36:13.561 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
18:36:13.561 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
18:36:13.561 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
18:36:13.561 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
18:36:13.561 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
18:36:13.561 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
18:36:13.608 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
18:36:13.608 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
18:36:13.608 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
18:36:13.608 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
18:36:13.667 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:13.667 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:13.667 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:13.667 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:13.667 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:13.771 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
18:36:13.771 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
18:36:13.771 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=11)
18:36:13.771 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=11)
18:36:13.771 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.771 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.771 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
18:36:13.771 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
18:36:13.771 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
18:36:13.771 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
18:36:13.772 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
18:36:13.772 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
18:36:13.772 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=11)
18:36:13.772 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=12)
18:36:13.772 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.772 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.772 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
18:36:13.772 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
18:36:13.772 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
18:36:13.772 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
18:36:13.772 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
18:36:13.772 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
18:36:13.772 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
18:36:13.772 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
18:36:13.772 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=11)
18:36:13.772 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=13)
18:36:13.772 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.773 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.773 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
18:36:13.773 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
18:36:13.773 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=13
18:36:13.773 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
18:36:13.773 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
18:36:13.773 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
18:36:13.773 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
18:36:13.773 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
18:36:13.773 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=11)
18:36:13.773 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=14)
18:36:13.773 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.773 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.773 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
18:36:13.773 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
18:36:13.773 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=14
18:36:13.773 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
18:36:13.773 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
18:36:13.773 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
18:36:13.773 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
18:36:13.773 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
18:36:13.773 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=11)
18:36:13.773 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=15)
18:36:13.773 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.774 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.774 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
18:36:13.774 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
18:36:13.774 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=15
18:36:13.774 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
18:36:13.774 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
18:36:13.774 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
18:36:13.774 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
18:36:13.774 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(key15, value15)
18:36:13.774 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-1 (nextIndex=11)
18:36:13.774 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=16)
18:36:13.774 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.774 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.774 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
18:36:13.774 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
18:36:13.774 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=16
18:36:13.774 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
18:36:13.774 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
18:36:13.774 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
18:36:13.774 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
18:36:13.774 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(key16, value16)
18:36:13.774 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 7 entries to node-1 (nextIndex=11)
18:36:13.775 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=17)
18:36:13.775 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.775 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.775 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
18:36:13.775 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
18:36:13.775 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=17
18:36:13.775 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
18:36:13.775 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
18:36:13.775 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
18:36:13.775 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
18:36:13.775 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(key17, value17)
18:36:13.775 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 8 entries to node-1 (nextIndex=11)
18:36:13.775 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=18)
18:36:13.775 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.775 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.775 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
18:36:13.775 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
18:36:13.775 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=18
18:36:13.775 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
18:36:13.775 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
18:36:13.775 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
18:36:13.775 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
18:36:13.775 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(key18, value18)
18:36:13.775 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 9 entries to node-1 (nextIndex=11)
18:36:13.775 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=19)
18:36:13.775 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.776 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.776 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
18:36:13.776 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
18:36:13.776 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=19
18:36:13.776 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
18:36:13.776 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
18:36:13.776 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
18:36:13.776 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
18:36:13.776 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(key19, value19)
18:36:13.776 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 10 entries to node-1 (nextIndex=11)
18:36:13.776 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=20)
18:36:13.776 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
18:36:13.776 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:13.776 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
18:36:13.776 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
18:36:13.776 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
18:36:13.776 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
18:36:13.776 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
18:36:13.776 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
18:36:13.776 [main] [node-3] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 20, term 1
18:36:13.776 [main] [node-3] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 20 entries, 384 bytes
18:36:13.777 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=20, lastTerm=1, size=384 bytes
18:36:13.777 [main] [node-3] INFO  com.raftdb.log.LogManager - Compacted log to index 20, 0 entries remaining
18:36:13.777 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
18:36:13.777 [main] [node-3] INFO  com.raftdb.core.RaftNode - Snapshot complete: 384 bytes, 0 log entries remaining
18:36:13.777 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:13.777 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:13.777 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:13.777 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:13.777 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:13.777 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:13.777 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:13.778 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:13.807 [replication-node-3] [node-3] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 384 bytes
18:36:13.809 [replication-node-3] [node-3] INFO  c.r.replication.ReplicationManager - Sending snapshot to node-1 (lastIndex=20, size=384)
18:36:13.809 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 InstallSnapshot(term=1, lastIndex=20, size=384)
18:36:13.810 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:13.810 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:13.810 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:13.810 [] [node-1] INFO  com.raftdb.core.RaftNode - Installing snapshot: lastIndex=20, lastTerm=1, size=384
18:36:13.810 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
18:36:13.810 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
18:36:13.810 [] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=20, lastTerm=1, size=384 bytes
18:36:13.810 [] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 20 entries
18:36:13.810 [] [node-1] INFO  com.raftdb.log.LogManager - Reset log to snapshot: index=20, term=1
18:36:13.810 [] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
18:36:13.810 [] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot installed successfully
18:36:13.811 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 InstallSnapshotResponse(term=1)
18:36:13.811 [] [node-3] INFO  c.r.replication.ReplicationManager - Snapshot to node-1 complete, nextIndex=21
18:36:13.883 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Snapshot replication test passed
18:36:13.884 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:13.884 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:13.884 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:13.884 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:13.884 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:13.884 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:13.884 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:13.884 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:13.884 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:13.885 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:13.885 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:13.885 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:13.885 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:13.885 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:13.885 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:13.890 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:13.891 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:13.891 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:13.892 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:13.892 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:13.892 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:13.892 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:13.892 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:14.089 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:14.089 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:14.090 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:14.090 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:14.090 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
18:36:14.090 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:14.090 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:14.090 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:14.097 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:14.097 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(string, hello)
18:36:14.097 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:14.097 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(string, hello)
18:36:14.098 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:14.098 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(number, 12345)
18:36:14.098 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:14.098 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(number, 12345)
18:36:14.099 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:36:14.099 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(special, 特殊字符)
18:36:14.099 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:36:14.099 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(special, 特殊字符)
18:36:14.099 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
18:36:14.099 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(empty, )
18:36:14.099 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:36:14.100 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(empty, )
18:36:14.100 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
18:36:14.100 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: DELETE(empty)
18:36:14.100 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:36:14.100 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: DELETE(empty)
18:36:14.100 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 4, term 1
18:36:14.100 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 3 entries, 69 bytes
18:36:14.101 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=4, lastTerm=1, size=69 bytes
18:36:14.101 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 4, 1 entries remaining
18:36:14.101 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 1 entries
18:36:14.101 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 69 bytes, 1 log entries remaining
18:36:14.101 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:14.101 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:14.101 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:14.101 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:14.101 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:14.101 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:14.101 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:14.101 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:14.101 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
18:36:14.101 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
18:36:14.102 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=4, lastTerm=1
18:36:14.102 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
18:36:14.102 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 69 bytes
18:36:14.102 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 3 entries
18:36:14.102 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=4, term=1
18:36:14.102 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=4, term=1
18:36:14.102 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
18:36:14.102 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=5
18:36:14.102 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 5 to 5 to recover state machine
18:36:14.102 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=5
18:36:14.102 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=5
18:36:14.102 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:14.102 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:14.377 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:14.384 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
18:36:14.385 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
18:36:14.386 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
18:36:14.386 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
18:36:14.386 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
18:36:14.386 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
18:36:14.386 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:14.419 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - State machine snapshot test passed
18:36:14.420 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:14.420 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:14.420 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:14.420 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:14.420 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:14.430 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:14.433 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19001
18:36:14.433 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:14.433 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
18:36:14.433 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
18:36:14.433 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:14.433 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:14.434 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:14.434 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19001
18:36:14.434 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:14.435 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19002
18:36:14.435 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:14.435 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
18:36:14.435 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
18:36:14.435 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:14.435 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:14.436 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:14.436 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19002
18:36:14.436 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:14.436 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19003
18:36:14.436 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:14.437 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
18:36:14.437 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
18:36:14.437 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:14.437 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:14.437 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:14.437 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19003
18:36:14.669 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:14.670 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:14.670 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:36:14.670 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:14.670 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:14.671 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19002
18:36:14.671 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19001
18:36:14.676 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:14.676 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:14.676 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:14.676 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:14.676 [grpc-default-executor-1] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:14.676 [grpc-default-executor-0] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:14.676 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:36:14.676 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
18:36:14.677 [grpc-default-executor-1] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:14.677 [grpc-default-executor-0] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:14.677 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=true
18:36:14.677 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=true
18:36:14.677 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:14.677 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:14.677 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:14.677 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:14.753 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Leader elected: node-3
18:36:14.759 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:14.760 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:14.760 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:14.764 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
18:36:14.764 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:14.765 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:14.765 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:14.765 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:14.768 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
18:36:14.768 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:14.768 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:14.768 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:14.768 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:14.778 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
18:36:14.778 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:14.890 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:14.893 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19011
18:36:14.893 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:14.894 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
18:36:14.894 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
18:36:14.894 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:14.894 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:14.894 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:14.894 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19011
18:36:14.894 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:14.895 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19012
18:36:14.895 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:14.895 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
18:36:14.895 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
18:36:14.895 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:14.895 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:14.895 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:14.895 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19012
18:36:14.895 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:14.896 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19013
18:36:14.896 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:14.897 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
18:36:14.897 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
18:36:14.897 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:14.897 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:14.897 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:14.897 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19013
18:36:15.059 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:15.059 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:15.060 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:15.060 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:15.060 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:15.060 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19013
18:36:15.060 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19012
18:36:15.064 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:15.064 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:15.064 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:15.064 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:15.064 [grpc-default-executor-3] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:15.064 [grpc-default-executor-5] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:15.064 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:15.064 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:15.064 [grpc-default-executor-3] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:15.064 [grpc-default-executor-5] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:15.065 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
18:36:15.065 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:15.065 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:15.065 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:15.065 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:15.065 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
18:36:15.104 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:15.104 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(grpc-key, grpc-value)
18:36:15.105 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:15.105 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:15.108 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:15.108 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:15.108 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:15.108 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:15.109 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
18:36:15.109 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:15.109 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:15.110 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
18:36:15.110 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:15.111 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
18:36:15.118 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:15.118 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:15.118 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
18:36:15.118 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
18:36:15.218 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Data replicated to all nodes
18:36:15.218 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:15.218 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:15.218 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:15.227 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
18:36:15.227 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:15.227 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:15.227 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:15.227 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:15.228 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
18:36:15.228 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:15.228 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:15.228 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:15.228 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:15.229 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
18:36:15.230 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:15.338 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:15.353 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19021
18:36:15.353 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:15.353 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
18:36:15.353 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
18:36:15.353 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:15.353 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:15.381 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:15.381 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19021
18:36:15.381 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:15.387 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19022
18:36:15.387 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:15.387 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
18:36:15.387 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
18:36:15.387 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:15.387 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:15.390 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:15.390 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19022
18:36:15.390 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:15.397 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19023
18:36:15.397 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:15.398 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
18:36:15.401 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
18:36:15.401 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:15.401 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:15.410 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:15.410 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19023
18:36:15.540 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:15.541 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:15.541 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:15.541 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:15.541 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:15.541 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19022
18:36:15.541 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19023
18:36:15.545 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:15.545 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:15.545 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:15.545 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:15.545 [grpc-default-executor-3] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:15.545 [grpc-default-executor-1] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:15.546 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:15.546 [grpc-default-executor-3] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:15.546 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:15.546 [grpc-default-executor-1] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:15.546 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
18:36:15.546 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:15.546 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:15.546 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:15.546 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:15.546 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
18:36:15.620 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Initial leader: node-1 at term 1
18:36:15.620 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:15.620 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
18:36:15.620 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:15.620 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:15.622 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:15.622 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:15.622 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:15.622 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:15.622 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
18:36:15.623 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:15.623 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:15.623 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
18:36:15.623 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:15.623 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
18:36:15.648 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:15.648 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:15.649 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
18:36:15.649 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
18:36:15.727 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:15.727 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:15.727 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:15.728 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
18:36:15.728 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:15.728 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-1
18:36:15.728 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Stopped leader: node-1
18:36:15.860 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:15.861 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
18:36:15.861 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
18:36:15.861 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:15.861 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19023
18:36:15.861 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19021
18:36:15.867 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: Vote request to node-1 failed
18:36:15.870 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
18:36:15.870 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:15.870 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:15.871 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
18:36:15.871 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
18:36:15.873 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=2) -> granted=true
18:36:15.873 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:15.873 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
18:36:15.873 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
18:36:15.873 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:15.941 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - New leader: node-2 at term 2
18:36:15.941 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
18:36:15.941 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
18:36:15.942 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:15.942 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:15.954 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:15.954 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:15.976 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:15.976 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
18:36:15.977 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:15.977 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
18:36:15.979 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:15.984 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:15.985 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
18:36:16.025 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:16.077 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:16.080 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:16.080 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:16.080 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:16.080 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
18:36:16.081 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:16.081 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:16.081 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:16.081 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:16.083 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
18:36:16.083 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:16.191 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:16.192 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19031
18:36:16.192 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:16.192 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
18:36:16.192 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
18:36:16.192 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:16.192 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:16.192 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:16.192 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19031
18:36:16.192 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:16.192 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19032
18:36:16.192 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:16.193 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
18:36:16.193 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
18:36:16.193 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:16.193 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:16.193 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:16.193 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19032
18:36:16.193 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:16.193 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19033
18:36:16.193 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:16.193 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
18:36:16.194 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
18:36:16.194 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:16.194 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:16.194 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:16.194 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19033
18:36:16.396 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:16.397 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:16.398 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:16.398 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:16.398 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:16.398 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19031
18:36:16.398 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19033
18:36:16.404 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:16.404 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:16.404 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:16.404 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:16.404 [grpc-default-executor-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:16.404 [grpc-default-executor-5] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:16.405 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:16.405 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:16.405 [grpc-default-executor-1] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:16.405 [grpc-default-executor-5] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:16.405 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
18:36:16.405 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
18:36:16.405 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:16.406 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:16.406 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:16.406 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:16.507 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:16.507 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
18:36:16.507 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:16.507 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:16.507 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:16.507 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:16.509 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.509 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.509 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:16.509 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:16.509 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:16.509 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:16.510 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.510 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.510 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.510 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:16.510 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:16.510 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.510 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:16.510 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:16.510 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
18:36:16.510 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:16.510 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
18:36:16.510 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:16.510 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:16.511 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.511 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:16.511 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:16.511 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.511 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:16.511 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:16.512 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
18:36:16.512 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
18:36:16.512 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.512 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
18:36:16.512 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:16.512 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.512 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
18:36:16.512 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
18:36:16.512 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:36:16.512 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
18:36:16.512 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
18:36:16.512 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
18:36:16.513 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.513 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.513 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:16.513 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:16.513 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:16.513 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:16.513 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
18:36:16.513 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
18:36:16.514 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.514 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.514 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
18:36:16.514 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
18:36:16.514 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:36:16.514 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:36:16.514 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
18:36:16.514 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
18:36:16.514 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
18:36:16.514 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
18:36:16.514 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
18:36:16.515 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.515 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.515 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:36:16.515 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:36:16.515 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:16.515 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:16.515 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
18:36:16.515 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
18:36:16.515 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.515 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.515 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
18:36:16.515 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
18:36:16.515 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:36:16.515 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:36:16.515 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
18:36:16.515 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
18:36:16.515 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
18:36:16.515 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
18:36:16.516 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
18:36:16.516 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.516 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:36:16.516 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.516 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:36:16.516 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:36:16.516 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:36:16.516 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
18:36:16.516 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
18:36:16.517 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.517 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.517 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
18:36:16.517 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
18:36:16.517 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:36:16.517 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:36:16.517 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
18:36:16.517 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
18:36:16.517 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
18:36:16.517 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
18:36:16.517 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
18:36:16.518 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.518 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:36:16.518 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:16.518 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.518 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
18:36:16.518 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:36:16.518 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:16.518 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
18:36:16.518 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.518 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
18:36:16.518 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
18:36:16.518 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
18:36:16.518 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.519 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
18:36:16.519 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
18:36:16.519 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
18:36:16.519 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
18:36:16.519 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
18:36:16.519 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.519 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
18:36:16.519 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:16.519 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.519 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
18:36:16.519 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
18:36:16.519 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
18:36:16.519 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
18:36:16.520 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.520 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
18:36:16.520 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.520 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
18:36:16.520 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
18:36:16.520 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
18:36:16.520 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
18:36:16.520 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
18:36:16.520 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
18:36:16.520 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
18:36:16.521 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.521 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
18:36:16.521 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.521 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
18:36:16.521 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
18:36:16.521 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
18:36:16.521 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
18:36:16.521 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
18:36:16.521 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.521 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.521 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
18:36:16.521 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
18:36:16.521 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
18:36:16.521 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
18:36:16.521 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
18:36:16.522 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
18:36:16.522 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
18:36:16.522 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
18:36:16.522 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
18:36:16.522 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.522 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
18:36:16.522 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
18:36:16.522 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
18:36:16.522 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.522 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
18:36:16.522 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
18:36:16.522 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
18:36:16.523 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.523 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.523 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
18:36:16.523 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
18:36:16.523 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
18:36:16.523 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
18:36:16.523 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
18:36:16.523 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
18:36:16.523 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
18:36:16.523 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
18:36:16.523 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
18:36:16.524 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.524 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.524 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
18:36:16.524 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
18:36:16.524 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
18:36:16.524 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
18:36:16.524 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
18:36:16.524 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
18:36:16.524 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.524 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
18:36:16.524 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.524 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
18:36:16.524 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
18:36:16.524 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
18:36:16.524 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
18:36:16.524 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key-10, value-10)
18:36:16.524 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
18:36:16.524 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=11)
18:36:16.525 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.525 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
18:36:16.525 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
18:36:16.525 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.525 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
18:36:16.525 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
18:36:16.525 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
18:36:16.525 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
18:36:16.525 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.525 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=11
18:36:16.525 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
18:36:16.525 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
18:36:16.525 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.525 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
18:36:16.525 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
18:36:16.525 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key-11, value-11)
18:36:16.525 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=12)
18:36:16.525 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=12)
18:36:16.526 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.526 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.526 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
18:36:16.526 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
18:36:16.526 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
18:36:16.526 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
18:36:16.526 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
18:36:16.526 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
18:36:16.527 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.527 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
18:36:16.527 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
18:36:16.527 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.527 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
18:36:16.527 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=12
18:36:16.527 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
18:36:16.527 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key-12, value-12)
18:36:16.527 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=13)
18:36:16.527 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=13)
18:36:16.528 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.528 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.528 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
18:36:16.528 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
18:36:16.528 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
18:36:16.528 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
18:36:16.528 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
18:36:16.528 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
18:36:16.528 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.528 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.528 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
18:36:16.528 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=13
18:36:16.528 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
18:36:16.528 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
18:36:16.529 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
18:36:16.529 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
18:36:16.529 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key-13, value-13)
18:36:16.529 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=14)
18:36:16.529 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=14)
18:36:16.532 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.532 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
18:36:16.532 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
18:36:16.532 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.532 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
18:36:16.532 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
18:36:16.532 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
18:36:16.532 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
18:36:16.533 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.533 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
18:36:16.533 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
18:36:16.533 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.533 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
18:36:16.533 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=14
18:36:16.533 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
18:36:16.533 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key-14, value-14)
18:36:16.533 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=15)
18:36:16.533 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=15)
18:36:16.534 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.534 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.534 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
18:36:16.534 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
18:36:16.534 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
18:36:16.534 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
18:36:16.534 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
18:36:16.534 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
18:36:16.534 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.534 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=15
18:36:16.534 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
18:36:16.534 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.534 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
18:36:16.534 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
18:36:16.534 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(key-15, value-15)
18:36:16.535 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
18:36:16.535 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=16)
18:36:16.534 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
18:36:16.535 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.535 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
18:36:16.535 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
18:36:16.535 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
18:36:16.536 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.538 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
18:36:16.538 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
18:36:16.537 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.538 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
18:36:16.538 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
18:36:16.538 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
18:36:16.538 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
18:36:16.538 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
18:36:16.538 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(key-16, value-16)
18:36:16.539 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
18:36:16.539 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=16)
18:36:16.539 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.539 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=16
18:36:16.539 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.539 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
18:36:16.539 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
18:36:16.540 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
18:36:16.540 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.540 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
18:36:16.540 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
18:36:16.540 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
18:36:16.541 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.541 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 17
18:36:16.541 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
18:36:16.541 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
18:36:16.541 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
18:36:16.541 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(key-17, value-17)
18:36:16.541 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=18)
18:36:16.541 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=17)
18:36:16.541 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=2) -> success=true
18:36:16.541 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=17
18:36:16.542 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.542 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 18
18:36:16.542 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.542 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
18:36:16.542 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
18:36:16.542 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
18:36:16.542 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
18:36:16.542 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
18:36:16.543 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=2) -> success=true
18:36:16.543 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.543 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=18
18:36:16.543 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=18
18:36:16.543 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
18:36:16.543 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
18:36:16.543 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
18:36:16.543 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
18:36:16.543 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(key-18, value-18)
18:36:16.543 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=19)
18:36:16.543 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=19)
18:36:16.544 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.544 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.544 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
18:36:16.544 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
18:36:16.544 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
18:36:16.544 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
18:36:16.544 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
18:36:16.544 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
18:36:16.544 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.544 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
18:36:16.544 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
18:36:16.544 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.544 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=19
18:36:16.544 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
18:36:16.544 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
18:36:16.544 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(key-19, value-19)
18:36:16.544 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
18:36:16.544 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=20)
18:36:16.545 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.545 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.545 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
18:36:16.545 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
18:36:16.545 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
18:36:16.545 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
18:36:16.545 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
18:36:16.545 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
18:36:16.545 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
18:36:16.545 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
18:36:16.545 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
18:36:16.545 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.545 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
18:36:16.545 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
18:36:16.559 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
18:36:16.559 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
18:36:16.560 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
18:36:16.560 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
18:36:16.653 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - All 20 writes replicated
18:36:16.654 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:16.654 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:16.654 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:16.655 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
18:36:16.655 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:16.655 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:16.655 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:16.655 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:16.655 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
18:36:16.655 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:16.655 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:16.655 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:16.656 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:16.656 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
18:36:16.656 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:16.769 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:16.771 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19041
18:36:16.771 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:16.771 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
18:36:16.771 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
18:36:16.772 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:16.772 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:16.772 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:16.772 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19041
18:36:16.772 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:16.772 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19042
18:36:16.772 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:16.773 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
18:36:16.773 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
18:36:16.773 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:16.773 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:16.773 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:16.773 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19042
18:36:16.773 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:16.773 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19043
18:36:16.773 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:16.773 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
18:36:16.773 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
18:36:16.773 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:16.773 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:16.774 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:16.774 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19043
18:36:16.939 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:16.940 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:16.941 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:16.941 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:16.941 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:16.941 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19043
18:36:16.941 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19042
18:36:16.944 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:16.944 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:16.944 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:16.944 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:16.944 [grpc-default-executor-2] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:16.944 [grpc-default-executor-5] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:16.945 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:16.945 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:16.945 [grpc-default-executor-5] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:16.945 [grpc-default-executor-2] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:16.945 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
18:36:16.945 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
18:36:16.945 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:16.945 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:16.945 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:16.945 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:16.979 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:16.979 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(restart-test, initial)
18:36:16.980 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:16.980 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:16.981 [grpc-default-executor-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.981 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:16.981 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:16.981 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:16.981 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
18:36:16.981 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
18:36:16.981 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:16.981 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:16.981 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:16.981 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:16.981 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
18:36:16.999 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:16.999 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:16.999 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
18:36:16.999 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
18:36:17.090 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Restarting follower: node-2 on port 19042
18:36:17.091 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:17.091 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:17.091 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:17.092 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
18:36:17.092 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:17.092 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-2
18:36:17.195 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:17.195 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during-downtime, value)
18:36:17.195 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:17.195 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:17.195 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:17.195 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:17.196 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:17.196 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:17.196 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:17.197 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
18:36:17.197 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
18:36:17.197 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
18:36:17.197 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:17.197 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
18:36:17.198 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:17.198 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19042
18:36:17.198 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:17.198 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
18:36:17.199 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
18:36:17.199 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
18:36:17.199 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
18:36:17.199 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
18:36:17.199 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 1 to recover state machine
18:36:17.199 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
18:36:17.199 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=1
18:36:17.199 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:17.199 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:17.199 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Restarted node node-2 on port 19042
18:36:17.247 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:17.248 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:17.249 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
18:36:17.298 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:17.349 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:17.398 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:17.449 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:17.488 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:17.489 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
18:36:17.490 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
18:36:17.490 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:17.490 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19043
18:36:17.490 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19041
18:36:17.496 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
18:36:17.496 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
18:36:17.496 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:17.496 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:17.496 [grpc-default-executor-2] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:17.496 [grpc-default-executor-5] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:17.497 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
18:36:17.497 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
18:36:17.497 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=true, logUpToDate=false
18:36:17.497 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=true, logUpToDate=false
18:36:17.497 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=2) -> granted=false
18:36:17.497 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=2) -> granted=false
18:36:17.689 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:17.689 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:17.690 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
18:36:17.690 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-2
18:36:17.690 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
18:36:17.690 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
18:36:17.690 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:17.690 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:17.690 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19041
18:36:17.690 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19042
18:36:17.693 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=null
18:36:17.693 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-2
18:36:17.693 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:17.693 [grpc-default-executor-4] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:17.693 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=true, logUpToDate=false
18:36:17.694 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-2
18:36:17.694 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=true, logUpToDate=false
18:36:17.694 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=3) -> granted=false
18:36:17.695 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=3) -> granted=false
18:36:17.695 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
18:36:17.695 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
18:36:17.695 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=3) -> granted=false
18:36:17.695 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=3) -> granted=false
18:36:17.948 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:17.950 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-2
18:36:17.951 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
18:36:17.951 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:17.952 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: Vote request to node-2 failed
18:36:17.954 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=null
18:36:17.954 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:17.954 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:17.955 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-1
18:36:17.955 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 4
18:36:17.956 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=4) -> granted=true
18:36:17.956 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:17.956 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 4
18:36:17.956 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 4
18:36:17.956 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:17.979 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:17.980 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-1
18:36:17.980 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
18:36:17.980 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:17.982 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=false
18:36:17.983 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-2
18:36:17.983 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=true, logUpToDate=false
18:36:17.983 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=4) -> granted=false
18:36:17.983 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=4) -> granted=false
18:36:18.155 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:18.156 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-1
18:36:18.156 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 5
18:36:18.156 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:18.158 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=null
18:36:18.159 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=null
18:36:18.159 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:18.159 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:18.159 [grpc-default-executor-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:18.159 [grpc-default-executor-0] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:18.159 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-2
18:36:18.159 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-2
18:36:18.159 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=true, logUpToDate=false
18:36:18.159 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=true, logUpToDate=false
18:36:18.160 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=5) -> granted=false
18:36:18.160 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=5) -> granted=false
18:36:18.385 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:18.388 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-2
18:36:18.388 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 6
18:36:18.390 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:18.395 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=null
18:36:18.395 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=null
18:36:18.395 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:18.395 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:18.395 [grpc-default-executor-0] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:18.395 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:18.396 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-1
18:36:18.396 [grpc-default-executor-0] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 6
18:36:18.396 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-1
18:36:18.396 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 6
18:36:18.397 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=6) -> granted=true
18:36:18.397 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:18.397 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 6
18:36:18.397 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=6) -> granted=true
18:36:18.397 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 6
18:36:18.398 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:18.399 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Missing entry at index 2
18:36:18.400 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 failed, nextIndex decremented to 2
18:36:18.453 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:18.459 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:18.459 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:18.459 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:18.460 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
18:36:18.460 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
18:36:18.460 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
18:36:18.463 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Restarted node caught up successfully
18:36:18.464 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:18.464 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:18.464 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:18.466 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
18:36:18.466 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:18.466 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:18.466 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:18.466 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:18.467 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
18:36:18.467 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:18.467 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:18.467 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:18.467 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:18.468 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
18:36:18.468 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:18.578 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:18.579 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19051
18:36:18.579 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:18.580 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
18:36:18.580 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
18:36:18.580 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:18.580 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:18.580 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:18.580 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19051
18:36:18.581 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:18.581 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19052
18:36:18.581 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:18.582 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
18:36:18.582 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
18:36:18.582 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:18.582 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:18.582 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:18.582 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19052
18:36:18.582 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:18.582 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19053
18:36:18.582 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:18.583 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
18:36:18.583 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
18:36:18.583 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:18.583 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:18.583 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:18.583 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19053
18:36:18.583 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
18:36:18.584 [main] [node-4] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19054
18:36:18.584 [main] [node-4] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-4
18:36:18.584 [main] [node-4] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-4
18:36:18.584 [main] [node-4] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-4
18:36:18.584 [main] [node-4] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:18.584 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:18.584 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 initialized as FOLLOWER
18:36:18.584 [main] [node-4] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-4 on port 19054
18:36:18.584 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
18:36:18.585 [main] [node-5] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19055
18:36:18.585 [main] [node-5] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-5
18:36:18.585 [main] [node-5] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-5
18:36:18.585 [main] [node-5] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-5
18:36:18.585 [main] [node-5] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:18.585 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:18.585 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 initialized as FOLLOWER
18:36:18.585 [main] [node-5] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-5 on port 19055
18:36:18.741 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:18.742 [election-node-5] [node-5] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:18.742 [election-node-5] [node-5] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
18:36:18.742 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:18.742 [election-node-5] [node-5] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
18:36:18.742 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19053
18:36:18.742 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19051
18:36:18.742 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-4 at localhost:19054
18:36:18.742 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19052
18:36:18.745 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:18.745 [grpc-default-executor-1] [node-4] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:18.745 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:18.745 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:18.745 [grpc-default-executor-1] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:18.745 [grpc-default-executor-5] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:18.745 [grpc-default-executor-1] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:18.745 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:18.745 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:18.745 [grpc-default-executor-0] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:18.745 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:18.745 [grpc-default-executor-8] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:18.746 [grpc-default-executor-1] [node-4] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
18:36:18.746 [grpc-default-executor-1] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
18:36:18.746 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
18:36:18.746 [grpc-default-executor-0] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
18:36:18.746 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
18:36:18.746 [grpc-default-executor-5] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
18:36:18.746 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
18:36:18.746 [grpc-default-executor-8] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
18:36:18.746 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-3 VoteRequest(term=1) -> granted=true
18:36:18.746 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
18:36:18.746 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-4 VoteRequest(term=1) -> granted=true
18:36:18.746 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-2 VoteRequest(term=1) -> granted=true
18:36:18.746 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
18:36:18.746 [] [node-5] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:18.746 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-1 VoteRequest(term=1) -> granted=true
18:36:18.746 [] [node-5] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:18.746 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:18.796 [main] [node-5] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:18.796 [main] [node-5] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(five-node-test, value)
18:36:18.796 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:18.796 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
18:36:18.796 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:18.796 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:18.796 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:18.796 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
18:36:18.796 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:18.797 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:18.798 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:18.798 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:18.798 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:18.798 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:18.798 [grpc-default-executor-7] [node-4] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:18.798 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:18.798 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:18.798 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:18.798 [grpc-default-executor-8] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:18.798 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:18.798 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:18.798 [grpc-default-executor-7] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:18.798 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-4 AppendEntries(entries=1) -> success=true
18:36:18.798 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-1 AppendEntries(entries=1) -> success=true
18:36:18.798 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
18:36:18.798 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:18.798 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:18.798 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-3 AppendEntries(entries=1) -> success=true
18:36:18.798 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:18.798 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-2 AppendEntries(entries=1) -> success=true
18:36:18.798 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-3 AppendEntries(entries=1) -> success=true
18:36:18.798 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-2 AppendEntries(entries=1) -> success=true
18:36:18.798 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-4 AppendEntries(entries=1) -> success=true
18:36:18.798 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:18.799 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
18:36:18.798 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-1 AppendEntries(entries=1) -> success=true
18:36:18.853 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:18.853 [grpc-default-executor-8] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:18.853 [grpc-default-executor-7] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:18.853 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:18.853 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
18:36:18.853 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
18:36:18.853 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
18:36:18.853 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
18:36:18.904 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:18.904 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:18.904 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:18.905 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
18:36:18.905 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:18.905 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-1
18:36:18.905 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:18.905 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:18.905 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:18.905 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
18:36:18.905 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:18.905 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-2
18:36:18.905 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Stopped two followers: node-1 and node-2
18:36:19.011 [main] [node-5] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:19.011 [main] [node-5] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failures, still-working)
18:36:19.011 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:19.011 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
18:36:19.011 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:19.011 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:19.012 [grpc-default-executor-0] [node-4] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:19.012 [grpc-default-executor-8] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:19.012 [grpc-default-executor-0] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:19.012 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:19.013 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-4 AppendEntries(entries=1) -> success=true
18:36:19.013 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-3 AppendEntries(entries=1) -> success=true
18:36:19.013 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
18:36:19.013 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
18:36:19.013 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:19.013 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:19.013 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
18:36:19.049 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:19.049 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:19.049 [grpc-default-executor-8] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:19.049 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:19.049 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
18:36:19.049 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
18:36:19.097 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:19.097 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:19.119 [main] [node-5] INFO  c.raftdb.integration.GrpcClusterTest - Five-node cluster survived two failures
18:36:19.119 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:19.119 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:19.119 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:19.121 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
18:36:19.121 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:19.121 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
18:36:19.121 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:19.121 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:19.121 [main] [node-4] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-4
18:36:19.121 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
18:36:19.121 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
18:36:19.121 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:19.121 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:19.122 [main] [node-5] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-5
18:36:19.122 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
18:36:19.230 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:19.231 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19061
18:36:19.231 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:19.231 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
18:36:19.231 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
18:36:19.231 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:19.231 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:19.231 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:19.231 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19061
18:36:19.384 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:19.386 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:19.387 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:19.387 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:19.387 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
18:36:19.387 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:19.387 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:19.387 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:19.443 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:19.443 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(single, node)
18:36:19.443 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:19.444 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(single, node)
18:36:19.444 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Single node cluster works
18:36:19.444 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:19.444 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:19.444 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:19.444 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
18:36:19.444 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:19.562 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:19.562 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-116704514088054645665
18:36:19.562 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-116704514088054645665
18:36:19.562 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:19.562 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:19.562 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:19.562 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:19.562 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:19.562 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:19.562 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-116704514088054645665
18:36:19.562 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-116704514088054645665
18:36:19.562 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:19.563 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:19.563 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:19.563 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:19.563 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-27336081856142274581
18:36:19.563 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-27336081856142274581
18:36:19.563 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:19.563 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:19.563 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:19.563 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:19.563 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:19.563 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:19.563 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-27336081856142274581
18:36:19.563 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-27336081856142274581
18:36:19.563 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:19.563 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:19.563 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:19.563 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:19.563 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312156723309131525241
18:36:19.563 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312156723309131525241
18:36:19.563 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:19.563 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:19.563 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:19.563 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:19.563 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:19.563 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:19.563 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312156723309131525241
18:36:19.564 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312156723309131525241
18:36:19.564 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:19.564 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:19.564 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:19.749 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:19.750 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:19.750 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:19.750 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:19.751 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:19.751 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
18:36:19.751 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
18:36:19.751 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:19.751 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:19.751 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:19.751 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:19.751 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:19.751 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:19.751 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:19.751 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:19.751 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
18:36:19.751 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:19.751 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:19.751 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:19.751 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:19.751 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:19.751 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:19.751 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
18:36:19.780 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:19.781 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test-key, test-value)
18:36:19.781 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:19.781 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:19.781 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
18:36:19.781 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
18:36:19.781 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:19.781 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:19.781 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:19.781 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:19.781 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:19.781 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:19.781 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:19.781 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test-key, test-value)
18:36:19.807 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:19.807 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:19.807 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test-key, test-value)
18:36:19.807 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test-key, test-value)
18:36:19.986 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
18:36:19.990 [main] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:19.991 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=test-key, found=true
18:36:19.993 [main] [node-2] INFO  c.r.integration.LinearizableReadTest - ✓ Linearizable read returned committed value
18:36:19.994 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:19.994 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:19.994 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:19.994 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:19.994 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:19.994 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:19.994 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:19.994 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:19.994 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:19.994 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:19.994 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:19.994 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:19.994 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:19.994 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:19.994 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:19.999 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:20.000 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-19402397075576796631
18:36:20.000 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-19402397075576796631
18:36:20.000 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.000 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.000 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:20.000 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:20.000 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:20.000 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:20.000 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-19402397075576796631
18:36:20.000 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-19402397075576796631
18:36:20.000 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.000 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.000 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:20.000 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:20.000 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-211522331582885498537
18:36:20.000 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-211522331582885498537
18:36:20.000 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.000 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.000 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:20.000 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:20.000 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:20.000 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:20.000 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-211522331582885498537
18:36:20.000 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-211522331582885498537
18:36:20.000 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.000 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.000 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:20.000 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:20.001 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-33522027338829197824
18:36:20.001 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-33522027338829197824
18:36:20.001 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.001 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.001 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:20.001 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:20.001 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:20.001 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:20.001 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-33522027338829197824
18:36:20.001 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-33522027338829197824
18:36:20.001 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.001 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.001 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:20.215 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:20.218 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:20.219 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:20.219 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:20.219 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:20.219 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
18:36:20.220 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
18:36:20.220 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:20.221 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:20.221 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:20.221 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:20.221 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:20.221 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:20.221 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:20.221 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:20.221 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
18:36:20.221 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:20.221 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:20.221 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:20.221 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:20.221 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:20.221 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
18:36:20.221 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:20.272 [main] [node-2] INFO  c.r.integration.LinearizableReadTest - ✓ Linearizable read on follower correctly rejected
18:36:20.273 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:20.273 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:20.273 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:20.273 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:20.273 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:20.273 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:20.273 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:20.273 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:20.273 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:20.273 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:20.273 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:20.273 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:20.273 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:20.273 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:20.273 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:20.278 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:20.279 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-18725636915381734577
18:36:20.279 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-18725636915381734577
18:36:20.279 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.279 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.279 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:20.279 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:20.279 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:20.279 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:20.279 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-18725636915381734577
18:36:20.279 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-18725636915381734577
18:36:20.279 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.279 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.279 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:20.279 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:20.279 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-23285591934868250200
18:36:20.279 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-23285591934868250200
18:36:20.279 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.279 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.279 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:20.279 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:20.279 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:20.280 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:20.280 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-23285591934868250200
18:36:20.280 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-23285591934868250200
18:36:20.280 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.280 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.280 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:20.280 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:20.280 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-31543898816723651153
18:36:20.280 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-31543898816723651153
18:36:20.280 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.280 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.280 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:20.280 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:20.280 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:20.280 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:20.280 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-31543898816723651153
18:36:20.280 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-31543898816723651153
18:36:20.280 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.280 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.280 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:20.501 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:20.503 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:20.504 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:20.504 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:20.504 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:20.504 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
18:36:20.504 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
18:36:20.505 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:20.505 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:20.505 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:20.505 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:20.505 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:20.505 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:20.506 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:20.506 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:20.506 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:20.506 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:20.506 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
18:36:20.506 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
18:36:20.506 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:20.506 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:20.506 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:20.506 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:20.551 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:20.552 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(counter, value-1)
18:36:20.552 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:20.552 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:20.553 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
18:36:20.553 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
18:36:20.553 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:20.553 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:20.553 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:20.554 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:20.554 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:20.554 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:20.554 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:20.555 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(counter, value-1)
18:36:20.555 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:20.555 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(counter, value-2)
18:36:20.555 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
18:36:20.555 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
18:36:20.555 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
18:36:20.555 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
18:36:20.556 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:20.556 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:20.556 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:20.556 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:20.556 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:20.556 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:20.556 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
18:36:20.556 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
18:36:20.556 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(counter, value-1)
18:36:20.556 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
18:36:20.556 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(counter, value-2)
18:36:20.556 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(counter, value-1)
18:36:20.556 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:20.556 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
18:36:20.556 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(counter, value-2)
18:36:20.556 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(counter, value-2)
18:36:20.557 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:36:20.557 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(counter, value-3)
18:36:20.557 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
18:36:20.557 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
18:36:20.557 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
18:36:20.557 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
18:36:20.557 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:20.557 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:20.557 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
18:36:20.557 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
18:36:20.557 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:20.557 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
18:36:20.557 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(counter, value-3)
18:36:20.557 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
18:36:20.558 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
18:36:20.558 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(counter, value-4)
18:36:20.558 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
18:36:20.558 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
18:36:20.558 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
18:36:20.558 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
18:36:20.558 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:20.558 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:36:20.558 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:20.558 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
18:36:20.558 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:20.558 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:20.558 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
18:36:20.558 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(counter, value-3)
18:36:20.558 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
18:36:20.558 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:36:20.558 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:36:20.558 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(counter, value-3)
18:36:20.558 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(counter, value-4)
18:36:20.559 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
18:36:20.559 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(counter, value-5)
18:36:20.559 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
18:36:20.559 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
18:36:20.559 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
18:36:20.559 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
18:36:20.559 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:20.559 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:36:20.559 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:20.559 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:36:20.559 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
18:36:20.559 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
18:36:20.559 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
18:36:20.559 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(counter, value-4)
18:36:20.559 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(counter, value-4)
18:36:20.559 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
18:36:20.559 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:36:20.559 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:36:20.559 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(counter, value-5)
18:36:20.559 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=5
18:36:20.560 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:20.560 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:20.560 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:20.560 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(counter, value-5)
18:36:20.560 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(counter, value-5)
18:36:20.560 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=counter, found=true
18:36:20.561 [main] [node-2] INFO  c.r.integration.LinearizableReadTest - ✓ Linearizable read sees latest write
18:36:20.562 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:20.562 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:20.562 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:20.562 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:20.562 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:20.562 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:20.562 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:20.562 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:20.562 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:20.562 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:20.562 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:20.562 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:20.562 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:20.562 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:20.562 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:20.567 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:20.567 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-11668740340894010422
18:36:20.567 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-11668740340894010422
18:36:20.567 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.567 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.567 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:20.567 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:20.567 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:20.567 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:20.568 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-11668740340894010422
18:36:20.568 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-11668740340894010422
18:36:20.568 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.568 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.568 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:20.568 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:20.568 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-214518396960902404358
18:36:20.568 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-214518396960902404358
18:36:20.568 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.568 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.568 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:20.568 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:20.568 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:20.568 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:20.568 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-214518396960902404358
18:36:20.568 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-214518396960902404358
18:36:20.568 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.568 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.568 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:20.568 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:20.568 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312766735408210750978
18:36:20.569 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312766735408210750978
18:36:20.569 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.569 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.569 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:20.569 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:20.569 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:20.569 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:20.569 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312766735408210750978
18:36:20.569 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312766735408210750978
18:36:20.569 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:20.569 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:20.569 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:20.785 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:20.786 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:20.786 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:20.786 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:20.786 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:20.786 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
18:36:20.786 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
18:36:20.787 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:20.787 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:20.787 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:20.787 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:20.787 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:20.787 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:20.787 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:20.787 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:20.787 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
18:36:20.787 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:20.787 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:20.787 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:20.787 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:20.787 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
18:36:20.787 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:20.787 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:21.340 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=0
18:36:21.341 [main] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:21.341 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=non-existent-key, found=false
18:36:21.343 [main] [node-1] INFO  c.r.integration.LinearizableReadTest - ✓ Linearizable read for non-existent key returns null
18:36:21.344 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:21.344 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:21.344 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:21.344 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:21.344 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:21.344 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:21.344 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:21.344 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:21.345 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:21.345 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:21.345 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:21.345 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:21.345 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:21.345 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:21.345 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:21.350 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:21.350 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-17516221755786529147
18:36:21.350 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-17516221755786529147
18:36:21.350 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:21.350 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:21.350 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:21.351 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:21.351 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:21.351 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:21.351 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-17516221755786529147
18:36:21.351 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-17516221755786529147
18:36:21.351 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:21.351 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:21.351 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:21.351 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:21.351 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-212886879382749925374
18:36:21.351 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-212886879382749925374
18:36:21.351 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:21.351 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:21.352 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:21.352 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:21.352 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:21.352 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:21.352 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-212886879382749925374
18:36:21.352 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-212886879382749925374
18:36:21.352 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:21.352 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:21.352 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:21.352 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:21.352 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312234676547846140051
18:36:21.352 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312234676547846140051
18:36:21.352 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:21.352 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:21.352 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:21.352 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:21.352 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:21.352 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:21.352 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312234676547846140051
18:36:21.352 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312234676547846140051
18:36:21.352 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:21.352 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:21.352 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:21.543 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:21.546 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:21.547 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:21.547 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:21.547 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:21.548 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
18:36:21.548 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
18:36:21.548 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:21.549 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:21.549 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:21.549 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:21.549 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:21.549 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:21.549 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:21.549 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:21.549 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:21.549 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:21.549 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
18:36:21.549 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
18:36:21.549 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:21.549 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:21.549 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:21.549 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:21.565 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:21.565 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(leadership-test, confirmed)
18:36:21.565 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:21.565 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:21.566 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
18:36:21.566 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
18:36:21.566 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:21.566 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:21.566 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:21.566 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:21.566 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:21.567 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:21.567 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:21.567 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(leadership-test, confirmed)
18:36:21.602 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:21.602 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:21.603 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(leadership-test, confirmed)
18:36:21.603 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(leadership-test, confirmed)
18:36:21.773 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
18:36:21.774 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:21.774 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=leadership-test, found=true
18:36:21.774 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
18:36:21.774 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:21.775 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=leadership-test, found=true
18:36:21.775 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
18:36:21.775 [main] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:21.775 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=leadership-test, found=true
18:36:21.775 [main] [node-2] INFO  c.r.integration.LinearizableReadTest - ✓ Multiple linearizable reads succeeded, leadership confirmed
18:36:21.776 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:21.776 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:21.776 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:21.776 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:21.776 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:21.776 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:21.776 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:21.777 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:21.777 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:21.777 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:21.777 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:21.777 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:21.777 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:21.777 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:21.777 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:21.787 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:21.788 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-12050611840373266263
18:36:21.788 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-12050611840373266263
18:36:21.789 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:21.789 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:21.789 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:21.789 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:21.789 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:21.789 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:21.789 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-12050611840373266263
18:36:21.789 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-12050611840373266263
18:36:21.790 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:21.790 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:21.790 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:21.998 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:22.000 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:22.000 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:22.000 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:22.000 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
18:36:22.000 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:22.000 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:22.000 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:22.795 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:22.795 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(single-node-key, single-node-value)
18:36:22.796 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:22.796 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(single-node-key, single-node-value)
18:36:22.796 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
18:36:22.797 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=single-node-key, found=true
18:36:22.797 [main] [node-1] INFO  c.r.integration.LinearizableReadTest - ✓ Single node linearizable read succeeded
18:36:22.797 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:22.797 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:22.797 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:22.797 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:22.797 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:22.800 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:22.800 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-114447052075018783812
18:36:22.800 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-114447052075018783812
18:36:22.800 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:22.800 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:22.801 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:22.801 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:22.801 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:22.801 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:22.801 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-114447052075018783812
18:36:22.801 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-114447052075018783812
18:36:22.801 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:22.801 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:22.801 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:22.801 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:22.801 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-215733264072180629010
18:36:22.801 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-215733264072180629010
18:36:22.801 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:22.801 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:22.801 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:22.801 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:22.801 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:22.801 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:22.801 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-215733264072180629010
18:36:22.801 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-215733264072180629010
18:36:22.801 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:22.801 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:22.801 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:22.801 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:22.801 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-38872197931970882262
18:36:22.801 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-38872197931970882262
18:36:22.801 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:22.801 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:22.801 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:22.801 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:22.801 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:22.801 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:22.801 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-38872197931970882262
18:36:22.801 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-38872197931970882262
18:36:22.801 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:22.801 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:22.801 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:22.996 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:22.999 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:22.999 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:23.000 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:23.000 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:23.000 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:23.001 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:23.001 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
18:36:23.001 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
18:36:23.002 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
18:36:23.002 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=false)
18:36:23.002 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:23.002 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:23.002 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:23.002 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
18:36:23.002 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
18:36:23.002 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=false)
18:36:23.002 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
18:36:23.002 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:23.002 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:23.002 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:23.003 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
18:36:23.003 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=false)
18:36:23.003 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
18:36:23.003 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:23.003 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
18:36:23.003 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:23.004 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:23.004 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:23.004 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:23.020 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:23.020 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-key, 0)
18:36:23.020 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
18:36:23.021 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:23.021 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:36:23.022 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:36:23.022 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.022 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:23.022 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
18:36:23.022 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.022 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:23.022 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:23.022 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:23.022 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:23.022 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-key, 0)
18:36:23.058 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:23.058 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:23.058 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-key, 0)
18:36:23.059 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-key, 0)
18:36:23.232 [pool-7-thread-1] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
18:36:23.232 [pool-7-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-key, 1)
18:36:23.232 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
18:36:23.232 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:36:23.232 [pool-7-thread-2] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
18:36:23.232 [pool-7-thread-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-key, 2)
18:36:23.232 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=2)
18:36:23.233 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
18:36:23.233 [pool-7-thread-3] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
18:36:23.233 [pool-7-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-key, 3)
18:36:23.233 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.233 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=2)
18:36:23.233 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
18:36:23.233 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=2)
18:36:23.233 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=2)
18:36:23.233 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
18:36:23.233 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
18:36:23.233 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
18:36:23.233 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
18:36:23.233 [pool-7-thread-4] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
18:36:23.233 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
18:36:23.233 [pool-7-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-key, 4)
18:36:23.233 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 3
18:36:23.233 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
18:36:23.233 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=2)
18:36:23.233 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
18:36:23.233 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 3
18:36:23.233 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=3)
18:36:23.233 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
18:36:23.233 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 3
18:36:23.233 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.233 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 4
18:36:23.233 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 4
18:36:23.233 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 4
18:36:23.234 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
18:36:23.233 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-key, 1)
18:36:23.234 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.233 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=4)
18:36:23.234 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
18:36:23.234 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
18:36:23.233 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
18:36:23.234 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-key, 2)
18:36:23.234 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 5
18:36:23.234 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-key, 3)
18:36:23.234 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
18:36:23.234 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.234 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
18:36:23.234 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
18:36:23.234 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
18:36:23.234 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-key, 4)
18:36:23.234 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 5
18:36:23.234 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
18:36:23.234 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
18:36:23.234 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-key, 1)
18:36:23.234 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-key, 2)
18:36:23.259 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:23.259 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
18:36:23.259 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-key, 3)
18:36:23.259 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-key, 4)
18:36:23.259 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-key, 1)
18:36:23.259 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-key, 2)
18:36:23.259 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-key, 3)
18:36:23.259 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-key, 4)
18:36:23.289 [pool-7-thread-2] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
18:36:23.289 [pool-7-thread-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-key, 5)
18:36:23.289 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
18:36:23.289 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:36:23.290 [pool-7-thread-4] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
18:36:23.290 [pool-7-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-key, 6)
18:36:23.290 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=6)
18:36:23.290 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
18:36:23.290 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.290 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
18:36:23.290 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
18:36:23.290 [pool-7-thread-1] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
18:36:23.290 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
18:36:23.290 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 7
18:36:23.290 [pool-7-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-key, 7)
18:36:23.290 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=6)
18:36:23.290 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 7
18:36:23.290 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
18:36:23.290 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
18:36:23.290 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:36:23.290 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
18:36:23.290 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=7)
18:36:23.290 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
18:36:23.290 [pool-7-thread-3] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
18:36:23.290 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.290 [pool-7-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-key, 8)
18:36:23.290 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
18:36:23.290 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
18:36:23.290 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
18:36:23.290 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=7)
18:36:23.290 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
18:36:23.290 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-key, 5)
18:36:23.290 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
18:36:23.290 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-key, 6)
18:36:23.290 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:36:23.290 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-key, 5)
18:36:23.290 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=8)
18:36:23.290 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-key, 6)
18:36:23.290 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
18:36:23.290 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
18:36:23.291 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
18:36:23.290 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
18:36:23.291 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-key, 7)
18:36:23.290 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 8
18:36:23.290 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
18:36:23.291 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.291 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.291 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
18:36:23.291 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
18:36:23.291 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
18:36:23.291 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
18:36:23.291 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 9
18:36:23.291 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
18:36:23.291 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
18:36:23.291 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-key, 5)
18:36:23.291 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-key, 8)
18:36:23.291 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-key, 6)
18:36:23.307 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
18:36:23.307 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
18:36:23.307 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-key, 7)
18:36:23.307 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-key, 7)
18:36:23.307 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-key, 8)
18:36:23.307 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-key, 8)
18:36:23.343 [pool-7-thread-1] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
18:36:23.344 [pool-7-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-key, 9)
18:36:23.344 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
18:36:23.344 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
18:36:23.344 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:36:23.344 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:36:23.344 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.344 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
18:36:23.344 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.344 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
18:36:23.344 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
18:36:23.344 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
18:36:23.344 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
18:36:23.344 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-key, 9)
18:36:23.346 [pool-7-thread-2] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
18:36:23.346 [pool-7-thread-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-key, 10)
18:36:23.346 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=11)
18:36:23.346 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
18:36:23.346 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
18:36:23.346 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
18:36:23.346 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.346 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
18:36:23.346 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.346 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
18:36:23.346 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
18:36:23.346 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
18:36:23.346 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
18:36:23.346 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
18:36:23.346 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-key, 9)
18:36:23.346 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
18:36:23.346 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-key, 9)
18:36:23.346 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
18:36:23.346 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-key, 10)
18:36:23.355 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
18:36:23.355 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
18:36:23.355 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-key, 10)
18:36:23.356 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-key, 10)
18:36:23.366 [pool-7-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:36:23.366 [] [node-3] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 2/2 peer responses
18:36:23.366 [] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:36:23.371 [pool-7-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:36:23.371 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:23.371 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:36:23.391 [pool-7-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:36:23.391 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:23.391 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:36:23.393 [pool-7-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:36:23.393 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:23.393 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:36:23.416 [pool-7-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:36:23.416 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:23.416 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:36:23.418 [pool-7-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:36:23.418 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:23.418 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:36:23.422 [pool-7-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:36:23.422 [pool-7-thread-2] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:36:23.422 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:23.422 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:36:23.422 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:23.423 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:36:23.439 [pool-7-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:36:23.439 [pool-7-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:36:23.439 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:23.439 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:36:23.439 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:23.439 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:36:23.439 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
18:36:23.439 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:23.439 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
18:36:23.439 [main] [node-1] INFO  c.r.integration.LinearizableReadTest - ✓ Concurrent writes and linearizable reads completed successfully
18:36:23.440 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:23.440 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:23.440 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:23.440 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:23.440 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:23.440 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:23.440 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:23.440 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:23.440 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:23.440 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:23.440 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:23.440 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:23.440 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:23.440 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:23.440 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:23.442 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:23.443 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-110474278502158873166
18:36:23.443 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-110474278502158873166
18:36:23.443 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:23.443 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:23.443 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:23.443 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:23.443 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:23.443 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:23.443 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-110474278502158873166
18:36:23.443 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-110474278502158873166
18:36:23.443 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:23.443 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:23.443 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:23.443 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:23.443 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-26182714436128929188
18:36:23.443 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-26182714436128929188
18:36:23.443 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:23.443 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:23.444 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:23.444 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:23.444 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:23.444 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:23.444 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-26182714436128929188
18:36:23.444 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-26182714436128929188
18:36:23.444 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:23.444 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:23.444 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:23.444 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:23.444 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-39607381329187191902
18:36:23.444 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-39607381329187191902
18:36:23.444 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:23.444 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:23.444 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:23.444 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:23.444 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:23.444 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:23.444 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-39607381329187191902
18:36:23.445 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-39607381329187191902
18:36:23.445 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
18:36:23.445 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:23.445 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:23.600 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:23.601 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:23.601 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:23.601 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:23.601 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:23.601 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
18:36:23.601 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
18:36:23.602 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:23.602 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
18:36:23.602 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:23.602 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:23.602 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:23.602 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:23.602 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:23.602 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:23.602 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
18:36:23.602 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
18:36:23.602 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:23.602 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:23.602 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
18:36:23.602 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:23.602 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:23.602 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:23.607 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
18:36:23.607 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(compare-key, latest-value)
18:36:23.607 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
18:36:23.607 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
18:36:23.607 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
18:36:23.607 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
18:36:23.608 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.608 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:23.608 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
18:36:23.608 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
18:36:23.608 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
18:36:23.608 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
18:36:23.608 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:23.608 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
18:36:23.608 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(compare-key, latest-value)
18:36:23.655 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:23.655 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
18:36:23.656 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(compare-key, latest-value)
18:36:23.656 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(compare-key, latest-value)
18:36:23.813 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
18:36:23.813 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
18:36:23.813 [] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=compare-key, found=true
18:36:23.813 [main] [node-2] INFO  c.r.integration.LinearizableReadTest - ✓ Both stale and linearizable reads returned correct value
18:36:23.814 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:23.814 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:23.814 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:23.814 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:23.814 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:23.814 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:23.814 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:23.814 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:23.814 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:23.814 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:23.814 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:23.814 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:23.814 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:23.815 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:23.815 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:23.821 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:23.821 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:23.821 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:23.821 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:23.821 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:23.821 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:23.821 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:23.821 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:23.821 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:23.821 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:23.821 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:23.821 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:23.821 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:23.821 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:23.821 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:24.009 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:24.010 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:24.010 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:24.010 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
18:36:24.010 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:24.010 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
18:36:24.010 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.010 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:24.010 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.010 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:24.010 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
18:36:24.010 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
18:36:24.010 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
18:36:24.010 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:24.010 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:24.010 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:24.010 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:24.034 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-3 (term 1)
18:36:24.243 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - All nodes agree on leader: node-3
18:36:24.244 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:24.244 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.244 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:24.244 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:24.244 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:24.244 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:24.244 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.244 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:24.244 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:24.244 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:24.244 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:24.244 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.244 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:24.244 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:24.244 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:24.247 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:24.247 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:24.247 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:24.247 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:24.247 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:24.247 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:24.247 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:24.247 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:24.247 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:24.247 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:24.247 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:24.247 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:24.247 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:24.247 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:24.247 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:24.247 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
18:36:24.247 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
18:36:24.247 [main] [node-4] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-4
18:36:24.247 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:24.247 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 initialized as FOLLOWER
18:36:24.247 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
18:36:24.247 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
18:36:24.247 [main] [node-5] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-5
18:36:24.247 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:24.247 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 initialized as FOLLOWER
18:36:24.412 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:24.412 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:24.412 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:24.412 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:24.412 [election-node-4] [node-4] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
18:36:24.412 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
18:36:24.412 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 VoteRequest(term=1)
18:36:24.412 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 VoteRequest(term=1)
18:36:24.412 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
18:36:24.412 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
18:36:24.412 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:24.412 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:24.412 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 VoteRequest(term=1)
18:36:24.412 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 VoteRequest(term=1)
18:36:24.413 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
18:36:24.412 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 VoteRequest(term=1)
18:36:24.413 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:24.413 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-4 - canVote=false, logUpToDate=true
18:36:24.413 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:24.413 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.412 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 VoteRequest(term=1)
18:36:24.413 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
18:36:24.413 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.413 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.413 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-4 - canVote=false, logUpToDate=true
18:36:24.413 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
18:36:24.413 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-1 VoteResponse(granted=false)
18:36:24.413 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-4 VoteResponse(granted=false)
18:36:24.413 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
18:36:24.413 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-2 VoteResponse(granted=false)
18:36:24.413 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:24.413 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=false)
18:36:24.413 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-4 - canVote=false, logUpToDate=true
18:36:24.413 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-5 VoteResponse(granted=false)
18:36:24.413 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-3 VoteResponse(granted=true)
18:36:24.413 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
18:36:24.413 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-5 VoteResponse(granted=true)
18:36:24.413 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
18:36:24.413 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
18:36:24.413 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:24.413 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:24.413 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:24.455 [main] [node-5] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-2 (term 1)
18:36:24.455 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:24.455 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.455 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:24.455 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:24.456 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:24.456 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:24.456 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.456 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:24.456 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:24.456 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:24.456 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:24.456 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.456 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:24.456 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:24.456 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:24.456 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
18:36:24.456 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.456 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:24.456 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
18:36:24.456 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
18:36:24.456 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
18:36:24.456 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.456 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:24.456 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
18:36:24.456 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
18:36:24.458 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:24.458 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:24.458 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:24.458 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:24.458 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:24.458 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:24.458 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:24.458 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:24.458 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:24.458 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:24.458 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:24.458 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:24.458 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:24.458 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:24.459 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:24.620 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:24.621 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:24.621 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:24.622 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
18:36:24.622 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:24.622 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
18:36:24.622 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:24.622 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.622 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:24.622 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:24.622 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
18:36:24.622 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
18:36:24.622 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:24.622 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
18:36:24.622 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:24.622 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:24.622 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:25.178 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader node-1 maintained leadership for 500ms
18:36:25.178 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:25.178 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:25.179 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:25.179 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:25.179 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:25.179 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:25.179 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:25.179 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:25.179 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:25.179 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:25.179 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:25.179 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:25.179 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:25.179 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:25.179 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
18:36:25.186 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
18:36:25.186 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
18:36:25.186 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
18:36:25.186 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:25.186 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
18:36:25.186 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
18:36:25.186 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
18:36:25.186 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
18:36:25.186 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:25.187 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
18:36:25.187 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
18:36:25.187 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
18:36:25.187 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
18:36:25.187 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
18:36:25.187 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
18:36:25.375 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:25.376 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
18:36:25.379 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:25.379 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
18:36:25.380 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:25.380 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:25.380 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:25.380 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
18:36:25.380 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:25.380 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
18:36:25.380 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
18:36:25.380 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:25.380 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
18:36:25.380 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:25.380 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:25.380 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
18:36:25.380 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
18:36:25.395 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Initial leader: node-2 (term 1)
18:36:25.395 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
18:36:25.395 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:25.395 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:25.395 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
18:36:25.395 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
18:36:25.542 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
18:36:25.542 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
18:36:25.542 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
18:36:25.543 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=2)
18:36:25.543 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
18:36:25.543 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:25.543 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
18:36:25.543 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
18:36:25.543 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
18:36:25.543 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
18:36:25.543 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
18:36:25.543 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
18:36:25.543 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
18:36:25.605 [main] [node-2] INFO  com.raftdb.integration.ClusterTest - New leader: node-1 (term 2)
18:36:25.606 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
18:36:25.606 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:25.606 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:25.606 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
18:36:25.606 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
18:36:25.606 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
18:36:25.606 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
18:36:25.606 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
18:36:25.606 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
18:36:25.606 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:56:53.876 [main] [] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
19:56:53.878 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:56:53.878 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
19:56:53.879 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
19:56:53.879 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:53.879 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:53.880 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:56:53.880 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
19:56:53.881 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
19:56:53.881 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:56:53.881 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
19:56:53.881 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
19:56:53.881 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:53.881 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:53.881 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:56:53.881 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
19:56:53.882 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
19:56:53.882 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:56:53.882 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
19:56:53.882 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
19:56:53.882 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:53.882 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:53.883 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:56:53.883 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
19:56:54.054 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:54.054 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:54.057 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:54.057 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:54.058 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:56:54.058 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:56:54.058 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:54.058 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:54.060 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:54.060 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:54.065 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
19:56:54.065 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
19:56:54.066 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
19:56:54.066 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
19:56:54.082 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:54.082 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:54.083 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:56:54.083 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:54.083 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:54.083 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
19:56:54.083 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
19:56:54.185 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
19:56:54.185 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:56:54.185 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:56:54.185 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:56:54.185 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:56:54.185 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
19:56:54.192 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=false
19:56:54.192 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=false
19:56:54.192 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=false
19:56:54.192 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=false
19:56:54.192 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=false
19:56:54.192 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=false
19:56:54.266 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:54.267 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:56:54.267 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:56:54.267 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:56:54.267 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:54.269 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:56:54.269 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:56:54.269 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:54.270 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:54.270 [grpc-default-executor-2] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:54.270 [grpc-default-executor-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:54.270 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:56:54.270 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:56:54.270 [grpc-default-executor-1] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
19:56:54.270 [grpc-default-executor-2] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
19:56:54.271 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=2) -> granted=true
19:56:54.271 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=2) -> granted=true
19:56:54.271 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:56:54.271 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:56:54.271 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:56:54.272 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:56:54.308 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=name
19:56:54.310 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
19:56:54.310 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
19:56:54.369 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=name
19:56:54.370 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 2
19:56:54.371 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(name, Alice)
19:56:54.371 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:56:54.372 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:56:54.373 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:54.373 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:54.374 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:54.374 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:54.374 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:56:54.374 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:56:54.378 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:56:54.378 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:56:54.378 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:54.378 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:54.378 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:56:54.378 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:56:54.378 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:54.378 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:54.379 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(name, Alice)
19:56:54.379 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:56:54.379 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:56:54.384 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=age
19:56:54.384 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
19:56:54.384 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(age, 25)
19:56:54.384 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:56:54.384 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:56:54.385 [grpc-default-executor-10] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:54.385 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:54.386 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:56:54.386 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:56:54.386 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:56:54.386 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:56:54.386 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(name, Alice)
19:56:54.386 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(name, Alice)
19:56:54.387 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:56:54.387 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:56:54.387 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:56:54.387 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:56:54.387 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:56:54.387 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(age, 25)
19:56:54.388 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=name
19:56:54.410 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=age
19:56:54.412 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=nonexistent
19:56:54.413 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Basic put/get test passed
19:56:54.420 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:56:54.420 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:54.420 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:54.427 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:56:54.427 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:56:54.427 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:56:54.427 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:54.428 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:54.429 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:56:54.429 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:56:54.429 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:56:54.429 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:54.429 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:54.430 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:56:54.430 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:56:54.541 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
19:56:54.541 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:56:54.542 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
19:56:54.542 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
19:56:54.542 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:54.542 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:54.542 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:56:54.542 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
19:56:54.543 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
19:56:54.543 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:56:54.543 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
19:56:54.543 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
19:56:54.543 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:54.543 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:54.543 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:56:54.543 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
19:56:54.544 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
19:56:54.544 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:56:54.544 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
19:56:54.544 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
19:56:54.544 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:54.544 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:54.544 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:56:54.544 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
19:56:54.704 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:54.705 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:54.706 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:56:54.706 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:54.706 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:54.706 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
19:56:54.706 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
19:56:54.711 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:54.711 [grpc-default-executor-17] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:54.711 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:54.711 [grpc-default-executor-17] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:54.711 [grpc-default-executor-1] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:54.712 [grpc-default-executor-17] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:54.712 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:56:54.712 [grpc-default-executor-17] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:56:54.712 [grpc-default-executor-1] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:56:54.712 [grpc-default-executor-17] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:56:54.713 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
19:56:54.713 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
19:56:54.713 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:56:54.713 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:56:54.713 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:56:54.713 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:56:54.757 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=temp
19:56:54.758 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:56:54.758 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(temp, value)
19:56:54.758 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:56:54.758 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:56:54.760 [grpc-default-executor-17] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:54.760 [grpc-default-executor-17] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:54.760 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:54.760 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:54.761 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:56:54.761 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:56:54.761 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:56:54.761 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:54.761 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:56:54.761 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(temp, value)
19:56:54.763 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=temp
19:56:54.765 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=DELETE, key=temp
19:56:54.765 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:56:54.765 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(temp)
19:56:54.765 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:56:54.765 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:56:54.765 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:56:54.765 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:56:54.767 [grpc-default-executor-17] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:54.767 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:54.767 [grpc-default-executor-17] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:56:54.767 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:56:54.767 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:56:54.767 [grpc-default-executor-17] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:56:54.767 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:56:54.767 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:56:54.767 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(temp, value)
19:56:54.767 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(temp, value)
19:56:54.768 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:56:54.768 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:56:54.768 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:56:54.768 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:56:54.768 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:56:54.768 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:56:54.768 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:56:54.768 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:56:54.768 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(temp)
19:56:54.770 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=temp
19:56:54.770 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Delete test passed
19:56:54.771 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:56:54.771 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:54.771 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:54.772 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:56:54.772 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:56:54.772 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:56:54.772 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:54.772 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:54.772 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:56:54.772 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:56:54.772 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:56:54.772 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:54.772 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:54.773 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:56:54.773 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:56:54.877 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
19:56:54.877 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:56:54.877 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
19:56:54.878 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
19:56:54.878 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:54.878 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:54.878 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:56:54.878 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
19:56:54.878 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
19:56:54.878 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:56:54.879 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
19:56:54.879 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
19:56:54.879 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:54.879 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:54.879 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:56:54.879 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
19:56:54.879 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
19:56:54.879 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:56:54.880 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
19:56:54.880 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
19:56:54.880 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:54.880 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:54.880 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:56:54.880 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
19:56:55.092 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:55.093 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:55.094 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:56:55.095 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:55.095 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:55.095 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
19:56:55.095 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
19:56:55.098 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:55.099 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:55.100 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:56:55.100 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:55.100 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:55.100 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
19:56:55.100 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
19:56:55.100 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:56:55.101 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:55.101 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:55.101 [grpc-default-executor-5] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:55.102 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:56:55.102 [grpc-default-executor-5] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:56:55.102 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=false
19:56:55.103 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
19:56:55.103 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:56:55.103 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:56:55.103 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:56:55.103 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:56:55.104 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:56:55.104 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:56:55.105 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=false
19:56:55.105 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=false
19:56:55.199 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=redirect-test
19:56:55.200 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-1
19:56:55.200 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
19:56:55.256 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=redirect-test
19:56:55.256 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:56:55.256 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(redirect-test, value)
19:56:55.256 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:56:55.257 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:56:55.257 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:56:55.257 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:56:55.258 [grpc-default-executor-10] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:55.259 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:55.259 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:55.259 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:55.259 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:55.259 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:55.260 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:56:55.260 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:56:55.260 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:56:55.260 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:56:55.260 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:56:55.260 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:55.260 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:55.260 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:56:55.260 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(redirect-test, value)
19:56:55.262 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=redirect-test
19:56:55.263 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Auto-redirect test passed
19:56:55.264 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:56:55.264 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:55.264 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:55.265 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:56:55.265 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:56:55.265 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:56:55.265 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:55.265 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:55.266 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:56:55.266 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:56:55.266 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:56:55.266 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:55.266 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:55.266 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:56:55.266 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:56:55.371 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
19:56:55.371 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:56:55.371 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
19:56:55.372 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
19:56:55.372 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:55.372 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:55.372 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:56:55.372 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
19:56:55.372 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
19:56:55.372 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:56:55.373 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
19:56:55.373 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
19:56:55.373 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:55.373 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:55.373 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:56:55.373 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
19:56:55.374 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
19:56:55.374 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:56:55.374 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
19:56:55.374 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
19:56:55.374 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:55.374 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:55.374 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:56:55.374 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
19:56:55.602 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:55.603 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:55.603 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:56:55.604 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:55.604 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:55.604 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
19:56:55.604 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
19:56:55.610 [grpc-default-executor-10] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:55.610 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:55.610 [grpc-default-executor-10] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:55.610 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:55.610 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:55.611 [grpc-default-executor-4] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:55.611 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:56:55.611 [grpc-default-executor-10] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:56:55.611 [grpc-default-executor-4] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:56:55.611 [grpc-default-executor-10] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:56:55.613 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
19:56:55.613 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
19:56:55.613 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:56:55.613 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:56:55.613 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:56:55.613 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:56:55.690 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=before
19:56:55.690 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:56:55.691 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, leader-change)
19:56:55.691 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:56:55.691 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:56:55.692 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:55.692 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:55.692 [grpc-default-executor-17] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:55.692 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:55.693 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:56:55.693 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:56:55.693 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:56:55.693 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:56:55.693 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:55.693 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:55.693 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, leader-change)
19:56:55.695 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=before
19:56:55.696 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:56:55.696 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:55.696 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:55.697 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:56:55.697 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:56:55.881 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:55.886 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:56:55.886 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:56:55.887 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:55.887 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
19:56:55.887 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
19:56:55.894 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:56:55.895 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:55.895 [grpc-default-executor-3] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:55.896 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
19:56:55.896 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: Vote request to node-1 failed
19:56:55.896 [grpc-default-executor-3] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
19:56:55.898 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=2) -> granted=true
19:56:55.898 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:56:55.898 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:56:55.898 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:56:55.898 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:56:55.907 [main] [node-1] DEBUG com.raftdb.client.RaftKVClient - Request to localhost:18001 failed: UNAVAILABLE: io exception
19:56:55.961 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=after
19:56:55.961 [main] [node-1] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
19:56:55.962 [main] [node-1] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
19:56:56.069 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=after
19:56:56.070 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
19:56:56.070 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after, leader-change)
19:56:56.070 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:56:56.070 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:56:56.071 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:56.071 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:56:56.072 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
19:56:56.072 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:56:56.072 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
19:56:56.072 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, leader-change)
19:56:56.072 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after, leader-change)
19:56:56.073 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=after
19:56:56.074 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=before
19:56:56.074 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Leader change retry test passed
19:56:56.075 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:56:56.075 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:56.075 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:56.075 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:56:56.075 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:56:56.075 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:56:56.076 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:56.076 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:56.076 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:56:56.076 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:56:56.184 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
19:56:56.184 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:56:56.185 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
19:56:56.185 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
19:56:56.185 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:56.185 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:56.185 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:56:56.185 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
19:56:56.186 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
19:56:56.186 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:56:56.186 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
19:56:56.186 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
19:56:56.186 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:56.186 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:56.186 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:56:56.186 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
19:56:56.187 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
19:56:56.187 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:56:56.187 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
19:56:56.187 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
19:56:56.187 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:56.187 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:56.187 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:56:56.187 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
19:56:56.390 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:56.392 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:56.393 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:56:56.393 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:56.393 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:56.393 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
19:56:56.393 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
19:56:56.400 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:56.400 [grpc-default-executor-10] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:56.400 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:56.400 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:56.400 [grpc-default-executor-3] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:56.401 [grpc-default-executor-10] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:56.402 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:56:56.402 [grpc-default-executor-10] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:56:56.402 [grpc-default-executor-3] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:56:56.402 [grpc-default-executor-10] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:56:56.403 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
19:56:56.403 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:56:56.403 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:56:56.403 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:56:56.403 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
19:56:56.403 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:56:57.021 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-0
19:56:57.021 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-3
19:56:57.021 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-1
19:56:57.021 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-2
19:56:57.021 [grpc-default-executor-17] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-4
19:56:57.023 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
19:56:57.023 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
19:56:57.023 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
19:56:57.023 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
19:56:57.023 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
19:56:57.023 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
19:56:57.023 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
19:56:57.023 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
19:56:57.023 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
19:56:57.023 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
19:56:57.081 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-4
19:56:57.081 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-2
19:56:57.081 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-0
19:56:57.081 [grpc-default-executor-17] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-1
19:56:57.081 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-3
19:56:57.083 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
19:56:57.083 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
19:56:57.083 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
19:56:57.083 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
19:56:57.083 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
19:56:57.083 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
19:56:57.083 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
19:56:57.083 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
19:56:57.083 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
19:56:57.083 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
19:56:57.192 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-4
19:56:57.192 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-1
19:56:57.192 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-3
19:56:57.192 [grpc-default-executor-17] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-0
19:56:57.192 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-2
19:56:57.193 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:56:57.193 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-4, value-4)
19:56:57.193 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:56:57.193 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-1, value-1)
19:56:57.193 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=1)
19:56:57.193 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:56:57.193 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-3, value-3)
19:56:57.193 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=1)
19:56:57.193 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=1)
19:56:57.193 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=1)
19:56:57.194 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:56:57.194 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-0, value-0)
19:56:57.194 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=1)
19:56:57.194 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=1)
19:56:57.194 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:56:57.194 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-2, value-2)
19:56:57.194 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=1)
19:56:57.194 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=1)
19:56:57.194 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=1)
19:56:57.194 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=1)
19:56:57.200 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
19:56:57.200 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.200 [grpc-default-executor-16] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 3 log entries
19:56:57.200 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
19:56:57.200 [grpc-default-executor-12] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.200 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 5
19:56:57.200 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
19:56:57.200 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 5
19:56:57.200 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 5
19:56:57.200 [grpc-default-executor-15] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 5
19:56:57.200 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.200 [grpc-default-executor-14] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 5
19:56:57.200 [grpc-default-executor-16] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 5
19:56:57.200 [grpc-default-executor-12] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 5
19:56:57.200 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 5
19:56:57.200 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 5
19:56:57.201 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=5) -> success=true
19:56:57.201 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:56:57.201 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 5
19:56:57.201 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=3) -> success=true
19:56:57.201 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=5) -> success=true
19:56:57.201 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=5) -> success=true
19:56:57.201 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
19:56:57.201 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-4, value-4)
19:56:57.201 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=3) -> success=true
19:56:57.202 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=5) -> success=true
19:56:57.202 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:56:57.202 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=2) -> success=true
19:56:57.202 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=4) -> success=true
19:56:57.202 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-3, value-3)
19:56:57.202 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=4) -> success=true
19:56:57.202 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-0, value-0)
19:56:57.202 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-2, value-2)
19:56:57.202 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=3) -> success=true
19:56:57.204 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-6
19:56:57.204 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-9
19:56:57.204 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-8
19:56:57.204 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-5
19:56:57.204 [grpc-default-executor-12] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-7
19:56:57.204 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:56:57.204 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-6, value-6)
19:56:57.204 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:56:57.204 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-9, value-9)
19:56:57.204 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:56:57.204 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-8, value-8)
19:56:57.205 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:56:57.205 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-5, value-5)
19:56:57.205 [grpc-default-executor-12] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:56:57.205 [grpc-default-executor-12] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-7, value-7)
19:56:57.205 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=6)
19:56:57.205 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=6)
19:56:57.205 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=6)
19:56:57.205 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=6)
19:56:57.205 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=6)
19:56:57.205 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=6)
19:56:57.205 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=6)
19:56:57.206 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=6)
19:56:57.206 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=6)
19:56:57.206 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=6)
19:56:57.206 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=6)
19:56:57.206 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=6)
19:56:57.207 [grpc-default-executor-10] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 5 log entries
19:56:57.207 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 5 log entries
19:56:57.207 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
19:56:57.207 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
19:56:57.207 [grpc-default-executor-15] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
19:56:57.207 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
19:56:57.207 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
19:56:57.207 [grpc-default-executor-16] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
19:56:57.207 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:56:57.207 [grpc-default-executor-14] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
19:56:57.207 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
19:56:57.207 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:56:57.207 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
19:56:57.207 [grpc-default-executor-11] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
19:56:57.207 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
19:56:57.207 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
19:56:57.207 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-4, value-4)
19:56:57.207 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-4, value-4)
19:56:57.208 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:56:57.208 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:56:57.208 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-3, value-3)
19:56:57.208 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-3, value-3)
19:56:57.208 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-0, value-0)
19:56:57.208 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-0, value-0)
19:56:57.208 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-2, value-2)
19:56:57.208 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-2, value-2)
19:56:57.208 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=5) -> success=true
19:56:57.208 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=5) -> success=true
19:56:57.208 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
19:56:57.208 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 10
19:56:57.208 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=5) -> success=true
19:56:57.208 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-6, value-6)
19:56:57.208 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=5) -> success=true
19:56:57.208 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=5) -> success=true
19:56:57.208 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-9, value-9)
19:56:57.208 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
19:56:57.208 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-8, value-8)
19:56:57.208 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=5) -> success=true
19:56:57.208 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=5) -> success=true
19:56:57.208 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-5, value-5)
19:56:57.209 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-7, value-7)
19:56:57.209 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=5) -> success=true
19:56:57.209 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=5) -> success=true
19:56:57.209 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=5) -> success=true
19:56:57.209 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=5) -> success=true
19:56:57.209 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=5) -> success=true
19:56:57.210 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-10
19:56:57.210 [grpc-default-executor-12] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-11
19:56:57.210 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-12
19:56:57.210 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-14
19:56:57.210 [grpc-default-executor-11] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-13
19:56:57.211 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:56:57.211 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
19:56:57.211 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
19:56:57.211 [grpc-default-executor-12] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:56:57.211 [grpc-default-executor-12] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
19:56:57.211 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=11)
19:56:57.211 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=11)
19:56:57.211 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:56:57.211 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
19:56:57.211 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=11)
19:56:57.211 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=11)
19:56:57.211 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:56:57.211 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-14, value-14)
19:56:57.211 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=11)
19:56:57.211 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=11)
19:56:57.211 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:56:57.211 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-13, value-13)
19:56:57.211 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=11)
19:56:57.211 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=11)
19:56:57.212 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=11)
19:56:57.212 [grpc-default-executor-17] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
19:56:57.212 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
19:56:57.212 [grpc-default-executor-17] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
19:56:57.212 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
19:56:57.212 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:56:57.212 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
19:56:57.212 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.212 [grpc-default-executor-10] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.212 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 13
19:56:57.212 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 13
19:56:57.212 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:56:57.212 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-6, value-6)
19:56:57.212 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-6, value-6)
19:56:57.212 [grpc-default-executor-17] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.212 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-9, value-9)
19:56:57.212 [grpc-default-executor-17] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 14
19:56:57.212 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-9, value-9)
19:56:57.212 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-8, value-8)
19:56:57.212 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-8, value-8)
19:56:57.212 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-5, value-5)
19:56:57.212 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-5, value-5)
19:56:57.212 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-7, value-7)
19:56:57.212 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-7, value-7)
19:56:57.213 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=2) -> success=true
19:56:57.213 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
19:56:57.213 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=3) -> success=true
19:56:57.213 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 12
19:56:57.213 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
19:56:57.213 [grpc-default-executor-10] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.213 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
19:56:57.213 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 15
19:56:57.213 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:56:57.213 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:56:57.213 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.213 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 14
19:56:57.213 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:56:57.213 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=4) -> success=true
19:56:57.213 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=3) -> success=true
19:56:57.213 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
19:56:57.213 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=13
19:56:57.213 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:56:57.213 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:56:57.213 [grpc-default-executor-17] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.213 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=2) -> success=true
19:56:57.213 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-14, value-14)
19:56:57.213 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:56:57.213 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 15
19:56:57.213 [grpc-default-executor-17] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 15
19:56:57.213 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=5) -> success=true
19:56:57.213 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
19:56:57.213 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
19:56:57.213 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=4) -> success=true
19:56:57.213 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-13, value-13)
19:56:57.213 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=14
19:56:57.214 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=5) -> success=true
19:56:57.214 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=15
19:56:57.214 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=5) -> success=true
19:56:57.214 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-15
19:56:57.214 [grpc-default-executor-17] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-16
19:56:57.214 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-17
19:56:57.214 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-18
19:56:57.215 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
19:56:57.215 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
19:56:57.215 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-19
19:56:57.215 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
19:56:57.215 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
19:56:57.215 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-16, value-16)
19:56:57.215 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=16)
19:56:57.215 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=16)
19:56:57.215 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
19:56:57.215 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-17, value-17)
19:56:57.215 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=16)
19:56:57.215 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
19:56:57.215 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-18, value-18)
19:56:57.215 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=16)
19:56:57.215 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=16)
19:56:57.215 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
19:56:57.215 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-19, value-19)
19:56:57.215 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=16)
19:56:57.215 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=16)
19:56:57.215 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=16)
19:56:57.215 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=16)
19:56:57.215 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.215 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
19:56:57.216 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
19:56:57.216 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
19:56:57.216 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 17
19:56:57.216 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
19:56:57.216 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:56:57.216 [grpc-default-executor-12] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.216 [grpc-default-executor-12] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 17
19:56:57.216 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.216 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:56:57.216 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 18
19:56:57.216 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:56:57.216 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:56:57.216 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-14, value-14)
19:56:57.216 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:56:57.216 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-13, value-13)
19:56:57.216 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:56:57.216 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-14, value-14)
19:56:57.216 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-13, value-13)
19:56:57.216 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.216 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 19
19:56:57.216 [grpc-default-executor-7] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
19:56:57.216 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=2) -> success=true
19:56:57.216 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=3) -> success=true
19:56:57.216 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:56:57.216 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
19:56:57.216 [grpc-default-executor-14] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.216 [grpc-default-executor-12] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:56:57.216 [grpc-default-executor-14] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 20
19:56:57.216 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 18
19:56:57.216 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
19:56:57.216 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=18
19:56:57.216 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=2) -> success=true
19:56:57.217 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 20
19:56:57.216 [grpc-default-executor-12] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 20
19:56:57.217 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
19:56:57.217 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 20
19:56:57.217 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
19:56:57.217 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
19:56:57.217 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=5) -> success=true
19:56:57.217 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=5) -> success=true
19:56:57.217 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
19:56:57.217 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=5) -> success=true
19:56:57.217 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
19:56:57.217 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=5) -> success=true
19:56:57.217 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=4) -> success=true
19:56:57.217 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 20
19:56:57.217 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=4) -> success=true
19:56:57.217 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 20
19:56:57.217 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
19:56:57.217 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
19:56:57.221 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-0
19:56:57.222 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-1
19:56:57.222 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-2
19:56:57.223 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-3
19:56:57.224 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-4
19:56:57.224 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-5
19:56:57.225 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-6
19:56:57.225 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-7
19:56:57.226 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-8
19:56:57.227 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-9
19:56:57.227 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-10
19:56:57.228 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-11
19:56:57.229 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-12
19:56:57.230 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-13
19:56:57.230 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-14
19:56:57.231 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-15
19:56:57.232 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-16
19:56:57.232 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-17
19:56:57.233 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-18
19:56:57.234 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-19
19:56:57.235 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Concurrent writes test passed with 20/20 successful writes
19:56:57.236 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:56:57.236 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:57.236 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:57.236 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:56:57.236 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:56:57.236 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:56:57.237 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:57.237 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:57.237 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:56:57.237 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:56:57.237 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:56:57.237 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:57.237 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:57.237 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:56:57.237 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:56:57.347 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
19:56:57.348 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:56:57.348 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
19:56:57.348 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
19:56:57.348 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:56:57.348 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:57.348 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:56:57.352 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
19:56:57.389 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:57.389 [election-node-3] [node-3] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: target/kv-client-test-data/node-3/meta.dat.tmp
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:213)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:244)
	at java.base/java.nio.file.spi.FileSystemProvider.newOutputStream(FileSystemProvider.java:426)
	at java.base/java.nio.file.Files.newOutputStream(Files.java:215)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:89)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:219)
	at com.raftdb.core.RaftState.persist(RaftState.java:85)
	at com.raftdb.core.RaftState.incrementTerm(RaftState.java:136)
	at com.raftdb.election.ElectionManager.startElection(ElectionManager.java:147)
	at com.raftdb.election.ElectionManager.onElectionTimeout(ElectionManager.java:139)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:545)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:309)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
19:56:57.398 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:57.398 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:56:57.398 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:56:57.462 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:57.463 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-2
19:56:57.463 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
19:56:57.557 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:57.558 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:56:57.558 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:56:57.558 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:57.558 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:56:57.558 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:56:57.558 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:56:57.558 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:56:57.662 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=single
19:56:57.663 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:56:57.663 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(single, node)
19:56:57.663 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:57.664 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(single, node)
19:56:57.665 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=single
19:56:57.665 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Single node client test passed
19:56:57.666 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:56:57.666 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:57.666 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:57.666 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:56:57.666 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:56:57.779 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:56:57.779 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:56:57.779 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:56:57.779 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:57.779 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:56:57.779 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:56:57.779 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:56:57.779 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:56:57.779 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:57.780 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:56:57.780 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:56:57.780 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:56:57.780 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:56:57.780 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:57.780 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:56:57.977 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:57.977 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:57.977 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:57.978 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:56:57.978 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:56:57.978 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:57.978 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:57.978 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:57.978 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:57.978 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:56:57.978 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:56:57.978 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:56:57.978 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:56:57.979 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:56:57.979 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:56:57.979 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:56:57.979 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:56:57.989 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:56:57.989 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key3, value3)
19:56:57.989 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:56:57.989 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:56:57.989 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:56:57.989 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:57.989 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:57.989 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:57.989 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:56:57.989 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:57.989 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:56:57.990 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
19:56:57.990 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:56:57.990 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(key3)
19:56:57.990 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:56:57.990 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:56:57.990 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:56:57.991 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:56:57.991 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:57.991 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:56:57.991 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:56:57.991 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:56:57.991 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:56:57.991 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:56:57.991 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
19:56:57.991 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
19:56:57.991 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:56:57.991 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
19:56:58.034 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:56:58.034 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:56:58.035 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
19:56:58.035 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
19:56:58.101 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:56:58.101 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:58.101 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:58.101 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:56:58.101 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:56:58.101 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:56:58.101 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:58.101 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:58.101 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:56:58.101 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:56:58.101 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:56:58.101 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:58.101 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:58.101 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:56:58.101 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:56:58.102 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:56:58.102 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:56:58.102 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:56:58.102 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:58.102 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:56:58.103 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:56:58.103 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:56:58.103 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:56:58.103 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:58.103 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:56:58.103 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:56:58.103 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:56:58.103 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:56:58.103 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:58.103 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:56:58.262 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:58.262 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:58.262 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:58.262 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:56:58.262 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:56:58.262 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:58.262 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:58.263 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:58.263 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:56:58.263 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:58.263 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:56:58.263 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:56:58.263 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:56:58.263 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:56:58.263 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:56:58.263 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:56:58.263 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:56:58.312 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:56:58.312 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-0, value-0)
19:56:58.313 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:56:58.313 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:56:58.313 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-1, value-1)
19:56:58.313 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=1)
19:56:58.313 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:58.313 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=1)
19:56:58.313 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:56:58.313 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-2, value-2)
19:56:58.313 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:58.313 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:56:58.313 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:56:58.313 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:56:58.313 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:56:58.313 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
19:56:58.313 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:58.313 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:56:58.313 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-3, value-3)
19:56:58.313 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:56:58.313 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=1)
19:56:58.313 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
19:56:58.313 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=2)
19:56:58.313 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=2)
19:56:58.313 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:56:58.313 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:56:58.313 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:56:58.313 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:56:58.313 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=3)
19:56:58.313 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 4
19:56:58.313 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:56:58.313 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
19:56:58.313 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-4, value-4)
19:56:58.313 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:56:58.313 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
19:56:58.313 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=2)
19:56:58.313 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 4
19:56:58.314 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:56:58.314 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
19:56:58.314 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 5
19:56:58.313 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=3)
19:56:58.314 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:56:58.314 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 5
19:56:58.314 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:56:58.313 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:56:58.314 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=5)
19:56:58.314 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:56:58.314 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:56:58.314 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
19:56:58.314 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 5
19:56:58.314 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 5
19:56:58.314 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 6
19:56:58.313 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:56:58.314 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
19:56:58.314 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:56:58.314 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:56:58.314 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-5, value-5)
19:56:58.314 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=4)
19:56:58.314 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
19:56:58.314 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
19:56:58.314 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:56:58.314 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 4
19:56:58.314 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:56:58.314 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-6, value-6)
19:56:58.314 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=4)
19:56:58.314 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
19:56:58.315 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 6
19:56:58.314 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
19:56:58.315 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
19:56:58.314 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
19:56:58.315 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:58.315 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:56:58.314 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:56:58.315 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:56:58.315 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:56:58.315 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:56:58.315 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-7, value-7)
19:56:58.315 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:58.315 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 6
19:56:58.315 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=7)
19:56:58.315 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:56:58.315 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:56:58.315 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:56:58.315 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:56:58.315 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=6)
19:56:58.315 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
19:56:58.315 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:56:58.315 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:56:58.315 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:56:58.315 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-8, value-8)
19:56:58.315 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
19:56:58.315 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 8
19:56:58.316 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=8)
19:56:58.316 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
19:56:58.316 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:56:58.316 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
19:56:58.315 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
19:56:58.316 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:56:58.316 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
19:56:58.316 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
19:56:58.316 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=7)
19:56:58.316 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 9
19:56:58.316 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
19:56:58.316 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:56:58.316 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
19:56:58.316 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
19:56:58.316 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
19:56:58.316 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:56:58.316 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
19:56:58.316 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-9, value-9)
19:56:58.316 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 9
19:56:58.316 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=7)
19:56:58.316 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
19:56:58.316 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
19:56:58.316 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 9
19:56:58.316 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:56:58.316 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
19:56:58.316 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
19:56:58.316 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 10
19:56:58.316 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 9
19:56:58.316 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=9)
19:56:58.316 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
19:56:58.317 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:56:58.316 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=9)
19:56:58.316 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:56:58.317 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
19:56:58.317 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:56:58.317 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:58.317 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
19:56:58.317 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:56:58.317 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:56:58.317 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:56:58.317 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 10
19:56:58.317 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
19:56:58.317 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
19:56:58.317 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
19:56:58.317 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
19:56:58.317 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:56:58.317 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
19:56:58.317 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=10)
19:56:58.317 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
19:56:58.317 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:56:58.317 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 11
19:56:58.317 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:56:58.317 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:56:58.317 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
19:56:58.317 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
19:56:58.318 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:56:58.317 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:56:58.318 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 12
19:56:58.318 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
19:56:58.318 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
19:56:58.317 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
19:56:58.318 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=12
19:56:58.317 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
19:56:58.318 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 12
19:56:58.318 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:56:58.318 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=11)
19:56:58.318 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:56:58.318 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=11)
19:56:58.318 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-13, value-13)
19:56:58.318 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:56:58.318 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:56:58.318 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:56:58.318 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
19:56:58.318 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 13
19:56:58.318 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=13)
19:56:58.318 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-14, value-14)
19:56:58.318 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=13)
19:56:58.318 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=12)
19:56:58.318 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=12)
19:56:58.318 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=12)
19:56:58.318 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
19:56:58.318 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:56:58.318 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:58.318 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=13
19:56:58.318 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
19:56:58.318 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=13
19:56:58.318 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
19:56:58.318 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
19:56:58.318 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
19:56:58.318 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:56:58.318 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
19:56:58.318 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:56:58.318 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 15
19:56:58.319 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
19:56:58.319 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:56:58.319 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=14)
19:56:58.319 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
19:56:58.319 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
19:56:58.319 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:56:58.319 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-16, value-16)
19:56:58.319 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 15
19:56:58.318 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:56:58.319 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
19:56:58.319 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
19:56:58.319 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=16
19:56:58.319 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
19:56:58.319 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
19:56:58.319 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
19:56:58.319 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=16)
19:56:58.318 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
19:56:58.319 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=14)
19:56:58.319 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:56:58.319 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 15
19:56:58.319 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
19:56:58.319 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=5)
19:56:58.319 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
19:56:58.319 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=15
19:56:58.319 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:56:58.319 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 18
19:56:58.319 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-17, value-17)
19:56:58.319 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:56:58.319 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:56:58.319 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=14)
19:56:58.319 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
19:56:58.319 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=16)
19:56:58.319 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-18, value-18)
19:56:58.319 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=16)
19:56:58.319 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 18
19:56:58.319 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
19:56:58.319 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
19:56:58.319 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:56:58.319 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:56:58.319 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=17)
19:56:58.319 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-19, value-19)
19:56:58.319 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:56:58.320 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 18
19:56:58.319 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
19:56:58.319 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=17)
19:56:58.320 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=18
19:56:58.319 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=5)
19:56:58.320 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:56:58.320 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=19)
19:56:58.319 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:56:58.320 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 18
19:56:58.319 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
19:56:58.320 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:56:58.320 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:56:58.320 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 19
19:56:58.320 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 19
19:56:58.320 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
19:56:58.320 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=16)
19:56:58.320 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=19
19:56:58.320 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:56:58.320 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 19
19:56:58.320 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:56:58.320 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=5)
19:56:58.320 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=18
19:56:58.320 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
19:56:58.320 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:56:58.320 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 18
19:56:58.320 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
19:56:58.320 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=19)
19:56:58.320 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
19:56:58.320 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=19
19:56:58.320 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:56:58.320 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
19:56:58.320 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
19:56:58.320 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
19:56:58.320 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
19:56:58.320 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
19:56:58.320 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
19:56:58.320 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
19:56:58.320 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 20
19:56:58.320 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 20
19:56:58.320 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 19
19:56:58.320 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=20)
19:56:58.320 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
19:56:58.320 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
19:56:58.320 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
19:56:58.321 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
19:56:58.320 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
19:56:58.321 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
19:56:58.321 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
19:56:58.321 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:56:58.321 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
19:56:58.321 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:56:58.321 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
19:56:58.321 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
19:56:58.368 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:56:58.368 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:56:58.368 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
19:56:58.368 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
19:56:58.368 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
19:56:58.368 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
19:56:58.368 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
19:56:58.368 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
19:56:58.427 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:56:58.427 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:58.428 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:58.428 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:56:58.428 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:56:58.428 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:56:58.428 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:58.428 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:58.428 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:56:58.428 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:56:58.428 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:56:58.428 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:58.428 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:58.428 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:56:58.428 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:56:58.430 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:56:58.430 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:56:58.430 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:56:58.430 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:58.430 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:56:58.430 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:56:58.430 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:56:58.430 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:56:58.430 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:58.430 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:56:58.430 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:56:58.430 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:56:58.430 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:56:58.430 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:58.430 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:56:58.600 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:58.600 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:58.601 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:58.601 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:58.601 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:58.601 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:58.600 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:58.601 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:58.601 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:56:58.602 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:56:58.602 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:56:58.602 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:56:58.602 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=false)
19:56:58.602 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:56:58.602 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:56:58.602 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=false)
19:56:58.601 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:58.602 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=false)
19:56:58.602 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:56:58.602 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:56:58.602 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
19:56:58.602 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
19:56:58.602 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=false)
19:56:58.602 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=false)
19:56:58.602 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
19:56:58.602 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
19:56:58.602 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=false)
19:56:58.764 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:58.765 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:56:58.765 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:58.765 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=2)
19:56:58.765 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=2)
19:56:58.765 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:58.765 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:58.765 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:58.765 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:58.765 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
19:56:58.765 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
19:56:58.765 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:56:58.765 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:56:58.765 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:56:58.765 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:56:58.765 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:56:58.765 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:56:58.851 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 2
19:56:58.851 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key2, value2)
19:56:58.851 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:56:58.851 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:56:58.851 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=2, entries=1)
19:56:58.852 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:58.852 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=2, entries=1)
19:56:58.852 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:56:58.852 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:58.852 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:58.852 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:56:58.852 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
19:56:58.869 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:56:58.869 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:56:58.870 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
19:56:58.870 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
19:56:58.959 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:56:58.959 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:58.959 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:58.959 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:56:58.960 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:56:58.960 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:56:58.960 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:58.960 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:58.960 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:56:58.960 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:56:58.960 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:56:58.960 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:58.960 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:58.960 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:56:58.960 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:56:58.962 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:56:58.962 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:56:58.962 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:56:58.962 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:58.962 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:56:58.962 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:56:58.962 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:56:58.962 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:56:58.962 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:58.962 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:56:58.962 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:56:58.962 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:56:58.962 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:56:58.962 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:58.962 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:56:59.136 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:59.136 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:59.136 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:59.136 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
19:56:59.136 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
19:56:59.136 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:59.137 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:59.137 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:59.137 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:59.137 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:56:59.137 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:56:59.137 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:56:59.137 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:56:59.137 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:56:59.137 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:56:59.137 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:56:59.137 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:56:59.171 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:56:59.171 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
19:56:59.171 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:56:59.171 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:56:59.171 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:56:59.171 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:56:59.171 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:59.171 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:56:59.171 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:59.171 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:56:59.171 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:59.172 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:59.172 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:56:59.191 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:56:59.191 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:56:59.191 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:56:59.191 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:56:59.278 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - Killing leader: node-2
19:56:59.278 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:56:59.278 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:59.278 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:59.278 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:56:59.278 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:56:59.425 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:59.426 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:56:59.426 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:59.426 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=2)
19:56:59.426 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:59.426 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:59.426 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
19:56:59.426 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:56:59.426 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:56:59.426 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:56:59.426 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:56:59.426 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:56:59.427 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
19:56:59.481 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - New leader: node-1
19:56:59.482 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
19:56:59.482 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
19:56:59.482 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:56:59.482 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:56:59.482 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=2, entries=1)
19:56:59.482 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:56:59.482 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:56:59.482 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:56:59.482 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:56:59.532 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:56:59.532 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:56:59.532 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:56:59.582 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:56:59.586 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:56:59.586 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:59.586 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:59.587 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:56:59.587 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:56:59.587 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:56:59.587 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:59.587 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:59.587 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:56:59.587 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:56:59.589 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:56:59.589 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:56:59.589 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:56:59.589 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:59.589 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:56:59.589 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:56:59.589 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:56:59.589 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:56:59.589 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:59.589 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:56:59.589 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:56:59.589 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:56:59.589 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:56:59.589 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:59.589 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:56:59.763 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:56:59.764 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:56:59.764 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:56:59.764 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:56:59.764 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:59.764 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:56:59.764 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:59.764 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:56:59.764 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:56:59.764 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:59.764 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:56:59.765 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:56:59.765 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:56:59.765 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:56:59.765 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:56:59.765 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:56:59.765 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:56:59.796 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:56:59.797 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
19:56:59.797 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:56:59.797 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:56:59.797 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:59.797 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:56:59.797 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:59.797 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:56:59.797 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:56:59.797 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:56:59.797 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:59.797 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:56:59.797 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:56:59.797 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:56:59.797 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
19:56:59.797 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:56:59.797 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:56:59.797 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:59.797 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:56:59.797 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:56:59.797 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:56:59.797 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:56:59.797 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:56:59.797 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:56:59.798 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:56:59.798 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:56:59.798 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:56:59.798 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:56:59.798 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:56:59.798 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:56:59.798 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
19:56:59.798 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:56:59.798 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
19:56:59.798 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:59.798 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:56:59.798 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:56:59.798 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:56:59.798 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:56:59.798 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:56:59.798 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:56:59.798 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:56:59.798 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:56:59.798 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:56:59.798 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:56:59.798 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:56:59.798 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:56:59.798 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:56:59.798 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
19:56:59.798 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
19:56:59.798 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
19:56:59.798 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:59.798 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:56:59.798 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:56:59.798 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:56:59.798 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:56:59.798 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:56:59.798 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:56:59.798 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
19:56:59.798 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:56:59.798 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:56:59.798 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:56:59.798 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:56:59.798 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:56:59.798 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:56:59.798 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
19:56:59.798 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
19:56:59.799 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
19:56:59.799 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:59.799 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:56:59.799 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:56:59.799 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:56:59.799 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:56:59.799 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:56:59.799 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
19:56:59.799 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:56:59.799 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:56:59.799 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
19:56:59.799 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:56:59.799 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:56:59.799 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:56:59.799 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
19:56:59.799 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
19:56:59.799 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
19:56:59.799 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:59.799 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:56:59.799 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:56:59.799 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:56:59.799 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:56:59.799 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
19:56:59.799 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:56:59.799 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:56:59.799 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:56:59.799 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:56:59.799 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:56:59.799 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:56:59.799 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:56:59.799 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
19:56:59.799 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
19:56:59.799 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
19:56:59.799 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:59.799 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:56:59.799 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:56:59.799 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:56:59.799 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:56:59.799 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:56:59.799 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
19:56:59.799 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
19:56:59.799 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:56:59.799 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:56:59.799 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:56:59.800 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:56:59.799 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:56:59.800 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:56:59.800 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
19:56:59.800 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
19:56:59.800 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
19:56:59.800 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:59.800 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:56:59.800 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:56:59.800 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:56:59.800 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:56:59.800 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:56:59.800 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
19:56:59.800 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
19:56:59.800 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:56:59.800 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:56:59.800 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:56:59.800 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:56:59.800 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:56:59.800 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:56:59.800 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
19:56:59.800 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
19:56:59.800 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
19:56:59.800 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:59.800 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:56:59.800 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:56:59.800 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:56:59.800 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:56:59.800 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:56:59.800 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
19:56:59.800 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:56:59.800 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:56:59.800 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
19:56:59.800 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:56:59.800 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:56:59.800 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:56:59.800 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
19:56:59.800 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
19:56:59.800 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
19:56:59.800 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:56:59.800 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:56:59.801 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:56:59.801 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:56:59.801 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:56:59.801 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:56:59.801 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
19:56:59.801 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:56:59.801 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
19:56:59.801 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:56:59.801 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:56:59.801 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:56:59.819 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:56:59.819 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:56:59.819 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:56:59.819 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:56:59.905 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:56:59.905 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:59.905 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:59.905 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:56:59.905 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:56:59.905 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:56:59.905 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:59.905 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:59.905 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:56:59.905 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:56:59.905 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:56:59.905 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:56:59.906 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:56:59.906 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:56:59.906 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:56:59.907 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:56:59.907 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:56:59.907 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:56:59.907 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:59.907 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:56:59.907 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:56:59.907 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:56:59.907 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:56:59.907 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:59.907 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:56:59.907 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:56:59.907 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:56:59.907 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:56:59.907 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:56:59.907 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:00.115 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:00.115 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:00.115 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:00.116 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:57:00.116 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:57:00.116 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:00.116 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:00.116 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.116 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.116 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:57:00.116 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:57:00.116 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:57:00.116 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:57:00.116 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:00.116 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:00.116 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:00.116 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:00.220 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Leader: node-3
19:57:00.221 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:00.221 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
19:57:00.221 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:57:00.221 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:57:00.221 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:57:00.221 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:57:00.221 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:57:00.221 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:57:00.221 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:57:00.221 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:57:00.221 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:00.221 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:00.221 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:00.221 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:00.221 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:57:00.221 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:57:00.222 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:00.222 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:00.222 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:57:00.222 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - PUT committed
19:57:00.272 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:00.272 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:00.272 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:57:00.272 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:57:00.324 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Data replicated to all nodes
19:57:00.324 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:00.324 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.325 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:00.325 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:00.325 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:00.325 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:00.325 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.325 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:00.325 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:00.325 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:00.325 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:00.325 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.325 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:00.325 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:00.325 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:00.327 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:00.327 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:00.327 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:00.327 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:00.327 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:00.327 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:00.327 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:00.327 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:00.327 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:00.327 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:00.327 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:00.327 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:00.327 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:00.327 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:00.327 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:00.588 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:00.588 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:00.589 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:00.589 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
19:57:00.589 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:00.589 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
19:57:00.590 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.590 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:00.590 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:00.590 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.590 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:57:00.590 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:00.590 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:00.590 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:57:00.590 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:00.590 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:00.590 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:00.641 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:00.641 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.641 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:00.641 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:00.641 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:00.641 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:00.641 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.641 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:00.641 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:00.641 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:00.641 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:00.641 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.641 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:00.641 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:00.641 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:00.642 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:00.642 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:00.642 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:00.642 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:00.642 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:00.642 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:00.642 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:00.642 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:00.642 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:00.642 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:00.642 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:00.642 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:00.642 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:00.642 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:00.642 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:00.642 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
19:57:00.642 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
19:57:00.642 [main] [node-4] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-4
19:57:00.642 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:00.642 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 initialized as FOLLOWER
19:57:00.642 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
19:57:00.642 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
19:57:00.642 [main] [node-5] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-5
19:57:00.642 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:00.642 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 initialized as FOLLOWER
19:57:00.805 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:00.805 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:00.805 [election-node-4] [node-4] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
19:57:00.806 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 VoteRequest(term=1)
19:57:00.806 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 VoteRequest(term=1)
19:57:00.806 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 VoteRequest(term=1)
19:57:00.806 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:00.806 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 VoteRequest(term=1)
19:57:00.806 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.806 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:00.806 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
19:57:00.806 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.806 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:00.806 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
19:57:00.806 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.806 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:00.806 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
19:57:00.806 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:00.806 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-2 VoteResponse(granted=true)
19:57:00.806 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-3 VoteResponse(granted=true)
19:57:00.806 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
19:57:00.806 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-1 VoteResponse(granted=true)
19:57:00.806 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
19:57:00.806 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
19:57:00.806 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-5 VoteResponse(granted=true)
19:57:00.806 [] [node-4] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:00.806 [] [node-4] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:00.806 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:00.848 [main] [node-4] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:00.849 [main] [node-4] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(stable-key, initial)
19:57:00.849 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:57:00.849 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:57:00.849 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 AppendEntries(term=1, entries=1)
19:57:00.849 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:57:00.849 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 AppendEntries(term=1, entries=1)
19:57:00.849 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:00.849 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
19:57:00.849 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 AppendEntries(term=1, entries=1)
19:57:00.849 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:00.849 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:57:00.849 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 AppendEntries(term=1, entries=1)
19:57:00.849 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:57:00.849 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:00.849 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:57:00.849 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:00.849 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:00.849 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:00.849 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:00.849 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
19:57:00.849 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:57:00.858 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:00.858 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:00.858 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:00.858 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:00.859 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:57:00.859 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:57:00.859 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:57:00.859 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:57:00.955 [main] [node-4] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:57:00.955 [main] [node-4] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-0, value-0)
19:57:00.956 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:00.956 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:57:00.956 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 AppendEntries(term=1, entries=1)
19:57:00.956 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:57:00.956 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 AppendEntries(term=1, entries=1)
19:57:00.956 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
19:57:00.956 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:00.956 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:00.956 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:57:00.956 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 AppendEntries(term=1, entries=1)
19:57:00.956 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 AppendEntries(term=1, entries=1)
19:57:00.956 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:57:00.956 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:00.956 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:00.956 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
19:57:00.956 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:00.956 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:00.956 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:57:00.956 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:57:00.956 [main] [node-4] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:57:00.956 [main] [node-4] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-1, value-1)
19:57:00.957 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:57:00.957 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:57:00.957 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
19:57:00.957 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 AppendEntries(term=1, entries=1)
19:57:00.957 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
19:57:00.957 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 AppendEntries(term=1, entries=1)
19:57:00.957 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
19:57:00.957 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 AppendEntries(term=1, entries=1)
19:57:00.957 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:00.957 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
19:57:00.957 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:00.957 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 AppendEntries(term=1, entries=1)
19:57:00.957 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:00.957 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 AppendEntries(term=1, entries=1)
19:57:00.957 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:57:00.957 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:00.957 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 AppendEntries(term=1, entries=1)
19:57:00.957 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:57:00.957 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:00.957 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:00.957 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:00.957 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:57:00.957 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=3)
19:57:00.957 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:00.957 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:57:00.957 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=3)
19:57:00.957 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 AppendEntries(term=1, entries=1)
19:57:00.957 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:00.957 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:57:00.957 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:57:00.957 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:57:00.957 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:57:00.957 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:57:00.957 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:00.957 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 AppendEntries(term=1, entries=1)
19:57:00.957 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:00.957 [main] [node-4] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:57:00.957 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=3
19:57:00.957 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:00.957 [main] [node-4] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-2, value-2)
19:57:00.957 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:57:00.957 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
19:57:00.957 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
19:57:00.957 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 AppendEntries(term=1, entries=1)
19:57:00.957 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
19:57:00.958 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 AppendEntries(term=1, entries=1)
19:57:00.958 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:57:00.958 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 AppendEntries(term=1, entries=1)
19:57:00.958 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:57:00.958 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:00.958 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:57:00.958 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:00.958 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
19:57:00.958 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:57:00.958 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=4)
19:57:00.958 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:57:00.958 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:57:00.958 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:00.958 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
19:57:00.958 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:57:00.958 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:57:00.958 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 AppendEntries(term=1, entries=1)
19:57:00.958 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:57:00.958 [main] [node-4] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:57:00.958 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:57:00.958 [main] [node-4] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-3, value-3)
19:57:00.958 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:00.958 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=4
19:57:00.958 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:57:00.958 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
19:57:00.958 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
19:57:00.958 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
19:57:00.958 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 AppendEntries(term=1, entries=1)
19:57:00.958 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 AppendEntries(term=1, entries=1)
19:57:00.958 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=5)
19:57:00.958 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 AppendEntries(term=1, entries=1)
19:57:00.958 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:57:00.958 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 AppendEntries(term=1, entries=1)
19:57:00.958 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:57:00.958 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:57:00.958 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:57:00.958 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:57:00.958 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:57:00.958 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
19:57:00.958 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:57:00.958 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:57:00.958 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:57:00.958 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:57:00.958 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:57:00.958 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:57:00.958 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
19:57:00.958 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:57:00.958 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=5
19:57:00.959 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:57:00.959 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:57:00.959 [main] [node-4] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:57:00.959 [main] [node-4] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-4, value-4)
19:57:00.959 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
19:57:00.959 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
19:57:00.959 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 AppendEntries(term=1, entries=1)
19:57:00.959 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
19:57:00.959 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 AppendEntries(term=1, entries=1)
19:57:00.959 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:57:00.959 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=6)
19:57:00.959 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:57:00.959 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:57:00.959 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
19:57:00.959 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:57:00.959 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 AppendEntries(term=1, entries=1)
19:57:00.959 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 AppendEntries(term=1, entries=1)
19:57:00.959 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:57:00.959 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:57:00.959 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:57:00.959 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:57:00.959 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:57:00.959 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:57:00.959 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:57:00.959 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:57:00.959 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=6
19:57:00.959 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:57:00.959 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
19:57:00.959 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:57:00.959 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:57:01.012 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:57:01.012 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:57:01.012 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:57:01.012 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:57:01.012 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:57:01.012 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:57:01.013 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:57:01.013 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:57:01.066 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:01.066 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:01.066 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:01.066 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:01.066 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:01.066 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:01.066 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:01.066 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:01.066 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:01.066 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:01.066 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:01.066 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:01.066 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:01.066 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:01.066 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:01.066 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
19:57:01.066 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:01.066 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:01.066 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
19:57:01.066 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
19:57:01.066 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
19:57:01.066 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:01.066 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:01.066 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
19:57:01.066 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
19:57:01.071 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:01.071 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:01.071 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:01.072 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:57:01.072 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:57:01.072 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:01.072 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:01.072 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:01.316 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:01.318 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:01.319 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:01.319 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:01.319 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:57:01.319 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:01.319 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:01.319 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:01.491 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:01.491 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test, data)
19:57:01.491 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:01.492 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test, data)
19:57:01.493 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Data files created at target/test-data/node-1
19:57:01.494 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:01.494 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:01.494 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:01.494 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:01.495 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:01.500 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:01.500 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:01.500 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:01.500 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:57:01.500 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:57:01.500 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:01.501 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:01.501 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:01.501 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:01.501 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:01.501 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:01.501 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
19:57:01.501 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
19:57:01.501 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:01.501 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:01.501 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:01.501 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:01.501 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:01.501 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:01.502 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
19:57:01.502 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
19:57:01.502 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:01.502 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:01.502 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:01.690 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:01.691 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:01.692 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:01.692 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:01.692 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:01.692 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:57:01.692 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:57:01.692 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:01.692 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:01.692 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:01.692 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:01.692 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:01.692 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:01.692 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:01.693 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:01.693 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:01.693 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:57:01.693 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:01.693 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:01.693 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:57:01.693 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:01.693 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:01.693 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:01.711 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Leader: node-1
19:57:01.711 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:01.711 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
19:57:01.711 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:57:01.711 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:57:01.711 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:01.711 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:01.712 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:01.712 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:01.713 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:01.713 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:01.713 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:57:01.713 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:57:01.713 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:01.713 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:01.713 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:57:01.713 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:57:01.713 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key2, value2)
19:57:01.713 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:57:01.713 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:57:01.713 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:01.713 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:01.713 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:01.713 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:01.713 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:01.714 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:01.714 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:01.714 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:01.714 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:57:01.714 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:01.714 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:57:01.714 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:57:01.714 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:57:01.714 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
19:57:01.714 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:57:01.714 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key3, value3)
19:57:01.714 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
19:57:01.714 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
19:57:01.714 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:01.714 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:01.714 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:01.714 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:01.714 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:01.714 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:01.714 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:01.714 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:01.714 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
19:57:01.714 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:57:01.714 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:57:01.714 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:57:01.714 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
19:57:01.714 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:57:01.714 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
19:57:01.748 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:01.748 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:01.748 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
19:57:01.748 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
19:57:01.820 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Stopping all nodes...
19:57:01.821 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:01.821 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:01.821 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:01.821 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:01.821 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:01.821 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:01.821 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:01.821 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:01.821 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:01.821 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:01.821 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:01.821 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:01.821 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:01.821 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:01.821 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:01.821 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting all nodes...
19:57:01.821 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:01.821 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:01.821 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:01.822 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
19:57:01.822 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:57:01.822 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:57:01.823 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
19:57:01.823 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
19:57:01.823 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
19:57:01.823 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
19:57:01.823 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
19:57:01.823 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:01.823 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:01.823 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:01.823 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:01.823 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:01.823 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
19:57:01.823 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
19:57:01.823 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
19:57:01.823 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
19:57:01.823 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
19:57:01.823 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
19:57:01.823 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
19:57:01.823 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
19:57:01.823 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:01.823 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:01.824 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:01.824 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:01.824 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:01.824 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
19:57:01.824 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
19:57:01.824 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
19:57:01.824 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
19:57:01.824 [main] [node-3] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
19:57:01.824 [main] [node-3] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
19:57:01.824 [main] [node-3] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
19:57:01.824 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
19:57:01.824 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:01.824 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:01.979 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:01.983 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:57:01.985 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:57:01.985 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:57:01.985 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:01.985 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=2)
19:57:01.985 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=2)
19:57:01.986 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:57:01.986 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:01.986 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:01.986 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:57:01.986 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:01.987 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:01.987 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:57:01.987 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
19:57:01.987 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:57:01.987 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:01.987 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:57:01.987 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:57:01.987 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:01.987 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:57:01.987 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
19:57:01.988 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:57:02.033 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - New leader after restart: node-1
19:57:02.034 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - All nodes recovered successfully
19:57:02.034 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:02.034 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:02.035 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:02.035 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:02.035 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:02.035 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:02.035 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:02.035 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:02.035 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:02.035 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:02.035 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:02.035 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:02.035 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:02.035 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:02.035 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:02.041 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:02.041 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:02.041 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:02.042 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:57:02.042 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:57:02.042 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:02.042 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:02.042 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:02.042 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:02.042 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:02.042 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:02.043 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
19:57:02.043 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
19:57:02.043 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:02.043 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:02.043 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:02.043 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:02.043 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:02.043 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:02.043 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
19:57:02.043 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
19:57:02.043 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:02.043 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:02.043 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:02.210 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:02.210 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:02.213 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:02.214 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:02.217 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:57:02.217 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:02.217 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:02.217 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:02.217 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:02.218 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:02.218 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:57:02.218 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:57:02.218 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:57:02.218 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:57:02.218 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:57:02.218 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:57:02.218 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=false)
19:57:02.218 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=false)
19:57:02.220 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:02.220 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:02.220 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:02.220 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:57:02.220 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=false)
19:57:02.220 [] [node-2] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: target/test-data/node-2/meta.dat.tmp -> target/test-data/node-2/meta.dat
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixFileSystem.move(UnixFileSystem.java:823)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:289)
	at java.base/java.nio.file.Files.move(Files.java:1319)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:98)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:219)
	at com.raftdb.core.RaftState.persist(RaftState.java:85)
	at com.raftdb.core.RaftState.tryVoteFor(RaftState.java:170)
	at com.raftdb.election.ElectionManager.handleVoteRequest(ElectionManager.java:282)
	at com.raftdb.core.RaftNode.handleVoteRequest(RaftNode.java:672)
	at com.raftdb.rpc.LocalTransport.lambda$sendVoteRequest$0(LocalTransport.java:65)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1789)
	at java.base/java.util.concurrent.ThreadPerTaskExecutor$TaskRunner.run(ThreadPerTaskExecutor.java:291)
	at java.base/java.lang.VirtualThread.run(VirtualThread.java:456)
19:57:02.221 [] [node-2] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: java.nio.file.NoSuchFileException: target/test-data/node-2/meta.dat.tmp -> target/test-data/node-2/meta.dat
19:57:02.374 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:02.378 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
19:57:02.378 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:57:02.378 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:02.378 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=2)
19:57:02.378 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=2)
19:57:02.379 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:57:02.379 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:02.379 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:02.379 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:57:02.379 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:02.379 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:02.380 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:57:02.380 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
19:57:02.380 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:57:02.380 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:02.380 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:57:02.380 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:57:02.380 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:02.380 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:57:02.380 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
19:57:02.380 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:57:02.465 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 2
19:57:02.465 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, restart)
19:57:02.465 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:57:02.465 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:57:02.465 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=2, entries=1)
19:57:02.465 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=2, entries=1)
19:57:02.465 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:02.465 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:02.465 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:57:02.465 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:02.465 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:02.465 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:02.465 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:57:02.466 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
19:57:02.483 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:02.483 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:02.483 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
19:57:02.483 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
19:57:02.572 [main] [node-2] INFO  c.raftdb.integration.PersistenceTest - Restarting follower: node-1
19:57:02.572 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:02.572 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:02.572 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:02.572 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:02.572 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:02.677 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
19:57:02.677 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during, downtime)
19:57:02.677 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:02.677 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:57:02.677 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=2, entries=1)
19:57:02.677 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:02.677 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:02.677 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:57:02.677 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:02.677 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
19:57:02.678 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:02.678 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:02.678 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:02.678 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=2, votedFor=node-2
19:57:02.678 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:57:02.678 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:57:02.678 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
19:57:02.678 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
19:57:02.678 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 1 to recover state machine
19:57:02.678 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
19:57:02.678 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=2, votedFor=node-2, lastLogIndex=1
19:57:02.678 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:02.679 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:02.681 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:02.681 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=2, entries=1)
19:57:02.681 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:02.681 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
19:57:02.681 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:02.681 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:02.681 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:02.681 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:57:02.681 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
19:57:02.780 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Follower node-1 caught up after restart
19:57:02.780 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:02.780 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:02.780 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:02.780 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:02.780 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:02.780 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:02.780 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:02.780 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:02.780 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:02.780 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:02.780 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:02.780 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:02.780 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:02.780 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:02.780 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:02.783 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:02.784 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:02.784 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:02.784 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:57:02.784 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:57:02.784 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:02.784 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:02.784 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:03.059 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:03.064 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:03.065 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:03.065 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:03.065 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:57:03.065 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:03.065 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:03.065 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:03.094 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:03.094 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:03.094 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:03.095 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:03.095 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:03.095 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:03.095 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:03.095 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:03.095 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
19:57:03.095 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:57:03.096 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:57:03.096 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=0
19:57:03.096 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:03.096 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:03.096 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Term persisted: 1 -> 1
19:57:03.096 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:03.096 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:03.096 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:03.096 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:03.096 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:03.102 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:03.102 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:03.102 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:03.102 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:57:03.102 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:57:03.102 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:03.102 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:03.103 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:03.313 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:03.318 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:03.319 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:03.319 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:03.320 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:57:03.320 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:03.320 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:03.320 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:03.429 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:03.429 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
19:57:03.429 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:03.430 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:57:03.430 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:57:03.430 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
19:57:03.430 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:03.431 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:57:03.431 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:57:03.431 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
19:57:03.431 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:57:03.431 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:57:03.431 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:57:03.431 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
19:57:03.431 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:57:03.432 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:57:03.432 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:57:03.432 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
19:57:03.432 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:57:03.432 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:57:03.432 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:57:03.432 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
19:57:03.432 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:57:03.432 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:57:03.433 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:57:03.433 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
19:57:03.433 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:57:03.433 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:57:03.433 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:57:03.433 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
19:57:03.433 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:57:03.433 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:57:03.433 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:57:03.433 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
19:57:03.433 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:57:03.433 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:57:03.433 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:57:03.433 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
19:57:03.433 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:57:03.434 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:57:03.434 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 10, term 1
19:57:03.434 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
19:57:03.436 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=10, lastTerm=1, size=184 bytes
19:57:03.436 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 10, 0 entries remaining
19:57:03.437 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
19:57:03.437 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 0 log entries remaining
19:57:03.437 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Snapshot test passed
19:57:03.437 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:03.437 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:03.438 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:03.438 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:03.438 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:03.441 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:03.441 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:03.441 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:03.442 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:57:03.442 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:57:03.442 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:03.442 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:03.442 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:03.601 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:03.602 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:03.602 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:03.602 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:03.602 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:57:03.602 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:03.602 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:03.602 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:03.649 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:03.649 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
19:57:03.649 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:03.649 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:57:03.650 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:57:03.650 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
19:57:03.650 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:03.650 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:57:03.650 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:57:03.650 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
19:57:03.650 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:57:03.650 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:57:03.650 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:57:03.650 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
19:57:03.650 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:57:03.650 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:57:03.650 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:57:03.650 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
19:57:03.650 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:57:03.650 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:57:03.650 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:57:03.650 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
19:57:03.650 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:57:03.650 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:57:03.650 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:57:03.650 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
19:57:03.650 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:57:03.650 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:57:03.650 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:57:03.650 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
19:57:03.650 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:57:03.650 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:57:03.650 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:57:03.650 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
19:57:03.650 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:57:03.651 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:57:03.651 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:57:03.651 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
19:57:03.651 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:57:03.651 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:57:03.651 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 9, term 1
19:57:03.651 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
19:57:03.651 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=9, lastTerm=1, size=184 bytes
19:57:03.651 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 9, 1 entries remaining
19:57:03.651 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 1 entries
19:57:03.651 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 1 log entries remaining
19:57:03.652 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:57:03.652 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
19:57:03.652 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:57:03.652 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
19:57:03.652 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:57:03.652 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
19:57:03.652 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
19:57:03.652 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
19:57:03.652 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:57:03.652 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
19:57:03.652 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
19:57:03.652 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
19:57:03.652 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:57:03.652 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
19:57:03.652 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:57:03.652 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
19:57:03.652 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:57:03.652 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
19:57:03.652 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
19:57:03.652 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
19:57:03.652 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:03.652 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:03.652 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:03.652 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:03.652 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:03.652 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:03.652 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:03.652 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:03.652 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
19:57:03.652 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:57:03.652 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=9, lastTerm=1
19:57:03.652 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:57:03.653 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 184 bytes
19:57:03.653 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 10 entries
19:57:03.653 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=9, term=1
19:57:03.653 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=9, term=1
19:57:03.653 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 6 log entries from disk
19:57:03.653 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 6 log entries, lastIndex=15
19:57:03.653 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 10 to 15 to recover state machine
19:57:03.653 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=15
19:57:03.653 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=15
19:57:03.653 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:03.653 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:03.917 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:03.918 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:57:03.918 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:57:03.918 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:57:03.918 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:57:03.918 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:57:03.918 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:57:03.918 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:03.967 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Recovery from snapshot test passed
19:57:03.967 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:03.967 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:03.967 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:03.967 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:03.967 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:03.969 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:03.969 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:03.969 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:03.969 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:57:03.969 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:57:03.969 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:03.969 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:03.969 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:03.969 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:03.969 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:03.969 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:03.969 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
19:57:03.969 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
19:57:03.970 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:03.970 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:03.970 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:03.970 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:03.970 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:03.970 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:03.970 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
19:57:03.970 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
19:57:03.970 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:03.970 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:03.970 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:04.194 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:04.195 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:04.196 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:04.196 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:04.196 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:04.196 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:57:04.196 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:57:04.197 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:04.197 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:04.197 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:04.197 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:04.197 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:04.197 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:04.197 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:04.197 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:04.197 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:57:04.197 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:04.197 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:04.197 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:04.197 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:04.197 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:04.197 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:04.197 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:57:04.279 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:04.279 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
19:57:04.279 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:57:04.279 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:57:04.279 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:04.279 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.279 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.279 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.279 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:04.279 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:04.279 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:57:04.279 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:57:04.279 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:04.279 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:04.279 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:57:04.280 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:57:04.280 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
19:57:04.280 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:57:04.280 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:57:04.280 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.280 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:04.280 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.280 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:04.280 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.280 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:04.280 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:04.280 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:04.280 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:57:04.280 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:04.280 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:57:04.280 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:57:04.280 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:57:04.280 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:57:04.280 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:57:04.280 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
19:57:04.280 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
19:57:04.280 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
19:57:04.280 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:04.280 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.281 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.281 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:04.281 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:04.281 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.281 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:04.281 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:04.281 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:57:04.281 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:57:04.281 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:57:04.281 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:57:04.281 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:57:04.281 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:57:04.281 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:57:04.281 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:57:04.281 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
19:57:04.281 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
19:57:04.281 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
19:57:04.281 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:04.281 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.281 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.281 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:57:04.281 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:04.281 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
19:57:04.281 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:57:04.281 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:57:04.281 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:57:04.281 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.281 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:57:04.281 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:57:04.281 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
19:57:04.281 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:04.281 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
19:57:04.281 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:57:04.282 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
19:57:04.282 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
19:57:04.282 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:04.282 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.282 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.282 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:57:04.282 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:57:04.282 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
19:57:04.282 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:57:04.282 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.282 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:57:04.282 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:57:04.282 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:57:04.282 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:57:04.282 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:57:04.282 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:57:04.282 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:57:04.282 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
19:57:04.282 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
19:57:04.282 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
19:57:04.282 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:04.282 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.282 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.282 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:57:04.282 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.282 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:57:04.282 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:57:04.282 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:57:04.282 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:57:04.282 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:57:04.282 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
19:57:04.282 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:57:04.282 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:57:04.282 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:57:04.282 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:57:04.282 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:57:04.282 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
19:57:04.282 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
19:57:04.282 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
19:57:04.282 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:04.282 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.282 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.282 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:57:04.282 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.282 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:57:04.282 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:57:04.282 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:57:04.282 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
19:57:04.282 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
19:57:04.282 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:57:04.282 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:57:04.282 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:57:04.282 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:57:04.282 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:57:04.283 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:57:04.283 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
19:57:04.283 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
19:57:04.283 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
19:57:04.283 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:04.283 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.283 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.283 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:57:04.283 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:57:04.283 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
19:57:04.283 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:57:04.283 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.283 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:57:04.283 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:57:04.283 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:57:04.283 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
19:57:04.283 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:57:04.283 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:57:04.283 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:57:04.283 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
19:57:04.283 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
19:57:04.283 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
19:57:04.283 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:04.283 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.283 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.283 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:57:04.283 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:57:04.283 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.283 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
19:57:04.283 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:57:04.283 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:57:04.283 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:57:04.283 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:57:04.283 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
19:57:04.283 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:57:04.283 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:57:04.283 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:57:04.283 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
19:57:04.283 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
19:57:04.283 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
19:57:04.283 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:04.283 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.283 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.283 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:57:04.283 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:57:04.283 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.283 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:57:04.283 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
19:57:04.283 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:57:04.283 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:57:04.283 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
19:57:04.283 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:57:04.283 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:57:04.283 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:57:04.298 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:57:04.298 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:57:04.298 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:57:04.298 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:57:04.389 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:04.389 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:04.389 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:04.389 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:04.389 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:04.493 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:57:04.493 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
19:57:04.493 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=11)
19:57:04.493 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
19:57:04.493 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.493 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.493 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
19:57:04.493 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
19:57:04.493 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:57:04.493 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
19:57:04.493 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:57:04.493 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
19:57:04.493 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
19:57:04.493 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=12)
19:57:04.493 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.493 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.493 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
19:57:04.493 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:57:04.493 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
19:57:04.493 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
19:57:04.493 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
19:57:04.493 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
19:57:04.494 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:57:04.494 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
19:57:04.494 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=11)
19:57:04.494 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=13)
19:57:04.494 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.494 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.494 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
19:57:04.494 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:57:04.494 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
19:57:04.494 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
19:57:04.494 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
19:57:04.494 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
19:57:04.494 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:57:04.494 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
19:57:04.494 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=11)
19:57:04.494 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=14)
19:57:04.494 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.494 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.494 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
19:57:04.494 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
19:57:04.494 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
19:57:04.494 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:57:04.494 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
19:57:04.494 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
19:57:04.494 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:57:04.494 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
19:57:04.494 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=11)
19:57:04.495 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=15)
19:57:04.495 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.495 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.495 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
19:57:04.495 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
19:57:04.495 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
19:57:04.495 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
19:57:04.495 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
19:57:04.495 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
19:57:04.495 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
19:57:04.495 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(key15, value15)
19:57:04.495 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-2 (nextIndex=11)
19:57:04.495 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
19:57:04.495 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.495 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.495 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
19:57:04.495 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
19:57:04.495 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
19:57:04.495 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
19:57:04.495 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
19:57:04.495 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
19:57:04.495 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
19:57:04.495 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(key16, value16)
19:57:04.495 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 7 entries to node-2 (nextIndex=11)
19:57:04.495 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
19:57:04.495 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.495 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.495 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:57:04.495 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:57:04.495 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
19:57:04.495 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
19:57:04.495 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
19:57:04.495 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
19:57:04.495 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
19:57:04.495 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(key17, value17)
19:57:04.495 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 8 entries to node-2 (nextIndex=11)
19:57:04.495 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=18)
19:57:04.495 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.496 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.496 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
19:57:04.496 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
19:57:04.496 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=18
19:57:04.496 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
19:57:04.496 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
19:57:04.496 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
19:57:04.496 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
19:57:04.496 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(key18, value18)
19:57:04.496 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 9 entries to node-2 (nextIndex=11)
19:57:04.496 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=19)
19:57:04.496 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.496 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.496 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
19:57:04.496 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:57:04.496 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
19:57:04.496 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
19:57:04.496 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
19:57:04.496 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
19:57:04.496 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
19:57:04.496 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(key19, value19)
19:57:04.496 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 10 entries to node-2 (nextIndex=11)
19:57:04.496 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
19:57:04.496 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:04.496 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:04.496 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
19:57:04.496 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
19:57:04.496 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
19:57:04.496 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
19:57:04.496 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
19:57:04.496 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
19:57:04.496 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 20, term 1
19:57:04.496 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 20 entries, 384 bytes
19:57:04.497 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=20, lastTerm=1, size=384 bytes
19:57:04.497 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 20, 0 entries remaining
19:57:04.497 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
19:57:04.497 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 384 bytes, 0 log entries remaining
19:57:04.497 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:04.497 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:04.497 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:04.497 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
19:57:04.497 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
19:57:04.497 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:04.497 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:04.497 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:04.498 [replication-node-1] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 384 bytes
19:57:04.499 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Sending snapshot to node-2 (lastIndex=20, size=384)
19:57:04.499 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 InstallSnapshot(term=1, lastIndex=20, size=384)
19:57:04.499 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:57:04.499 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
19:57:04.499 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:04.499 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:04.499 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:04.499 [] [node-2] INFO  com.raftdb.core.RaftNode - Installing snapshot: lastIndex=20, lastTerm=1, size=384
19:57:04.500 [] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=20, lastTerm=1, size=384 bytes
19:57:04.500 [] [node-2] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 20 entries
19:57:04.500 [] [node-2] INFO  com.raftdb.log.LogManager - Reset log to snapshot: index=20, term=1
19:57:04.500 [] [node-2] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
19:57:04.500 [] [node-2] INFO  com.raftdb.core.RaftNode - Snapshot installed successfully
19:57:04.500 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 InstallSnapshotResponse(term=1)
19:57:04.500 [] [node-1] INFO  c.r.replication.ReplicationManager - Snapshot to node-2 complete, nextIndex=21
19:57:04.603 [main] [node-2] INFO  com.raftdb.integration.SnapshotTest - Snapshot replication test passed
19:57:04.603 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:04.603 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:04.603 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:04.603 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:04.603 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:04.603 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:04.603 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:04.603 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:04.603 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:04.603 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:04.603 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:04.603 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:04.603 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:04.603 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:04.603 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:04.605 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:04.605 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:04.605 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:04.605 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:57:04.606 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:57:04.606 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:04.606 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:04.606 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:04.777 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:04.778 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:04.778 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:04.778 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:04.778 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:57:04.778 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:04.778 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:04.778 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:04.816 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:04.816 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(string, hello)
19:57:04.816 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:04.816 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(string, hello)
19:57:04.816 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:57:04.816 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(number, 12345)
19:57:04.816 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:04.816 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(number, 12345)
19:57:04.816 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:57:04.816 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(special, 特殊字符)
19:57:04.816 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:57:04.817 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(special, 特殊字符)
19:57:04.817 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:57:04.817 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(empty, )
19:57:04.817 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:57:04.817 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(empty, )
19:57:04.817 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:57:04.817 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: DELETE(empty)
19:57:04.817 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:57:04.817 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: DELETE(empty)
19:57:04.817 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 4, term 1
19:57:04.817 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 3 entries, 69 bytes
19:57:04.818 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=4, lastTerm=1, size=69 bytes
19:57:04.818 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 4, 1 entries remaining
19:57:04.818 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 1 entries
19:57:04.818 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 69 bytes, 1 log entries remaining
19:57:04.818 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:04.818 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:04.818 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:04.818 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:04.818 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:04.818 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:04.818 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:04.818 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:04.818 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
19:57:04.818 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:57:04.818 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=4, lastTerm=1
19:57:04.819 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:57:04.819 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 69 bytes
19:57:04.819 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 3 entries
19:57:04.819 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=4, term=1
19:57:04.819 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=4, term=1
19:57:04.819 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
19:57:04.819 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=5
19:57:04.819 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 5 to 5 to recover state machine
19:57:04.819 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=5
19:57:04.819 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=5
19:57:04.819 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:04.819 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:05.013 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:05.014 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:57:05.014 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:57:05.014 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:57:05.014 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:57:05.014 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:57:05.014 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:57:05.014 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:05.030 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - State machine snapshot test passed
19:57:05.030 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:05.030 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.030 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:05.030 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:05.030 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:05.034 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:05.035 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19001
19:57:05.035 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:05.036 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:57:05.036 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:57:05.036 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:05.036 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:05.036 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:05.036 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19001
19:57:05.036 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:05.036 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19002
19:57:05.036 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:05.036 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:57:05.036 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:57:05.036 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:05.036 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:05.037 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:05.037 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19002
19:57:05.037 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:05.037 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19003
19:57:05.037 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:05.037 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:57:05.037 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:57:05.037 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:05.037 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:05.037 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:05.037 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19003
19:57:05.216 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:05.217 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:05.217 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:57:05.217 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:05.217 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:05.217 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19001
19:57:05.217 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19002
19:57:05.221 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:05.221 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:05.221 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:05.221 [grpc-default-executor-0] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.221 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:05.221 [grpc-default-executor-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.221 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:57:05.221 [grpc-default-executor-0] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:57:05.221 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:57:05.221 [grpc-default-executor-1] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:57:05.222 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=true
19:57:05.222 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=true
19:57:05.222 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:05.222 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:05.222 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:05.222 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:05.247 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Leader elected: node-3
19:57:05.247 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:05.247 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.247 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:05.248 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:57:05.248 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:05.248 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:05.248 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.248 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:05.249 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:57:05.249 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:05.249 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:05.249 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.249 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:05.249 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:57:05.249 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:05.361 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:05.361 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19011
19:57:05.361 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:05.362 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:57:05.362 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:57:05.362 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:05.362 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:05.362 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:05.362 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19011
19:57:05.362 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:05.362 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19012
19:57:05.362 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:05.362 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:57:05.362 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:57:05.362 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:05.362 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:05.362 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:05.362 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19012
19:57:05.362 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:05.363 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19013
19:57:05.363 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:05.363 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:57:05.363 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:57:05.363 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:05.363 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:05.363 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:05.363 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19013
19:57:05.531 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:05.532 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:05.533 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:05.533 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:05.533 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:05.534 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19013
19:57:05.534 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19011
19:57:05.538 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:05.538 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:05.538 [grpc-default-executor-0] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.538 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:05.538 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:05.538 [grpc-default-executor-5] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.538 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:05.538 [grpc-default-executor-0] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:05.538 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:05.538 [grpc-default-executor-5] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:05.539 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
19:57:05.539 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
19:57:05.539 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:05.539 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:05.539 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:05.539 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:05.571 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:05.571 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(grpc-key, grpc-value)
19:57:05.571 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:57:05.571 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:57:05.573 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:05.573 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:05.573 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:05.573 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:05.573 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:05.573 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:05.573 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:57:05.573 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:57:05.573 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:05.573 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:05.573 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
19:57:05.595 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:05.595 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:05.595 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
19:57:05.595 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
19:57:05.676 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Data replicated to all nodes
19:57:05.676 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:05.676 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.676 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:05.677 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:57:05.677 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:05.677 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:05.677 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.677 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:05.678 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:57:05.678 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:05.678 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:05.678 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.678 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:05.678 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:57:05.678 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:05.780 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:05.781 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19021
19:57:05.781 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:05.782 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:57:05.782 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:57:05.782 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:05.782 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:05.782 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:05.782 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19021
19:57:05.782 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:05.782 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19022
19:57:05.782 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:05.783 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:57:05.783 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:57:05.783 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:05.783 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:05.783 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:05.783 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19022
19:57:05.783 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:05.783 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19023
19:57:05.783 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:05.783 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:57:05.783 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:57:05.783 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:05.783 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:05.783 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:05.784 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19023
19:57:05.961 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:05.962 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:05.963 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:05.963 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:05.963 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:05.964 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19021
19:57:05.964 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19023
19:57:05.969 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:05.969 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:05.969 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:05.969 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:05.969 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:05.969 [grpc-default-executor-0] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.969 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.969 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:57:05.969 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:57:05.969 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:05.970 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:05.970 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:05.970 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19022
19:57:05.970 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19023
19:57:05.970 [grpc-default-executor-0] [node-1] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: target/grpc-test-data/node-1/meta.dat.tmp -> target/grpc-test-data/node-1/meta.dat
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixFileSystem.move(UnixFileSystem.java:823)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:289)
	at java.base/java.nio.file.Files.move(Files.java:1319)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:98)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:219)
	at com.raftdb.core.RaftState.persist(RaftState.java:85)
	at com.raftdb.core.RaftState.tryVoteFor(RaftState.java:170)
	at com.raftdb.election.ElectionManager.handleVoteRequest(ElectionManager.java:282)
	at com.raftdb.core.RaftNode.handleVoteRequest(RaftNode.java:672)
	at com.raftdb.rpc.GrpcTransport$RaftServiceImpl.requestVote(GrpcTransport.java:264)
	at com.raftdb.rpc.proto.RaftServiceGrpc$MethodHandlers.invoke(RaftServiceGrpc.java:370)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:351)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
19:57:05.970 [grpc-default-executor-0] [node-1] ERROR com.raftdb.rpc.GrpcTransport - Error handling VoteRequest
java.lang.RuntimeException: java.nio.file.NoSuchFileException: target/grpc-test-data/node-1/meta.dat.tmp -> target/grpc-test-data/node-1/meta.dat
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:222)
	at com.raftdb.core.RaftState.persist(RaftState.java:85)
	at com.raftdb.core.RaftState.tryVoteFor(RaftState.java:170)
	at com.raftdb.election.ElectionManager.handleVoteRequest(ElectionManager.java:282)
	at com.raftdb.core.RaftNode.handleVoteRequest(RaftNode.java:672)
	at com.raftdb.rpc.GrpcTransport$RaftServiceImpl.requestVote(GrpcTransport.java:264)
	at com.raftdb.rpc.proto.RaftServiceGrpc$MethodHandlers.invoke(RaftServiceGrpc.java:370)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:351)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.file.NoSuchFileException: target/grpc-test-data/node-1/meta.dat.tmp -> target/grpc-test-data/node-1/meta.dat
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixFileSystem.move(UnixFileSystem.java:823)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:289)
	at java.base/java.nio.file.Files.move(Files.java:1319)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:98)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:219)
	... 14 common frames omitted
19:57:05.971 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
19:57:05.971 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:05.971 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:05.971 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:05.971 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:05.971 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: Vote request to node-1 failed
19:57:05.974 [] [node-2] INFO  c.r.replication.ReplicationManager - Discovered higher term 2 from node-1
19:57:05.975 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:57:05.975 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:05.975 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.975 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:57:05.975 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:57:05.975 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:05.975 [grpc-default-executor-0] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
19:57:05.975 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:05.975 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:57:05.975 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
19:57:05.976 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=2) -> granted=true
19:57:05.976 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:05.976 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:57:05.976 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:57:05.976 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:05.976 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=2) -> granted=true
19:57:05.990 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Initial leader: node-1 at term 2
19:57:05.990 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 2
19:57:05.990 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
19:57:05.990 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:57:05.990 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:57:05.992 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:05.992 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:05.992 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:05.992 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:05.993 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:57:05.993 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:57:05.993 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:05.993 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:57:05.993 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:57:05.993 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:57:06.033 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:06.033 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:06.033 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:57:06.033 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:57:06.097 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:06.097 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:06.097 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:06.098 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:57:06.098 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:06.098 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-1
19:57:06.098 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Stopped leader: node-1
19:57:06.287 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:06.288 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
19:57:06.288 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
19:57:06.288 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:06.288 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19022
19:57:06.288 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19021
19:57:06.290 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: Vote request to node-1 failed
19:57:06.291 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=null
19:57:06.291 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:06.291 [grpc-default-executor-4] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:06.292 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-3
19:57:06.292 [grpc-default-executor-4] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 3
19:57:06.292 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=3) -> granted=true
19:57:06.292 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:06.292 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 3
19:57:06.292 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 3
19:57:06.292 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:06.309 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - New leader: node-3 at term 3
19:57:06.309 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 3
19:57:06.309 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
19:57:06.309 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:06.309 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:57:06.311 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.311 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:06.311 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
19:57:06.311 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:57:06.311 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:06.311 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:57:06.347 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:06.348 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:06.348 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:57:06.397 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:06.417 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:06.417 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:06.417 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:06.418 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:57:06.418 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:06.418 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:06.418 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:06.418 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:06.418 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:57:06.418 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:06.523 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:06.524 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19031
19:57:06.524 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:06.524 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:57:06.524 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:57:06.524 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:06.524 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:06.524 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:06.524 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19031
19:57:06.524 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:06.525 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19032
19:57:06.525 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:06.525 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:57:06.525 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:57:06.525 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:06.525 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:06.525 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:06.525 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19032
19:57:06.525 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:06.525 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19033
19:57:06.525 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:06.525 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:57:06.525 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:57:06.525 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:06.525 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:06.526 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:06.526 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19033
19:57:06.746 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:06.746 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:06.747 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:06.747 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:06.747 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:06.747 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19033
19:57:06.747 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19031
19:57:06.749 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:06.749 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:06.749 [grpc-default-executor-4] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:06.749 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:06.749 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:06.749 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:06.750 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:06.750 [grpc-default-executor-4] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:06.750 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:06.750 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:06.750 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
19:57:06.750 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
19:57:06.750 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:06.750 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:06.750 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:06.750 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:06.837 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:06.837 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
19:57:06.837 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:57:06.837 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:57:06.838 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.838 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.838 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:06.838 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:06.838 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.838 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.838 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:57:06.838 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:57:06.838 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:06.838 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:06.838 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:57:06.839 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:57:06.839 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
19:57:06.839 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:57:06.839 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:06.839 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.839 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:06.839 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:06.839 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.839 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:06.839 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:06.840 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:57:06.840 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:57:06.840 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.840 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:57:06.840 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.840 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:06.840 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:57:06.840 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:57:06.840 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:57:06.840 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
19:57:06.840 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
19:57:06.840 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:57:06.841 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.841 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.841 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:06.841 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:06.841 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:06.841 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:06.841 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:57:06.841 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:57:06.841 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.841 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.841 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:57:06.841 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:57:06.841 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:57:06.841 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:57:06.841 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:57:06.841 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:57:06.841 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
19:57:06.841 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
19:57:06.841 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
19:57:06.842 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.842 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:57:06.842 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.842 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:06.842 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:57:06.842 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:06.842 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:57:06.842 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:57:06.842 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.842 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.842 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:57:06.842 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
19:57:06.842 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:57:06.842 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:57:06.842 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:57:06.843 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:57:06.843 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
19:57:06.843 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
19:57:06.843 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
19:57:06.843 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.843 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:57:06.843 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:57:06.843 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.843 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:57:06.843 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:57:06.843 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:57:06.843 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:57:06.843 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.843 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
19:57:06.844 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:57:06.844 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.844 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:57:06.844 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:57:06.844 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:57:06.844 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
19:57:06.844 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
19:57:06.844 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
19:57:06.844 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.844 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.844 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:57:06.844 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:57:06.844 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:57:06.844 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:57:06.844 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:57:06.844 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:57:06.845 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.845 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
19:57:06.845 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.845 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:57:06.845 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
19:57:06.845 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:57:06.845 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:57:06.845 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
19:57:06.845 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
19:57:06.845 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
19:57:06.845 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.845 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:57:06.845 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:57:06.845 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.845 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:57:06.845 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:57:06.845 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:57:06.845 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:57:06.846 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.846 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
19:57:06.846 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:57:06.846 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.846 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:57:06.846 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
19:57:06.846 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:57:06.846 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
19:57:06.846 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
19:57:06.846 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
19:57:06.846 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.846 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.847 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:57:06.847 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:57:06.847 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:57:06.847 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:57:06.847 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:57:06.847 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:57:06.847 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.847 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.847 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
19:57:06.847 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
19:57:06.847 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:57:06.847 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:57:06.847 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:57:06.847 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:57:06.847 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
19:57:06.847 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
19:57:06.847 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
19:57:06.848 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.848 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.848 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:57:06.848 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:57:06.848 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:57:06.848 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:57:06.848 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:57:06.848 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:57:06.850 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.850 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
19:57:06.850 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:57:06.850 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:57:06.850 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.850 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
19:57:06.850 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:57:06.850 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
19:57:06.850 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
19:57:06.850 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
19:57:06.850 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
19:57:06.850 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
19:57:06.851 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.851 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.851 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:57:06.851 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:57:06.851 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:57:06.851 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:57:06.851 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:57:06.851 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:57:06.852 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:57:06.852 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:57:06.852 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.852 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
19:57:06.852 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.852 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
19:57:06.852 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:57:06.852 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.852 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:57:06.852 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:57:06.852 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.852 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:57:06.852 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key-10, value-10)
19:57:06.852 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
19:57:06.852 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=11)
19:57:06.853 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.853 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.853 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
19:57:06.853 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
19:57:06.853 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:57:06.853 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:57:06.853 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:57:06.853 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:57:06.853 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.853 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.853 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=11
19:57:06.853 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
19:57:06.853 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:57:06.853 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:57:06.853 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
19:57:06.853 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:57:06.853 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key-11, value-11)
19:57:06.853 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=12)
19:57:06.853 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=12)
19:57:06.854 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.854 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.854 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
19:57:06.854 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
19:57:06.854 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:57:06.854 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:57:06.854 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
19:57:06.854 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
19:57:06.854 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.854 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
19:57:06.854 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.854 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
19:57:06.854 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=12
19:57:06.854 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
19:57:06.854 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:57:06.854 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key-12, value-12)
19:57:06.854 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=13)
19:57:06.854 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=13)
19:57:06.855 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.855 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
19:57:06.855 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:57:06.855 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.855 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
19:57:06.855 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
19:57:06.855 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:57:06.855 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
19:57:06.855 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.855 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=13
19:57:06.855 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.855 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
19:57:06.855 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
19:57:06.855 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
19:57:06.855 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:57:06.855 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key-13, value-13)
19:57:06.855 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=14)
19:57:06.855 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=14)
19:57:06.856 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.856 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.856 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
19:57:06.856 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
19:57:06.856 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
19:57:06.856 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
19:57:06.856 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
19:57:06.856 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
19:57:06.856 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.856 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=14
19:57:06.856 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.856 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
19:57:06.856 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:57:06.856 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:57:06.856 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
19:57:06.856 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:57:06.856 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key-14, value-14)
19:57:06.856 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=15)
19:57:06.856 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=15)
19:57:06.857 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.857 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.857 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
19:57:06.857 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
19:57:06.857 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
19:57:06.857 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
19:57:06.857 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
19:57:06.857 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
19:57:06.857 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.857 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=15
19:57:06.857 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
19:57:06.857 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.857 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
19:57:06.857 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
19:57:06.857 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
19:57:06.857 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(key-15, value-15)
19:57:06.857 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
19:57:06.857 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=16)
19:57:06.858 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.858 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
19:57:06.858 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
19:57:06.858 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.858 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
19:57:06.858 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
19:57:06.858 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
19:57:06.858 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
19:57:06.858 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.858 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=16
19:57:06.858 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.858 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
19:57:06.858 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
19:57:06.858 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
19:57:06.858 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
19:57:06.858 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(key-16, value-16)
19:57:06.858 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
19:57:06.858 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=17)
19:57:06.859 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.859 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:57:06.859 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:57:06.859 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.859 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
19:57:06.859 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:57:06.859 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:57:06.859 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
19:57:06.859 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.859 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
19:57:06.859 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
19:57:06.859 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
19:57:06.859 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.859 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=17
19:57:06.859 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
19:57:06.859 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(key-17, value-17)
19:57:06.859 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=18)
19:57:06.859 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=18)
19:57:06.860 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.860 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.860 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
19:57:06.860 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
19:57:06.860 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
19:57:06.860 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
19:57:06.860 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
19:57:06.860 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
19:57:06.860 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.860 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=18
19:57:06.860 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
19:57:06.860 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.860 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=18
19:57:06.860 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
19:57:06.860 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
19:57:06.860 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(key-18, value-18)
19:57:06.860 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=19)
19:57:06.860 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=19)
19:57:06.861 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.861 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
19:57:06.861 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:57:06.861 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.861 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
19:57:06.861 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:57:06.861 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
19:57:06.861 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
19:57:06.861 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.861 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=19
19:57:06.861 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.861 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
19:57:06.861 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
19:57:06.861 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
19:57:06.861 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
19:57:06.861 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(key-19, value-19)
19:57:06.861 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
19:57:06.861 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=20)
19:57:06.862 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.862 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
19:57:06.862 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
19:57:06.862 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:06.862 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
19:57:06.862 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
19:57:06.862 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
19:57:06.862 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
19:57:06.863 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:06.863 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
19:57:06.863 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
19:57:06.863 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:06.863 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
19:57:06.863 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
19:57:06.902 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:57:06.902 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:57:06.903 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
19:57:06.903 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
19:57:06.970 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - All 20 writes replicated
19:57:06.970 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:06.970 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:06.970 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:06.971 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:57:06.971 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:06.971 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:06.971 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:06.971 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:06.971 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:57:06.971 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:06.971 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:06.971 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:06.971 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:06.971 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:57:06.971 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:07.077 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:07.078 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19041
19:57:07.078 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:07.078 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:57:07.078 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:57:07.078 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:07.078 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:07.078 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:07.078 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19041
19:57:07.078 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:07.078 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19042
19:57:07.078 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:07.079 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:57:07.079 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:57:07.079 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:07.079 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:07.079 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:07.079 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19042
19:57:07.079 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:07.079 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19043
19:57:07.079 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:07.079 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:57:07.079 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:57:07.079 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:07.079 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:07.079 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:07.079 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19043
19:57:07.265 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:07.265 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:07.266 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:07.266 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:07.266 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:07.266 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19043
19:57:07.266 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19041
19:57:07.269 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:07.269 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:07.269 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:07.269 [grpc-default-executor-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:07.269 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:07.269 [grpc-default-executor-4] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:07.269 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:07.269 [grpc-default-executor-1] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:07.269 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:07.269 [grpc-default-executor-4] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:07.270 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
19:57:07.270 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:07.270 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:07.270 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:07.270 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:07.270 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
19:57:07.290 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:07.290 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(restart-test, initial)
19:57:07.290 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:57:07.290 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:57:07.291 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:07.291 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:07.291 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:07.291 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:07.292 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:07.292 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:07.292 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:57:07.292 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:57:07.292 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:07.292 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:07.292 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
19:57:07.322 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:07.322 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:07.323 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
19:57:07.323 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
19:57:07.402 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Restarting follower: node-1 on port 19041
19:57:07.402 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:07.402 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:07.402 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:07.402 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:57:07.403 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:07.403 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-1
19:57:07.508 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:57:07.508 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during-downtime, value)
19:57:07.508 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:57:07.508 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:07.509 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:07.509 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:07.510 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:57:07.510 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:57:07.510 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:07.510 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
19:57:07.511 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:07.511 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19041
19:57:07.511 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:07.512 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-2
19:57:07.512 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:57:07.512 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:57:07.512 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
19:57:07.512 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
19:57:07.512 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 1 to recover state machine
19:57:07.512 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
19:57:07.512 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-2, lastLogIndex=1
19:57:07.512 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:07.512 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:07.512 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Restarted node node-1 on port 19041
19:57:07.523 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:07.523 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:07.523 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
19:57:07.572 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:07.624 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:07.674 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:07.725 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:07.750 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:07.751 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:57:07.751 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:57:07.751 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:07.751 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19043
19:57:07.751 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19042
19:57:07.754 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:57:07.754 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:57:07.754 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:07.754 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:07.754 [grpc-default-executor-1] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:07.754 [grpc-default-executor-5] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:07.754 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:57:07.754 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:57:07.754 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:57:07.754 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:57:07.754 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=2) -> granted=false
19:57:07.754 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=2) -> granted=false
19:57:07.916 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:07.917 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
19:57:07.917 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
19:57:07.917 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:07.917 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: Vote request to node-1 failed
19:57:07.918 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=null
19:57:07.918 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:07.918 [grpc-default-executor-3] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:07.918 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-2
19:57:07.918 [grpc-default-executor-3] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 3
19:57:07.919 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=3) -> granted=true
19:57:07.919 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:07.919 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 3
19:57:07.919 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 3
19:57:07.919 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:08.009 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:08.010 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-2
19:57:08.010 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
19:57:08.010 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:08.011 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=false
19:57:08.011 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
19:57:08.011 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:57:08.011 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=3) -> granted=false
19:57:08.011 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=3) -> granted=false
19:57:08.184 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:08.185 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-2
19:57:08.185 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
19:57:08.185 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:08.186 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=null
19:57:08.186 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:08.186 [grpc-default-executor-5] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:08.186 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=null
19:57:08.186 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:08.186 [grpc-default-executor-0] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:08.186 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-1
19:57:08.186 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:57:08.187 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-1
19:57:08.187 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:57:08.187 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=4) -> granted=false
19:57:08.187 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=4) -> granted=false
19:57:08.383 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:08.383 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-2
19:57:08.383 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 5
19:57:08.384 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:08.385 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=null
19:57:08.385 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:08.385 [grpc-default-executor-5] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:08.385 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=null
19:57:08.385 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:08.385 [grpc-default-executor-0] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:08.385 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-1
19:57:08.385 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:57:08.385 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-1
19:57:08.385 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:57:08.386 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=5) -> granted=false
19:57:08.386 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=5) -> granted=false
19:57:08.541 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:08.542 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-1
19:57:08.542 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 6
19:57:08.542 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:08.542 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: Vote request to node-1 failed
19:57:08.543 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=null
19:57:08.543 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:08.543 [grpc-default-executor-0] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:08.543 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-2
19:57:08.543 [grpc-default-executor-0] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 6
19:57:08.544 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=6) -> granted=true
19:57:08.544 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:08.544 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 6
19:57:08.544 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 6
19:57:08.544 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:08.549 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:08.549 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-2
19:57:08.549 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 6
19:57:08.549 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:08.550 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=false
19:57:08.550 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-1
19:57:08.551 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:57:08.551 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=6) -> granted=false
19:57:08.551 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=6) -> granted=false
19:57:08.598 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Missing entry at index 2
19:57:08.598 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 failed, nextIndex decremented to 2
19:57:08.645 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:08.647 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:08.647 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:08.647 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:08.647 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
19:57:08.647 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:57:08.647 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:57:08.662 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Restarted node caught up successfully
19:57:08.662 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:08.662 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:08.662 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:08.663 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:57:08.663 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:08.663 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:08.663 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:08.663 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:08.664 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:57:08.664 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:08.664 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:08.664 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:08.664 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:08.664 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:57:08.664 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:08.767 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:08.767 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19051
19:57:08.767 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:08.767 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:57:08.767 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:57:08.767 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:08.767 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:08.768 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:08.768 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19051
19:57:08.768 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:08.768 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19052
19:57:08.768 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:08.768 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:57:08.768 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:57:08.768 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:08.768 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:08.768 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:08.768 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19052
19:57:08.768 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:08.768 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19053
19:57:08.768 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:08.768 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:57:08.768 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:57:08.769 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:08.769 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:08.769 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:08.769 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19053
19:57:08.769 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
19:57:08.769 [main] [node-4] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19054
19:57:08.769 [main] [node-4] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-4
19:57:08.769 [main] [node-4] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-4
19:57:08.769 [main] [node-4] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-4
19:57:08.769 [main] [node-4] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:08.769 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:08.769 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 initialized as FOLLOWER
19:57:08.769 [main] [node-4] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-4 on port 19054
19:57:08.769 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
19:57:08.769 [main] [node-5] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19055
19:57:08.769 [main] [node-5] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-5
19:57:08.769 [main] [node-5] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-5
19:57:08.770 [main] [node-5] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-5
19:57:08.770 [main] [node-5] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:08.770 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:08.770 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 initialized as FOLLOWER
19:57:08.770 [main] [node-5] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-5 on port 19055
19:57:08.945 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:08.945 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:08.945 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:08.945 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:08.945 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
19:57:08.946 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-5 at localhost:19055
19:57:08.946 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19052
19:57:08.946 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19053
19:57:08.946 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-4 at localhost:19054
19:57:08.948 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:08.948 [grpc-default-executor-6] [node-4] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:08.948 [grpc-default-executor-6] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:08.948 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:08.948 [grpc-default-executor-10] [node-5] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:08.948 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:08.949 [grpc-default-executor-10] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:08.949 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:08.949 [grpc-default-executor-10] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:08.949 [grpc-default-executor-0] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:08.948 [grpc-default-executor-6] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:08.948 [grpc-default-executor-9] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:08.949 [grpc-default-executor-10] [node-5] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:08.949 [grpc-default-executor-6] [node-4] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:08.949 [grpc-default-executor-6] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:08.949 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:08.949 [grpc-default-executor-10] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:08.949 [grpc-default-executor-9] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:08.949 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:08.949 [grpc-default-executor-0] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:08.950 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
19:57:08.950 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
19:57:08.950 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-5 VoteRequest(term=1) -> granted=true
19:57:08.950 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
19:57:08.950 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-4 VoteRequest(term=1) -> granted=true
19:57:08.950 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
19:57:08.950 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:08.950 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:08.950 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:08.980 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:08.980 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(five-node-test, value)
19:57:08.980 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:57:08.981 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
19:57:08.981 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
19:57:08.981 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:57:08.982 [grpc-default-executor-3] [node-4] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:08.982 [grpc-default-executor-3] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:08.982 [grpc-default-executor-5] [node-5] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:08.982 [grpc-default-executor-5] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:08.982 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:08.982 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:08.982 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:08.982 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:08.982 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-4 AppendEntries(entries=1) -> success=true
19:57:08.982 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:57:08.982 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
19:57:08.982 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:57:08.982 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:08.982 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-5 AppendEntries(entries=1) -> success=true
19:57:08.982 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:08.982 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:57:08.982 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
19:57:08.982 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:57:08.982 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:57:09.004 [grpc-default-executor-0] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:09.004 [grpc-default-executor-3] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:09.005 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:09.004 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:09.005 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:57:09.005 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:57:09.005 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:57:09.005 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:57:09.088 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:09.088 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:09.088 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:09.089 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:57:09.089 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:09.089 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-2
19:57:09.089 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:09.089 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:09.089 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:09.089 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:57:09.089 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:09.089 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-3
19:57:09.089 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Stopped two followers: node-2 and node-3
19:57:09.196 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:57:09.196 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failures, still-working)
19:57:09.196 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:57:09.196 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
19:57:09.196 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
19:57:09.196 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:57:09.197 [grpc-default-executor-0] [node-5] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:09.197 [grpc-default-executor-2] [node-4] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:09.197 [grpc-default-executor-0] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:09.197 [grpc-default-executor-2] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:09.198 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-5 AppendEntries(entries=1) -> success=true
19:57:09.198 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
19:57:09.198 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-4 AppendEntries(entries=1) -> success=true
19:57:09.198 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
19:57:09.198 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:09.198 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
19:57:09.200 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:57:09.200 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:57:09.201 [grpc-default-executor-3] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:09.201 [grpc-default-executor-0] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:09.201 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
19:57:09.201 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
19:57:09.254 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:57:09.254 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:57:09.304 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Five-node cluster survived two failures
19:57:09.305 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:09.305 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:09.305 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:09.306 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:57:09.306 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:09.306 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
19:57:09.306 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:09.306 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:09.306 [main] [node-4] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-4
19:57:09.306 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
19:57:09.306 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
19:57:09.306 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:09.306 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:09.307 [main] [node-5] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-5
19:57:09.307 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
19:57:09.411 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:09.412 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19061
19:57:09.412 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:09.412 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:57:09.412 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:57:09.412 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:09.412 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:09.412 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:09.412 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19061
19:57:09.578 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:09.579 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:09.579 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:09.579 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:09.579 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:57:09.579 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:09.579 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:09.579 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:09.623 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:09.623 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(single, node)
19:57:09.623 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:09.623 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(single, node)
19:57:09.623 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Single node cluster works
19:57:09.624 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:09.624 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:09.624 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:09.624 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:57:09.624 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:09.738 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:09.738 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-112630963041639722689
19:57:09.738 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-112630963041639722689
19:57:09.738 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:09.738 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:09.738 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:09.738 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:09.738 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:09.738 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:09.738 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-112630963041639722689
19:57:09.738 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-112630963041639722689
19:57:09.738 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:09.738 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:09.738 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:09.738 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:09.738 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-25774716475186689016
19:57:09.739 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-25774716475186689016
19:57:09.739 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:09.739 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:09.739 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:09.739 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:09.739 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:09.739 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:09.739 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-25774716475186689016
19:57:09.739 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-25774716475186689016
19:57:09.739 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:09.739 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:09.739 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:09.739 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:09.739 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-315838168059879560341
19:57:09.739 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-315838168059879560341
19:57:09.739 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:09.739 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:09.739 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:09.739 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:09.739 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:09.739 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:09.739 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-315838168059879560341
19:57:09.739 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-315838168059879560341
19:57:09.739 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:09.739 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:09.739 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:09.973 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:09.974 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:09.974 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:09.974 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:09.974 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:09.974 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:09.974 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:09.975 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:09.975 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:57:09.975 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:09.975 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:57:09.975 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:09.975 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:57:09.975 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=false)
19:57:09.975 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
19:57:09.975 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
19:57:09.975 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
19:57:09.975 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=false)
19:57:09.975 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:09.975 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:09.975 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:09.975 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:57:09.975 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=false)
19:57:09.975 [] [node-3] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-315838168059879560341/meta.dat.tmp -> /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-315838168059879560341/meta.dat
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixFileSystem.move(UnixFileSystem.java:823)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:289)
	at java.base/java.nio.file.Files.move(Files.java:1319)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:98)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:219)
	at com.raftdb.core.RaftState.persist(RaftState.java:85)
	at com.raftdb.core.RaftState.tryVoteFor(RaftState.java:170)
	at com.raftdb.election.ElectionManager.handleVoteRequest(ElectionManager.java:282)
	at com.raftdb.core.RaftNode.handleVoteRequest(RaftNode.java:672)
	at com.raftdb.rpc.LocalTransport.lambda$sendVoteRequest$0(LocalTransport.java:65)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1789)
	at java.base/java.util.concurrent.ThreadPerTaskExecutor$TaskRunner.run(ThreadPerTaskExecutor.java:291)
	at java.base/java.lang.VirtualThread.run(VirtualThread.java:456)
19:57:09.975 [] [node-3] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: java.nio.file.NoSuchFileException: /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-315838168059879560341/meta.dat.tmp -> /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-315838168059879560341/meta.dat
19:57:10.200 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:10.201 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:57:10.201 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:57:10.201 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:10.201 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=2)
19:57:10.201 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=2)
19:57:10.201 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:57:10.201 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:10.201 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.201 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:57:10.201 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:10.201 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.202 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
19:57:10.202 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
19:57:10.202 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
19:57:10.202 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
19:57:10.202 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:57:10.202 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:57:10.202 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:10.202 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:57:10.202 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:57:10.202 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:10.227 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 2
19:57:10.227 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test-key, test-value)
19:57:10.227 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:57:10.227 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:57:10.227 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=2, entries=1)
19:57:10.228 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=2, entries=1)
19:57:10.228 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:10.228 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:10.228 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:10.228 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:10.228 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:57:10.228 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:57:10.228 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:10.228 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:10.228 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test-key, test-value)
19:57:10.255 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:10.255 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:10.257 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test-key, test-value)
19:57:10.257 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test-key, test-value)
19:57:10.434 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
19:57:10.435 [main] [node-3] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:10.436 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=test-key, found=true
19:57:10.437 [main] [node-3] INFO  c.r.integration.LinearizableReadTest - ✓ Linearizable read returned committed value
19:57:10.438 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:10.438 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.438 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:10.438 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:10.438 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:10.438 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:10.438 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.438 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:10.438 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:10.438 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:10.438 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:10.438 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.438 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:10.438 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:10.438 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:10.440 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:10.441 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-115995925025184780804
19:57:10.441 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-115995925025184780804
19:57:10.441 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.441 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.441 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:10.441 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:10.441 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:10.441 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:10.441 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-115995925025184780804
19:57:10.441 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-115995925025184780804
19:57:10.441 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.441 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.441 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:10.441 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:10.441 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-211973549977621050986
19:57:10.441 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-211973549977621050986
19:57:10.441 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.441 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.441 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:10.441 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:10.441 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:10.441 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:10.441 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-211973549977621050986
19:57:10.441 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-211973549977621050986
19:57:10.441 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.441 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.441 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:10.441 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:10.442 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-318184210567481626722
19:57:10.442 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-318184210567481626722
19:57:10.442 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.442 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.442 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:10.442 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:10.442 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:10.442 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:10.442 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-318184210567481626722
19:57:10.442 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-318184210567481626722
19:57:10.442 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.442 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.442 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:10.616 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:10.617 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:10.617 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:10.617 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:10.617 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:10.617 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
19:57:10.617 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
19:57:10.617 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:10.617 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:10.617 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.617 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:10.617 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:10.617 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.617 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:10.617 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:10.617 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:57:10.617 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:10.617 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:10.617 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:10.617 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:10.617 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:10.617 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:10.617 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:57:10.655 [main] [node-1] INFO  c.r.integration.LinearizableReadTest - ✓ Linearizable read on follower correctly rejected
19:57:10.655 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:10.656 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.656 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:10.656 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:10.656 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:10.656 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:10.656 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.656 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:10.656 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:10.656 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:10.656 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:10.656 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.656 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:10.656 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:10.656 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:10.658 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:10.658 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-116254689446390230299
19:57:10.658 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-116254689446390230299
19:57:10.658 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.658 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.658 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:10.658 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:10.658 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:10.658 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:10.658 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-116254689446390230299
19:57:10.658 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-116254689446390230299
19:57:10.658 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.658 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.658 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:10.658 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:10.658 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-21452978540021132509
19:57:10.658 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-21452978540021132509
19:57:10.658 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.658 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.658 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:10.658 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:10.658 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:10.658 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:10.659 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-21452978540021132509
19:57:10.659 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-21452978540021132509
19:57:10.659 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.659 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.659 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:10.659 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:10.659 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-33296709088280780802
19:57:10.659 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-33296709088280780802
19:57:10.659 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.659 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.659 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:10.659 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:10.659 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:10.659 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:10.659 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-33296709088280780802
19:57:10.659 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-33296709088280780802
19:57:10.659 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.659 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.659 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:10.833 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:10.834 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:10.835 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:10.835 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:10.835 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:10.835 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
19:57:10.835 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
19:57:10.835 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:10.835 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:10.835 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.835 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:10.835 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:10.835 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.836 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:10.836 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:10.836 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:57:10.836 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:10.836 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:10.836 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:10.836 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:10.836 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:10.836 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:10.836 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:57:10.870 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:10.871 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(counter, value-1)
19:57:10.872 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:57:10.873 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:57:10.873 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:57:10.873 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:57:10.873 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:10.873 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:10.873 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:57:10.873 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:10.873 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:10.873 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:10.874 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:57:10.874 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(counter, value-1)
19:57:10.874 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:57:10.874 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(counter, value-2)
19:57:10.875 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:57:10.875 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:57:10.875 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:57:10.877 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:57:10.876 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:10.877 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:10.877 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:10.878 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:10.878 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:10.878 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:10.878 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:57:10.878 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:10.878 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(counter, value-1)
19:57:10.879 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:57:10.879 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(counter, value-2)
19:57:10.879 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(counter, value-1)
19:57:10.880 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:57:10.880 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(counter, value-3)
19:57:10.880 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:57:10.883 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:57:10.880 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
19:57:10.883 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:57:10.883 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:10.883 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:10.883 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:10.883 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:57:10.884 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:57:10.889 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(counter, value-3)
19:57:10.890 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:57:10.889 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:10.890 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:10.890 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:57:10.890 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:57:10.890 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:57:10.890 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:57:10.890 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:10.890 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:10.890 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(counter, value-2)
19:57:10.890 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(counter, value-3)
19:57:10.890 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:57:10.890 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(counter, value-4)
19:57:10.891 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(counter, value-2)
19:57:10.891 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(counter, value-3)
19:57:10.891 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
19:57:10.891 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:57:10.891 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
19:57:10.891 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:57:10.891 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:10.891 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:57:10.891 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
19:57:10.891 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:57:10.891 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:10.891 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:57:10.891 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:57:10.891 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(counter, value-4)
19:57:10.892 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:57:10.892 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(counter, value-5)
19:57:10.892 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
19:57:10.892 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
19:57:10.892 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:57:10.892 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:57:10.892 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:10.892 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:57:10.892 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:57:10.892 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:10.892 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:57:10.892 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:57:10.892 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(counter, value-4)
19:57:10.892 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:57:10.892 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:57:10.892 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
19:57:10.892 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(counter, value-4)
19:57:10.893 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(counter, value-5)
19:57:10.895 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=5
19:57:10.897 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:57:10.897 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:10.897 [] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=counter, found=true
19:57:10.897 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:57:10.897 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(counter, value-5)
19:57:10.897 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(counter, value-5)
19:57:10.898 [main] [node-2] INFO  c.r.integration.LinearizableReadTest - ✓ Linearizable read sees latest write
19:57:10.898 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:10.898 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.898 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:10.898 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:10.898 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:10.898 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:10.898 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.898 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:10.898 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:10.898 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:10.898 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:10.898 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:10.898 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:10.898 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:10.898 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:10.900 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:10.901 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-15262731984877843861
19:57:10.901 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-15262731984877843861
19:57:10.901 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.901 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.902 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:10.902 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:10.902 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:10.902 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:10.902 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-15262731984877843861
19:57:10.902 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-15262731984877843861
19:57:10.902 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.902 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.902 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:10.902 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:10.902 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-27310650357419041600
19:57:10.902 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-27310650357419041600
19:57:10.902 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.902 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.903 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:10.903 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:10.903 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:10.903 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:10.903 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-27310650357419041600
19:57:10.903 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-27310650357419041600
19:57:10.903 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.903 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.903 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:10.903 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:10.903 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-310108854155883902133
19:57:10.903 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-310108854155883902133
19:57:10.903 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.903 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.904 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:10.904 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:10.904 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:10.904 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:10.904 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-310108854155883902133
19:57:10.905 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-310108854155883902133
19:57:10.906 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:10.906 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:10.906 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:11.107 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:11.108 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:11.108 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:11.108 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:11.108 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:11.109 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:57:11.109 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:57:11.109 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:11.109 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:11.109 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:11.109 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:11.109 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:11.109 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:11.109 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:11.109 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:11.109 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:57:11.109 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:11.109 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:11.109 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:11.109 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:11.109 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:11.109 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:11.109 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:57:11.626 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=0
19:57:11.628 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:11.629 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=non-existent-key, found=false
19:57:11.630 [main] [node-1] INFO  c.r.integration.LinearizableReadTest - ✓ Linearizable read for non-existent key returns null
19:57:11.630 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:11.631 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:11.631 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:11.631 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:11.631 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:11.631 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:11.631 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:11.631 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:11.631 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:11.631 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:11.631 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:11.631 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:11.631 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:11.631 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:11.632 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:11.635 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:11.635 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-17169723007643827409
19:57:11.635 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-17169723007643827409
19:57:11.635 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:11.635 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:11.636 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:11.636 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:11.636 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:11.636 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:11.636 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-17169723007643827409
19:57:11.636 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-17169723007643827409
19:57:11.636 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:11.636 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:11.636 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:11.636 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:11.636 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-210702352313154073867
19:57:11.636 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-210702352313154073867
19:57:11.636 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:11.636 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:11.636 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:11.636 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:11.636 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:11.636 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:11.636 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-210702352313154073867
19:57:11.636 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-210702352313154073867
19:57:11.636 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:11.636 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:11.636 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:11.636 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:11.637 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-36198168305770487457
19:57:11.637 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-36198168305770487457
19:57:11.637 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:11.637 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:11.637 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:11.637 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:11.637 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:11.637 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:11.637 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-36198168305770487457
19:57:11.637 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-36198168305770487457
19:57:11.637 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:11.637 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:11.637 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:11.803 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:11.803 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:11.804 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:57:11.804 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:11.804 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:11.804 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:57:11.804 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:57:11.804 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:11.804 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:11.804 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:11.804 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:11.804 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:11.804 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:11.804 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:57:11.804 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:57:11.804 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:57:11.804 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:57:11.804 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:11.804 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:11.804 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:57:11.805 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:11.805 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:57:11.805 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:11.857 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:11.857 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(leadership-test, confirmed)
19:57:11.857 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:57:11.857 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:57:11.857 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:57:11.857 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:57:11.857 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:11.857 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:11.857 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:57:11.857 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:11.857 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:11.857 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:11.857 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:57:11.857 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(leadership-test, confirmed)
19:57:11.910 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:11.910 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:11.910 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(leadership-test, confirmed)
19:57:11.910 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(leadership-test, confirmed)
19:57:12.058 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
19:57:12.058 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:12.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=leadership-test, found=true
19:57:12.059 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
19:57:12.059 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:12.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=leadership-test, found=true
19:57:12.059 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
19:57:12.059 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:12.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=leadership-test, found=true
19:57:12.059 [main] [node-3] INFO  c.r.integration.LinearizableReadTest - ✓ Multiple linearizable reads succeeded, leadership confirmed
19:57:12.059 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:12.059 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:12.059 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:12.059 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:12.059 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:12.059 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:12.059 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:12.059 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:12.059 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:12.059 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:12.059 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:12.059 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:12.059 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:12.059 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:12.059 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:12.061 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:12.061 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-15207515243715785927
19:57:12.061 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-15207515243715785927
19:57:12.061 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:12.061 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:12.061 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:12.061 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:12.061 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:12.061 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:12.061 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-15207515243715785927
19:57:12.061 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-15207515243715785927
19:57:12.061 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:12.061 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:12.061 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:12.266 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:12.267 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:12.267 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:12.267 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:12.267 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:57:12.267 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:12.267 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:12.267 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:13.067 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:13.067 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(single-node-key, single-node-value)
19:57:13.067 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:13.068 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(single-node-key, single-node-value)
19:57:13.068 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
19:57:13.068 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=single-node-key, found=true
19:57:13.068 [main] [node-1] INFO  c.r.integration.LinearizableReadTest - ✓ Single node linearizable read succeeded
19:57:13.068 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:13.068 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:13.068 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:13.068 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:13.068 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:13.073 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:13.073 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-1651450736164692006
19:57:13.073 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-1651450736164692006
19:57:13.073 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:13.073 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:13.073 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:13.074 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:13.074 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:13.074 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:13.074 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-1651450736164692006
19:57:13.074 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-1651450736164692006
19:57:13.074 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:13.074 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:13.074 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:13.074 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:13.074 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-216403422142559744177
19:57:13.074 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-216403422142559744177
19:57:13.074 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:13.074 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:13.074 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:13.074 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:13.075 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:13.075 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:13.075 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-216403422142559744177
19:57:13.075 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-216403422142559744177
19:57:13.075 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:13.075 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:13.075 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:13.075 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:13.075 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-315240927941562554172
19:57:13.075 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-315240927941562554172
19:57:13.075 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:13.075 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:13.075 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:13.075 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:13.075 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:13.075 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:13.075 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-315240927941562554172
19:57:13.075 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-315240927941562554172
19:57:13.075 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:13.075 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:13.075 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:13.316 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:13.317 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:13.317 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:13.317 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:13.317 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:13.317 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:57:13.317 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:57:13.317 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:13.317 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:13.317 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:13.317 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:13.317 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:13.317 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:13.317 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:13.317 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:13.317 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:57:13.317 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:13.317 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:13.317 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:13.317 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:13.317 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:57:13.317 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:13.317 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:57:13.346 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:13.346 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-key, 0)
19:57:13.346 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:57:13.346 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:57:13.346 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:13.346 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:13.346 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.346 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:13.346 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.346 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:57:13.346 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:13.346 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:13.346 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:57:13.347 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-key, 0)
19:57:13.373 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:13.373 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:13.373 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-key, 0)
19:57:13.373 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-key, 0)
19:57:13.553 [pool-7-thread-1] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:57:13.553 [pool-7-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-key, 1)
19:57:13.553 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:57:13.553 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:13.553 [pool-7-thread-3] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:57:13.553 [pool-7-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-key, 3)
19:57:13.553 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=2)
19:57:13.553 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=2)
19:57:13.553 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.553 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=2)
19:57:13.553 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:57:13.553 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:57:13.553 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
19:57:13.553 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
19:57:13.553 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
19:57:13.553 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.553 [pool-7-thread-2] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:57:13.554 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
19:57:13.554 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 3
19:57:13.554 [pool-7-thread-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-key, 2)
19:57:13.554 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:57:13.554 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:57:13.554 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 3
19:57:13.554 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 3
19:57:13.554 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:57:13.554 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
19:57:13.554 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 3
19:57:13.554 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:13.554 [pool-7-thread-4] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:57:13.554 [pool-7-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-key, 4)
19:57:13.554 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=4)
19:57:13.554 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=4)
19:57:13.554 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.554 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:57:13.554 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
19:57:13.554 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:13.554 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-key, 1)
19:57:13.554 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=4)
19:57:13.554 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
19:57:13.554 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-key, 3)
19:57:13.554 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.554 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
19:57:13.554 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
19:57:13.554 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 5
19:57:13.554 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
19:57:13.554 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
19:57:13.554 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-key, 2)
19:57:13.554 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
19:57:13.554 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-key, 1)
19:57:13.554 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-key, 4)
19:57:13.554 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-key, 3)
19:57:13.554 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:57:13.554 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:57:13.554 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-key, 1)
19:57:13.554 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
19:57:13.554 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-key, 3)
19:57:13.570 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:57:13.570 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-key, 2)
19:57:13.570 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:57:13.570 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-key, 2)
19:57:13.570 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-key, 4)
19:57:13.571 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-key, 4)
19:57:13.609 [pool-7-thread-4] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:57:13.609 [pool-7-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-key, 5)
19:57:13.609 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
19:57:13.609 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:13.610 [pool-7-thread-1] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:57:13.610 [pool-7-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-key, 6)
19:57:13.610 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=6)
19:57:13.610 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.610 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
19:57:13.610 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=6)
19:57:13.610 [pool-7-thread-3] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:57:13.610 [pool-7-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-key, 7)
19:57:13.610 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=6)
19:57:13.610 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:57:13.610 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=6)
19:57:13.610 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:57:13.610 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=6)
19:57:13.610 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:57:13.610 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
19:57:13.610 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 7
19:57:13.610 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
19:57:13.610 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
19:57:13.610 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:57:13.610 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
19:57:13.610 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
19:57:13.610 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
19:57:13.610 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
19:57:13.610 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
19:57:13.610 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
19:57:13.610 [pool-7-thread-2] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:57:13.610 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.610 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 8
19:57:13.610 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
19:57:13.610 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
19:57:13.610 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:57:13.610 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
19:57:13.610 [pool-7-thread-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-key, 8)
19:57:13.610 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-key, 5)
19:57:13.610 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:57:13.610 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
19:57:13.610 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-key, 6)
19:57:13.610 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:13.610 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
19:57:13.610 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.610 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:57:13.610 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:57:13.610 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
19:57:13.610 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:57:13.610 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:13.610 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-key, 5)
19:57:13.611 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.611 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:57:13.611 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:57:13.610 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-key, 7)
19:57:13.611 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-key, 6)
19:57:13.611 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
19:57:13.611 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-key, 5)
19:57:13.611 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-key, 7)
19:57:13.611 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-key, 8)
19:57:13.611 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-key, 6)
19:57:13.611 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-key, 7)
19:57:13.619 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:57:13.619 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:57:13.619 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-key, 8)
19:57:13.619 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-key, 8)
19:57:13.661 [pool-7-thread-2] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:57:13.662 [pool-7-thread-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-key, 9)
19:57:13.662 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
19:57:13.662 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:13.662 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
19:57:13.662 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.663 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:57:13.663 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:13.663 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
19:57:13.663 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:57:13.663 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-key, 9)
19:57:13.663 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.663 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:57:13.663 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
19:57:13.665 [pool-7-thread-4] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:57:13.665 [pool-7-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-key, 10)
19:57:13.665 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=11)
19:57:13.665 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
19:57:13.665 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:57:13.665 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:57:13.665 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.666 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.666 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
19:57:13.666 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
19:57:13.666 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:57:13.666 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:57:13.666 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
19:57:13.666 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
19:57:13.666 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:57:13.666 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-key, 9)
19:57:13.666 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:57:13.666 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-key, 9)
19:57:13.666 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-key, 10)
19:57:13.668 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:57:13.668 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:57:13.669 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-key, 10)
19:57:13.669 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-key, 10)
19:57:13.686 [pool-7-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
19:57:13.686 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:13.686 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
19:57:13.689 [pool-7-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
19:57:13.690 [] [node-3] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 2/2 peer responses
19:57:13.690 [] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
19:57:13.711 [pool-7-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
19:57:13.711 [pool-7-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
19:57:13.712 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:13.712 [] [node-3] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:13.712 [] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
19:57:13.712 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
19:57:13.737 [pool-7-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
19:57:13.737 [pool-7-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
19:57:13.737 [] [node-3] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:13.737 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:13.737 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
19:57:13.737 [] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
19:57:13.740 [pool-7-thread-2] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
19:57:13.740 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:13.740 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
19:57:13.745 [pool-7-thread-4] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
19:57:13.745 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:13.746 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
19:57:13.762 [pool-7-thread-3] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
19:57:13.762 [pool-7-thread-1] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
19:57:13.762 [] [node-3] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:13.762 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:13.762 [] [node-3] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
19:57:13.762 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
19:57:13.762 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=11
19:57:13.762 [] [node-2] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:13.762 [] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=concurrent-key, found=true
19:57:13.763 [main] [node-1] INFO  c.r.integration.LinearizableReadTest - ✓ Concurrent writes and linearizable reads completed successfully
19:57:13.763 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:13.763 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:13.763 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:13.763 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:13.763 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:13.763 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:13.763 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:13.763 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:13.763 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:13.763 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:13.763 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:13.763 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:13.763 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:13.763 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:13.763 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:13.765 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:13.765 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-18115665918952020015
19:57:13.765 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-18115665918952020015
19:57:13.765 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:13.765 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:13.765 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:13.765 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:13.765 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:13.765 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:13.766 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-18115665918952020015
19:57:13.766 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-18115665918952020015
19:57:13.766 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:13.766 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:13.766 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:13.766 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:13.766 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-212738004711506880550
19:57:13.766 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-212738004711506880550
19:57:13.766 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:13.766 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:13.766 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:13.766 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:13.766 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:13.766 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:13.766 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-212738004711506880550
19:57:13.766 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-212738004711506880550
19:57:13.766 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:13.766 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:13.766 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:13.766 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:13.766 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312960927107513605924
19:57:13.766 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312960927107513605924
19:57:13.766 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:13.766 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:13.766 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:13.766 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:13.766 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:13.766 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:13.766 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312960927107513605924
19:57:13.766 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-312960927107513605924
19:57:13.766 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:57:13.766 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:13.766 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:13.909 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:13.909 [election-node-2] [node-2] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: /var/folders/rz/y2_nybls1bgbgq1_1hm4q5ym0000gn/T/raft-test-node-216403422142559744177/meta.dat.tmp
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:213)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:244)
	at java.base/java.nio.file.spi.FileSystemProvider.newOutputStream(FileSystemProvider.java:426)
	at java.base/java.nio.file.Files.newOutputStream(Files.java:215)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:89)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:219)
	at com.raftdb.core.RaftState.persist(RaftState.java:85)
	at com.raftdb.core.RaftState.incrementTerm(RaftState.java:136)
	at com.raftdb.election.ElectionManager.startElection(ElectionManager.java:147)
	at com.raftdb.election.ElectionManager.onElectionTimeout(ElectionManager.java:139)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:545)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:309)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
19:57:13.953 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:13.954 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:13.954 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:13.954 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:13.954 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:13.954 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
19:57:13.954 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
19:57:13.954 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:13.954 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:13.954 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:13.955 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:57:13.955 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:13.955 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:13.955 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:13.955 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:13.955 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:57:13.955 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:13.955 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:13.955 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:13.955 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:13.955 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:57:13.955 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:13.955 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:57:13.984 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:57:13.984 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(compare-key, latest-value)
19:57:13.984 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:57:13.985 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:57:13.985 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:57:13.985 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:57:13.985 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.985 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:13.985 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:57:13.985 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:57:13.985 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:57:13.985 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:57:13.985 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:13.985 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:57:13.985 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(compare-key, latest-value)
19:57:14.006 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:14.006 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:57:14.007 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(compare-key, latest-value)
19:57:14.007 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(compare-key, latest-value)
19:57:14.190 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Linearizable read starting, readIndex=1
19:57:14.190 [] [node-1] DEBUG c.r.replication.ReplicationManager - Leadership confirmed with 1/2 peer responses
19:57:14.190 [] [node-1] DEBUG com.raftdb.core.RaftNode - Linearizable read completed, key=compare-key, found=true
19:57:14.190 [main] [node-2] INFO  c.r.integration.LinearizableReadTest - ✓ Both stale and linearizable reads returned correct value
19:57:14.190 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:14.191 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.191 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:14.191 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:14.191 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:14.191 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:14.191 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.191 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:14.191 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:14.191 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:14.191 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:14.191 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.191 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:14.191 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:14.191 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:14.194 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:14.194 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:14.194 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:14.194 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:14.194 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:14.194 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:14.194 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:14.194 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:14.194 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:14.194 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:14.194 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:14.194 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:14.194 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:14.194 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:14.194 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:14.397 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:14.397 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:14.397 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:14.397 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:57:14.397 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:14.397 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.397 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:14.397 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:57:14.397 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:14.397 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.397 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:57:14.397 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:57:14.397 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:14.397 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:14.397 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:14.397 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:57:14.397 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:14.400 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-1 (term 1)
19:57:14.611 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - All nodes agree on leader: node-1
19:57:14.611 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:14.611 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.611 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:14.611 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:14.611 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:14.611 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:14.611 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.611 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:14.611 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:14.611 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:14.611 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:14.611 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.611 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:14.611 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:14.611 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:14.613 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:14.613 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:14.613 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:14.613 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:14.613 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:14.613 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:14.613 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:14.613 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:14.613 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:14.613 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:14.613 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:14.613 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:14.613 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:14.613 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:14.613 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:14.613 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
19:57:14.613 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
19:57:14.613 [main] [node-4] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-4
19:57:14.613 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:14.613 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 initialized as FOLLOWER
19:57:14.613 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
19:57:14.613 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
19:57:14.613 [main] [node-5] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-5
19:57:14.613 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:14.613 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 initialized as FOLLOWER
19:57:14.775 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:14.775 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:14.775 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
19:57:14.775 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:57:14.775 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:14.775 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 VoteRequest(term=1)
19:57:14.775 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 VoteRequest(term=1)
19:57:14.775 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:57:14.775 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:14.775 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.775 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:14.775 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:14.775 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:57:14.775 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.775 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.775 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.775 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:57:14.775 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:57:14.775 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:57:14.775 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-4 VoteResponse(granted=true)
19:57:14.775 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:57:14.775 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:57:14.775 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-5 VoteResponse(granted=true)
19:57:14.775 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
19:57:14.776 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
19:57:14.776 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:14.776 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:14.776 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:14.821 [main] [node-5] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-3 (term 1)
19:57:14.821 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:14.821 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.821 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:14.821 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:14.821 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:14.821 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:14.821 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.821 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:14.821 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:14.821 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:14.821 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:14.821 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.821 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:14.821 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:14.821 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:14.821 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
19:57:14.821 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.821 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:14.821 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
19:57:14.821 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
19:57:14.821 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
19:57:14.821 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:14.821 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:14.821 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
19:57:14.821 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
19:57:14.822 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:14.822 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:14.822 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:14.822 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:14.822 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:14.822 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:14.822 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:14.822 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:14.822 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:14.822 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:14.823 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:14.823 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:14.823 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:14.823 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:14.823 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:15.026 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:15.026 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:15.026 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:15.026 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
19:57:15.026 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
19:57:15.026 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:15.026 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:15.026 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:15.026 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:15.026 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:15.026 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:57:15.026 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:57:15.026 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:57:15.026 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:15.026 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:15.026 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:15.026 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:15.532 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader node-2 maintained leadership for 500ms
19:57:15.532 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:15.532 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:15.532 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:15.532 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:15.532 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:15.533 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:15.533 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:15.533 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:15.533 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:15.533 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:57:15.533 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:15.533 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:15.533 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:15.533 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:15.533 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:15.534 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:57:15.534 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:57:15.534 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
19:57:15.534 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:15.535 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
19:57:15.535 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:57:15.535 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:57:15.535 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
19:57:15.535 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:15.535 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
19:57:15.535 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:57:15.535 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:57:15.535 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
19:57:15.535 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:57:15.535 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
19:57:15.697 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:15.697 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:57:15.697 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:15.697 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:57:15.697 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:57:15.697 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:15.697 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:15.697 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:15.697 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:15.697 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:57:15.697 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:57:15.697 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:15.697 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:57:15.697 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:57:15.697 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:57:15.697 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:57:15.697 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:15.741 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Initial leader: node-3 (term 1)
19:57:15.741 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:57:15.741 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:15.741 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:15.741 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:57:15.741 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:57:15.906 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:57:15.906 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:57:15.906 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:57:15.906 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=2)
19:57:15.906 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:57:15.906 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
19:57:15.906 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:15.906 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
19:57:15.906 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:57:15.906 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:57:15.906 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:57:15.906 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:57:15.906 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:57:15.952 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - New leader: node-2 (term 2)
19:57:15.952 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:57:15.952 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:15.952 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:15.952 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:57:15.952 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:57:15.952 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:57:15.952 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:57:15.952 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:57:15.952 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:57:15.953 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped

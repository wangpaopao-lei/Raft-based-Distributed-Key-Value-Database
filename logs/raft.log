15:22:59.847 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:22:59.849 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:22:59.849 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:22:59.850 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:22:59.850 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:22:59.850 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:22:59.850 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:22:59.850 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:22:59.850 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:22:59.850 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:22:59.850 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:22:59.850 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:23:00.046 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:23:00.047 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:23:00.057 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:23:00.058 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:23:00.058 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:23:00.058 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:23:00.062 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
15:23:00.062 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:23:00.062 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
15:23:00.062 [] [node-1] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.062 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:23:00.063 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
15:23:00.063 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
15:23:00.063 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
15:23:00.063 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
15:23:00.063 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
15:23:00.063 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
15:23:00.063 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=false)
15:23:00.063 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=false)
15:23:00.063 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=false)
15:23:00.063 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:23:00.064 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:23:00.064 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:23:00.064 [] [node-3] INFO  c.r.replication.HeartbeatManager - HeartbeatManager started
15:23:00.190 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-3 (term 1)
15:23:00.402 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - All nodes agree on leader: node-3
15:23:00.408 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:23:00.409 [main] [node-1] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.409 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:00.409 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:23:00.409 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:23:00.409 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:23:00.409 [main] [node-2] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.410 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:00.410 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:23:00.410 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:23:00.410 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:23:00.410 [main] [node-3] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.410 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:00.410 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:23:00.411 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:23:00.420 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:23:00.421 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:23:00.421 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:23:00.421 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:23:00.421 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:23:00.421 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:23:00.421 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:23:00.421 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:23:00.422 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:23:00.422 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:23:00.422 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:23:00.422 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:23:00.422 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
15:23:00.423 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
15:23:00.423 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:23:00.423 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
15:23:00.423 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
15:23:00.423 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
15:23:00.423 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:23:00.423 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
15:23:00.591 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:23:00.592 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:23:00.592 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
15:23:00.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
15:23:00.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
15:23:00.592 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:23:00.592 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:23:00.592 [] [node-1] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.592 [] [node-2] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.592 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:23:00.592 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:23:00.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 VoteRequest(term=1)
15:23:00.592 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
15:23:00.592 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:23:00.592 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
15:23:00.592 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
15:23:00.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 VoteRequest(term=1)
15:23:00.592 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
15:23:00.592 [] [node-4] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.593 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:23:00.593 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:23:00.593 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:23:00.593 [] [node-5] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.593 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-4 VoteResponse(granted=true)
15:23:00.593 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:23:00.593 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
15:23:00.593 [] [node-3] INFO  c.r.replication.HeartbeatManager - HeartbeatManager started
15:23:00.593 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-5 VoteResponse(granted=true)
15:23:00.634 [main] [node-5] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-3 (term 1)
15:23:00.635 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:23:00.635 [main] [node-1] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.635 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:00.635 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:23:00.635 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:23:00.635 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:23:00.635 [main] [node-2] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.635 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:00.635 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:23:00.635 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:23:00.635 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:23:00.636 [main] [node-3] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.636 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:00.636 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:23:00.636 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:23:00.636 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
15:23:00.636 [main] [node-4] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.636 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:00.636 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
15:23:00.636 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
15:23:00.636 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
15:23:00.636 [main] [node-5] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.636 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:00.636 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
15:23:00.636 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
15:23:00.639 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:23:00.639 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:23:00.639 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:23:00.639 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:23:00.639 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:23:00.639 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:23:00.639 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:23:00.639 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:23:00.639 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:23:00.639 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:23:00.639 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:23:00.640 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:23:00.803 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:23:00.804 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:23:00.804 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:23:00.804 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
15:23:00.804 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
15:23:00.804 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:23:00.805 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:23:00.805 [] [node-2] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.805 [] [node-3] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:00.805 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
15:23:00.805 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
15:23:00.805 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
15:23:00.805 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
15:23:00.805 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:23:00.805 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:23:00.805 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:23:00.805 [] [node-1] INFO  c.r.replication.HeartbeatManager - HeartbeatManager started
15:23:01.356 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader node-1 maintained leadership for 500ms
15:23:01.356 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:23:01.357 [main] [node-1] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:01.357 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:01.357 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:23:01.357 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:23:01.357 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:23:01.357 [main] [node-2] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:01.357 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:01.357 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:23:01.357 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:23:01.357 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:23:01.357 [main] [node-3] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:01.358 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:01.358 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:23:01.358 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
15:23:01.361 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
15:23:01.361 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
15:23:01.361 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:23:01.362 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
15:23:01.362 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
15:23:01.362 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
15:23:01.362 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:23:01.362 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
15:23:01.363 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
15:23:01.363 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
15:23:01.363 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
15:23:01.363 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
15:23:01.523 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:23:01.523 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
15:23:01.523 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:23:01.523 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
15:23:01.523 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:23:01.523 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
15:23:01.523 [] [node-3] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:01.523 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:23:01.523 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
15:23:01.524 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
15:23:01.524 [] [node-1] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:01.524 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:23:01.524 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
15:23:01.524 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
15:23:01.524 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
15:23:01.524 [] [node-2] INFO  c.r.replication.HeartbeatManager - HeartbeatManager started
15:23:01.524 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
15:23:01.574 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Initial leader: node-2 (term 1)
15:23:01.574 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
15:23:01.574 [main] [node-2] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:01.574 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:01.575 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
15:23:01.575 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
15:23:01.757 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
15:23:01.757 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
15:23:01.757 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
15:23:01.757 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=2)
15:23:01.758 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
15:23:01.758 [] [node-1] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:01.758 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
15:23:01.758 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
15:23:01.758 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
15:23:01.758 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
15:23:01.758 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
15:23:01.758 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
15:23:01.758 [] [node-3] INFO  c.r.replication.HeartbeatManager - HeartbeatManager started
15:23:01.782 [main] [node-2] INFO  com.raftdb.integration.ClusterTest - New leader: node-3 (term 2)
15:23:01.784 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
15:23:01.784 [main] [node-1] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:01.784 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:01.784 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
15:23:01.784 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
15:23:01.784 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
15:23:01.784 [main] [node-3] INFO  c.r.replication.HeartbeatManager - HeartbeatManager stopped
15:23:01.784 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
15:23:01.784 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
15:23:01.784 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:59:55.969 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:59:55.971 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:59:55.972 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:55.972 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:59:55.972 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:59:55.972 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:59:55.972 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:55.972 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:59:55.972 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:59:55.972 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:59:55.972 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:55.973 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:59:56.138 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:59:56.139 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:59:56.145 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:59:56.149 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:59:56.149 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:56.149 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.149 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:59:56.149 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:59:56.149 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:56.149 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:59:56.150 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.150 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:59:56.150 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:59:56.150 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:59:56.150 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:59:56.150 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:59:56.150 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:59:56.192 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:59:56.192 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key3, value3)
19:59:56.196 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:59:56.196 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:59:56.196 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:56.196 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:56.196 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:56.196 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:56.196 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:59:56.196 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:59:56.197 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:59:56.197 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:59:56.197 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
19:59:56.204 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:56.204 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:56.205 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
19:59:56.205 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
19:59:56.216 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:59:56.216 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(key3)
19:59:56.217 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:59:56.217 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:59:56.217 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:56.217 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:56.217 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:59:56.217 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:59:56.217 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:59:56.217 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:59:56.217 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:59:56.217 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:59:56.217 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
19:59:56.256 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:59:56.256 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:59:56.257 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
19:59:56.257 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
19:59:56.326 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:59:56.327 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.327 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:56.327 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:59:56.327 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:59:56.327 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:59:56.327 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.327 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:56.327 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:59:56.327 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:59:56.327 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:59:56.327 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.328 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:56.328 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:59:56.328 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:59:56.333 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:59:56.333 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:59:56.333 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:56.333 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:59:56.333 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:59:56.333 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:59:56.333 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:56.333 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:59:56.334 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:59:56.334 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:59:56.334 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:56.334 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:59:56.499 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:59:56.500 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:59:56.500 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:59:56.500 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:59:56.500 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:59:56.500 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:56.500 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:56.500 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.500 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.500 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:59:56.500 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:59:56.500 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:59:56.500 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:59:56.500 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:59:56.500 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:59:56.500 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:59:56.501 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:59:56.544 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:59:56.544 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-0, value-0)
19:59:56.544 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:59:56.544 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:59:56.544 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-1, value-1)
19:59:56.544 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=1)
19:59:56.544 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:56.544 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
19:59:56.544 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=1)
19:59:56.544 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
19:59:56.544 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:59:56.545 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
19:59:56.545 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
19:59:56.544 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:56.545 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=1)
19:59:56.545 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:59:56.545 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:59:56.545 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-2, value-2)
19:59:56.545 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
19:59:56.545 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
19:59:56.545 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
19:59:56.545 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
19:59:56.545 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:59:56.545 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:59:56.545 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-3, value-3)
19:59:56.545 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=3)
19:59:56.545 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:59:56.545 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
19:59:56.545 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
19:59:56.545 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=3)
19:59:56.545 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-4, value-4)
19:59:56.545 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=4)
19:59:56.545 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:59:56.545 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:59:56.546 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:59:56.545 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
19:59:56.545 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=4)
19:59:56.546 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-5, value-5)
19:59:56.546 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=3)
19:59:56.546 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 5
19:59:56.546 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:59:56.546 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
19:59:56.546 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
19:59:56.545 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 4
19:59:56.546 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
19:59:56.546 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
19:59:56.546 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:59:56.546 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
19:59:56.546 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=3)
19:59:56.546 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
19:59:56.546 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-6, value-6)
19:59:56.546 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=4)
19:59:56.546 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 5
19:59:56.546 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
19:59:56.546 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
19:59:56.546 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:59:56.546 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
19:59:56.546 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:59:56.546 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 5
19:59:56.546 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=4)
19:59:56.546 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 6
19:59:56.546 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
19:59:56.546 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:59:56.546 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
19:59:56.547 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:59:56.546 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:59:56.547 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
19:59:56.546 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=6)
19:59:56.546 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
19:59:56.547 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
19:59:56.546 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:59:56.546 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
19:59:56.547 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
19:59:56.547 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:59:56.547 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 6
19:59:56.547 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-7, value-7)
19:59:56.547 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
19:59:56.547 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 7
19:59:56.547 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=6)
19:59:56.547 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:59:56.547 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 7
19:59:56.547 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:59:56.547 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:59:56.547 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=7)
19:59:56.547 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-8, value-8)
19:59:56.547 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 7
19:59:56.547 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:59:56.547 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:59:56.547 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
19:59:56.547 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
19:59:56.548 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
19:59:56.547 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
19:59:56.547 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=8)
19:59:56.548 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
19:59:56.548 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
19:59:56.548 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:59:56.548 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=7)
19:59:56.548 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
19:59:56.548 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:59:56.548 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
19:59:56.548 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
19:59:56.548 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
19:59:56.548 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
19:59:56.548 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
19:59:56.548 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 8
19:59:56.548 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:59:56.548 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-9, value-9)
19:59:56.548 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
19:59:56.548 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=8)
19:59:56.548 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
19:59:56.548 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:59:56.548 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 9
19:59:56.549 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
19:59:56.548 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
19:59:56.548 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
19:59:56.549 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 10
19:59:56.548 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 9
19:59:56.548 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:59:56.549 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
19:59:56.549 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
19:59:56.549 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:59:56.549 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 10
19:59:56.549 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
19:59:56.549 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
19:59:56.549 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
19:59:56.549 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=10)
19:59:56.549 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
19:59:56.549 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
19:59:56.549 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:59:56.549 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
19:59:56.549 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:59:56.549 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 11
19:59:56.549 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
19:59:56.549 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:59:56.549 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=10)
19:59:56.549 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
19:59:56.549 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=11)
19:59:56.549 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:59:56.549 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
19:59:56.549 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
19:59:56.549 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
19:59:56.549 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=11)
19:59:56.549 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
19:59:56.549 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=12)
19:59:56.549 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
19:59:56.549 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=10)
19:59:56.549 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
19:59:56.550 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
19:59:56.549 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:59:56.550 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
19:59:56.549 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:59:56.550 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
19:59:56.550 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
19:59:56.550 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-13, value-13)
19:59:56.550 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 12
19:59:56.550 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:59:56.550 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=11)
19:59:56.550 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:59:56.550 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
19:59:56.550 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
19:59:56.550 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:59:56.550 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 13
19:59:56.550 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 13
19:59:56.550 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
19:59:56.550 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=13
19:59:56.550 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
19:59:56.550 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 13
19:59:56.550 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 13
19:59:56.550 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=11)
19:59:56.550 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:59:56.550 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
19:59:56.550 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-14, value-14)
19:59:56.550 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:59:56.550 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
19:59:56.550 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=12)
19:59:56.550 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
19:59:56.550 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
19:59:56.550 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
19:59:56.550 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
19:59:56.550 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
19:59:56.551 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
19:59:56.551 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 14
19:59:56.551 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
19:59:56.551 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
19:59:56.551 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=14)
19:59:56.551 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=14)
19:59:56.551 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
19:59:56.551 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 14
19:59:56.551 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
19:59:56.551 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
19:59:56.551 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
19:59:56.551 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
19:59:56.551 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
19:59:56.551 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=16
19:59:56.551 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:59:56.551 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:59:56.551 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=14)
19:59:56.551 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 15
19:59:56.551 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
19:59:56.551 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
19:59:56.551 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
19:59:56.551 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:59:56.551 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=14)
19:59:56.551 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:59:56.551 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=14)
19:59:56.551 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 16
19:59:56.551 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 16
19:59:56.551 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=17)
19:59:56.551 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-16, value-16)
19:59:56.551 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
19:59:56.551 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
19:59:56.551 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 16
19:59:56.552 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
19:59:56.551 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:59:56.551 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
19:59:56.551 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
19:59:56.552 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 17
19:59:56.552 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:56.552 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 17
19:59:56.552 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
19:59:56.552 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
19:59:56.552 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=15)
19:59:56.552 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
19:59:56.552 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:59:56.552 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
19:59:56.552 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
19:59:56.552 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:59:56.552 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-17, value-17)
19:59:56.552 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=17)
19:59:56.552 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
19:59:56.552 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
19:59:56.552 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:59:56.552 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=17
19:59:56.552 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:59:56.552 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
19:59:56.552 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
19:59:56.552 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-18, value-18)
19:59:56.552 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=18)
19:59:56.552 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=18)
19:59:56.552 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 18
19:59:56.552 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
19:59:56.552 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
19:59:56.552 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 19
19:59:56.552 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 17
19:59:56.552 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
19:59:56.552 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=18)
19:59:56.553 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-19, value-19)
19:59:56.553 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=18)
19:59:56.552 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:59:56.552 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 19
19:59:56.553 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=18)
19:59:56.553 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
19:59:56.553 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
19:59:56.553 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
19:59:56.553 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=18
19:59:56.553 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
19:59:56.553 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 19
19:59:56.553 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
19:59:56.553 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
19:59:56.553 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
19:59:56.553 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
19:59:56.553 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=18)
19:59:56.553 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=19
19:59:56.553 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
19:59:56.553 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
19:59:56.553 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
19:59:56.553 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 19
19:59:56.553 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 19
19:59:56.553 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
19:59:56.553 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
19:59:56.553 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
19:59:56.553 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
19:59:56.553 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
19:59:56.553 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
19:59:56.553 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
19:59:56.553 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:56.553 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
19:59:56.553 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
19:59:56.553 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
19:59:56.553 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
19:59:56.554 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
19:59:56.554 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
19:59:56.554 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
19:59:56.554 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
19:59:56.554 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
19:59:56.554 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
19:59:56.554 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
19:59:56.606 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:59:56.606 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:59:56.606 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
19:59:56.606 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
19:59:56.607 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
19:59:56.607 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
19:59:56.656 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:59:56.656 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.656 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:56.656 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:59:56.656 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:59:56.656 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:59:56.656 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.656 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:56.656 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:59:56.656 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:59:56.656 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:59:56.656 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.656 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:56.657 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:59:56.657 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:59:56.658 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:59:56.659 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:59:56.659 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:56.659 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:59:56.659 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:59:56.659 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:59:56.659 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:56.660 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:59:56.660 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:59:56.660 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:59:56.660 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:56.660 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:59:56.839 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:59:56.839 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:59:56.839 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:59:56.840 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:59:56.840 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:59:56.840 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:56.840 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:56.840 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.840 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.840 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:59:56.840 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:59:56.840 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:59:56.840 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:59:56.840 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:59:56.840 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:59:56.840 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:59:56.840 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:59:56.871 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:59:56.872 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key2, value2)
19:59:56.872 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:59:56.872 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:59:56.872 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:59:56.872 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:59:56.872 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:56.873 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:59:56.873 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:56.873 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:59:56.873 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:59:56.873 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
19:59:56.895 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:56.895 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:56.895 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
19:59:56.895 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
19:59:56.980 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:59:56.980 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.981 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:56.981 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:59:56.981 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:59:56.981 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:59:56.981 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.981 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:56.981 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:59:56.981 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:59:56.981 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:59:56.981 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:56.981 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:56.982 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:59:56.982 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:59:56.984 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:59:56.984 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:59:56.984 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:56.984 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:59:56.984 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:59:56.984 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:59:56.984 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:56.984 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:59:56.984 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:59:56.985 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:59:56.985 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:56.985 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:59:57.153 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:59:57.153 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:59:57.153 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:59:57.154 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:59:57.153 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:59:57.154 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:59:57.155 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
19:59:57.155 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
19:59:57.155 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=false)
19:59:57.155 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
19:59:57.156 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:57.156 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:57.156 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:59:57.156 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:59:57.156 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:59:57.156 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:59:57.156 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:59:57.156 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:59:57.157 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:59:57.157 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:59:57.157 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=false)
19:59:57.157 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:59:57.157 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:59:57.157 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=false)
19:59:57.195 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:59:57.195 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
19:59:57.196 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:59:57.197 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:59:57.197 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:59:57.197 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:57.197 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:59:57.197 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:59:57.198 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:59:57.198 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:57.198 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:59:57.199 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:59:57.209 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:57.209 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:57.211 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:59:57.211 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:59:57.305 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - Killing leader: node-2
19:59:57.305 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:59:57.306 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:57.306 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:57.306 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:59:57.306 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:59:57.433 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:59:57.433 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:59:57.434 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:59:57.435 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=2)
19:59:57.435 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:57.435 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:57.435 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
19:59:57.436 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:59:57.436 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:59:57.436 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:59:57.436 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:59:57.436 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:59:57.438 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
19:59:57.514 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - New leader: node-3
19:59:57.516 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
19:59:57.516 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
19:59:57.516 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:59:57.516 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:59:57.517 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=2, entries=1)
19:59:57.517 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:59:57.517 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:59:57.517 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:59:57.517 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:59:57.541 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:59:57.541 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:59:57.542 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:59:57.591 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:59:57.625 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:59:57.626 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:57.626 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:57.626 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:59:57.626 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:59:57.626 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:59:57.626 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:57.626 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:57.627 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:59:57.627 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:59:57.630 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:59:57.631 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:59:57.631 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:57.631 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:59:57.631 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:59:57.631 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:59:57.631 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:57.631 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:59:57.631 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:59:57.631 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:59:57.631 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:57.631 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:59:57.832 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:59:57.833 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:59:57.834 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:59:57.836 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:59:57.836 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:57.836 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:57.836 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:59:57.836 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:59:57.836 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:59:57.836 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:59:57.836 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:59:57.836 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:59:57.837 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:57.837 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:57.838 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:59:57.838 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:59:57.838 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:59:57.841 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:59:57.841 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
19:59:57.841 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:59:57.841 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:59:57.841 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:57.841 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:57.841 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:57.842 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:57.842 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:59:57.842 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:59:57.842 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:59:57.842 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:59:57.842 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:59:57.842 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:59:57.842 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
19:59:57.843 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:59:57.843 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:59:57.843 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:57.843 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:57.843 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:59:57.843 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:57.843 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:59:57.843 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:57.843 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:59:57.843 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:59:57.843 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:59:57.843 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:59:57.843 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:59:57.843 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:59:57.844 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:59:57.844 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
19:59:57.844 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
19:59:57.844 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
19:59:57.844 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:57.844 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:57.844 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:59:57.845 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:59:57.845 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:59:57.845 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:59:57.845 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:59:57.845 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:59:57.845 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:59:57.845 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:59:57.845 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:59:57.845 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:59:57.845 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:59:57.845 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
19:59:57.845 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
19:59:57.846 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
19:59:57.846 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:57.846 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:57.846 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:59:57.846 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:59:57.846 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:59:57.846 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:59:57.846 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
19:59:57.846 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:59:57.846 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:59:57.846 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:59:57.846 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
19:59:57.846 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:59:57.846 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:59:57.846 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
19:59:57.847 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
19:59:57.847 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
19:59:57.847 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:57.847 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:57.847 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:59:57.847 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:59:57.847 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:59:57.847 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
19:59:57.847 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:59:57.847 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:59:57.847 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:59:57.847 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:59:57.847 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:59:57.847 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:59:57.847 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:59:57.847 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
19:59:57.847 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
19:59:57.848 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
19:59:57.848 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:57.848 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:57.848 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:59:57.848 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:59:57.848 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:59:57.848 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:59:57.848 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:59:57.848 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:59:57.848 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:59:57.848 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
19:59:57.848 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:59:57.848 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:59:57.848 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:59:57.848 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
19:59:57.848 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
19:59:57.848 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
19:59:57.848 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:57.849 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:57.849 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:59:57.849 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:59:57.849 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:59:57.849 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
19:59:57.849 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:59:57.849 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:59:57.849 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:59:57.849 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
19:59:57.849 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:59:57.849 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:59:57.849 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:59:57.849 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
19:59:57.849 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
19:59:57.849 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
19:59:57.849 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:57.849 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:57.849 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:59:57.849 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:59:57.849 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:59:57.850 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:59:57.850 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:59:57.850 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
19:59:57.850 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
19:59:57.850 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:59:57.850 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:59:57.850 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:59:57.850 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:59:57.850 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:59:57.850 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
19:59:57.850 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
19:59:57.850 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
19:59:57.850 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:57.850 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:57.850 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:59:57.850 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:59:57.851 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:59:57.851 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
19:59:57.851 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:59:57.851 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:59:57.851 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
19:59:57.851 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:59:57.851 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:59:57.851 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:59:57.851 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:59:57.851 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:59:57.851 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
19:59:57.851 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
19:59:57.851 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
19:59:57.851 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:57.851 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:57.851 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:59:57.851 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:59:57.851 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:59:57.851 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:59:57.851 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
19:59:57.851 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:59:57.851 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:59:57.851 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
19:59:57.851 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:59:57.852 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:59:57.892 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:59:57.892 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:59:57.892 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:59:57.892 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:59:57.964 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:59:57.964 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:57.965 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:57.965 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:59:57.965 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:59:57.965 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:59:57.965 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:57.965 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:57.965 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:59:57.965 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:59:57.965 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:59:57.965 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:57.966 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:57.966 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:59:57.966 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:59:57.969 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:59:57.969 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:59:57.969 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:57.969 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:59:57.969 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:59:57.969 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:59:57.969 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:57.969 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:59:57.969 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:59:57.969 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:59:57.969 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:57.969 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:59:58.140 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:59:58.140 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:59:58.140 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:59:58.140 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:59:58.140 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:59:58.140 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:58.140 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:58.140 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.140 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.140 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:59:58.140 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:59:58.140 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:59:58.140 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:59:58.140 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:59:58.140 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:59:58.140 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:59:58.140 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:59:58.177 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Leader: node-1
19:59:58.177 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:59:58.177 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
19:59:58.177 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:59:58.177 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:59:58.177 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:59:58.177 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:59:58.177 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:58.177 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:59:58.177 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:58.177 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:59:58.177 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:59:58.178 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:59:58.178 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - PUT committed
19:59:58.194 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:58.194 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:58.194 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:59:58.194 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:59:58.284 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - Data replicated to all nodes
19:59:58.284 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:59:58.284 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.284 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:58.285 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:59:58.285 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:59:58.285 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:59:58.285 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.285 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:58.285 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:59:58.285 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:59:58.285 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:59:58.285 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.285 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:58.285 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:59:58.285 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:59:58.287 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:59:58.287 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:59:58.287 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:58.287 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:59:58.287 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:59:58.287 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:59:58.287 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:58.287 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:59:58.288 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:59:58.288 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:59:58.288 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:58.288 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:59:58.525 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:59:58.526 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:59:58.526 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:59:58.527 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:59:58.527 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:59:58.527 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:58.527 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:58.527 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.527 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.527 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:59:58.527 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:59:58.527 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:59:58.527 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:59:58.527 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:59:58.527 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:59:58.527 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:59:58.530 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:59:58.606 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:59:58.606 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.606 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:58.606 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:59:58.606 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:59:58.606 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:59:58.607 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.607 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:58.607 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:59:58.607 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:59:58.607 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:59:58.607 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.607 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:58.607 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:59:58.607 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:59:58.610 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:59:58.610 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:59:58.610 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:58.610 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:59:58.610 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:59:58.610 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:59:58.610 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:58.610 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:59:58.610 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:59:58.610 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:59:58.610 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:58.610 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:59:58.610 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
19:59:58.610 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
19:59:58.610 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:58.611 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
19:59:58.611 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
19:59:58.611 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
19:59:58.611 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:58.611 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
19:59:58.831 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:59:58.832 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:59:58.832 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
19:59:58.832 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:59:58.832 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:58.832 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:59:58.832 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:58.832 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.832 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 VoteRequest(term=1)
19:59:58.832 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:59:58.833 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:59:58.832 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.832 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:58.833 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:59:58.833 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.833 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:59:58.833 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:59:58.833 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 VoteRequest(term=1)
19:59:58.833 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
19:59:58.833 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-4 VoteResponse(granted=true)
19:59:58.834 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:58.834 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:58.834 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:59:58.834 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-5 VoteResponse(granted=true)
19:59:58.836 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
19:59:58.836 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:59:58.836 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:59:58.836 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:59:58.918 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:59:58.918 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(stable-key, initial)
19:59:58.919 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:59:58.919 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:59:58.919 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:59:58.919 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
19:59:58.919 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
19:59:58.919 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:58.919 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 AppendEntries(term=1, entries=1)
19:59:58.919 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 AppendEntries(term=1, entries=1)
19:59:58.919 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:59:58.919 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:59:58.919 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:58.919 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:58.919 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
19:59:58.919 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
19:59:58.919 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:59:58.919 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:59:58.919 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:59:58.919 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:59:58.920 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:59:58.940 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:58.940 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:58.940 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:58.940 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:59:58.940 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:59:58.940 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:59:58.940 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:59:58.940 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:59:59.026 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:59:59.026 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-0, value-0)
19:59:59.026 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:59:59.026 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:59:59.026 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
19:59:59.026 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:59:59.026 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:59:59.026 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 AppendEntries(term=1, entries=1)
19:59:59.026 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
19:59:59.026 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:59:59.027 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:59:59.026 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:59:59.027 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:59:59.027 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
19:59:59.027 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:59:59.027 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:59:59.027 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 AppendEntries(term=1, entries=1)
19:59:59.027 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:59:59.027 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:59:59.027 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:59:59.027 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:59:59.027 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
19:59:59.027 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-1, value-1)
19:59:59.027 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:59:59.027 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
19:59:59.027 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:59:59.027 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=3)
19:59:59.027 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:59:59.027 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=3)
19:59:59.027 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:59:59.027 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:59:59.027 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:59:59.027 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:59:59.027 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 AppendEntries(term=1, entries=1)
19:59:59.027 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:59:59.027 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:59:59.027 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 AppendEntries(term=1, entries=1)
19:59:59.028 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:59:59.028 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:59:59.028 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:59:59.028 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:59:59.028 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:59:59.027 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:59:59.028 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:59:59.028 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:59:59.028 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:59:59.028 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:59:59.028 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=3
19:59:59.028 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-2, value-2)
19:59:59.028 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=3
19:59:59.028 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:59:59.028 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
19:59:59.028 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
19:59:59.028 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:59:59.028 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=4)
19:59:59.028 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:59:59.028 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=4)
19:59:59.028 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:59:59.028 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 AppendEntries(term=1, entries=1)
19:59:59.028 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:59:59.028 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 AppendEntries(term=1, entries=1)
19:59:59.028 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:59:59.029 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:59:59.029 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:59:59.029 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:59:59.029 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:59:59.029 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
19:59:59.029 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:59:59.029 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:59:59.029 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:59:59.029 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:59:59.029 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:59:59.029 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=4
19:59:59.029 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=4
19:59:59.029 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:59:59.029 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:59:59.029 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:59:59.029 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:59:59.029 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-3, value-3)
19:59:59.029 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
19:59:59.029 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
19:59:59.029 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:59:59.029 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=5)
19:59:59.030 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:59:59.030 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 AppendEntries(term=1, entries=1)
19:59:59.030 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:59:59.030 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=5)
19:59:59.030 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:59:59.030 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:59:59.030 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:59:59.030 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:59:59.030 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:59:59.030 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:59:59.030 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:59:59.030 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
19:59:59.030 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 AppendEntries(term=1, entries=1)
19:59:59.030 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
19:59:59.030 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=5
19:59:59.030 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:59:59.030 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:59:59.030 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:59:59.030 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:59:59.030 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:59:59.030 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:59:59.030 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:59:59.030 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=5
19:59:59.030 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:59:59.030 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:59:59.030 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-4, value-4)
19:59:59.031 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
19:59:59.031 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
19:59:59.031 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:59:59.031 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=6)
19:59:59.031 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:59:59.031 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=6)
19:59:59.031 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 AppendEntries(term=1, entries=1)
19:59:59.031 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 AppendEntries(term=1, entries=1)
19:59:59.031 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:59:59.031 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:59:59.031 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:59:59.031 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:59:59.031 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:59:59.031 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:59:59.031 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:59:59.031 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=6
19:59:59.031 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:59:59.031 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:59:59.031 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:59:59.031 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:59:59.031 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:59:59.031 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:59:59.031 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=6
19:59:59.031 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:59:59.031 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
19:59:59.031 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:59:59.031 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:59:59.038 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:59:59.038 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:59:59.038 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:59:59.038 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:59:59.039 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:59:59.039 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:59:59.039 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:59:59.039 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:59:59.137 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:59:59.137 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.137 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:59.137 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:59:59.137 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:59:59.137 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:59:59.137 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.137 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:59.137 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:59:59.137 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:59:59.137 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:59:59.137 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.138 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:59.138 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:59:59.138 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:59:59.138 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
19:59:59.138 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.138 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:59.138 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
19:59:59.138 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
19:59:59.138 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
19:59:59.138 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.138 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:59.138 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
19:59:59.138 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
19:59:59.143 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:59:59.143 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:59:59.143 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:59.143 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:59:59.143 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:59:59.143 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:59:59.143 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:59.144 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:59:59.144 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:59:59.144 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:59:59.144 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:59.144 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:59:59.372 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:59:59.372 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:59:59.373 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:59:59.373 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:59:59.373 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:59:59.373 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:59.373 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:59.373 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.373 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.373 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:59:59.373 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:59:59.373 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:59:59.373 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:59:59.373 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:59:59.373 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:59:59.373 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:59:59.373 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:59:59.460 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-1 (term 1)
19:59:59.672 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - All nodes agree on leader: node-1
19:59:59.674 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:59:59.674 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.674 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:59.674 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:59:59.674 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:59:59.674 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:59:59.674 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.674 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:59.674 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:59:59.674 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:59:59.674 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:59:59.675 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.675 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:59.675 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:59:59.675 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:59:59.679 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:59:59.679 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:59:59.679 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:59.680 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:59:59.680 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:59:59.680 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:59:59.680 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:59.680 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:59:59.680 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:59:59.680 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:59:59.680 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:59.680 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:59:59.680 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
19:59:59.680 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
19:59:59.680 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:59.680 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
19:59:59.680 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
19:59:59.680 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
19:59:59.680 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:59.681 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
19:59:59.839 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:59:59.840 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:59:59.841 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
19:59:59.841 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:59:59.841 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:59:59.841 [election-node-5] [node-5] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
19:59:59.842 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-1 VoteRequest(term=1)
19:59:59.842 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:59.842 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.842 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
19:59:59.842 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-1 VoteResponse(granted=true)
19:59:59.842 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
19:59:59.842 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-2 VoteRequest(term=1)
19:59:59.842 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:59.842 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.843 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
19:59:59.845 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-2 VoteResponse(granted=true)
19:59:59.845 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
19:59:59.845 [] [node-5] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:59:59.846 [] [node-5] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:59:59.846 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:59:59.846 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:59:59.846 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:59:59.846 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-3 VoteRequest(term=1)
19:59:59.846 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-4 VoteRequest(term=1)
19:59:59.846 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-5 - canVote=false, logUpToDate=true
19:59:59.846 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:59:59.846 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:59:59.846 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.846 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:59:59.846 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 VoteRequest(term=1)
19:59:59.846 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=false)
19:59:59.846 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 VoteRequest(term=1)
19:59:59.846 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:59:59.846 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-3 VoteResponse(granted=false)
19:59:59.846 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:59:59.846 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=false)
19:59:59.846 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-5 VoteResponse(granted=false)
19:59:59.846 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
19:59:59.846 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-4 VoteResponse(granted=false)
19:59:59.847 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-4 VoteResponse(granted=true)
19:59:59.908 [main] [node-5] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-5 (term 1)
19:59:59.908 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:59:59.908 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.908 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:59.908 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:59:59.908 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:59:59.909 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:59:59.909 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.909 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:59.909 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:59:59.909 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:59:59.909 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:59:59.909 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.909 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:59.909 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:59:59.909 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:59:59.909 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
19:59:59.909 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.909 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:59.909 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
19:59:59.909 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
19:59:59.909 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
19:59:59.909 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:59:59.909 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:59:59.909 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
19:59:59.909 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
19:59:59.911 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:59:59.911 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:59:59.911 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:59.911 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:59:59.911 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:59:59.911 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:59:59.911 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:59.912 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:59:59.912 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:59:59.912 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:59:59.912 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:59:59.912 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:00:00.100 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:00:00.101 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:00:00.101 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:00:00.103 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:00:00.103 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:00:00.104 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:00:00.104 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:00:00.104 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:00:00.104 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:00:00.104 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:00:00.104 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:00:00.104 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:00:00.104 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:00:00.104 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:00:00.104 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:00:00.105 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:00:00.105 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:00:00.624 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader node-1 maintained leadership for 500ms
20:00:00.625 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:00:00.625 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:00:00.625 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:00:00.625 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:00:00.625 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:00:00.625 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:00:00.625 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:00:00.625 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:00:00.625 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:00:00.625 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:00:00.625 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:00:00.625 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:00:00.625 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:00:00.625 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:00:00.625 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:00:00.627 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:00:00.627 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:00:00.627 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:00:00.627 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:00:00.627 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:00:00.627 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:00:00.627 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:00:00.628 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:00:00.628 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:00:00.628 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:00:00.628 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:00:00.629 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:00:00.805 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:00:00.805 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:00:00.806 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:00:00.806 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:00:00.806 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:00:00.806 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:00:00.806 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:00:00.806 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:00:00.806 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:00:00.806 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:00:00.806 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:00:00.806 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:00:00.806 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:00:00.806 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:00:00.806 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:00:00.806 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:00:00.806 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:00:00.838 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Initial leader: node-3 (term 1)
20:00:00.838 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:00:00.838 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:00:00.838 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:00:00.838 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:00:00.838 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:00:01.000 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:00:01.001 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:00:01.001 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:00:01.005 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:00:01.005 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=2)
20:00:01.008 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:00:01.008 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:00:01.008 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:00:01.008 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:00:01.008 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:00:01.008 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:00:01.008 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:00:01.008 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:00:01.056 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - New leader: node-2 (term 2)
20:00:01.059 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:00:01.059 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:00:01.059 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:00:01.060 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:00:01.060 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:00:01.060 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:00:01.060 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:00:01.060 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:00:01.060 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:00:01.060 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:48.492 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:48.494 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:48.494 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:48.494 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:48.494 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:48.494 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:48.494 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:48.495 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:48.495 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:48.495 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:48.495 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:48.495 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:48.735 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:48.736 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:48.748 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:48.754 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:12:48.754 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:48.754 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:48.755 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:48.755 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:12:48.756 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:48.756 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:12:48.756 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:48.756 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:48.756 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:48.756 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:12:48.756 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:48.756 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:48.756 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:48.817 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:48.817 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key3, value3)
20:12:48.821 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:48.821 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:48.821 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:48.821 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:48.821 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:48.821 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:48.821 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:48.821 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:48.822 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:48.822 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:48.822 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:12:48.840 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:48.840 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(key3)
20:12:48.840 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:48.841 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:48.841 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:48.841 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:48.841 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:48.841 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:48.841 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:48.841 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:48.841 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:48.841 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:12:48.841 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:12:48.841 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:48.841 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:48.841 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:12:48.841 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:12:48.862 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:48.862 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:48.862 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:12:48.862 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:12:48.951 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:48.951 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:48.951 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:48.951 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:48.951 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:48.951 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:48.951 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:48.952 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:48.952 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:48.952 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:48.952 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:48.952 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:48.952 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:48.952 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:48.952 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:48.957 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:48.958 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:48.958 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:48.958 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:48.958 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:48.958 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:48.958 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:48.958 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:48.958 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:48.958 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:48.958 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:48.958 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:49.123 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:49.124 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:49.124 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:49.124 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:12:49.124 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:12:49.124 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:49.124 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:49.124 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:49.124 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:49.124 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:49.124 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:49.124 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:12:49.124 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:12:49.124 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:49.124 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:49.124 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:49.124 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:49.168 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:49.168 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-0, value-0)
20:12:49.168 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:49.168 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:49.169 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=1)
20:12:49.169 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:49.169 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-1, value-1)
20:12:49.169 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=2)
20:12:49.169 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:49.169 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=1)
20:12:49.169 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:49.169 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:49.169 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
20:12:49.169 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-2, value-2)
20:12:49.169 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=2)
20:12:49.169 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:12:49.169 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
20:12:49.169 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=1)
20:12:49.169 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:12:49.169 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:49.169 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
20:12:49.169 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=3)
20:12:49.169 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=2)
20:12:49.169 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-3, value-3)
20:12:49.169 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:49.169 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
20:12:49.169 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=2)
20:12:49.169 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:49.169 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:12:49.169 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=3)
20:12:49.169 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:12:49.169 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:12:49.170 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 3
20:12:49.170 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=3)
20:12:49.170 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=2)
20:12:49.170 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:12:49.170 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-4, value-4)
20:12:49.170 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:49.170 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:49.170 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:12:49.170 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=4)
20:12:49.170 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:49.170 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 4
20:12:49.170 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=2)
20:12:49.170 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 5
20:12:49.170 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
20:12:49.170 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:12:49.170 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:49.170 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:49.170 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:49.170 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-5, value-5)
20:12:49.170 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:12:49.170 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:12:49.170 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 5
20:12:49.170 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=4)
20:12:49.170 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:12:49.170 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:12:49.170 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-6, value-6)
20:12:49.170 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:12:49.171 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:12:49.170 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:12:49.170 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:49.171 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=4)
20:12:49.171 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 6
20:12:49.171 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=6)
20:12:49.171 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:12:49.171 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:12:49.171 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=4)
20:12:49.171 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=2)
20:12:49.171 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=6)
20:12:49.171 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:12:49.171 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=6)
20:12:49.171 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=2)
20:12:49.171 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=6)
20:12:49.171 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:12:49.171 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=3)
20:12:49.171 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:49.171 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-7, value-7)
20:12:49.171 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 7
20:12:49.171 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:12:49.171 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:12:49.171 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 7
20:12:49.171 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 7
20:12:49.171 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:49.171 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=3)
20:12:49.171 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
20:12:49.171 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
20:12:49.171 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
20:12:49.171 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:49.171 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
20:12:49.171 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:12:49.171 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:12:49.172 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:12:49.171 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
20:12:49.172 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:12:49.172 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 8
20:12:49.172 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-8, value-8)
20:12:49.172 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:12:49.172 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:12:49.172 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=7)
20:12:49.172 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 8
20:12:49.172 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:12:49.172 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:49.172 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 8
20:12:49.172 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 8
20:12:49.172 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=8)
20:12:49.172 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
20:12:49.172 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:12:49.172 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=2)
20:12:49.172 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-9, value-9)
20:12:49.172 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:12:49.172 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=9)
20:12:49.172 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
20:12:49.172 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 9
20:12:49.172 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=2)
20:12:49.172 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:12:49.172 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=9)
20:12:49.172 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 10
20:12:49.172 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:12:49.172 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:12:49.172 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:12:49.172 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:12:49.172 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
20:12:49.172 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:12:49.172 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=10)
20:12:49.172 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=2)
20:12:49.173 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 10
20:12:49.172 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
20:12:49.173 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
20:12:49.172 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:12:49.173 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:12:49.173 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 10
20:12:49.173 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:12:49.173 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=2)
20:12:49.173 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 10
20:12:49.173 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:12:49.173 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:49.173 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
20:12:49.173 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=10)
20:12:49.173 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:12:49.173 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 11
20:12:49.173 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:49.173 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=10)
20:12:49.173 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=11
20:12:49.173 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 12
20:12:49.173 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
20:12:49.173 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:12:49.173 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:12:49.173 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
20:12:49.173 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=11)
20:12:49.173 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:12:49.173 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:12:49.173 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:49.173 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=2)
20:12:49.173 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=11)
20:12:49.173 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=12
20:12:49.174 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 12
20:12:49.173 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:12:49.174 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=3)
20:12:49.173 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
20:12:49.174 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 12
20:12:49.174 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
20:12:49.174 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 12
20:12:49.174 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:12:49.174 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:12:49.174 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:12:49.174 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-13, value-13)
20:12:49.174 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 12
20:12:49.174 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 13
20:12:49.174 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:12:49.174 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:12:49.174 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
20:12:49.174 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-14, value-14)
20:12:49.174 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=13)
20:12:49.174 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
20:12:49.174 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=13)
20:12:49.174 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:49.174 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:12:49.174 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=2)
20:12:49.174 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:12:49.174 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:12:49.174 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
20:12:49.174 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
20:12:49.174 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
20:12:49.174 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
20:12:49.174 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
20:12:49.174 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 15
20:12:49.175 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=14)
20:12:49.175 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=15
20:12:49.175 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:12:49.175 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
20:12:49.175 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=14)
20:12:49.175 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:12:49.174 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=13)
20:12:49.175 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
20:12:49.175 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=16)
20:12:49.175 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:12:49.175 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=14)
20:12:49.175 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=3)
20:12:49.175 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=14)
20:12:49.175 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-16, value-16)
20:12:49.175 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
20:12:49.175 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 15
20:12:49.175 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
20:12:49.175 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=3)
20:12:49.175 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=16)
20:12:49.175 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:12:49.175 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=4)
20:12:49.175 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=2)
20:12:49.175 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=14)
20:12:49.175 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:12:49.175 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 16
20:12:49.175 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 17
20:12:49.175 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=2)
20:12:49.175 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=4)
20:12:49.175 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=4)
20:12:49.175 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:12:49.175 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-17, value-17)
20:12:49.175 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 17
20:12:49.175 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
20:12:49.175 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:12:49.175 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
20:12:49.175 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=16)
20:12:49.175 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:12:49.175 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
20:12:49.176 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:49.175 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=5)
20:12:49.175 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:12:49.176 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 18
20:12:49.176 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 18
20:12:49.175 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=17
20:12:49.175 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 17
20:12:49.176 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:12:49.175 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 17
20:12:49.176 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 17
20:12:49.175 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
20:12:49.175 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-18, value-18)
20:12:49.176 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=18)
20:12:49.176 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:12:49.176 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:12:49.176 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=18)
20:12:49.176 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=2)
20:12:49.176 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 17
20:12:49.176 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=2)
20:12:49.176 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:12:49.176 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 19
20:12:49.176 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:12:49.176 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 19
20:12:49.176 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
20:12:49.176 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
20:12:49.176 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=18
20:12:49.176 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-19, value-19)
20:12:49.176 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=18)
20:12:49.176 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 19
20:12:49.176 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:12:49.176 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 19
20:12:49.177 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=20)
20:12:49.176 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=19
20:12:49.176 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:12:49.177 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
20:12:49.176 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:12:49.176 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=18)
20:12:49.177 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:49.177 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:12:49.177 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
20:12:49.177 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=3)
20:12:49.177 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:12:49.177 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:12:49.177 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
20:12:49.177 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
20:12:49.177 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:12:49.177 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
20:12:49.177 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:49.177 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
20:12:49.177 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:12:49.177 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:49.177 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:49.177 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
20:12:49.177 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:12:49.177 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:12:49.177 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:12:49.177 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
20:12:49.177 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:12:49.177 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
20:12:49.177 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:12:49.177 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:12:49.177 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:12:49.177 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:12:49.177 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:12:49.230 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:12:49.230 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:12:49.230 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:12:49.230 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:12:49.230 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:12:49.230 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:12:49.284 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:49.284 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:49.285 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:49.285 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:49.285 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:49.285 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:49.285 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:49.285 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:49.285 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:49.285 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:49.285 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:49.285 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:49.285 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:49.285 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:49.285 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:49.287 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:49.288 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:49.288 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:49.288 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:49.288 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:49.288 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:49.288 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:49.288 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:49.288 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:49.288 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:49.288 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:49.288 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:49.482 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:49.482 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:49.482 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:49.483 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:12:49.483 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:49.483 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:49.483 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:12:49.483 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:49.483 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:49.483 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:12:49.483 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:49.483 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:49.483 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:49.483 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:49.483 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:12:49.483 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:49.483 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:49.500 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:49.500 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key2, value2)
20:12:49.500 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:49.500 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:49.500 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:12:49.500 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:12:49.500 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:49.500 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:49.500 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:49.500 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:49.500 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:49.500 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:49.500 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:12:49.535 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:49.535 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:49.535 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:12:49.535 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:12:49.602 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:49.602 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:49.602 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:49.602 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:49.602 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:49.602 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:49.602 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:49.602 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:49.602 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:49.602 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:49.602 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:49.602 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:49.602 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:49.602 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:49.603 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:49.604 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:49.604 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:49.604 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:49.604 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:49.604 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:49.604 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:49.604 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:49.604 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:49.604 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:49.604 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:49.604 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:49.604 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:49.833 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:49.834 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:49.834 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:49.834 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:12:49.834 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:12:49.834 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:49.834 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:49.834 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:49.834 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:49.834 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:49.834 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:49.835 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:12:49.835 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:12:49.835 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:49.835 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:49.835 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:49.835 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:49.918 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:49.918 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
20:12:49.918 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:49.918 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:49.918 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:49.919 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:49.919 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:49.919 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:49.919 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:49.919 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:49.919 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:49.919 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:49.919 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:12:49.939 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:49.939 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:49.940 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:12:49.940 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:12:50.023 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Killing leader: node-3
20:12:50.023 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:50.023 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:50.023 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:50.023 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:50.024 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:50.167 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:50.168 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:50.168 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:50.170 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=2)
20:12:50.170 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:50.170 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:50.170 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:12:50.170 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:12:50.171 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:50.171 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:12:50.171 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:12:50.171 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:50.172 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:12:50.234 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - New leader: node-2
20:12:50.235 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
20:12:50.235 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
20:12:50.235 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:50.236 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:50.236 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=2, entries=1)
20:12:50.236 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:50.236 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:50.236 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:50.236 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:12:50.276 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:50.276 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:50.276 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:12:50.322 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:50.343 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:50.343 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:50.343 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:50.343 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:50.343 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:50.343 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:50.343 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:50.343 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:50.344 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:50.344 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:50.347 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:50.347 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:50.347 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:50.347 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:50.347 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:50.347 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:50.347 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:50.348 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:50.348 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:50.348 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:50.348 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:50.348 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:50.525 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:50.526 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:50.526 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:50.527 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:12:50.527 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:50.527 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:50.527 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:50.527 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:12:50.528 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:50.532 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:50.532 [election-node-2] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:50.532 [election-node-2] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:50.533 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:50.533 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:50.533 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:12:50.534 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:50.534 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:12:50.558 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:50.559 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
20:12:50.560 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:50.560 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:50.560 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:50.560 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:50.560 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:50.560 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:50.560 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:50.560 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:50.560 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:50.561 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:12:50.561 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:50.561 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
20:12:50.561 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:50.562 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:50.562 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:50.562 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:50.562 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:50.562 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:50.562 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:50.562 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:50.562 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:50.562 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:12:50.563 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:50.563 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:50.562 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:12:50.563 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:12:50.563 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:12:50.563 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:50.563 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
20:12:50.564 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:12:50.564 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:12:50.564 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:50.564 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:50.564 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:50.564 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:50.564 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:12:50.564 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:50.564 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:50.564 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:12:50.564 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:50.564 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:12:50.564 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:12:50.565 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:12:50.565 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:12:50.565 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
20:12:50.565 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:12:50.565 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
20:12:50.565 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:50.565 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:50.565 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:50.566 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:50.566 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:50.566 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:50.566 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:12:50.566 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:50.566 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:12:50.566 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:12:50.566 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:12:50.566 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:12:50.566 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:12:50.566 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
20:12:50.566 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:12:50.566 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
20:12:50.566 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:50.566 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:50.567 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:50.567 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:50.567 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:50.567 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:50.567 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:12:50.567 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:12:50.567 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:12:50.567 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:12:50.567 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:12:50.567 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:12:50.567 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:12:50.567 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:12:50.567 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
20:12:50.568 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:12:50.568 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
20:12:50.568 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:50.568 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:50.568 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:50.568 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:50.568 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:50.568 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:50.568 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
20:12:50.568 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:12:50.568 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:12:50.568 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:50.568 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:50.568 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:12:50.568 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:12:50.568 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:12:50.568 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
20:12:50.569 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
20:12:50.569 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
20:12:50.569 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:50.569 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:50.569 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:12:50.569 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:50.569 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:12:50.569 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
20:12:50.569 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:50.569 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:12:50.569 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:12:50.569 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
20:12:50.569 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:12:50.569 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:12:50.569 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:12:50.569 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
20:12:50.570 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
20:12:50.570 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
20:12:50.570 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:50.570 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:50.570 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:12:50.570 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:12:50.570 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:12:50.570 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
20:12:50.570 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:12:50.570 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:12:50.570 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:12:50.570 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:12:50.570 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:12:50.570 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
20:12:50.570 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:12:50.570 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
20:12:50.571 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
20:12:50.571 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
20:12:50.571 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:50.571 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:50.571 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:12:50.571 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:12:50.571 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:12:50.571 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
20:12:50.571 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:12:50.571 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:12:50.571 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:12:50.571 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
20:12:50.571 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:12:50.571 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:12:50.571 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:12:50.571 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
20:12:50.572 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
20:12:50.572 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
20:12:50.572 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:50.572 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:50.572 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:12:50.572 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:12:50.572 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:12:50.572 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
20:12:50.572 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:12:50.572 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:12:50.572 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:12:50.572 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
20:12:50.572 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:12:50.572 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:12:50.585 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:12:50.585 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:12:50.585 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:12:50.585 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:12:50.684 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:50.684 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:50.684 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:50.685 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:50.685 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:50.685 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:50.685 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:50.685 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:50.685 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:50.685 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 10 entries to node-3 (nextIndex=1)
20:12:50.685 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:50.685 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:50.685 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:50.685 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:50.685 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:50.685 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:50.688 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:50.689 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:50.689 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:50.689 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:50.689 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:50.689 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:50.689 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:50.689 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:50.689 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:50.689 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:50.689 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:50.689 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:50.923 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:50.924 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:50.924 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:50.924 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:12:50.924 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:50.924 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:50.924 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:50.924 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:12:50.924 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:50.924 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:50.924 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:50.924 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:50.925 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:12:50.925 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:50.925 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:50.925 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:50.925 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:12:51.007 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Leader: node-2
20:12:51.008 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:51.008 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
20:12:51.008 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:51.008 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:51.009 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:51.009 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:51.009 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:51.009 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:51.009 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:51.009 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:51.009 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:51.010 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:12:51.010 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - PUT committed
20:12:51.026 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:51.026 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:51.027 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:12:51.027 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:12:51.115 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - Data replicated to all nodes
20:12:51.116 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:51.116 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.116 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:51.116 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:51.116 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:51.116 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:51.116 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.116 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:51.116 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:51.116 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:51.116 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:51.117 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.117 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:51.117 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:51.117 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:51.120 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:51.120 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:51.120 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:51.121 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:51.121 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:51.121 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:51.121 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:51.121 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:51.121 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:51.121 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:51.121 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:51.122 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:51.286 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:51.287 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:51.287 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:51.287 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:12:51.287 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:12:51.287 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:51.287 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:51.287 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.287 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.287 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:51.287 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:51.287 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:12:51.287 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:12:51.287 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:51.287 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:51.287 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:51.287 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:51.332 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:51.333 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.333 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:51.333 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:51.333 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:51.333 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:51.333 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.333 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:51.333 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:51.333 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:51.333 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:51.333 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.333 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:51.333 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:51.333 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:51.334 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:51.335 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:51.335 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:51.335 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:51.335 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:51.335 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:51.335 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:51.335 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:51.335 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:51.335 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:51.335 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:51.335 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:51.335 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:12:51.335 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
20:12:51.335 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:51.335 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
20:12:51.335 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:12:51.335 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
20:12:51.335 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:51.335 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
20:12:51.492 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:51.492 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:51.492 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:12:51.492 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:12:51.492 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:12:51.492 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:51.492 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:51.492 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 VoteRequest(term=1)
20:12:51.493 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.493 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:51.493 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.493 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.493 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:51.492 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 VoteRequest(term=1)
20:12:51.493 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:51.493 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:51.493 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:12:51.493 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-5 VoteResponse(granted=true)
20:12:51.493 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:12:51.493 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:12:51.493 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:12:51.493 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:51.493 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:51.493 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.493 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:51.493 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:51.493 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:51.493 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-4 VoteResponse(granted=true)
20:12:51.543 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:51.543 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(stable-key, initial)
20:12:51.543 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:51.544 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:51.544 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:51.544 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
20:12:51.544 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:51.544 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
20:12:51.544 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:51.544 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
20:12:51.544 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:51.544 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:51.544 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:51.544 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:51.544 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
20:12:51.544 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
20:12:51.544 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:51.544 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
20:12:51.544 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:51.544 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:51.544 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
20:12:51.544 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
20:12:51.544 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:51.544 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:12:51.598 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:51.598 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:51.598 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:51.598 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:51.599 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:12:51.599 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:12:51.599 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:12:51.599 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:12:51.650 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:51.650 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-0, value-0)
20:12:51.650 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:51.651 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:51.651 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
20:12:51.651 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:51.651 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
20:12:51.651 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:51.651 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
20:12:51.651 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:51.651 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:51.651 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:12:51.651 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:51.651 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
20:12:51.651 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:51.651 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
20:12:51.651 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:51.651 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:51.651 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:51.651 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:51.651 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:12:51.651 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
20:12:51.651 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:51.651 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-1, value-1)
20:12:51.651 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:12:51.651 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:12:51.651 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:51.651 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=3)
20:12:51.651 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:51.651 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:51.651 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:51.651 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=3)
20:12:51.651 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
20:12:51.651 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:51.651 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
20:12:51.651 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:51.651 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:51.651 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:51.651 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:12:51.651 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=3
20:12:51.651 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:51.651 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:51.651 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:51.651 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:12:51.651 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:12:51.652 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:12:51.652 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:12:51.651 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:12:51.651 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:12:51.651 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:51.652 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:12:51.652 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=3
20:12:51.652 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-2, value-2)
20:12:51.652 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:12:51.652 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
20:12:51.652 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:51.652 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=4)
20:12:51.652 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:51.652 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:51.652 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=4)
20:12:51.652 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
20:12:51.652 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:51.652 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
20:12:51.652 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:51.652 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:51.652 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:12:51.652 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:51.652 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:12:51.652 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:51.652 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=4
20:12:51.652 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:51.652 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:12:51.652 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:12:51.652 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:12:51.652 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:51.652 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:51.652 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:51.652 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=4
20:12:51.652 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:12:51.652 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:12:51.652 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:12:51.652 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-3, value-3)
20:12:51.653 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:12:51.653 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
20:12:51.653 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:51.653 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=5)
20:12:51.653 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:51.653 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:51.653 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:51.653 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=5)
20:12:51.653 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
20:12:51.653 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:12:51.653 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
20:12:51.653 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:51.653 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:12:51.653 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:51.653 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:51.653 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:51.653 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:12:51.653 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:51.653 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:12:51.653 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:51.653 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:12:51.653 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=5
20:12:51.653 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=5
20:12:51.653 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:12:51.653 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:12:51.653 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:12:51.653 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:12:51.653 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-4, value-4)
20:12:51.653 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:12:51.653 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
20:12:51.653 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:51.653 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=6)
20:12:51.653 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:51.653 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:51.653 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=6)
20:12:51.653 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:51.653 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:51.653 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
20:12:51.653 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:51.653 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
20:12:51.654 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:12:51.654 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
20:12:51.654 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:51.654 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:51.654 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:51.654 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:51.654 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:51.654 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:12:51.654 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:51.654 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:12:51.654 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:12:51.654 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=6
20:12:51.654 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=6
20:12:51.654 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:12:51.654 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:12:51.698 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:51.698 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:51.698 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:51.698 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:12:51.698 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:12:51.698 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:51.698 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:12:51.699 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:12:51.760 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:51.760 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.760 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:51.760 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:51.760 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:51.760 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:51.761 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.761 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:51.761 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:51.761 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:51.761 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:51.761 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.761 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:51.761 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:51.761 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:51.761 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:12:51.761 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.761 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:51.761 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
20:12:51.761 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:12:51.761 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:12:51.761 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:51.762 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:51.762 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
20:12:51.762 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:12:51.769 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:51.770 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:51.770 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:51.771 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:51.771 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:51.771 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:51.935 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:51.939 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:51.939 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:51.940 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:51.940 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:52.118 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:52.121 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:52.123 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:52.123 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:52.123 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:52.352 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:52.354 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
20:12:52.355 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
20:12:52.355 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
20:12:52.356 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:52.569 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:52.570 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-1
20:12:52.571 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-1
20:12:52.571 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
20:12:52.571 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:52.752 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:52.755 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-1
20:12:52.756 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-1
20:12:52.756 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 5
20:12:52.756 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:52.977 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:52.977 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-1
20:12:52.978 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-1
20:12:52.978 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 6
20:12:52.978 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:53.162 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:53.164 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=7, votedFor=node-1
20:12:53.165 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=7, votedFor=node-1
20:12:53.165 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 7
20:12:53.166 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:53.409 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:53.421 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=8, votedFor=node-1
20:12:53.422 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=8, votedFor=node-1
20:12:53.422 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 8
20:12:53.422 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:53.652 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:53.654 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=9, votedFor=node-1
20:12:53.654 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=9, votedFor=node-1
20:12:53.654 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 9
20:12:53.654 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:53.830 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:53.832 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=10, votedFor=node-1
20:12:53.836 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=10, votedFor=node-1
20:12:53.837 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 10
20:12:53.837 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:54.004 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:54.005 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=11, votedFor=node-1
20:12:54.005 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=11, votedFor=node-1
20:12:54.005 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 11
20:12:54.005 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:54.075 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:54.075 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.075 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:54.075 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:54.075 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:54.084 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:54.084 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:54.084 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:54.085 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:54.085 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:54.085 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:54.085 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:54.085 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:12:54.085 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:54.085 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:54.085 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:54.085 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:54.085 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:54.085 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:12:54.085 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:54.085 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:54.085 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:54.085 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:54.280 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:54.280 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:54.281 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:54.281 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:54.281 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:54.281 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:12:54.281 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:12:54.281 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:54.281 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:54.281 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.281 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:54.282 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:54.282 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.282 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:54.282 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:54.282 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:12:54.282 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:54.282 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:54.282 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:54.282 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:54.282 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:54.282 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:54.282 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:12:54.296 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Leader: node-1
20:12:54.297 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:54.297 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
20:12:54.297 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:54.297 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:54.297 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:12:54.297 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:12:54.298 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:54.298 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:54.298 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:54.298 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:54.298 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:54.298 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:54.298 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:54.298 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:12:54.298 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:54.298 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key2, value2)
20:12:54.298 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:54.298 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:54.298 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:12:54.298 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:12:54.298 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:54.298 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:54.298 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:54.298 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:54.298 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:54.298 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:54.299 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:12:54.299 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:54.299 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:12:54.299 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:12:54.299 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:12:54.299 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:12:54.299 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:54.299 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key3, value3)
20:12:54.299 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:12:54.299 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:12:54.299 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:12:54.299 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:12:54.299 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:54.299 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:54.299 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:54.299 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:54.299 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:54.299 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:54.299 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:12:54.299 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:12:54.299 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:12:54.299 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:54.299 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:54.299 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:12:54.299 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:12:54.337 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:54.337 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:54.338 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:12:54.338 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:12:54.404 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Stopping all nodes...
20:12:54.404 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:54.404 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.404 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:54.404 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:54.404 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:54.404 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:54.404 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.404 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:54.404 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:54.404 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:54.404 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:54.404 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.404 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:54.404 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:54.404 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:54.404 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting all nodes...
20:12:54.404 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:54.405 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:12:54.405 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:54.406 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:12:54.406 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:12:54.406 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:12:54.406 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:12:54.406 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
20:12:54.406 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:54.406 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:54.406 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:54.406 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:54.406 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:12:54.406 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:12:54.406 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:12:54.406 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:12:54.406 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:12:54.406 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:12:54.406 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
20:12:54.406 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:54.406 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:54.406 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:54.406 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:54.406 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:12:54.406 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:12:54.406 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:12:54.406 [main] [node-3] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:12:54.406 [main] [node-3] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:12:54.406 [main] [node-3] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:12:54.406 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
20:12:54.406 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:54.406 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:54.406 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:54.566 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:54.567 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:54.567 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:54.567 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:54.567 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=2)
20:12:54.567 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=2)
20:12:54.568 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:12:54.568 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:54.568 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.568 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:12:54.568 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:54.568 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.568 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:12:54.568 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:12:54.568 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:12:54.568 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:54.568 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:12:54.568 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:12:54.568 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:54.568 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:12:54.568 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:12:54.568 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:12:54.612 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - New leader after restart: node-3
20:12:54.614 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - All nodes recovered successfully
20:12:54.614 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:54.614 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.614 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:54.614 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:54.614 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:54.614 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:54.614 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.614 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:54.614 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:54.614 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:54.614 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:54.614 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.614 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:54.614 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:54.614 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:54.617 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:54.617 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:54.617 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:54.617 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:54.617 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:54.617 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:54.617 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:54.617 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:12:54.617 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:54.617 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:54.617 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:54.618 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:54.618 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:54.618 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:12:54.618 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:54.618 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:54.618 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:54.618 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:54.774 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:54.775 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:54.776 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:54.776 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:54.776 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:54.776 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:12:54.776 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:12:54.777 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:54.777 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:54.777 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.777 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:54.777 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:54.777 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.777 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:54.777 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:54.777 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:12:54.777 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:54.777 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:54.777 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:54.777 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:54.778 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:54.778 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:54.778 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:12:54.820 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:54.820 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, restart)
20:12:54.820 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:54.820 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:12:54.820 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:54.820 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:12:54.820 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:54.820 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:54.820 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:54.820 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:54.820 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:54.820 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:54.820 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:54.820 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:12:54.829 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:54.829 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:54.830 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:12:54.830 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:12:54.926 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Restarting follower: node-2
20:12:54.926 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:54.927 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:54.927 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:54.927 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:54.927 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:55.029 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:55.029 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during, downtime)
20:12:55.029 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.029 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.083 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.083 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.130 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:55.130 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.130 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.131 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:55.131 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:55.131 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:55.131 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:12:55.131 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:12:55.183 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.183 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.233 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.234 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.280 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.280 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.332 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.333 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.383 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.383 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.407 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:55.407 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
20:12:55.407 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
20:12:55.407 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:55.408 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:12:55.408 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:12:55.433 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.433 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.483 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.483 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.533 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.533 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.583 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.584 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.628 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:55.628 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.629 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.629 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-1
20:12:55.629 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
20:12:55.630 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:55.630 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:12:55.630 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:12:55.683 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.683 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.732 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.733 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.780 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.781 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.832 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.833 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.881 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.882 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.899 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:55.901 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-1
20:12:55.901 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 5
20:12:55.901 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:55.902 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:12:55.902 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:12:55.933 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.933 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:55.980 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:55.981 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.032 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.032 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.083 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.083 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.093 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:56.096 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-1
20:12:56.096 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 6
20:12:56.096 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:56.097 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:12:56.097 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:12:56.131 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.132 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.183 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.183 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.233 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.233 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.283 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.283 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.327 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:56.330 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=7, votedFor=node-1
20:12:56.330 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 7
20:12:56.331 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:56.331 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:12:56.331 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:12:56.333 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.333 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.383 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.384 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.433 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.433 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.483 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.483 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.534 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.534 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.578 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.578 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:56.578 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.579 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=8, votedFor=node-1
20:12:56.580 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 8
20:12:56.580 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:56.580 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:12:56.580 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:12:56.632 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.636 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.683 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.684 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.729 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.730 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.786 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.787 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.833 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.833 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.856 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:56.857 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=9, votedFor=node-1
20:12:56.857 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 9
20:12:56.857 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:56.857 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:12:56.857 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:12:56.878 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.878 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.933 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.933 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:56.982 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:56.986 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:57.031 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:57.032 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:57.035 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:57.035 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:57.035 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:57.035 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:57.036 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:57.036 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:57.036 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:57.036 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:57.036 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:57.036 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:57.045 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:57.045 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:57.045 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:57.045 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:57.045 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:57.045 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:57.262 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:57.265 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:57.266 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:57.266 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:57.269 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:57.537 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:57.540 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:57.541 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:57.541 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:57.541 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:57.719 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:57.723 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
20:12:57.729 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
20:12:57.729 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
20:12:57.730 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:57.908 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:57.909 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-1
20:12:57.910 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-1
20:12:57.910 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
20:12:57.910 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:58.127 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:58.128 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-1
20:12:58.128 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-1
20:12:58.128 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 5
20:12:58.128 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:58.326 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:58.327 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-1
20:12:58.327 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-1
20:12:58.327 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 6
20:12:58.327 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:58.603 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:58.605 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=7, votedFor=node-1
20:12:58.605 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=7, votedFor=node-1
20:12:58.606 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 7
20:12:58.606 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:58.853 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:58.854 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=8, votedFor=node-1
20:12:58.854 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=8, votedFor=node-1
20:12:58.854 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 8
20:12:58.854 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:59.032 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:59.033 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=9, votedFor=node-1
20:12:59.034 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=9, votedFor=node-1
20:12:59.034 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 9
20:12:59.034 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:59.144 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:59.144 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.144 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:59.144 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:59.144 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:59.151 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:59.151 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:59.151 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:59.151 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:59.152 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:59.152 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:59.152 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:59.152 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:59.152 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:59.152 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:59.152 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:59.152 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:59.314 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:59.314 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:59.314 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:59.314 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:12:59.314 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:12:59.314 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:59.315 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:59.315 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.315 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.315 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:59.315 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:59.315 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:12:59.315 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:12:59.315 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:59.315 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:59.315 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:59.315 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:59.361 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-3 (term 1)
20:12:59.570 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - All nodes agree on leader: node-3
20:12:59.570 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:59.570 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.570 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:59.570 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:59.570 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:59.570 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:59.570 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.570 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:59.570 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:59.570 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:59.570 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:59.570 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.570 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:59.570 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:59.570 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:59.572 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:59.572 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:59.572 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:59.572 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:59.572 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:59.572 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:59.572 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:59.572 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:59.572 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:59.572 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:59.572 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:59.572 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:59.572 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:12:59.572 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
20:12:59.572 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:59.573 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
20:12:59.573 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:12:59.573 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
20:12:59.573 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:59.573 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
20:12:59.744 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:59.744 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:59.744 [election-node-4] [node-4] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:12:59.744 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 VoteRequest(term=1)
20:12:59.744 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 VoteRequest(term=1)
20:12:59.744 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 VoteRequest(term=1)
20:12:59.744 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 VoteRequest(term=1)
20:12:59.744 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:59.744 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.744 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:59.744 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.744 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:59.744 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
20:12:59.744 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
20:12:59.744 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-2 VoteResponse(granted=true)
20:12:59.744 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:59.744 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:12:59.744 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.744 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.744 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
20:12:59.744 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
20:12:59.744 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-3 VoteResponse(granted=true)
20:12:59.744 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-1 VoteResponse(granted=true)
20:12:59.744 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-5 VoteResponse(granted=true)
20:12:59.744 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:12:59.744 [] [node-4] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:59.744 [] [node-4] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:59.745 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:59.779 [main] [node-5] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-4 (term 1)
20:12:59.779 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:59.779 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.779 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:59.779 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:59.779 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:59.779 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:59.779 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.779 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:59.779 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:59.779 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:59.779 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:59.779 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.779 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:59.779 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:59.779 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:59.779 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:12:59.779 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.779 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:59.779 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
20:12:59.779 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:12:59.779 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:12:59.779 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.779 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:59.779 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
20:12:59.779 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:12:59.781 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:59.781 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:59.781 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:59.781 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:12:59.781 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:59.781 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:59.781 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:59.781 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:12:59.781 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:59.781 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:59.781 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:59.781 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:12:59.977 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:59.977 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:59.977 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:59.977 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:12:59.977 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:12:59.977 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:59.977 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:59.977 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.977 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:59.977 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:59.977 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:59.977 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:12:59.977 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:12:59.977 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:59.977 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:59.978 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:59.978 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:13:00.492 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader node-2 maintained leadership for 500ms
20:13:00.493 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:13:00.493 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:13:00.494 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:13:00.494 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:13:00.494 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:13:00.494 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:13:00.494 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:13:00.494 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:13:00.494 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:13:00.494 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:13:00.494 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:13:00.494 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:13:00.494 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:13:00.494 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:13:00.494 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:13:00.498 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:13:00.498 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:13:00.498 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:13:00.498 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:13:00.498 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:13:00.498 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:13:00.498 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:13:00.498 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:13:00.498 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:13:00.498 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:13:00.498 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:13:00.499 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:13:00.691 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:13:00.692 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:13:00.692 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:13:00.692 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:13:00.692 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:13:00.692 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:13:00.692 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:13:00.692 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:13:00.692 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:13:00.692 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:13:00.692 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:13:00.692 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:13:00.692 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:13:00.692 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:13:00.692 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:13:00.692 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:13:00.692 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:13:00.708 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Initial leader: node-2 (term 1)
20:13:00.708 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:13:00.708 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:13:00.708 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:13:00.708 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:13:00.708 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:13:00.853 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:13:00.854 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:13:00.855 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:13:00.857 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:13:00.857 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=2)
20:13:00.857 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:13:00.857 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:13:00.857 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
20:13:00.857 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:13:00.857 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:13:00.857 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:13:00.857 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:13:00.857 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:13:00.910 [main] [node-2] INFO  com.raftdb.integration.ClusterTest - New leader: node-1 (term 2)
20:13:00.912 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:13:00.912 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:13:00.912 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:13:00.912 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:13:00.912 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:13:00.912 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:13:00.912 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:13:00.912 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:13:00.912 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:13:00.912 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:11.784 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:11.787 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:11.787 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:11.787 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:11.787 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:11.787 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:11.787 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:11.787 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:11.788 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:11.788 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:11.788 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:11.788 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:11.983 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:11.984 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:11.994 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:11.994 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:11.996 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:11.996 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:12.002 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:18:12.002 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:18:12.002 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:18:12.003 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:12.003 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:12.003 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:12.003 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=false)
20:18:12.003 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:18:12.004 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:18:12.003 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:18:12.004 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:18:12.004 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:18:12.004 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:12.004 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=false)
20:18:12.004 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:12.004 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=false)
20:18:12.007 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:12.007 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:12.110 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:18:12.110 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key3, value3)
20:18:12.115 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:18:12.115 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:18:12.115 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:18:12.115 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:18:12.115 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:12.115 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:18:12.115 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:18:12.115 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:12.115 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:12.115 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:12.115 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:18:12.115 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:12.115 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:18:12.116 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:18:12.116 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:18:12.116 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:12.116 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:18:12.137 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:18:12.137 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(key3)
20:18:12.137 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:18:12.137 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:12.137 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:18:12.137 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:12.137 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:18:12.138 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:18:12.138 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:12.138 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:12.138 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:18:12.138 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:18:12.138 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:18:12.138 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:18:12.138 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:18:12.138 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:18:12.138 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:18:12.165 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:18:12.165 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:18:12.166 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:18:12.166 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:18:12.243 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:12.244 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:12.244 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:12.244 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:12.244 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:12.244 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:12.244 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:12.244 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:12.244 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:12.245 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:12.245 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:12.245 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:12.245 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:12.245 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:12.245 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:12.251 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:12.251 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:12.251 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:12.251 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:12.251 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:12.251 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:12.251 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:12.251 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:12.251 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:12.251 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:12.251 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:12.252 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:12.486 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:12.487 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:12.487 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:12.487 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:18:12.487 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:18:12.487 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:12.487 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:12.487 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:12.487 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:12.488 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:12.488 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:12.488 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:18:12.488 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:18:12.488 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:12.488 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:12.488 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:12.488 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:12.562 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:18:12.562 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-0, value-0)
20:18:12.563 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:18:12.563 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:18:12.563 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-1, value-1)
20:18:12.563 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:18:12.563 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=1)
20:18:12.563 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-2, value-2)
20:18:12.563 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:18:12.563 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:18:12.563 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:18:12.563 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
20:18:12.563 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:12.563 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-3, value-3)
20:18:12.563 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:18:12.563 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:18:12.563 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=2)
20:18:12.564 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
20:18:12.564 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=3)
20:18:12.564 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:18:12.564 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:18:12.564 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
20:18:12.564 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:18:12.564 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 4
20:18:12.564 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 4
20:18:12.564 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
20:18:12.564 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:18:12.564 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=1)
20:18:12.564 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:18:12.564 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:18:12.564 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=1)
20:18:12.564 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
20:18:12.564 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-4, value-4)
20:18:12.564 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 4
20:18:12.564 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 4
20:18:12.564 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:18:12.564 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
20:18:12.564 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 4
20:18:12.564 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
20:18:12.564 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:18:12.565 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:12.565 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-5, value-5)
20:18:12.565 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 4
20:18:12.565 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=5)
20:18:12.565 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:18:12.565 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=5)
20:18:12.565 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:18:12.565 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:18:12.565 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:18:12.565 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:18:12.565 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:18:12.565 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 6
20:18:12.565 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:18:12.565 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:18:12.565 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 6
20:18:12.565 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=5)
20:18:12.565 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:18:12.565 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:18:12.565 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-6, value-6)
20:18:12.565 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=5)
20:18:12.565 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:18:12.566 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:18:12.566 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:18:12.565 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
20:18:12.565 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:18:12.566 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
20:18:12.566 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:18:12.566 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 7
20:18:12.566 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:18:12.566 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:18:12.566 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-7, value-7)
20:18:12.566 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=7)
20:18:12.566 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=7)
20:18:12.566 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 7
20:18:12.566 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
20:18:12.566 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:18:12.566 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 7
20:18:12.566 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 7
20:18:12.566 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:18:12.566 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:18:12.566 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
20:18:12.566 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:18:12.567 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:18:12.567 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-8, value-8)
20:18:12.566 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:18:12.566 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
20:18:12.567 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=7)
20:18:12.567 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 8
20:18:12.567 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:18:12.567 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 8
20:18:12.567 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:18:12.567 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
20:18:12.567 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:12.567 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
20:18:12.567 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 7
20:18:12.567 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:18:12.567 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:18:12.567 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
20:18:12.567 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
20:18:12.567 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:18:12.567 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:18:12.567 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 9
20:18:12.567 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-9, value-9)
20:18:12.567 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:18:12.567 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=8)
20:18:12.567 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:18:12.567 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=8)
20:18:12.568 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:18:12.567 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:18:12.568 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:18:12.568 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 10
20:18:12.567 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 9
20:18:12.568 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
20:18:12.567 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:18:12.567 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:18:12.568 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 10
20:18:12.568 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
20:18:12.568 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:18:12.568 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:18:12.568 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:18:12.568 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
20:18:12.568 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=9)
20:18:12.568 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:18:12.568 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:18:12.568 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=9)
20:18:12.568 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
20:18:12.568 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
20:18:12.568 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:18:12.568 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:18:12.568 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
20:18:12.569 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 11
20:18:12.569 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
20:18:12.569 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=11)
20:18:12.569 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:18:12.569 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:18:12.568 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:18:12.569 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
20:18:12.568 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:18:12.568 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:18:12.568 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:18:12.569 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:18:12.568 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:18:12.569 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 11
20:18:12.569 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:18:12.569 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:18:12.568 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
20:18:12.568 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:18:12.569 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:18:12.569 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:18:12.569 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:18:12.569 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-13, value-13)
20:18:12.569 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:18:12.569 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 13
20:18:12.569 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
20:18:12.569 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:18:12.569 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:18:12.569 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:18:12.570 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=12)
20:18:12.569 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
20:18:12.569 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=11)
20:18:12.569 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
20:18:12.570 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:18:12.569 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
20:18:12.570 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:18:12.570 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 14
20:18:12.570 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
20:18:12.570 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:18:12.570 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:18:12.570 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=14)
20:18:12.570 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
20:18:12.570 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:18:12.570 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 14
20:18:12.570 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:18:12.570 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
20:18:12.570 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-14, value-14)
20:18:12.570 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 15
20:18:12.570 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 14
20:18:12.570 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=11)
20:18:12.570 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:18:12.570 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=13)
20:18:12.570 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 13
20:18:12.570 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 13
20:18:12.570 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:18:12.570 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
20:18:12.570 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:18:12.570 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
20:18:12.571 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:18:12.570 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=5)
20:18:12.571 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=15)
20:18:12.571 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=15)
20:18:12.571 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 15
20:18:12.571 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:18:12.571 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
20:18:12.570 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:18:12.571 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
20:18:12.571 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=15
20:18:12.571 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:18:12.571 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=14
20:18:12.571 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 15
20:18:12.571 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
20:18:12.571 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 15
20:18:12.571 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:18:12.571 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:18:12.571 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 16
20:18:12.571 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:18:12.571 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
20:18:12.571 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 15
20:18:12.571 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
20:18:12.571 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:18:12.571 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 16
20:18:12.572 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
20:18:12.572 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=16)
20:18:12.571 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
20:18:12.572 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-16, value-16)
20:18:12.572 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:18:12.572 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
20:18:12.572 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:18:12.572 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:18:12.572 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:12.572 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
20:18:12.572 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:18:12.572 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:18:12.572 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
20:18:12.572 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:18:12.572 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:18:12.572 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
20:18:12.572 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:18:12.572 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:18:12.572 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 17
20:18:12.572 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
20:18:12.572 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-17, value-17)
20:18:12.572 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:18:12.572 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
20:18:12.572 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=16)
20:18:12.572 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=17
20:18:12.572 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
20:18:12.572 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:18:12.572 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:18:12.572 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:18:12.572 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=16)
20:18:12.573 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=18)
20:18:12.573 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:18:12.573 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=18)
20:18:12.572 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:18:12.572 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-18, value-18)
20:18:12.573 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:18:12.573 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:18:12.573 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 18
20:18:12.573 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:18:12.573 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 19
20:18:12.573 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:18:12.573 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 18
20:18:12.573 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
20:18:12.573 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
20:18:12.573 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
20:18:12.573 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
20:18:12.573 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=18
20:18:12.573 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:18:12.573 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:18:12.573 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 19
20:18:12.573 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 19
20:18:12.573 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:18:12.573 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-19, value-19)
20:18:12.573 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:18:12.573 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
20:18:12.573 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=18)
20:18:12.573 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:18:12.573 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:18:12.573 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=19)
20:18:12.574 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
20:18:12.573 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:18:12.574 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:18:12.574 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
20:18:12.574 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:18:12.574 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:18:12.574 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:12.574 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:12.574 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:18:12.574 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
20:18:12.574 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
20:18:12.574 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
20:18:12.574 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:18:12.574 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
20:18:12.574 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
20:18:12.574 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
20:18:12.574 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
20:18:12.574 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
20:18:12.574 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:18:12.574 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:18:12.574 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:18:12.574 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:18:12.574 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:18:12.592 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:18:12.592 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:18:12.592 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:18:12.592 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:18:12.682 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:12.682 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:12.682 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:12.682 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:12.682 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:12.682 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:12.682 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:12.683 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:12.683 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:12.683 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:12.683 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:12.683 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:12.683 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:12.683 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:12.683 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:12.686 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:12.686 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:12.686 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:12.686 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:12.686 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:12.686 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:12.686 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:12.686 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:12.687 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:12.687 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:12.687 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:12.687 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:12.888 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:12.889 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:12.889 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:12.889 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:18:12.889 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:18:12.889 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:12.889 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:12.889 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:12.889 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:12.889 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:18:12.889 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:18:12.889 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:18:12.889 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:18:12.889 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:12.889 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:12.889 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:12.889 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:12.897 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:18:12.897 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key2, value2)
20:18:12.897 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:18:12.897 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:18:12.897 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:18:12.897 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:12.897 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:18:12.897 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:18:12.898 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:18:12.898 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:12.898 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:18:12.898 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:18:12.945 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:12.945 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:12.945 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:18:12.945 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:18:13.004 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:13.004 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:13.004 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:13.004 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:13.004 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:13.004 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:13.005 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:13.005 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:13.005 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:13.005 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:13.005 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:13.005 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:13.005 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:13.005 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:13.005 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:13.007 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:13.007 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:13.007 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:13.007 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:13.007 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:13.007 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:13.007 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:13.007 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:13.007 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:13.007 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:13.007 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:13.007 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:13.220 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:13.220 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:13.220 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:13.221 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:18:13.221 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:18:13.221 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:13.221 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:13.221 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:13.221 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:13.221 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:13.221 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:18:13.221 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:13.221 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:13.221 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:13.221 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:18:13.221 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:13.221 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:13.319 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:18:13.319 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
20:18:13.320 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:18:13.320 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:18:13.320 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:18:13.320 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:13.320 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:13.320 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:13.320 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:18:13.320 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:18:13.320 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:18:13.320 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:18:13.320 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:18:13.322 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:13.322 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:13.322 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:18:13.322 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:18:13.426 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - Killing leader: node-1
20:18:13.427 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:13.427 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:13.427 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:13.427 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:13.427 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:13.664 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:13.665 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:18:13.665 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:13.667 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=2)
20:18:13.668 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:13.668 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:13.668 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:18:13.668 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:18:13.668 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:13.668 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:18:13.668 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:18:13.668 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:13.669 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:18:13.742 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - New leader: node-2
20:18:13.742 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
20:18:13.742 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
20:18:13.743 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:13.743 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:13.743 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=2, entries=1)
20:18:13.743 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:18:13.743 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:18:13.743 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:18:13.743 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:18:13.774 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:13.774 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:18:13.775 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:18:13.819 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:13.844 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:13.844 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:13.845 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:13.845 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:13.845 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:13.845 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:13.845 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:13.845 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:13.845 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:13.845 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:13.846 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:13.847 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:13.847 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:13.847 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:13.847 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:13.847 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:13.847 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:13.847 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:13.847 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:13.847 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:13.847 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:13.847 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:14.064 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:14.064 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:14.064 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:14.064 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:14.064 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:14.064 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:14.064 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:18:14.064 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:18:14.064 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:18:14.064 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:14.064 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:18:14.064 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.064 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:18:14.064 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:18:14.064 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:18:14.064 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:14.064 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=false)
20:18:14.065 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:14.064 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:18:14.064 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:18:14.065 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=false)
20:18:14.065 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:14.065 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=false)
20:18:14.065 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:14.163 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:18:14.166 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
20:18:14.168 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:18:14.169 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:18:14.176 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.175 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:18:14.169 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:18:14.184 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.183 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:14.184 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:14.184 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:18:14.186 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.184 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:18:14.203 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:18:14.204 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:14.186 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:18:14.175 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.204 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:14.204 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:18:14.204 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:18:14.204 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
20:18:14.205 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:14.205 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:18:14.205 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.205 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.205 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:18:14.205 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:14.205 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:18:14.205 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:14.205 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:18:14.205 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:18:14.205 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:18:14.205 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:18:14.206 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:18:14.206 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
20:18:14.206 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:18:14.206 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:18:14.206 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:18:14.206 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.206 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:18:14.206 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:18:14.206 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:18:14.206 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:18:14.206 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.206 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:18:14.206 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:18:14.206 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:18:14.206 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:18:14.206 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:18:14.206 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:18:14.206 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:18:14.207 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:18:14.207 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
20:18:14.207 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:18:14.207 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
20:18:14.207 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.207 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.207 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:18:14.207 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:18:14.207 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:18:14.207 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:18:14.207 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:18:14.207 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:18:14.207 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
20:18:14.207 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:18:14.207 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:18:14.207 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:18:14.207 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:18:14.207 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
20:18:14.207 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:18:14.207 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
20:18:14.208 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.208 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.208 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:18:14.208 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:18:14.208 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:18:14.208 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:18:14.208 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:18:14.208 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:18:14.208 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
20:18:14.208 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:18:14.208 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:18:14.208 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:18:14.208 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:18:14.208 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
20:18:14.208 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:18:14.208 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
20:18:14.208 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.208 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.208 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:18:14.208 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:18:14.208 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:18:14.208 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:18:14.208 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:18:14.208 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:18:14.208 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
20:18:14.209 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:18:14.209 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:18:14.209 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:18:14.209 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:18:14.209 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
20:18:14.209 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
20:18:14.209 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
20:18:14.209 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.209 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:18:14.209 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:18:14.209 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
20:18:14.210 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:18:14.210 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.210 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:18:14.210 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:18:14.210 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:18:14.210 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:18:14.210 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:18:14.210 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
20:18:14.219 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
20:18:14.220 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
20:18:14.220 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
20:18:14.220 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
20:18:14.220 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
20:18:14.220 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:18:14.220 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.220 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:18:14.220 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:18:14.220 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
20:18:14.220 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:18:14.220 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.220 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.220 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:18:14.220 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:18:14.220 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:18:14.220 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.220 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:18:14.220 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
20:18:14.220 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:18:14.221 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:18:14.221 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:18:14.221 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
20:18:14.223 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:18:14.223 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
20:18:14.223 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
20:18:14.223 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.224 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.224 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:18:14.224 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:18:14.224 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
20:18:14.224 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:18:14.224 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:18:14.224 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:18:14.224 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:18:14.225 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:18:14.225 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
20:18:14.225 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:18:14.225 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
20:18:14.225 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:18:14.225 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
20:18:14.225 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
20:18:14.225 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.226 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:18:14.226 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:18:14.226 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.226 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
20:18:14.226 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:18:14.226 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:18:14.226 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:18:14.226 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
20:18:14.226 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:18:14.226 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:18:14.226 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:18:14.270 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:18:14.270 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:18:14.270 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:18:14.270 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:18:14.331 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:14.331 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.331 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:14.331 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:14.331 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:14.331 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:14.331 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.331 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:14.331 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:14.331 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:14.331 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:14.331 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.331 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:14.331 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:14.331 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:14.332 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:14.332 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:14.332 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:14.332 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:14.332 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:14.332 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:14.332 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:14.332 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:14.332 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:14.332 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:14.332 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:14.333 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:14.546 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:14.546 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:14.546 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:14.546 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:18:14.546 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:18:14.546 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:14.546 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:14.546 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.546 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.546 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:18:14.546 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:18:14.546 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:18:14.546 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:18:14.546 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:14.546 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:14.546 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:14.546 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:14.646 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Leader: node-3
20:18:14.646 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:18:14.646 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
20:18:14.646 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:18:14.646 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:18:14.647 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:18:14.647 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:18:14.647 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.647 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.647 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:14.647 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:18:14.647 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:14.647 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:18:14.647 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:18:14.647 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:18:14.647 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:14.647 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:14.647 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:14.647 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:14.647 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:18:14.647 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - PUT committed
20:18:14.702 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:14.702 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:14.702 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:18:14.703 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:18:14.753 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Data replicated to all nodes
20:18:14.754 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:14.754 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.754 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:14.754 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:14.754 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:14.754 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:14.754 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.754 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:14.754 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:14.754 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:14.754 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:14.754 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.754 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:14.754 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:14.754 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:14.755 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:14.755 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:14.755 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:14.755 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:14.755 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:14.755 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:14.755 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:14.755 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:14.755 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:14.756 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:14.756 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:14.756 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:14.942 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:14.942 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:14.942 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:14.942 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:18:14.942 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:14.942 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.942 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:18:14.942 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:18:14.942 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:14.943 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:18:14.943 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:14.943 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:14.943 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.943 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:14.943 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:18:14.943 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:14.943 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:18:14.966 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:14.966 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.966 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:14.967 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:14.967 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:14.967 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:14.967 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.967 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:14.967 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:14.967 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:14.967 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:14.967 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:14.967 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:14.967 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:14.967 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:14.969 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:14.969 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:14.969 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:14.969 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:14.969 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:14.969 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:14.969 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:14.969 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:14.969 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:14.969 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:14.969 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:14.969 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:14.969 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:18:14.969 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
20:18:14.969 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:14.969 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
20:18:14.969 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:18:14.969 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
20:18:14.969 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:14.969 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
20:18:15.176 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:15.176 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:15.176 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:18:15.177 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:18:15.177 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:15.177 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:15.177 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:15.177 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:18:15.177 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:18:15.177 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:18:15.177 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:15.178 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:15.178 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:15.178 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:18:15.178 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:18:15.178 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:15.178 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:15.178 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:15.178 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:15.178 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:15.179 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:15.179 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:15.179 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 VoteRequest(term=1)
20:18:15.179 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:15.179 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-4 VoteResponse(granted=true)
20:18:15.179 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 VoteRequest(term=1)
20:18:15.179 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:15.179 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-5 VoteResponse(granted=true)
20:18:15.276 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:18:15.277 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(stable-key, initial)
20:18:15.277 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:18:15.277 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:18:15.277 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:18:15.277 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
20:18:15.277 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
20:18:15.277 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:15.277 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:18:15.277 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
20:18:15.277 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
20:18:15.277 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:15.277 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:15.277 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
20:18:15.277 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:15.277 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:18:15.277 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:15.277 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
20:18:15.277 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:18:15.277 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:18:15.278 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:15.278 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:15.278 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:15.278 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:15.279 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:18:15.279 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:18:15.279 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:18:15.279 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:18:15.384 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:18:15.384 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-0, value-0)
20:18:15.384 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:18:15.384 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:15.384 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:18:15.384 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
20:18:15.384 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:15.385 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:18:15.385 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
20:18:15.385 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
20:18:15.385 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:18:15.385 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:18:15.385 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
20:18:15.385 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:18:15.385 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:18:15.385 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:18:15.385 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:18:15.385 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:18:15.385 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:18:15.385 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
20:18:15.385 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
20:18:15.385 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:18:15.385 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-1, value-1)
20:18:15.385 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:18:15.385 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:18:15.385 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:18:15.386 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:18:15.386 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:15.386 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=3)
20:18:15.386 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:18:15.386 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:18:15.386 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
20:18:15.386 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:18:15.386 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=3)
20:18:15.386 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:18:15.386 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:18:15.386 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:18:15.386 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:18:15.386 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:18:15.386 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:18:15.386 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:18:15.386 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
20:18:15.386 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:18:15.386 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=3
20:18:15.386 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:18:15.386 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:18:15.386 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:18:15.386 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:18:15.386 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-2, value-2)
20:18:15.386 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=3
20:18:15.386 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:18:15.386 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
20:18:15.387 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
20:18:15.387 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:18:15.387 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=4)
20:18:15.387 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:15.387 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:18:15.387 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=4)
20:18:15.387 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:18:15.387 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:18:15.387 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
20:18:15.387 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
20:18:15.387 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
20:18:15.387 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:18:15.387 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:18:15.387 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:18:15.387 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:18:15.387 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:18:15.387 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:18:15.387 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:18:15.387 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=4
20:18:15.387 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:18:15.387 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:18:15.387 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:18:15.387 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:18:15.387 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:18:15.387 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=4
20:18:15.387 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:18:15.388 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:18:15.388 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-3, value-3)
20:18:15.388 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
20:18:15.388 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
20:18:15.388 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:18:15.388 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=5)
20:18:15.388 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:15.388 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=5)
20:18:15.388 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:18:15.388 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:18:15.388 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
20:18:15.388 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:18:15.388 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
20:18:15.388 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:18:15.388 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:18:15.388 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:18:15.388 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
20:18:15.388 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:18:15.388 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:18:15.388 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=5
20:18:15.388 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:18:15.388 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:18:15.388 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:18:15.388 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:18:15.388 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:18:15.388 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:18:15.388 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=5
20:18:15.388 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:18:15.389 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:18:15.389 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:18:15.389 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-4, value-4)
20:18:15.389 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
20:18:15.389 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
20:18:15.389 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:18:15.389 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:18:15.389 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:18:15.389 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:18:15.389 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=6)
20:18:15.389 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:18:15.389 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
20:18:15.389 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:18:15.389 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=6)
20:18:15.389 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
20:18:15.389 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:18:15.389 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
20:18:15.389 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
20:18:15.389 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:18:15.390 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:18:15.390 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:18:15.389 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:18:15.390 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=6
20:18:15.390 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:18:15.390 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:18:15.390 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:18:15.390 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:18:15.390 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=6
20:18:15.390 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:18:15.432 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:18:15.432 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:18:15.432 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:18:15.432 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:18:15.433 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:18:15.433 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:18:15.433 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:18:15.433 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:18:15.497 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:15.497 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:15.498 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:15.498 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:15.498 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:15.498 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:15.498 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:15.498 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:15.498 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:15.498 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:15.498 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:15.498 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:15.498 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:15.498 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:15.498 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:15.498 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:18:15.498 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:15.498 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:15.498 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
20:18:15.498 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:18:15.498 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:18:15.499 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:15.499 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:15.499 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
20:18:15.499 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:18:15.508 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:15.508 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:18:15.509 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:18:15.509 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:15.509 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:15.509 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:15.783 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:15.789 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:18:15.789 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:18:15.789 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:15.789 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:18:15.789 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:15.789 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:15.789 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:15.933 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:18:15.939 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test, data)
20:18:17.945 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:17.946 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:17.946 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:17.946 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:17.946 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:17.960 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:17.961 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:18:17.961 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:18:17.961 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:17.961 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:17.961 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:17.961 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:17.962 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:18:17.962 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:18:17.962 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:17.962 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:17.962 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:17.962 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:17.962 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:18:17.962 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:18:17.962 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:17.962 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:17.962 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:18.239 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:18.240 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:18:18.241 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:18:18.241 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:18.241 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:18.241 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:18:18.242 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:18:18.242 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:18.242 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:18.242 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:18:18.243 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:18:18.243 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:18.243 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:18.243 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:18:18.243 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:18:18.243 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:18:18.243 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:18.243 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:18.243 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:18.243 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:18.244 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:18:18.244 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:18:18.244 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:18:18.281 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Leader: node-3
20:18:18.282 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:18:18.282 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
20:18:18.282 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:18:18.283 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:18.283 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:18:18.283 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:18.283 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:18:18.283 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:18.283 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:18:18.283 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:18:18.283 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:18:18.283 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:18.283 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:18:18.283 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:18:18.284 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:18:18.284 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key2, value2)
20:18:18.284 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:18.284 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:18:18.284 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:18.284 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:18.284 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:18:18.284 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:18:18.284 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:18.284 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:18:18.284 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:18:18.284 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:18.284 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:18:18.284 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:18:18.284 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:18:18.284 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:18:18.284 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:18:18.284 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:18:18.284 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:18:18.284 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key3, value3)
20:18:18.285 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:18:18.285 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:18:18.285 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:18:18.285 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:18:18.285 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:18:18.285 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:18:18.285 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:18:18.285 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:18:18.285 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:18:18.285 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:18:18.285 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:18:18.285 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:18:18.285 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:18:18.285 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:18:18.285 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:18:18.285 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:18:18.296 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:18:18.296 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:18:18.296 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:18:18.296 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:18:18.386 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Stopping all nodes...
20:18:18.386 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:18.386 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:18.387 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:18.387 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:18.387 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:18.387 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:18.387 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:18.387 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:18.387 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:18.387 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:18.387 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:18.387 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:18.387 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:18.387 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:18.387 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:18.387 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting all nodes...
20:18:18.387 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:18.389 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
20:18:18.389 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:18:18.389 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:18:18.389 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:18:18.389 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:18:18.389 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:18:18.389 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=3
20:18:18.389 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:18.389 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:18.390 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:18.390 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:18.390 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
20:18:18.390 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:18:18.390 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:18:18.390 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:18:18.390 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:18:18.390 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:18:18.390 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=3
20:18:18.390 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:18.390 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:18.390 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:18.390 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:18.390 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
20:18:18.391 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:18:18.391 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:18:18.391 [main] [node-3] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:18:18.391 [main] [node-3] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:18:18.391 [main] [node-3] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:18:18.391 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=3
20:18:18.391 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:18.391 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:18.391 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:18.543 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:18.544 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:18:18.545 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:18:18.545 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:18:18.545 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:18.545 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=2)
20:18:18.545 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=2)
20:18:18.545 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:18:18.545 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:18.545 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:18.546 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:18:18.546 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:18.546 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:18.546 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:18:18.546 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:18:18.546 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:18:18.546 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:18.546 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:18:18.546 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:18:18.546 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:18.546 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:18:18.546 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:18:18.546 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:18:18.599 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - New leader after restart: node-3
20:18:18.601 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - All nodes recovered successfully
20:18:18.602 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:18.602 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:18.602 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:18.602 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:18.602 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:18.602 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:18.602 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:18.602 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:18.602 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:18.602 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:18.602 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:18.602 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:18.602 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:18.602 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:18.602 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:18.606 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:18.606 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:18:18.606 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:18:18.606 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:18.606 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:18.606 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:18.607 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:18.607 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:18:18.607 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:18:18.607 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:18.607 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:18.607 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:18.607 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:18.607 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:18:18.607 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:18:18.608 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:18.608 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:18.608 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:18.816 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:18.818 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:18:18.818 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:18:18.819 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:18.819 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:18.819 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:18:18.819 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:18:18.819 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:18:18.820 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:18.820 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:18:18.820 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:18.820 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:18.820 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:18.820 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:18:18.820 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:18:18.820 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:18:18.820 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:18:18.820 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:18:18.820 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:18:18.820 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:18.820 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:18.821 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:18.821 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:18.923 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:18:18.923 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, restart)
20:18:18.923 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:18:18.923 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:18:18.923 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:18:18.923 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:18:18.923 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:18:18.924 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:18:18.924 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:18:18.924 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:18:18.924 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:18:18.924 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:18:18.924 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:18.924 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:18.924 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:18:18.924 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:18:18.924 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:18.924 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:18:18.924 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:18:18.924 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:18:18.976 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:18.976 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:18:18.976 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:18:18.976 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:18:19.025 [main] [node-2] INFO  c.raftdb.integration.PersistenceTest - Restarting follower: node-1
20:18:19.025 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:19.025 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:19.025 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:19.025 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:19.025 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:19.131 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:18:19.131 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during, downtime)
20:18:19.131 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.131 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.171 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.171 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.226 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.226 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.245 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:19.247 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:18:19.247 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:18:19.247 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:19.247 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:18:19.247 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:18:19.276 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.276 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.326 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.326 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.376 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.377 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.423 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.423 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.476 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.476 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.486 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:19.487 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-2
20:18:19.487 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
20:18:19.487 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:19.487 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:18:19.487 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:18:19.526 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.526 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.574 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.574 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.626 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.626 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.654 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:19.655 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-2
20:18:19.655 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
20:18:19.655 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:19.656 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:18:19.656 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:18:19.676 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.676 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.725 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.726 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.771 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.772 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.826 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.827 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.874 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.875 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.920 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:19.922 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-2
20:18:19.923 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 5
20:18:19.923 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:19.924 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:18:19.924 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:18:19.926 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.926 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:19.977 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:19.978 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.023 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.023 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.076 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.077 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.125 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.125 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.175 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.175 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.193 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:20.194 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-2
20:18:20.194 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 6
20:18:20.194 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:20.194 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:18:20.194 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:18:20.226 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.226 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.276 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.276 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.326 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.326 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.369 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:20.370 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=7, votedFor=node-2
20:18:20.370 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 7
20:18:20.370 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:20.370 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:18:20.370 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:18:20.376 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.376 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.426 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.426 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.475 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.475 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.526 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.527 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.572 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.572 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.593 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:20.594 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=8, votedFor=node-2
20:18:20.594 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 8
20:18:20.594 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:20.594 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:18:20.594 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:18:20.626 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.626 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.671 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.671 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.726 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.726 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.774 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.774 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.825 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.825 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.834 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:20.836 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=9, votedFor=node-2
20:18:20.836 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 9
20:18:20.836 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:20.837 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:18:20.837 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:18:20.874 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.874 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.926 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.926 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:20.975 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:20.975 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:21.026 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:21.027 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:21.076 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:21.076 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:21.085 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:21.086 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=10, votedFor=node-2
20:18:21.087 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 10
20:18:21.087 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:21.087 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:18:21.087 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:18:21.126 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:18:21.126 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:18:21.138 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:21.139 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:21.139 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:21.139 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:21.139 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:21.139 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:21.140 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:21.140 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:21.140 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:21.140 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:21.147 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:21.148 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:18:21.148 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:18:21.148 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:21.148 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:21.148 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:21.405 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:21.408 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:18:21.409 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:18:21.410 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:21.410 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:18:21.410 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:21.410 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:21.410 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:21.465 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:21.466 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:21.466 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:21.466 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:21.466 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:21.466 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:21.467 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:18:21.467 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:18:21.467 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=0
20:18:21.467 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:21.467 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:21.468 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:21.468 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Term persisted: 1 -> 1
20:18:21.468 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:21.468 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:21.468 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:21.468 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:21.468 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:21.475 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:21.475 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:21.475 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:21.475 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:21.475 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:21.475 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:21.475 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:21.475 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:21.475 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:21.475 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:21.475 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:21.475 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:21.643 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:21.643 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:21.643 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:21.643 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:18:21.643 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:18:21.643 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:21.643 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:21.643 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:21.643 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:21.643 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:21.643 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:21.643 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:18:21.643 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:18:21.644 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:21.644 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:21.644 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:21.644 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:21.686 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-1 (term 1)
20:18:21.898 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - All nodes agree on leader: node-1
20:18:21.901 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:21.901 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:21.901 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:21.901 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:21.901 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:21.901 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:21.901 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:21.901 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:21.901 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:21.901 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:21.901 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:21.901 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:21.901 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:21.901 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:21.901 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:21.905 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:21.905 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:21.905 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:21.905 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:21.906 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:21.906 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:21.906 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:21.906 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:21.906 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:21.906 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:21.906 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:21.906 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:21.906 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:18:21.906 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
20:18:21.906 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:21.906 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
20:18:21.906 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:18:21.906 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
20:18:21.906 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:21.906 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
20:18:22.151 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:22.152 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:22.152 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:18:22.152 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:18:22.152 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:18:22.152 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:22.152 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 VoteRequest(term=1)
20:18:22.152 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:22.152 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:22.152 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 VoteRequest(term=1)
20:18:22.152 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:22.153 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:22.153 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:22.153 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:22.153 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:22.153 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:22.153 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:22.153 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:22.153 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:18:22.153 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:18:22.153 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:18:22.153 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-4 VoteResponse(granted=true)
20:18:22.153 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:18:22.153 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:22.153 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:22.153 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-5 VoteResponse(granted=true)
20:18:22.153 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:22.153 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:22.224 [main] [node-5] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-1 (term 1)
20:18:22.224 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:22.224 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:22.224 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:22.224 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:22.224 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:22.224 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:22.224 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:22.224 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:22.224 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:22.224 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:22.224 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:22.224 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:22.224 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:22.224 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:22.225 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:22.225 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:18:22.225 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:22.225 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:22.225 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
20:18:22.225 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:18:22.225 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:18:22.225 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:22.225 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:22.225 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
20:18:22.225 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:18:22.227 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:22.227 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:22.227 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:22.227 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:22.227 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:22.227 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:22.227 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:22.227 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:22.227 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:22.227 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:22.227 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:22.227 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:22.446 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:22.447 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:22.447 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:22.447 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:18:22.447 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:18:22.447 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:22.447 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:22.447 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:22.448 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:18:22.448 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:22.448 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:18:22.448 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:18:22.448 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:22.448 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:18:22.448 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:22.448 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:22.448 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:23.050 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader node-3 maintained leadership for 500ms
20:18:23.050 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:23.050 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:23.051 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:23.051 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:23.051 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:23.051 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:23.051 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:23.051 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:23.051 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:23.051 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:23.051 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:23.051 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:23.051 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:23.051 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:23.051 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:18:23.054 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:18:23.054 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:18:23.054 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:23.055 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:18:23.055 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:18:23.055 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:18:23.055 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:23.055 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:18:23.055 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:18:23.055 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:18:23.055 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:18:23.055 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:18:23.257 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:23.257 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:18:23.257 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:23.258 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:18:23.258 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:23.258 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:23.258 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:23.258 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:18:23.258 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:23.258 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:18:23.258 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:18:23.258 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:23.258 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:18:23.258 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:23.258 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:23.258 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:18:23.258 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:18:23.266 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Initial leader: node-1 (term 1)
20:18:23.267 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:18:23.267 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:23.267 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:23.267 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:18:23.267 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:18:23.422 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:18:23.423 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:18:23.423 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:18:23.424 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=2)
20:18:23.424 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:18:23.424 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:23.424 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:18:23.424 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:18:23.424 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:18:23.424 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:18:23.424 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:18:23.424 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:18:23.424 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:18:23.471 [main] [node-1] INFO  com.raftdb.integration.ClusterTest - New leader: node-3 (term 2)
20:18:23.472 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:18:23.472 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:23.472 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:23.472 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:18:23.472 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:18:23.472 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:18:23.472 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:18:23.472 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:18:23.472 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:18:23.472 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:24:34.160 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:24:34.162 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:24:34.162 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:24:34.164 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:24:34.164 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:24:34.164 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:24:34.466 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:34.472 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:24:34.473 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:24:34.473 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:24:34.481 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:24:34.481 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:24:34.481 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:24:34.481 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:24:34.590 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:24:34.591 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test, data)
20:24:36.604 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:24:36.605 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:36.605 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:24:36.605 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:24:36.606 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:24:36.626 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:24:36.627 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:24:36.627 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:24:36.627 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:24:36.627 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:24:36.627 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:24:36.627 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:24:36.628 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:24:36.628 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:24:36.628 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:24:36.628 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:24:36.628 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:24:36.628 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:24:36.628 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:24:36.629 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:24:36.629 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:24:36.629 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:24:36.629 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:24:36.839 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:36.840 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:24:36.841 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:24:36.841 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:24:36.841 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:24:36.846 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:24:36.847 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:24:36.847 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:24:36.847 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:24:36.847 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:36.847 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:24:36.848 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:24:36.848 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:24:36.848 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:36.848 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:24:36.848 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:24:36.848 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:24:36.849 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:24:36.849 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:24:36.849 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:24:36.849 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:24:36.849 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:24:36.849 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:24:36.946 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Leader: node-1
20:24:36.946 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:24:36.947 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
20:24:36.951 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:24:36.951 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:24:36.951 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:24:36.951 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:24:36.951 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:24:36.952 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:24:36.952 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:24:36.952 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:24:36.952 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:24:36.952 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:24:36.952 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:24:36.952 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:24:36.952 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:24:36.952 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:24:36.952 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:24:36.952 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:24:36.953 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:24:36.953 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:24:36.953 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:24:36.954 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:24:36.954 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key2, value2)
20:24:36.955 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:36.955 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:24:36.955 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:24:36.955 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:24:36.955 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:24:36.955 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:24:36.955 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:24:36.955 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:24:36.955 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:24:36.955 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:24:36.955 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:24:36.955 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:24:36.955 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:24:36.955 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:24:36.955 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:24:36.955 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:24:36.956 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:24:36.956 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key3, value3)
20:24:36.956 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:24:36.956 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:24:36.956 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:24:36.956 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:24:36.956 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:24:36.956 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:24:36.956 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:24:36.956 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:24:36.956 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:24:36.956 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:24:36.956 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:24:36.956 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:24:36.956 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:24:36.956 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:24:36.956 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:24:36.957 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:24:37.002 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:24:37.002 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:24:37.002 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:24:37.002 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:24:37.082 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Stopping all nodes...
20:24:37.082 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:24:37.082 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:37.082 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:24:37.083 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:24:37.083 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:24:37.083 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:24:37.083 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:37.083 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:24:37.083 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:24:37.083 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:24:37.083 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:24:37.083 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:37.083 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:24:37.084 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:24:37.084 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:24:37.084 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting all nodes...
20:24:37.084 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:24:37.084 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:24:37.085 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:24:37.085 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:24:37.085 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:24:37.085 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:24:37.085 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:24:37.085 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
20:24:37.085 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:24:37.085 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:24:37.085 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:24:37.086 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:24:37.086 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:24:37.086 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:24:37.086 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:24:37.086 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:24:37.086 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:24:37.086 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:24:37.086 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
20:24:37.086 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:24:37.086 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:24:37.086 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:24:37.086 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:24:37.087 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:24:37.087 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:24:37.087 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:24:37.087 [main] [node-3] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:24:37.087 [main] [node-3] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:24:37.087 [main] [node-3] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:24:37.087 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
20:24:37.087 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:24:37.087 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:24:37.087 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:24:37.360 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:37.363 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:24:37.363 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:24:37.363 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:24:37.364 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=2)
20:24:37.364 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=2)
20:24:37.365 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:24:37.365 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:24:37.365 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:24:37.365 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:24:37.365 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:37.365 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:37.366 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:24:37.366 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:24:37.366 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:24:37.366 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:24:37.366 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:24:37.366 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:24:37.366 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:24:37.366 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:24:37.366 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:24:37.366 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:24:37.400 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - New leader after restart: node-3
20:24:37.404 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - All nodes recovered successfully
20:24:37.405 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:24:37.405 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:37.405 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:24:37.405 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:24:37.405 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:24:37.405 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:24:37.405 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:37.405 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:24:37.405 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:24:37.406 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:24:37.406 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:24:37.406 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:37.406 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:24:37.406 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:24:37.406 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:24:37.410 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:24:37.411 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:24:37.411 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:24:37.411 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:24:37.411 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:24:37.411 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:24:37.411 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:24:37.411 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:24:37.412 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:24:37.412 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:24:37.412 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:24:37.412 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:24:37.412 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:24:37.412 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:24:37.412 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:24:37.412 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:24:37.412 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:24:37.412 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:24:37.576 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:37.578 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:24:37.579 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:24:37.579 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:24:37.579 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:24:37.580 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:24:37.580 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:24:37.580 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:24:37.581 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:24:37.581 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:24:37.581 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:24:37.581 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:37.581 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:37.581 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:24:37.581 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:24:37.581 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:24:37.581 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:24:37.582 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:24:37.582 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:24:37.582 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:24:37.582 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:24:37.582 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:24:37.582 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:24:37.620 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:24:37.620 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, restart)
20:24:37.621 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:24:37.621 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:24:37.621 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:24:37.621 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:24:37.621 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:24:37.621 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:24:37.621 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:24:37.621 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:24:37.621 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:24:37.621 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:24:37.621 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:24:37.622 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:24:37.636 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:24:37.636 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:24:37.636 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:24:37.636 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:24:37.727 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting follower: node-1
20:24:37.727 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:24:37.727 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:37.728 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:24:37.728 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:24:37.728 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:24:37.834 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:24:37.835 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during, downtime)
20:24:37.836 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:37.836 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:37.836 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:37.836 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:37.886 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:37.887 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:37.936 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:37.936 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:37.944 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:37.944 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:24:37.944 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:24:37.945 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:24:37.945 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:24:37.945 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:24:37.987 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:37.988 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.038 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.039 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.085 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.085 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.109 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:38.111 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-3
20:24:38.111 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
20:24:38.111 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:24:38.111 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:24:38.111 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:24:38.138 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.138 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.188 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.188 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.238 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.239 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.288 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.288 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.324 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:38.325 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-3
20:24:38.325 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
20:24:38.325 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:24:38.325 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:24:38.325 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:24:38.334 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.335 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.392 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.393 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.437 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.438 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.487 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.488 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.494 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:38.495 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-3
20:24:38.495 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 5
20:24:38.495 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:24:38.495 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:24:38.495 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:24:38.536 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.536 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.588 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.588 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.638 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.638 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.688 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.688 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.733 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.734 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.749 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:38.750 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-3
20:24:38.750 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 6
20:24:38.750 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:24:38.751 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:24:38.751 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:24:38.788 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.788 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.838 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.838 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.886 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.887 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.936 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.936 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:38.977 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:38.978 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=7, votedFor=node-3
20:24:38.978 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 7
20:24:38.978 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:24:38.978 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:24:38.978 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:24:38.983 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:38.984 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.033 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.033 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.087 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.088 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.137 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.137 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.159 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:39.160 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=8, votedFor=node-3
20:24:39.161 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 8
20:24:39.161 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:24:39.161 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:24:39.161 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:24:39.187 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.188 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.234 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.234 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.287 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.288 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.345 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.345 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:39.345 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.346 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=9, votedFor=node-3
20:24:39.347 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 9
20:24:39.347 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:24:39.347 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:24:39.347 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:24:39.386 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.386 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.436 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.437 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.486 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.487 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.516 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:39.517 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=10, votedFor=node-3
20:24:39.517 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 10
20:24:39.517 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:24:39.517 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:24:39.517 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:24:39.538 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.538 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.637 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.637 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.686 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.686 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.736 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.736 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.756 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:39.757 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=11, votedFor=node-3
20:24:39.757 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 11
20:24:39.758 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:24:39.758 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:24:39.758 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:24:39.788 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.788 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.838 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:24:39.838 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:24:39.838 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:39.838 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:24:39.838 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:24:39.838 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:24:39.838 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:24:39.838 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:24:39.838 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:39.839 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:24:39.839 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:24:39.839 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:24:39.845 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:24:39.846 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:24:39.846 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:24:39.846 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:24:39.846 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:24:39.846 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:24:40.093 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:24:40.094 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:24:40.095 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:24:40.095 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:24:40.095 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:24:40.095 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:24:40.095 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:24:40.095 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:24:40.163 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:24:40.163 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:40.163 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:24:40.163 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:24:40.164 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:24:40.164 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:24:40.164 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:24:40.164 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:24:40.164 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=0
20:24:40.164 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:24:40.164 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:24:40.165 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:24:40.165 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Term persisted: 1 -> 1
20:24:40.165 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:24:40.165 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:24:40.165 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:24:40.166 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:24:40.166 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:25:01.873 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:25:01.876 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:25:01.876 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:25:01.878 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:25:01.878 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:25:01.879 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:25:02.180 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:25:02.187 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:25:02.188 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:25:02.188 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:25:02.203 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:25:02.203 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:25:02.203 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:25:02.203 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:25:02.307 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:25:02.307 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test, data)
20:25:04.319 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:25:04.320 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:25:04.320 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:25:04.320 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:25:04.321 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:27:48.405 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:27:48.407 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:27:48.407 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:27:48.409 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:27:48.409 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:27:48.409 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:27:48.700 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:27:48.710 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:27:48.711 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:27:48.711 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:27:48.724 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:27:48.724 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:27:48.724 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:27:48.724 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:27:48.834 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:27:48.834 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test, data)
20:27:48.835 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:27:48.836 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test, data)
20:27:48.853 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Data files created at target/test-data/node-1
20:27:48.854 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:27:48.854 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:27:48.855 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:27:48.855 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:27:48.855 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:28:16.415 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:28:16.418 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:28:16.418 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:28:16.419 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:28:16.419 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:28:16.420 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:28:16.420 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:28:16.420 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:28:16.420 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:28:16.420 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:28:16.420 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:28:16.420 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:28:16.420 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:28:16.421 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:28:16.421 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:28:16.421 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:28:16.421 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:28:16.421 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:28:16.586 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:28:16.589 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:28:16.590 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:28:16.590 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:28:16.602 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:28:16.610 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:28:16.612 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:28:16.612 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:28:16.612 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:28:16.613 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:28:16.613 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:28:16.615 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:28:16.615 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:28:16.615 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:28:16.615 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:28:16.615 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:28:16.617 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:28:16.618 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:28:16.618 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:28:16.618 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:28:16.618 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:28:16.618 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:28:16.619 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:28:16.648 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:28:16.648 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, restart)
20:28:16.652 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:28:16.653 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:28:16.653 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:28:16.653 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:28:16.653 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:28:16.653 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:28:16.653 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:28:16.653 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:28:16.653 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:28:16.654 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:28:16.654 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:28:16.654 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:28:16.655 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:28:16.678 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:28:16.678 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:28:16.679 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:28:16.679 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:28:16.781 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting follower: node-1
20:28:16.781 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:28:16.781 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:28:16.781 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:28:16.781 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:28:16.781 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:28:16.887 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:28:16.887 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during, downtime)
20:28:16.888 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:16.888 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:16.928 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:16.928 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:16.983 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:16.983 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.002 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:28:17.007 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:28:17.007 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:28:17.007 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:28:17.008 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:28:17.008 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:28:17.026 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.027 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.081 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.082 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.132 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.133 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.181 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.181 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.224 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:28:17.225 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-3
20:28:17.226 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
20:28:17.226 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:28:17.226 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:28:17.226 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:28:17.231 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.231 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.279 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.280 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.331 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.331 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.378 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.378 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.429 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.430 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.481 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.481 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.484 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:28:17.485 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-3
20:28:17.485 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
20:28:17.485 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:28:17.485 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:28:17.485 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:28:17.531 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.531 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.580 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.580 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.631 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.631 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.678 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.678 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.728 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.728 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.744 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:28:17.746 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-3
20:28:17.746 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 5
20:28:17.748 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:28:17.749 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:28:17.749 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:28:17.777 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.778 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.830 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.831 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.879 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.880 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.931 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.931 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:17.981 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:17.981 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.029 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.031 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.050 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:28:18.052 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-3
20:28:18.052 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 6
20:28:18.052 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:28:18.053 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:28:18.053 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:28:18.080 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.081 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.129 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.130 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.183 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.184 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.235 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.235 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.268 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:28:18.271 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=7, votedFor=node-3
20:28:18.271 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 7
20:28:18.271 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:28:18.273 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:28:18.273 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:28:18.286 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.286 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.331 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.332 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.381 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.381 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.428 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.428 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.481 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.481 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.505 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:28:18.506 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=8, votedFor=node-3
20:28:18.507 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 8
20:28:18.507 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:28:18.507 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:28:18.507 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:28:18.531 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.531 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.581 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.583 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.629 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.630 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.681 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.684 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.731 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.732 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.778 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:28:18.779 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.780 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.782 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=9, votedFor=node-3
20:28:18.782 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 9
20:28:18.782 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:28:18.790 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:28:18.791 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:28:18.827 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.831 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.880 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:28:18.881 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:28:18.905 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:28:18.906 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:28:18.906 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:28:18.906 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:28:18.909 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:28:18.909 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:28:18.909 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:28:18.910 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:28:18.910 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:28:18.910 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:29:55.857 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:29:55.859 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:29:55.859 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:55.860 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:29:55.860 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:29:55.860 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:29:55.860 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:55.860 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:29:55.860 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:29:55.860 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:29:55.860 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:55.860 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:29:56.051 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:56.052 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:29:56.061 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:29:56.067 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:29:56.067 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:56.067 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.067 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:29:56.067 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:29:56.067 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:56.068 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:29:56.069 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.069 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:29:56.069 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:29:56.069 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:29:56.069 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:29:56.069 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:29:56.070 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:29:56.078 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:29:56.078 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key3, value3)
20:29:56.082 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:29:56.082 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:29:56.082 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:29:56.083 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:29:56.083 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:56.083 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:56.083 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:29:56.083 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:29:56.083 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:29:56.083 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:29:56.083 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:29:56.103 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:29:56.103 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(key3)
20:29:56.104 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:29:56.104 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:29:56.104 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:29:56.104 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:29:56.104 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:29:56.104 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:29:56.104 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:56.104 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:56.104 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:29:56.104 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:29:56.104 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:29:56.104 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:29:56.104 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:29:56.105 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:29:56.105 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:29:56.127 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:29:56.127 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:29:56.128 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:29:56.128 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:29:56.212 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:29:56.213 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.213 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:56.213 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:29:56.213 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:29:56.213 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:29:56.213 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.213 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:56.214 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:29:56.214 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:29:56.214 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:29:56.214 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.214 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:56.214 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:29:56.214 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:29:56.220 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:29:56.220 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:29:56.220 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:56.221 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:29:56.221 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:29:56.221 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:29:56.221 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:56.221 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:29:56.221 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:29:56.221 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:29:56.221 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:56.221 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:29:56.415 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:56.416 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:29:56.416 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:29:56.416 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:29:56.416 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:29:56.416 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:56.416 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:56.416 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.416 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.416 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:29:56.416 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:29:56.416 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:29:56.416 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:29:56.416 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:29:56.416 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:29:56.416 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:29:56.416 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:29:56.430 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:29:56.431 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-0, value-0)
20:29:56.431 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:29:56.431 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:29:56.431 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-1, value-1)
20:29:56.431 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:56.431 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=1)
20:29:56.431 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=1)
20:29:56.431 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:29:56.431 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:56.431 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
20:29:56.431 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=1)
20:29:56.431 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
20:29:56.431 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-2, value-2)
20:29:56.431 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
20:29:56.431 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:29:56.431 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
20:29:56.431 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:29:56.431 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:29:56.432 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 3
20:29:56.431 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
20:29:56.432 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-3, value-3)
20:29:56.432 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 3
20:29:56.432 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
20:29:56.432 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=3)
20:29:56.432 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:29:56.432 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:29:56.432 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-4, value-4)
20:29:56.432 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:29:56.432 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=3)
20:29:56.432 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
20:29:56.432 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=4)
20:29:56.432 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:29:56.432 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:29:56.432 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-5, value-5)
20:29:56.432 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
20:29:56.432 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=3)
20:29:56.432 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:29:56.432 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
20:29:56.432 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
20:29:56.432 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:29:56.432 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 5
20:29:56.432 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-6, value-6)
20:29:56.432 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:29:56.432 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 4
20:29:56.432 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:29:56.433 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:29:56.433 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:29:56.432 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
20:29:56.433 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 5
20:29:56.433 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:29:56.433 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:29:56.432 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=3)
20:29:56.432 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=4)
20:29:56.432 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:29:56.433 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=6)
20:29:56.432 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=4)
20:29:56.432 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 6
20:29:56.433 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
20:29:56.433 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:29:56.433 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:29:56.433 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-7, value-7)
20:29:56.433 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:29:56.433 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:29:56.433 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:29:56.433 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:29:56.433 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:29:56.433 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
20:29:56.433 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:29:56.433 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:29:56.433 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=7)
20:29:56.433 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
20:29:56.433 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=6)
20:29:56.434 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=6)
20:29:56.433 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
20:29:56.434 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
20:29:56.433 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
20:29:56.433 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 7
20:29:56.434 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
20:29:56.433 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:29:56.434 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:29:56.433 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-8, value-8)
20:29:56.434 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:29:56.434 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:29:56.434 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
20:29:56.434 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:29:56.434 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
20:29:56.434 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-9, value-9)
20:29:56.434 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 6
20:29:56.434 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=6)
20:29:56.434 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
20:29:56.434 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
20:29:56.434 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:29:56.434 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
20:29:56.434 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 9
20:29:56.434 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
20:29:56.434 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:29:56.434 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
20:29:56.434 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:29:56.434 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:29:56.434 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=7)
20:29:56.434 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:29:56.434 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:29:56.435 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
20:29:56.435 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:29:56.434 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
20:29:56.435 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
20:29:56.435 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 10
20:29:56.434 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:29:56.435 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 9
20:29:56.435 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 9
20:29:56.434 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:29:56.435 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
20:29:56.435 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:29:56.435 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
20:29:56.435 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=7)
20:29:56.435 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:29:56.435 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
20:29:56.435 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:29:56.435 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=9)
20:29:56.435 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:29:56.436 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=5)
20:29:56.436 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:29:56.436 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
20:29:56.436 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=11)
20:29:56.436 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:29:56.436 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:29:56.436 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=10)
20:29:56.436 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=10)
20:29:56.436 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
20:29:56.436 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:29:56.436 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
20:29:56.436 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
20:29:56.437 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:29:56.436 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 11
20:29:56.436 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 11
20:29:56.437 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=11)
20:29:56.436 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:29:56.436 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:29:56.437 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
20:29:56.436 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
20:29:56.437 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
20:29:56.437 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 12
20:29:56.437 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:29:56.437 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:29:56.437 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:29:56.437 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=12
20:29:56.437 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
20:29:56.437 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=10)
20:29:56.437 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:29:56.437 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:29:56.437 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=13)
20:29:56.437 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
20:29:56.437 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:29:56.437 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
20:29:56.437 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:29:56.437 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 12
20:29:56.437 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-13, value-13)
20:29:56.437 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
20:29:56.437 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=12)
20:29:56.437 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:29:56.437 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:29:56.437 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
20:29:56.437 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 12
20:29:56.437 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
20:29:56.438 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 14
20:29:56.437 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:29:56.437 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:56.437 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:29:56.438 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:29:56.437 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:29:56.438 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:29:56.437 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:29:56.438 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=14
20:29:56.438 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-14, value-14)
20:29:56.438 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 14
20:29:56.438 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 13
20:29:56.438 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
20:29:56.438 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:29:56.438 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=13
20:29:56.438 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 14
20:29:56.438 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:29:56.438 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 14
20:29:56.438 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=13)
20:29:56.438 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:29:56.438 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
20:29:56.438 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
20:29:56.438 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
20:29:56.438 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=13)
20:29:56.438 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=15)
20:29:56.438 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
20:29:56.438 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
20:29:56.438 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-16, value-16)
20:29:56.438 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
20:29:56.438 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=15)
20:29:56.438 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
20:29:56.438 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 16
20:29:56.438 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
20:29:56.438 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:29:56.438 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
20:29:56.438 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=14)
20:29:56.438 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
20:29:56.438 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
20:29:56.439 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-17, value-17)
20:29:56.439 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:29:56.439 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
20:29:56.439 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=15
20:29:56.439 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:29:56.439 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:29:56.439 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:29:56.439 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 16
20:29:56.439 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
20:29:56.439 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:29:56.439 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
20:29:56.439 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=15)
20:29:56.439 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:29:56.439 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=14)
20:29:56.439 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:29:56.439 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
20:29:56.439 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 17
20:29:56.439 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
20:29:56.439 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 18
20:29:56.439 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=16
20:29:56.439 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-18, value-18)
20:29:56.439 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=16)
20:29:56.439 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:29:56.439 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
20:29:56.439 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 17
20:29:56.439 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-19, value-19)
20:29:56.439 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=19)
20:29:56.439 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=17)
20:29:56.439 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=16
20:29:56.440 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=17)
20:29:56.440 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
20:29:56.440 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=19)
20:29:56.440 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
20:29:56.440 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
20:29:56.439 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=5)
20:29:56.439 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=17
20:29:56.439 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=18
20:29:56.440 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 18
20:29:56.440 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
20:29:56.439 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 18
20:29:56.439 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 18
20:29:56.440 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
20:29:56.439 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:29:56.439 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
20:29:56.439 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:29:56.440 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:29:56.439 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=17
20:29:56.440 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:29:56.440 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
20:29:56.440 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=18)
20:29:56.440 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 18
20:29:56.440 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
20:29:56.440 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 18
20:29:56.440 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
20:29:56.440 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
20:29:56.440 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 18
20:29:56.440 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 20
20:29:56.440 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 19
20:29:56.440 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:29:56.440 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 20
20:29:56.440 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
20:29:56.440 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
20:29:56.440 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
20:29:56.440 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:29:56.441 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
20:29:56.441 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:29:56.441 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:29:56.441 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:29:56.441 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:29:56.441 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:29:56.441 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:29:56.441 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:29:56.472 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:29:56.472 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:29:56.472 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:29:56.472 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:29:56.472 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:29:56.472 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:29:56.472 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:29:56.472 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:29:56.472 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:29:56.472 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:29:56.548 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:29:56.548 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.548 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:56.549 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:29:56.549 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:29:56.549 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:29:56.549 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.549 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:56.549 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:29:56.549 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:29:56.549 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:29:56.549 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.549 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:56.549 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:29:56.550 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:29:56.552 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:29:56.552 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:29:56.552 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:56.552 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:29:56.553 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:29:56.553 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:29:56.553 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:56.553 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:29:56.553 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:29:56.553 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:29:56.553 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:56.553 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:29:56.711 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:56.711 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:29:56.711 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:29:56.711 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:29:56.711 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:29:56.712 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:56.712 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:56.712 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.712 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.712 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:29:56.712 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:29:56.712 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:29:56.712 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:29:56.712 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:29:56.712 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:29:56.712 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:29:56.712 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:29:56.762 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:29:56.762 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key2, value2)
20:29:56.762 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:29:56.763 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:29:56.763 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:29:56.763 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:29:56.763 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:29:56.763 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:29:56.763 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:56.763 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:29:56.763 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:56.763 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:29:56.763 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:29:56.763 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:56.763 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:29:56.763 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:29:56.763 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:56.764 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:29:56.818 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:56.818 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:56.819 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:29:56.819 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:29:56.871 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:29:56.871 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.871 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:56.871 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:29:56.871 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:29:56.872 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:29:56.872 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.872 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:56.872 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:29:56.872 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:29:56.872 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:29:56.872 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:56.872 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:56.872 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:29:56.872 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:29:56.875 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:29:56.875 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:29:56.875 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:56.875 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:29:56.875 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:29:56.875 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:29:56.875 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:56.876 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:29:56.876 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:29:56.876 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:29:56.876 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:56.876 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:29:57.029 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:57.029 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:29:57.029 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:29:57.030 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:29:57.030 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:29:57.030 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:57.030 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:57.030 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:57.030 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:57.030 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:29:57.030 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:29:57.030 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:29:57.030 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:29:57.030 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:29:57.030 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:29:57.030 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:29:57.030 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:29:57.087 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:29:57.087 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
20:29:57.088 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:29:57.088 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:29:57.088 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:29:57.088 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:29:57.088 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:57.089 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:29:57.089 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:57.089 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:29:57.089 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:29:57.089 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:29:57.136 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:57.136 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:57.137 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:29:57.137 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:29:57.192 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - Killing leader: node-2
20:29:57.192 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:29:57.192 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:57.193 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:57.193 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:29:57.193 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:29:57.393 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:57.394 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:29:57.395 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:29:57.396 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:29:57.396 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=2)
20:29:57.396 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:57.396 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:57.397 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
20:29:57.397 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:29:57.397 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:29:57.397 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:29:57.397 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:29:57.397 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:29:57.401 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - New leader: node-1
20:29:57.408 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
20:29:57.408 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
20:29:57.409 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:29:57.409 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:29:57.409 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=2, entries=1)
20:29:57.409 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:29:57.409 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:29:57.409 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:29:57.410 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:29:57.452 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:29:57.453 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:29:57.454 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:29:57.501 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:29:57.516 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:29:57.516 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:57.516 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:57.516 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:29:57.516 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:29:57.516 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:29:57.516 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:57.516 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:57.516 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:29:57.516 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:29:57.518 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:29:57.519 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:29:57.519 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:57.519 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:29:57.519 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:29:57.519 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:29:57.519 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:57.519 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:29:57.519 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:29:57.519 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:29:57.519 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:57.519 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:29:57.736 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:57.737 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:29:57.738 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:29:57.738 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:29:57.739 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:29:57.739 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:57.739 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:57.739 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:57.739 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:29:57.739 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:57.739 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:29:57.739 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:29:57.739 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:29:57.739 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:29:57.739 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:29:57.739 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:29:57.739 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:29:57.835 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:29:57.836 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
20:29:57.836 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:29:57.837 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:29:57.837 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:57.837 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:57.837 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:57.837 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:57.837 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:29:57.837 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:29:57.837 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:29:57.837 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:29:57.837 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:29:57.838 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:29:57.838 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
20:29:57.838 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:29:57.838 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:29:57.838 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:57.838 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:57.838 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:29:57.838 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:29:57.839 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:57.839 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:57.839 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:29:57.839 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:29:57.839 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:29:57.839 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:29:57.839 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:29:57.839 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:29:57.839 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:29:57.840 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
20:29:57.840 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:29:57.840 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:29:57.840 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:29:57.840 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:57.840 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:29:57.840 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:57.840 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:29:57.840 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:57.840 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:57.841 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:29:57.840 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:29:57.841 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:29:57.841 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:29:57.841 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:29:57.840 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:29:57.841 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:29:57.841 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:29:57.841 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:29:57.841 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:29:57.841 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:29:57.841 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:29:57.841 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
20:29:57.841 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:29:57.841 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
20:29:57.841 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:57.842 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:57.842 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:29:57.842 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:29:57.842 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:29:57.842 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:29:57.842 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:29:57.842 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:29:57.842 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:29:57.842 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:29:57.842 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
20:29:57.842 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:29:57.842 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:29:57.842 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
20:29:57.842 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:29:57.843 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
20:29:57.843 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:57.843 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:29:57.843 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:57.843 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:29:57.843 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:29:57.843 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:29:57.843 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:29:57.843 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:29:57.843 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:29:57.843 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:29:57.843 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
20:29:57.843 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:29:57.843 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:29:57.843 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
20:29:57.843 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:29:57.844 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
20:29:57.844 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:57.844 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:57.844 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:29:57.844 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:29:57.844 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:29:57.844 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:29:57.844 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:29:57.844 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:29:57.844 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:29:57.844 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
20:29:57.844 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:29:57.844 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:29:57.845 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:29:57.845 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
20:29:57.845 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
20:29:57.845 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
20:29:57.845 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:57.845 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:29:57.845 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:57.845 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:29:57.845 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:29:57.845 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
20:29:57.845 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:29:57.845 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:29:57.845 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:29:57.845 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
20:29:57.845 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:29:57.845 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:29:57.846 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:29:57.846 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
20:29:57.846 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
20:29:57.846 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
20:29:57.846 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:57.846 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:29:57.846 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:29:57.846 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:57.846 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
20:29:57.846 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:29:57.846 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:29:57.846 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:29:57.846 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:29:57.846 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:29:57.846 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
20:29:57.846 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:29:57.847 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:29:57.847 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
20:29:57.847 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
20:29:57.847 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
20:29:57.847 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:57.847 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:57.847 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:29:57.847 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:29:57.847 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:29:57.847 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:29:57.847 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
20:29:57.847 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
20:29:57.847 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:29:57.847 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:29:57.847 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:29:57.847 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:29:57.847 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:29:57.847 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:29:57.847 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
20:29:57.848 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
20:29:57.848 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
20:29:57.848 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:57.848 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:57.848 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:29:57.848 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:29:57.848 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:29:57.848 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
20:29:57.848 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:29:57.848 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:29:57.848 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
20:29:57.848 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:29:57.848 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:29:57.848 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:29:57.895 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:29:57.895 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:29:57.895 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:29:57.895 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:29:57.953 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:29:57.953 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:57.953 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:57.953 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:29:57.953 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:29:57.954 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:29:57.954 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:57.954 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:57.954 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:29:57.954 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:29:57.954 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:29:57.954 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:57.954 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:57.954 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:29:57.954 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:29:57.957 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:29:57.958 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:29:57.958 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:57.958 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:29:57.958 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:29:57.958 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:29:57.958 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:57.958 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:29:57.959 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:29:57.959 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:29:57.959 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:57.959 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:29:58.160 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:58.161 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:29:58.161 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:29:58.160 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:58.162 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:29:58.163 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:29:58.163 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:29:58.163 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:29:58.163 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:29:58.163 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:58.163 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:29:58.163 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:29:58.164 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.164 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:29:58.164 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:29:58.164 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=false)
20:29:58.164 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:29:58.164 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:29:58.164 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=false)
20:29:58.164 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:29:58.164 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=false)
20:29:58.164 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:29:58.164 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:29:58.164 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:29:58.169 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Leader: node-3
20:29:58.169 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:29:58.170 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
20:29:58.170 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:29:58.170 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:29:58.170 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:58.170 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:58.170 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:58.170 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:29:58.170 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:58.170 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:29:58.170 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:29:58.171 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:29:58.171 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - PUT committed
20:29:58.217 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:58.217 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:58.217 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:29:58.217 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:29:58.277 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Data replicated to all nodes
20:29:58.278 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:29:58.278 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.278 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:58.279 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:29:58.279 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:29:58.279 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:29:58.279 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.279 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:58.279 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:29:58.279 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:29:58.279 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:29:58.279 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.279 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:58.279 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:29:58.279 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:29:58.282 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:29:58.282 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:29:58.282 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:58.282 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:29:58.282 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:29:58.282 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:29:58.282 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:58.282 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:29:58.282 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:29:58.282 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:29:58.282 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:58.282 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:29:58.456 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:58.456 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:29:58.456 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:29:58.457 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:29:58.458 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:58.458 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.458 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:29:58.458 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:29:58.458 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:29:58.458 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:29:58.458 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:29:58.458 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:29:58.458 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:29:58.459 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:58.459 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.459 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:29:58.459 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:29:58.498 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:29:58.498 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.498 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:58.498 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:29:58.498 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:29:58.498 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:29:58.498 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.498 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:58.498 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:29:58.498 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:29:58.498 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:29:58.498 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.498 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:58.498 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:29:58.498 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:29:58.500 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:29:58.500 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:29:58.500 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:58.500 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:29:58.500 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:29:58.500 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:29:58.500 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:58.500 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:29:58.500 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:29:58.500 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:29:58.500 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:58.501 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:29:58.501 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:29:58.501 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
20:29:58.501 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:58.501 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
20:29:58.501 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:29:58.501 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
20:29:58.501 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:58.501 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
20:29:58.661 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:58.661 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:29:58.662 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:29:58.662 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:29:58.662 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:29:58.662 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:58.662 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.662 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 VoteRequest(term=1)
20:29:58.662 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 VoteRequest(term=1)
20:29:58.662 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:58.662 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:58.662 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:58.662 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:29:58.662 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.662 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.662 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:29:58.662 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.663 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:29:58.663 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:29:58.663 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:29:58.663 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:29:58.663 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-4 VoteResponse(granted=true)
20:29:58.663 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-5 VoteResponse(granted=true)
20:29:58.663 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:29:58.663 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:29:58.663 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:29:58.663 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:29:58.663 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:29:58.712 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:29:58.712 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(stable-key, initial)
20:29:58.713 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:29:58.713 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:29:58.713 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:29:58.713 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:29:58.713 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:29:58.713 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:29:58.713 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
20:29:58.713 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:58.713 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:29:58.713 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:58.713 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
20:29:58.713 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
20:29:58.713 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:29:58.713 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:29:58.713 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
20:29:58.713 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
20:29:58.714 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
20:29:58.714 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:58.714 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
20:29:58.713 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:29:58.713 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:58.714 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:29:58.714 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:29:58.714 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:58.714 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
20:29:58.714 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:29:58.714 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
20:29:58.714 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:58.714 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:58.714 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
20:29:58.714 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:58.714 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:29:58.768 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:58.768 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:58.768 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:58.768 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:58.769 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:29:58.769 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:29:58.769 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:29:58.769 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:29:58.821 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:29:58.821 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-0, value-0)
20:29:58.821 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:29:58.821 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:29:58.821 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:29:58.821 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
20:29:58.821 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:29:58.822 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
20:29:58.822 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:29:58.822 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
20:29:58.822 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
20:29:58.822 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:29:58.822 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:29:58.822 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:29:58.822 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
20:29:58.822 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:29:58.822 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
20:29:58.822 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:29:58.822 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:29:58.822 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:29:58.822 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:29:58.822 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:29:58.822 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-1, value-1)
20:29:58.823 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:29:58.823 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:29:58.823 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:29:58.823 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=3)
20:29:58.823 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:29:58.823 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:29:58.823 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=3)
20:29:58.823 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:29:58.823 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
20:29:58.823 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:29:58.823 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
20:29:58.823 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:29:58.823 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:29:58.823 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:29:58.823 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:29:58.823 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:29:58.823 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:29:58.823 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:29:58.823 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:29:58.823 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:29:58.823 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:29:58.823 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=3
20:29:58.823 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:29:58.823 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=3
20:29:58.823 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:29:58.823 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:29:58.823 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:29:58.824 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:29:58.824 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-2, value-2)
20:29:58.824 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
20:29:58.824 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
20:29:58.824 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:29:58.824 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=4)
20:29:58.824 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:29:58.824 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:29:58.824 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=4)
20:29:58.824 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:29:58.824 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:29:58.824 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:29:58.824 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
20:29:58.824 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
20:29:58.824 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:29:58.824 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
20:29:58.824 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:29:58.824 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:29:58.824 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:29:58.824 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:29:58.824 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:29:58.824 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:29:58.824 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:29:58.824 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:29:58.824 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=4
20:29:58.825 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=4
20:29:58.825 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:29:58.825 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:29:58.825 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:29:58.825 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-3, value-3)
20:29:58.825 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
20:29:58.825 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
20:29:58.825 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:29:58.825 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=5)
20:29:58.825 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:29:58.825 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:29:58.825 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=5)
20:29:58.825 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:29:58.825 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:29:58.825 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:29:58.825 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
20:29:58.825 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
20:29:58.825 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:29:58.825 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:29:58.825 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:29:58.825 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
20:29:58.825 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:29:58.825 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:29:58.825 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:29:58.825 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:29:58.825 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:29:58.826 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:29:58.826 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:29:58.826 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:29:58.826 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=5
20:29:58.826 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:29:58.826 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:29:58.826 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=5
20:29:58.826 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-4, value-4)
20:29:58.826 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
20:29:58.826 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
20:29:58.826 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:29:58.826 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=6)
20:29:58.826 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:29:58.826 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:29:58.826 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:29:58.826 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=6)
20:29:58.826 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 AppendEntries(term=1, entries=1)
20:29:58.826 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
20:29:58.826 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:29:58.826 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:29:58.826 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:29:58.826 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 AppendEntries(term=1, entries=1)
20:29:58.826 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:29:58.826 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:29:58.826 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:29:58.827 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:29:58.827 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
20:29:58.826 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=6
20:29:58.827 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:29:58.827 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:29:58.827 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:29:58.827 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:29:58.827 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=6
20:29:58.827 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:29:58.827 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:29:58.868 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:29:58.868 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:29:58.868 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:29:58.868 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:29:58.869 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:29:58.869 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:29:58.869 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:29:58.869 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:29:58.934 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:29:58.934 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.934 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:58.934 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:29:58.934 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:29:58.935 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:29:58.935 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.935 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:58.935 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:29:58.935 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:29:58.935 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:29:58.935 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.935 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:58.935 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:29:58.935 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:29:58.935 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:29:58.935 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.935 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:58.935 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
20:29:58.935 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:29:58.935 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:29:58.935 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:58.935 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:58.936 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
20:29:58.936 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:29:58.947 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:29:58.947 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:29:58.947 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:29:58.947 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:29:58.947 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:58.948 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:29:59.117 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:59.123 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:29:59.123 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:29:59.123 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:29:59.123 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:29:59.124 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:29:59.124 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:29:59.124 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:29:59.263 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:29:59.264 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test, data)
20:29:59.264 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:29:59.264 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test, data)
20:29:59.265 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Data files created at target/test-data/node-1
20:29:59.266 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:29:59.266 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:59.266 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:59.266 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:29:59.266 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:29:59.274 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:29:59.274 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:29:59.274 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:29:59.274 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:29:59.274 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:59.274 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:29:59.274 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:29:59.275 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:29:59.275 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:29:59.275 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:29:59.275 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:59.275 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:29:59.275 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:29:59.275 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:29:59.275 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:29:59.275 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:29:59.275 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:59.275 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:29:59.454 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:59.455 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:29:59.456 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:29:59.456 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:29:59.456 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:29:59.457 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:29:59.457 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:29:59.457 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:59.458 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:59.458 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:29:59.458 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:29:59.458 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:29:59.458 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:29:59.458 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:29:59.458 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:29:59.458 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:29:59.458 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:29:59.459 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:29:59.459 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:59.459 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:59.459 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:29:59.459 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:29:59.459 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:29:59.478 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Leader: node-3
20:29:59.478 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:29:59.479 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
20:29:59.479 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:29:59.479 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:29:59.479 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:59.480 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:59.480 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:29:59.480 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:59.480 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:29:59.480 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:29:59.480 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:29:59.480 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:29:59.480 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:29:59.480 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:29:59.480 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:29:59.481 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:29:59.481 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key2, value2)
20:29:59.481 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:29:59.481 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:29:59.481 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:59.481 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:59.481 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:29:59.481 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:29:59.481 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:29:59.481 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:29:59.481 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:59.481 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:29:59.481 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:29:59.481 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:29:59.481 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:29:59.481 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:29:59.481 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:29:59.481 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:29:59.481 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:29:59.481 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key3, value3)
20:29:59.482 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:29:59.482 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:29:59.482 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:29:59.482 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:29:59.482 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:29:59.482 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:29:59.482 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:29:59.482 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:29:59.482 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:29:59.482 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:29:59.482 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:29:59.482 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:29:59.482 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:29:59.482 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:29:59.482 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:29:59.482 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:29:59.514 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:29:59.515 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:29:59.515 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:29:59.515 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:29:59.587 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Stopping all nodes...
20:29:59.588 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:29:59.588 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:59.588 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:59.588 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:29:59.588 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:29:59.588 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:29:59.588 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:59.588 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:59.588 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:29:59.588 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:29:59.588 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:29:59.588 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:59.588 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:59.588 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:29:59.588 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:29:59.588 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting all nodes...
20:29:59.589 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:29:59.590 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
20:29:59.590 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:29:59.591 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:29:59.591 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:29:59.591 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:29:59.591 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:29:59.591 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=3
20:29:59.591 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:29:59.591 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:59.591 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:29:59.591 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:29:59.591 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
20:29:59.591 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:29:59.592 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:29:59.592 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:29:59.592 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:29:59.592 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:29:59.592 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=3
20:29:59.592 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:29:59.592 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:59.592 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:29:59.592 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:29:59.592 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
20:29:59.592 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:29:59.592 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:29:59.592 [main] [node-3] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:29:59.592 [main] [node-3] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:29:59.592 [main] [node-3] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:29:59.592 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=3
20:29:59.592 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:29:59.592 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:59.593 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:29:59.777 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:59.780 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:29:59.781 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:29:59.781 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:29:59.782 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=2)
20:29:59.782 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=2)
20:29:59.783 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:29:59.783 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:29:59.783 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:59.783 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:59.783 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:59.783 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:59.784 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:29:59.784 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:29:59.784 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:29:59.785 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:29:59.785 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:29:59.785 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:29:59.785 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:29:59.785 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:29:59.785 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:29:59.785 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:29:59.800 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - New leader after restart: node-2
20:29:59.808 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - All nodes recovered successfully
20:29:59.808 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:29:59.808 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:59.808 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:59.808 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:29:59.808 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:29:59.808 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:29:59.808 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:59.808 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:59.809 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:29:59.809 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:29:59.809 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:29:59.809 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:59.809 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:29:59.809 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:29:59.809 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:29:59.814 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:29:59.814 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:29:59.814 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:29:59.814 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:29:59.814 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:59.814 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:29:59.814 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:29:59.815 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:29:59.815 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:29:59.815 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:29:59.815 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:59.815 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:29:59.815 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:29:59.815 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:29:59.815 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:29:59.816 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:29:59.816 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:29:59.816 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:29:59.972 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:29:59.975 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:29:59.976 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:29:59.976 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:29:59.976 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:29:59.977 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:29:59.977 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:29:59.978 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:29:59.978 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:59.978 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:29:59.978 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:59.978 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:29:59.978 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:29:59.979 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:29:59.979 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:29:59.979 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:29:59.979 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:29:59.979 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:29:59.979 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:29:59.979 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:29:59.979 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:29:59.979 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:29:59.979 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:30:00.027 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:30:00.028 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, restart)
20:30:00.028 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:30:00.028 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:30:00.028 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:30:00.028 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:30:00.028 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:30:00.028 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:30:00.028 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:30:00.028 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:30:00.028 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:30:00.028 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:30:00.028 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:30:00.028 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:30:00.030 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:30:00.030 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:30:00.030 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:30:00.030 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:30:00.137 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting follower: node-1
20:30:00.138 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:30:00.138 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:00.138 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:00.138 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:30:00.138 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:30:00.241 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:30:00.242 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during, downtime)
20:30:00.242 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.242 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.284 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.285 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.335 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.335 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.380 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.380 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.416 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:00.417 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:30:00.417 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:30:00.417 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:30:00.418 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:30:00.418 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:30:00.436 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.436 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.480 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.480 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.535 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.536 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.589 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:00.589 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-3
20:30:00.589 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
20:30:00.589 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:30:00.589 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:30:00.589 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:30:00.634 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.635 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.685 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.685 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.730 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.731 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.785 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.785 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.832 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.833 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.850 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:00.852 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-3
20:30:00.852 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
20:30:00.852 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:30:00.853 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:30:00.853 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:30:00.885 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.885 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.934 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.934 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:00.985 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:00.986 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.034 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.035 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.085 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.086 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.114 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:01.116 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=5, votedFor=node-3
20:30:01.116 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 5
20:30:01.116 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:30:01.116 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:30:01.116 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:30:01.131 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.131 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.185 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.186 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.234 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.235 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.285 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.286 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.331 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.331 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.353 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:01.355 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=6, votedFor=node-3
20:30:01.355 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 6
20:30:01.355 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:30:01.356 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:30:01.356 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:30:01.382 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.383 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.433 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.433 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.485 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.485 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.533 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.533 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.583 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.584 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.627 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:01.629 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=7, votedFor=node-3
20:30:01.629 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 7
20:30:01.629 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:30:01.629 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:30:01.629 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:30:01.634 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.634 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.680 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.680 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.734 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.735 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.785 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.786 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.830 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:01.832 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.832 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.832 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=8, votedFor=node-3
20:30:01.833 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 8
20:30:01.833 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:30:01.833 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:30:01.833 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:30:01.885 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.885 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.933 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.933 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:01.984 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:01.984 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:02.034 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:02.034 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:02.085 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:02.085 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:02.125 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:02.128 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=9, votedFor=node-3
20:30:02.129 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 9
20:30:02.129 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:30:02.130 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:30:02.130 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:30:02.134 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:02.134 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:02.184 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:02.184 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:02.234 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:30:02.234 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:30:02.246 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:30:02.246 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:02.246 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:02.246 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:30:02.246 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:30:02.246 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:30:02.246 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:02.246 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:02.246 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:30:02.246 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:30:02.251 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:30:02.252 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:30:02.252 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:30:02.252 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:30:02.252 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:02.252 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:30:02.408 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:02.409 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:30:02.409 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:30:02.409 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:30:02.409 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:30:02.409 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:30:02.409 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:30:02.409 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:30:02.464 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:30:02.464 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:02.464 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:02.465 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:30:02.465 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:30:02.465 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:30:02.466 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:30:02.466 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:30:02.466 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=0
20:30:02.466 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:30:02.466 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:02.466 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:30:02.466 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Term persisted: 1 -> 1
20:30:02.466 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:30:02.466 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:02.466 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:02.466 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:30:02.466 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:30:02.469 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:30:02.469 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:30:02.469 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:02.469 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:30:02.469 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:30:02.469 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:30:02.469 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:02.469 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:30:02.469 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:30:02.469 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:30:02.469 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:02.469 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:30:02.643 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:02.644 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:30:02.644 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:30:02.645 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:30:02.645 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:30:02.645 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:02.645 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:30:02.645 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:30:02.645 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:30:02.645 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:30:02.645 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:30:02.645 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:30:02.646 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:30:02.646 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:02.646 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:30:02.646 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:30:02.646 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:30:02.679 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-3 (term 1)
20:30:02.893 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - All nodes agree on leader: node-3
20:30:02.895 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:30:02.895 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:02.895 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:02.896 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:30:02.896 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:30:02.896 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:30:02.896 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:02.896 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:02.896 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:30:02.896 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:30:02.896 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:30:02.896 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:02.896 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:02.896 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:30:02.897 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:30:02.900 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:30:02.901 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:30:02.901 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:02.901 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:30:02.901 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:30:02.901 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:30:02.901 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:02.901 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:30:02.901 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:30:02.901 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:30:02.901 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:02.901 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:30:02.901 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:30:02.901 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
20:30:02.901 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:02.901 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
20:30:02.901 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:30:02.901 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
20:30:02.901 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:02.902 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
20:30:03.074 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:03.074 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:30:03.074 [election-node-4] [node-4] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:30:03.075 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 VoteRequest(term=1)
20:30:03.075 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:30:03.075 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.075 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 VoteRequest(term=1)
20:30:03.075 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 VoteRequest(term=1)
20:30:03.075 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 VoteRequest(term=1)
20:30:03.075 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
20:30:03.075 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:30:03.075 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-1 VoteResponse(granted=true)
20:30:03.075 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:30:03.075 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:30:03.075 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.075 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:30:03.075 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.075 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
20:30:03.076 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
20:30:03.075 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.076 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-2 VoteResponse(granted=true)
20:30:03.076 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
20:30:03.076 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-5 VoteResponse(granted=true)
20:30:03.076 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-3 VoteResponse(granted=true)
20:30:03.076 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:30:03.076 [] [node-4] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:30:03.076 [] [node-4] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:30:03.076 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:30:03.117 [main] [node-5] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-4 (term 1)
20:30:03.118 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:30:03.118 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.118 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:03.118 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:30:03.118 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:30:03.118 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:30:03.118 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.118 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:03.118 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:30:03.118 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:30:03.118 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:30:03.118 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.118 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:03.118 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:30:03.118 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:30:03.118 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:30:03.118 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.119 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:03.119 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
20:30:03.119 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:30:03.119 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:30:03.119 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.119 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:03.119 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
20:30:03.119 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:30:03.122 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:30:03.122 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:30:03.122 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:03.122 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:30:03.122 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:30:03.122 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:30:03.122 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:03.122 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:30:03.122 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:30:03.122 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:30:03.122 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:03.122 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:30:03.287 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:03.287 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:30:03.288 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:30:03.289 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:30:03.289 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:30:03.289 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.289 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:30:03.289 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:30:03.289 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:30:03.289 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:30:03.289 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:30:03.289 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:30:03.290 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:30:03.290 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:30:03.290 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.290 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:30:03.290 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:30:03.835 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader node-3 maintained leadership for 500ms
20:30:03.837 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:30:03.837 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.838 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:03.838 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:30:03.838 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:30:03.838 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:30:03.838 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.838 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:03.838 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:30:03.838 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:30:03.838 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:30:03.838 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:03.839 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:03.839 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:30:03.839 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:30:03.842 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:30:03.842 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:30:03.842 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:03.842 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:30:03.842 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:30:03.842 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:30:03.842 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:03.842 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:30:03.842 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:30:03.842 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:30:03.842 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:30:03.843 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:30:04.078 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:04.079 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:30:04.079 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:30:04.079 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:30:04.079 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:30:04.079 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:04.079 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:30:04.079 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:30:04.079 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:30:04.079 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:30:04.079 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:30:04.079 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:30:04.079 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:30:04.079 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:30:04.080 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:04.080 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:30:04.080 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:30:04.159 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Initial leader: node-1 (term 1)
20:30:04.160 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:30:04.160 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:04.160 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:04.160 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:30:04.160 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:30:04.305 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:30:04.306 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:30:04.306 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:30:04.306 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:30:04.306 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=2)
20:30:04.306 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:30:04.307 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:04.307 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:30:04.307 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:30:04.307 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:30:04.307 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:30:04.307 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:30:04.307 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:30:04.369 [main] [node-1] INFO  com.raftdb.integration.ClusterTest - New leader: node-2 (term 2)
20:30:04.370 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:30:04.370 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:04.370 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:04.370 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:30:04.370 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:30:04.370 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:30:04.370 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:30:04.370 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:30:04.371 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:30:04.371 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:52.192 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:52.194 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:52.195 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:52.195 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:52.195 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:52.195 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:52.195 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:52.195 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:52.195 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:52.195 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:52.195 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:52.196 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:52.368 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:52.368 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:52.378 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:52.385 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:32:52.385 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:52.385 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:52.385 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:52.386 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:32:52.386 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:32:52.386 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:52.386 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:52.386 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:52.386 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:52.386 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:52.386 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:32:52.386 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:52.386 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:52.414 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:32:52.414 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key3, value3)
20:32:52.417 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:32:52.418 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:32:52.418 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:32:52.418 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:32:52.418 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:52.418 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:52.418 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:32:52.418 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:52.418 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:32:52.419 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:32:52.437 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:32:52.438 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(key3)
20:32:52.438 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:32:52.438 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:32:52.438 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:32:52.438 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:32:52.438 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:32:52.438 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:52.438 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:32:52.439 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:32:52.439 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:32:52.439 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:52.439 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:32:52.439 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:32:52.439 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:32:52.439 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:32:52.444 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:52.444 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:52.445 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:32:52.445 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:32:52.548 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:52.549 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:52.549 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:52.549 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:52.549 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:52.550 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:52.550 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:52.550 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:52.550 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:52.550 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:52.550 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:52.550 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:52.550 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:52.550 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:52.550 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:52.557 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:52.557 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:52.557 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:52.557 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:52.557 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:52.557 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:52.557 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:52.557 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:52.557 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:52.557 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:52.557 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:52.557 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:52.744 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:52.744 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:52.745 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:52.745 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:32:52.745 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:32:52.745 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:52.745 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:52.745 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:52.745 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:52.745 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:52.745 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:52.745 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:32:52.745 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:32:52.745 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:52.745 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:52.745 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:52.745 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:52.762 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:32:52.762 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-0, value-0)
20:32:52.762 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:32:52.762 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:32:52.762 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:32:52.762 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-1, value-1)
20:32:52.762 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:52.763 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=1)
20:32:52.763 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:32:52.763 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:32:52.763 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:32:52.763 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-2, value-2)
20:32:52.763 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:52.763 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
20:32:52.763 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:32:52.763 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:32:52.763 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-3, value-3)
20:32:52.763 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:32:52.763 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=1)
20:32:52.763 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:32:52.763 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=1)
20:32:52.763 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:32:52.763 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=2)
20:32:52.763 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-4, value-4)
20:32:52.763 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=3)
20:32:52.763 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
20:32:52.763 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:32:52.763 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
20:32:52.763 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:32:52.763 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=1)
20:32:52.764 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 4
20:32:52.763 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:32:52.764 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=5)
20:32:52.764 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 4
20:32:52.764 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-5, value-5)
20:32:52.764 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:32:52.764 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 5
20:32:52.764 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:32:52.764 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 4
20:32:52.764 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:52.764 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=3)
20:32:52.764 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=3)
20:32:52.764 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-3 (nextIndex=1)
20:32:52.764 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
20:32:52.764 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=5)
20:32:52.764 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=5)
20:32:52.764 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 6
20:32:52.764 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:32:52.764 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:52.764 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:52.764 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 7
20:32:52.764 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 5
20:32:52.764 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-6, value-6)
20:32:52.764 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
20:32:52.764 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:32:52.764 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:32:52.765 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=6)
20:32:52.765 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:32:52.764 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
20:32:52.764 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=5)
20:32:52.764 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:32:52.765 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:32:52.764 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=6)
20:32:52.764 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 7
20:32:52.765 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 7
20:32:52.765 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
20:32:52.764 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:52.764 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:32:52.764 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
20:32:52.765 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 7
20:32:52.765 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:32:52.765 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:32:52.765 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-7, value-7)
20:32:52.765 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 7
20:32:52.765 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 6 entries, last index now 7
20:32:52.765 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:32:52.765 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 7
20:32:52.765 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
20:32:52.765 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:32:52.765 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:32:52.765 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:32:52.765 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
20:32:52.765 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:32:52.765 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 7
20:32:52.766 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 7
20:32:52.765 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 7
20:32:52.765 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-8, value-8)
20:32:52.765 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 7
20:32:52.766 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=8)
20:32:52.766 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:32:52.766 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:32:52.766 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
20:32:52.766 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:32:52.766 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:32:52.766 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:32:52.766 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:32:52.766 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-9, value-9)
20:32:52.766 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:32:52.766 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=8)
20:32:52.766 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:32:52.766 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:32:52.766 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:32:52.766 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 9
20:32:52.766 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=9)
20:32:52.766 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:32:52.766 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:32:52.766 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
20:32:52.766 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:32:52.766 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:32:52.766 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=10)
20:32:52.766 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:32:52.766 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:32:52.766 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
20:32:52.766 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:32:52.766 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:32:52.766 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=8)
20:32:52.767 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:32:52.767 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 11
20:32:52.766 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:32:52.767 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:32:52.766 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:32:52.766 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:32:52.767 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:32:52.766 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 10
20:32:52.767 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 11
20:32:52.767 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:32:52.767 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:32:52.767 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
20:32:52.767 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
20:32:52.767 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:32:52.767 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
20:32:52.767 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=9)
20:32:52.767 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
20:32:52.767 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:32:52.767 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:32:52.767 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
20:32:52.767 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=11)
20:32:52.767 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:32:52.767 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 11
20:32:52.767 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:32:52.767 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 11
20:32:52.767 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:32:52.767 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
20:32:52.767 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=12)
20:32:52.767 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
20:32:52.767 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:32:52.767 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 11
20:32:52.767 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 12
20:32:52.767 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:32:52.767 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=12)
20:32:52.767 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:32:52.768 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 13
20:32:52.768 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:32:52.768 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:32:52.768 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:32:52.767 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:32:52.768 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:32:52.768 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=13
20:32:52.768 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-13, value-13)
20:32:52.768 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 13
20:32:52.768 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:32:52.768 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 13
20:32:52.768 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:32:52.768 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:32:52.768 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 13
20:32:52.768 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=12)
20:32:52.768 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 13
20:32:52.768 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:32:52.768 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
20:32:52.768 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:32:52.768 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:32:52.768 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-14, value-14)
20:32:52.768 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=14)
20:32:52.768 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 14
20:32:52.768 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:32:52.769 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
20:32:52.769 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:32:52.768 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=14)
20:32:52.769 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
20:32:52.769 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
20:32:52.769 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 15
20:32:52.769 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=14)
20:32:52.769 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=14
20:32:52.769 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:32:52.769 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=14)
20:32:52.769 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:32:52.769 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
20:32:52.769 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=14)
20:32:52.769 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:32:52.769 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
20:32:52.769 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:32:52.769 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=14)
20:32:52.769 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:32:52.769 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:32:52.769 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:32:52.769 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:32:52.769 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
20:32:52.769 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-16, value-16)
20:32:52.769 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
20:32:52.769 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:32:52.769 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 15
20:32:52.769 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=16)
20:32:52.769 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 15
20:32:52.769 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
20:32:52.769 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:32:52.769 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
20:32:52.769 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 16
20:32:52.769 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:32:52.769 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:32:52.770 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 17
20:32:52.770 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:32:52.769 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=16
20:32:52.769 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
20:32:52.770 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
20:32:52.770 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:32:52.770 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 17
20:32:52.769 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
20:32:52.770 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:32:52.770 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-17, value-17)
20:32:52.770 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:32:52.770 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:32:52.770 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
20:32:52.770 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=17)
20:32:52.770 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-18, value-18)
20:32:52.770 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 17
20:32:52.770 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=17)
20:32:52.770 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:32:52.770 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:32:52.770 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:32:52.770 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 17
20:32:52.770 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 17
20:32:52.770 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=18)
20:32:52.770 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
20:32:52.770 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 18
20:32:52.771 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-19, value-19)
20:32:52.771 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=17)
20:32:52.771 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=18)
20:32:52.771 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:32:52.770 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 19
20:32:52.771 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
20:32:52.771 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:32:52.771 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=17)
20:32:52.771 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:32:52.771 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
20:32:52.771 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
20:32:52.771 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
20:32:52.771 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
20:32:52.771 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:32:52.771 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:32:52.771 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:32:52.771 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
20:32:52.771 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:32:52.771 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=18)
20:32:52.771 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:32:52.771 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=19
20:32:52.771 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
20:32:52.771 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=18)
20:32:52.771 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
20:32:52.771 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
20:32:52.771 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
20:32:52.771 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
20:32:52.771 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 20
20:32:52.771 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:32:52.771 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 20
20:32:52.771 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:32:52.771 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:32:52.771 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:32:52.771 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:32:52.771 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:32:52.771 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:32:52.771 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 20
20:32:52.772 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:32:52.771 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:32:52.771 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 20
20:32:52.771 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:32:52.772 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
20:32:52.772 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
20:32:52.772 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:32:52.797 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:32:52.797 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:32:52.797 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:32:52.797 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:32:52.798 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:32:52.798 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:32:52.798 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:32:52.798 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:32:52.879 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:52.879 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:52.879 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:52.879 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:52.879 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:52.879 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:52.880 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:52.880 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:52.880 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:52.880 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:52.880 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:52.880 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:52.880 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:52.880 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:52.880 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:52.883 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:52.883 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:52.883 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:52.883 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:52.883 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:52.883 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:52.883 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:52.884 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:52.884 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:52.884 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:52.884 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:52.885 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:53.056 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:53.056 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:53.056 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:53.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:32:53.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:32:53.057 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:53.057 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:53.057 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:53.057 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:53.057 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:53.057 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:32:53.057 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:53.057 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:53.057 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:32:53.057 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:53.057 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:53.057 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:53.093 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:32:53.093 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key2, value2)
20:32:53.093 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:32:53.094 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:32:53.094 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:32:53.094 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:32:53.094 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:53.094 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:53.094 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:32:53.094 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:32:53.094 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:53.094 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:53.094 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:32:53.109 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:53.109 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:53.109 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:32:53.109 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:32:53.201 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:53.201 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:53.202 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:53.202 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:53.202 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:53.202 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:53.202 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:53.202 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:53.202 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:53.202 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:53.202 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:53.202 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:53.202 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:53.202 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:53.202 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:53.205 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:53.205 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:53.205 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:53.205 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:53.205 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:53.205 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:53.205 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:53.205 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:53.205 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:53.205 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:53.205 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:53.205 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:53.375 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:53.376 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:53.377 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:53.377 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:32:53.377 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:32:53.377 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:53.378 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:53.378 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:53.378 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:53.378 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:32:53.378 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:32:53.378 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:32:53.378 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:53.379 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:53.379 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:53.379 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:53.378 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:32:53.416 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:32:53.417 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
20:32:53.418 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:32:53.419 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:32:53.420 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:32:53.420 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:53.420 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:32:53.420 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:53.420 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:32:53.420 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:53.421 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:32:53.421 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:32:53.432 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:53.432 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:53.433 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:32:53.433 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:32:53.526 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Killing leader: node-3
20:32:53.526 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:53.526 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:53.526 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:53.526 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:53.526 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:53.639 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:53.639 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:32:53.639 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:53.640 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=2)
20:32:53.640 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:53.640 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:53.640 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:32:53.640 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:32:53.640 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:53.640 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:32:53.640 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:32:53.640 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:32:53.640 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:53.734 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - New leader: node-2
20:32:53.735 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
20:32:53.735 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
20:32:53.736 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:32:53.736 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=2, entries=1)
20:32:53.736 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:32:53.736 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:32:53.736 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:32:53.736 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:32:53.737 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:32:53.741 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:32:53.741 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:53.741 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:32:53.795 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:32:53.843 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:53.843 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:53.843 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:53.844 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:53.844 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:53.844 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:53.844 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:53.844 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:53.844 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:53.844 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:53.847 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:53.847 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:53.847 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:53.847 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:53.847 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:53.847 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:53.847 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:53.847 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:53.847 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:53.847 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:53.847 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:53.848 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:54.058 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:54.059 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:54.059 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:54.060 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:32:54.060 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:54.061 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.061 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:32:54.061 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:32:54.061 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:54.061 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:54.061 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:54.061 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:54.062 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:32:54.062 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:54.063 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.062 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:32:54.063 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:32:54.160 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:32:54.160 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
20:32:54.160 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:32:54.160 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:32:54.160 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:32:54.160 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:32:54.160 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:54.160 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:54.160 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:32:54.160 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:32:54.160 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:54.160 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:54.160 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:32:54.160 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:32:54.160 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
20:32:54.160 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:32:54.161 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:32:54.161 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:32:54.161 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:32:54.161 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:54.161 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:32:54.161 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:32:54.161 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:54.161 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:32:54.161 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:32:54.161 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:32:54.161 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:32:54.161 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:32:54.161 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:32:54.161 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:32:54.161 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
20:32:54.161 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:32:54.161 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:32:54.161 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:32:54.161 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:32:54.161 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:54.161 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:32:54.161 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:32:54.161 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:32:54.161 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:32:54.161 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:32:54.161 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:32:54.161 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:54.161 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:32:54.161 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:32:54.161 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:32:54.161 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
20:32:54.162 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:32:54.162 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
20:32:54.162 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:32:54.162 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:32:54.162 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:32:54.162 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:32:54.162 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:32:54.162 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:32:54.162 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:32:54.162 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:32:54.162 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:32:54.162 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
20:32:54.162 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:32:54.162 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:32:54.162 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:32:54.162 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:32:54.162 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:32:54.162 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
20:32:54.162 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:32:54.162 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
20:32:54.162 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:32:54.162 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:32:54.162 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:32:54.162 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:32:54.162 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:32:54.162 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:32:54.162 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:32:54.162 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:32:54.162 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
20:32:54.162 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:32:54.162 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:32:54.162 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
20:32:54.162 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:32:54.163 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
20:32:54.163 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:32:54.163 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:32:54.163 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:32:54.163 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:32:54.163 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:32:54.163 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:32:54.163 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:32:54.163 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
20:32:54.163 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:32:54.163 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:32:54.163 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:32:54.163 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:32:54.163 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:32:54.163 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:32:54.163 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
20:32:54.163 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
20:32:54.163 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
20:32:54.163 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:32:54.163 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:32:54.163 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:32:54.163 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:32:54.163 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:32:54.163 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:32:54.163 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
20:32:54.163 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
20:32:54.163 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:32:54.163 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:32:54.163 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:32:54.163 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:32:54.163 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:32:54.163 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:32:54.163 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
20:32:54.163 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
20:32:54.163 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
20:32:54.163 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:32:54.163 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:32:54.163 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:32:54.163 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:32:54.163 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:32:54.163 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:32:54.163 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
20:32:54.163 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
20:32:54.163 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:32:54.163 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:32:54.163 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:32:54.163 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:32:54.164 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:32:54.164 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:32:54.164 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
20:32:54.164 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
20:32:54.164 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
20:32:54.164 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:32:54.164 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:32:54.164 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:32:54.164 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:32:54.164 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:32:54.164 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:32:54.164 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
20:32:54.164 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
20:32:54.164 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:32:54.164 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:32:54.164 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:32:54.164 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:32:54.164 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:32:54.164 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:32:54.164 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
20:32:54.164 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
20:32:54.164 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:32:54.164 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
20:32:54.164 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:32:54.164 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:32:54.164 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:32:54.164 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
20:32:54.164 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:32:54.164 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:32:54.164 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:32:54.164 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:32:54.164 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:32:54.164 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:32:54.164 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
20:32:54.227 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:32:54.228 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:32:54.228 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:32:54.228 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:32:54.275 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:54.275 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.275 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:54.275 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:54.275 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:54.275 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:54.276 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.276 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:54.276 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:54.276 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:54.276 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:54.276 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.276 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:54.276 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:54.276 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:54.278 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:54.278 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:54.278 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:54.278 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:54.278 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:54.278 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:54.278 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:54.278 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:54.278 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:54.278 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:54.278 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:54.278 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:54.451 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:54.452 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:54.453 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:54.453 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:32:54.453 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:54.453 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.454 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:54.454 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:32:54.454 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:54.454 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:54.454 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:54.454 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:54.454 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:32:54.454 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:54.454 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.455 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:54.455 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:32:54.490 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Leader: node-1
20:32:54.490 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:32:54.490 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
20:32:54.491 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:32:54.491 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:32:54.492 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:32:54.493 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:54.493 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:32:54.493 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:32:54.494 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:54.494 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:54.494 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:32:54.494 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:32:54.494 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - PUT committed
20:32:54.506 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:54.506 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:54.507 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:32:54.507 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:32:54.601 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - Data replicated to all nodes
20:32:54.601 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:54.601 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.601 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:54.601 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:54.602 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:54.602 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:54.602 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.602 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:54.602 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:54.602 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:54.602 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:54.602 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.602 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:54.602 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:54.602 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:54.603 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:54.604 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:54.604 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:54.604 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:54.604 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:54.604 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:54.604 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:54.604 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:54.604 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:54.604 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:54.604 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:54.604 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:54.784 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:54.784 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:54.784 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:54.785 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:32:54.785 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:32:54.785 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:54.785 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.785 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:54.785 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.785 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:32:54.785 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:32:54.785 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:32:54.785 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:32:54.785 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:54.785 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:54.785 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:54.785 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:54.814 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:54.814 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.814 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:54.814 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:54.814 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:54.814 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:54.814 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.814 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:54.814 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:54.814 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:54.814 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:54.814 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:54.814 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:54.814 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:54.814 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:54.815 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:54.815 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:54.815 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:54.815 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:54.815 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:54.815 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:54.815 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:54.815 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:54.815 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:54.816 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:54.816 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:54.816 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:54.816 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:32:54.816 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
20:32:54.816 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:54.816 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
20:32:54.816 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:32:54.816 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
20:32:54.816 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:54.816 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
20:32:55.011 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:55.012 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:55.012 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:32:55.013 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:32:55.013 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:32:55.013 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:55.013 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:55.013 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:55.013 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:55.013 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:32:55.013 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:32:55.013 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:32:55.013 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:32:55.014 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:32:55.014 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:32:55.014 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 VoteRequest(term=1)
20:32:55.014 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:55.014 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:55.014 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:55.014 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:55.014 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:32:55.014 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-4 VoteResponse(granted=true)
20:32:55.014 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 VoteRequest(term=1)
20:32:55.014 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:55.014 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:55.014 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:32:55.014 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-5 VoteResponse(granted=true)
20:32:55.015 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:55.027 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:32:55.027 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(stable-key, initial)
20:32:55.027 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:32:55.028 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:32:55.028 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:32:55.028 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
20:32:55.028 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
20:32:55.028 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:55.028 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
20:32:55.028 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:32:55.028 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:32:55.028 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:55.028 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
20:32:55.028 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:55.028 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
20:32:55.028 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:55.028 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:32:55.028 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:55.028 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
20:32:55.028 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:55.028 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:32:55.071 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:55.071 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:55.071 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:55.071 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:55.071 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:32:55.071 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:32:55.071 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:32:55.072 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:32:55.135 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:32:55.135 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-0, value-0)
20:32:55.136 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:32:55.136 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:32:55.136 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:32:55.136 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
20:32:55.136 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:32:55.136 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:32:55.136 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
20:32:55.136 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:32:55.136 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
20:32:55.136 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
20:32:55.136 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:32:55.136 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:32:55.136 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:32:55.136 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
20:32:55.136 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
20:32:55.136 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:32:55.136 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:32:55.136 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:32:55.136 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:32:55.136 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:32:55.136 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-1, value-1)
20:32:55.137 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:32:55.137 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:32:55.137 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:32:55.137 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=3)
20:32:55.137 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:32:55.137 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:32:55.137 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
20:32:55.137 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:55.137 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=3)
20:32:55.137 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:32:55.137 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:32:55.137 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:55.137 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:32:55.137 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
20:32:55.137 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:32:55.137 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:32:55.137 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:32:55.137 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:32:55.137 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:55.137 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:32:55.137 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=3
20:32:55.137 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:55.137 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:32:55.137 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:32:55.137 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=3
20:32:55.137 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:32:55.137 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:32:55.137 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-2, value-2)
20:32:55.137 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:32:55.138 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
20:32:55.138 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:32:55.138 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=4)
20:32:55.138 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:32:55.138 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:32:55.138 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=4)
20:32:55.138 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
20:32:55.138 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:32:55.138 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:32:55.138 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:32:55.138 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
20:32:55.138 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:32:55.138 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:32:55.138 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:32:55.138 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:32:55.138 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:32:55.138 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:32:55.138 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:32:55.138 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:32:55.138 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=4
20:32:55.138 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:32:55.138 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:32:55.138 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:32:55.138 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:32:55.138 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=4
20:32:55.138 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:32:55.138 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-3, value-3)
20:32:55.138 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:32:55.138 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
20:32:55.138 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:32:55.138 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=5)
20:32:55.138 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:32:55.138 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:32:55.139 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=5)
20:32:55.139 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:32:55.139 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:32:55.139 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
20:32:55.139 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
20:32:55.139 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:32:55.139 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:32:55.139 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:32:55.139 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:32:55.139 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:32:55.139 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:32:55.139 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:32:55.139 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:32:55.139 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:32:55.139 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:32:55.139 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=5
20:32:55.139 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=5
20:32:55.139 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:32:55.139 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:32:55.139 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:32:55.139 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:32:55.139 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-4, value-4)
20:32:55.139 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:32:55.139 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
20:32:55.139 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:32:55.139 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=6)
20:32:55.139 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:32:55.139 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=6)
20:32:55.139 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:32:55.139 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:32:55.139 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:32:55.139 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
20:32:55.139 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
20:32:55.139 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:32:55.139 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:32:55.139 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:32:55.140 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:32:55.140 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:32:55.140 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:32:55.140 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=6
20:32:55.140 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:32:55.140 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
20:32:55.140 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:32:55.140 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:32:55.140 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:32:55.140 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:32:55.140 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=6
20:32:55.140 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:32:55.140 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:32:55.171 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:32:55.171 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:32:55.171 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:32:55.171 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:32:55.171 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:32:55.171 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:32:55.171 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:32:55.171 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:32:55.244 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:55.244 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:55.244 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:55.244 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:55.244 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:55.244 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:55.244 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:55.244 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:55.244 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:55.244 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:55.244 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:55.244 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:55.244 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:55.244 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:55.244 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:55.244 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:32:55.244 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:55.245 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:55.245 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
20:32:55.245 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:32:55.245 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:32:55.245 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:55.245 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:55.245 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
20:32:55.245 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:32:55.253 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:55.254 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:32:55.254 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:32:55.254 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:55.254 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:55.254 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:55.513 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:55.517 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:32:55.517 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:32:55.517 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:55.517 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:32:55.517 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:55.517 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:55.517 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:55.674 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:32:55.674 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test, data)
20:32:55.674 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:55.674 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test, data)
20:32:55.675 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Data files created at target/test-data/node-1
20:32:55.676 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:55.676 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:55.676 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:55.676 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:55.676 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:55.684 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:55.685 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:32:55.685 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:32:55.685 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:55.685 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:55.685 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:55.685 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:55.685 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:32:55.685 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:32:55.685 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:55.685 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:55.685 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:55.685 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:55.686 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:32:55.686 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:32:55.686 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:55.686 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:55.686 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:55.843 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:55.845 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:32:55.845 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:32:55.845 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:55.846 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:55.846 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:32:55.846 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:32:55.846 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:32:55.846 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:55.846 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:55.846 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:32:55.847 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:55.847 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:55.847 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:32:55.847 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:55.847 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:32:55.847 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:32:55.847 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:55.847 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:55.847 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:55.847 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:55.847 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:32:55.847 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:55.899 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Leader: node-1
20:32:55.900 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:32:55.901 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
20:32:55.905 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:32:55.905 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:32:55.905 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:32:55.905 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:32:55.905 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:32:55.906 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:32:55.905 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:32:55.906 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:32:55.907 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:32:55.907 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:32:55.907 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:55.907 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:55.907 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:32:55.907 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:55.907 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:55.907 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:55.907 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:32:55.907 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:32:55.908 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:32:55.908 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key2, value2)
20:32:55.908 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:32:55.908 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:32:55.908 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:32:55.908 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:32:55.908 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:32:55.908 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:32:55.908 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:55.908 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:32:55.909 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:32:55.909 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:32:55.909 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:55.909 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:32:55.909 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:32:55.909 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:32:55.909 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:32:55.909 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:32:55.909 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:32:55.909 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key3, value3)
20:32:55.909 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:32:55.909 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:32:55.909 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:32:55.909 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:32:55.909 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:32:55.910 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:32:55.910 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:32:55.910 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:32:55.910 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:55.910 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:55.910 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:32:55.910 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:32:55.910 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:32:55.910 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:32:55.910 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:32:55.910 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:32:55.953 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:32:55.953 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:32:55.953 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:32:55.953 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:32:56.014 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Stopping all nodes...
20:32:56.014 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:56.014 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.014 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:56.014 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:56.014 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:56.014 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:56.014 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.014 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:56.014 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:56.015 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:56.015 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:56.015 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.015 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:56.015 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:56.015 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:56.015 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting all nodes...
20:32:56.015 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:56.016 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:32:56.017 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:32:56.017 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:32:56.017 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:32:56.017 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:32:56.017 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:32:56.017 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
20:32:56.017 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:56.017 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:56.017 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:56.017 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:56.017 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:32:56.017 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:32:56.018 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:32:56.018 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:32:56.018 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:32:56.018 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:32:56.018 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
20:32:56.018 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:56.018 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:56.018 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:56.018 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:56.018 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:32:56.018 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:32:56.018 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:32:56.018 [main] [node-3] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:32:56.018 [main] [node-3] INFO  com.raftdb.core.RaftNode - Replaying 3 log entries to recover state machine
20:32:56.018 [main] [node-3] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:32:56.018 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
20:32:56.018 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:56.018 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:56.018 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:56.227 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:56.229 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:32:56.229 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:32:56.229 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:56.230 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=2)
20:32:56.231 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:32:56.231 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:56.231 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.232 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=2)
20:32:56.232 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:32:56.232 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:32:56.232 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:32:56.232 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:56.232 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:32:56.232 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:32:56.232 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:56.232 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:32:56.232 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:56.232 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.233 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:32:56.233 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:32:56.233 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:32:56.331 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - New leader after restart: node-3
20:32:56.335 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - All nodes recovered successfully
20:32:56.335 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:56.335 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.335 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:56.336 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:56.336 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:56.336 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:56.336 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.336 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:56.336 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:56.336 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:56.336 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:56.336 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.336 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:56.336 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:56.336 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:56.338 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:56.338 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:32:56.338 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:32:56.339 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:56.339 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:56.339 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:56.339 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:56.339 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:32:56.339 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:32:56.339 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:56.339 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:56.339 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:56.339 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:56.339 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:32:56.339 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:32:56.339 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:56.339 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:56.339 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:56.540 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:56.543 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:32:56.548 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:32:56.549 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:56.549 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:56.550 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:32:56.550 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:32:56.551 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:32:56.551 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:56.551 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.552 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:32:56.553 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:56.552 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:32:56.553 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:56.553 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.553 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:32:56.553 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:56.553 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:56.553 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:56.553 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:56.554 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:32:56.554 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:56.554 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:32:56.654 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:32:56.655 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, restart)
20:32:56.656 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:32:56.656 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:32:56.657 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:32:56.657 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:32:56.657 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:32:56.657 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:32:56.657 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:32:56.657 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:32:56.658 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:32:56.658 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:32:56.658 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:56.658 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:56.658 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:32:56.658 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:56.658 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:32:56.658 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:32:56.658 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:56.658 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:32:56.658 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:32:56.708 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:56.708 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:32:56.709 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:32:56.709 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:32:56.766 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Restarting follower: node-2
20:32:56.766 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:56.766 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.766 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:56.766 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:56.766 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:56.869 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:32:56.870 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during, downtime)
20:32:56.870 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:32:56.870 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:32:56.871 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:32:56.871 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:32:56.872 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:32:56.872 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:32:56.872 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:32:56.872 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
20:32:56.873 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:56.874 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:32:56.874 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:32:56.874 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
20:32:56.874 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
20:32:56.874 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying 1 log entries to recover state machine
20:32:56.874 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
20:32:56.874 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=1
20:32:56.874 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:56.874 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:56.874 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:56.907 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:32:56.907 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:32:56.908 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:56.908 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
20:32:56.908 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:32:56.908 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:32:56.908 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:32:56.908 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:32:56.908 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
20:32:56.981 [main] [node-2] INFO  c.raftdb.integration.PersistenceTest - Follower node-2 caught up after restart
20:32:56.982 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:56.982 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.982 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:56.982 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:56.982 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:56.982 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:56.982 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.982 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:56.982 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:56.982 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:56.982 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:56.982 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:56.982 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:56.983 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:56.983 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:56.988 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:56.988 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:32:56.988 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:32:56.988 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:56.988 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:56.988 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:57.201 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:57.203 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:32:57.204 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:32:57.204 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:57.204 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:32:57.204 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:57.204 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:57.204 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:57.305 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:57.305 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:57.306 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:57.306 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:57.306 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:57.306 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:57.306 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:32:57.306 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:32:57.306 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=0
20:32:57.306 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:57.306 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:57.306 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:57.306 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Term persisted: 1 -> 1
20:32:57.307 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:57.307 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:57.307 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:57.307 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:57.307 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:57.310 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:57.310 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:57.310 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:57.310 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:57.310 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:57.310 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:57.310 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:57.310 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:57.310 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:57.310 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:57.310 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:57.310 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:57.535 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:57.535 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:57.535 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:57.536 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:32:57.536 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:57.536 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:57.536 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:32:57.536 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:32:57.536 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:32:57.536 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:57.536 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:57.536 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:57.536 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:57.536 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:57.536 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:32:57.536 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:57.536 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:32:57.624 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-2 (term 1)
20:32:57.840 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - All nodes agree on leader: node-2
20:32:57.841 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:57.842 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:57.842 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:57.842 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:57.842 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:57.842 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:57.842 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:57.842 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:57.842 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:57.842 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:57.842 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:57.842 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:57.843 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:57.843 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:57.843 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:57.846 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:57.846 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:57.846 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:57.846 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:57.846 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:57.846 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:57.846 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:57.847 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:57.847 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:57.847 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:57.847 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:57.847 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:57.847 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:32:57.847 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
20:32:57.847 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:57.847 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
20:32:57.847 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:32:57.847 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
20:32:57.847 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:57.847 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
20:32:58.011 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:58.012 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:58.011 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:58.012 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:58.013 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:32:58.013 [election-node-5] [node-5] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:32:58.013 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-1 VoteRequest(term=1)
20:32:58.013 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:58.013 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.013 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
20:32:58.013 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:32:58.013 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-1 VoteResponse(granted=true)
20:32:58.013 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:32:58.014 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-2 VoteRequest(term=1)
20:32:58.014 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-5 - canVote=false, logUpToDate=true
20:32:58.014 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-2 VoteResponse(granted=false)
20:32:58.014 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-4 VoteRequest(term=1)
20:32:58.014 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:58.014 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.014 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:32:58.014 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:58.014 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.014 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:32:58.014 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
20:32:58.014 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:32:58.014 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-4 VoteResponse(granted=true)
20:32:58.014 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:32:58.014 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:32:58.014 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 VoteRequest(term=1)
20:32:58.014 [] [node-5] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:58.014 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:32:58.015 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-3 VoteRequest(term=1)
20:32:58.015 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=false)
20:32:58.015 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-5 - canVote=false, logUpToDate=true
20:32:58.015 [] [node-5] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:58.015 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:32:58.015 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-3 VoteResponse(granted=false)
20:32:58.015 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:58.015 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 VoteRequest(term=1)
20:32:58.015 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-4 VoteResponse(granted=false)
20:32:58.015 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:32:58.015 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-5 VoteResponse(granted=false)
20:32:58.056 [main] [node-5] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-5 (term 1)
20:32:58.056 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:58.056 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.056 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:58.056 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:58.056 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:58.057 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:58.057 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.057 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:58.057 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:58.057 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:58.057 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:58.057 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.057 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:58.057 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:58.057 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:58.057 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:32:58.057 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.057 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:58.057 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
20:32:58.057 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:32:58.057 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:32:58.057 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.057 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:58.057 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
20:32:58.057 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:32:58.060 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:58.061 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:58.061 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:58.061 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:58.061 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:58.061 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:58.061 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:58.061 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:58.061 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:58.061 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:58.061 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:58.061 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:58.251 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:58.252 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:58.252 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:58.252 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:32:58.253 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:58.253 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:32:58.253 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.253 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:58.253 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.253 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:58.253 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:32:58.253 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:32:58.253 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:32:58.253 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:58.253 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:58.253 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:58.253 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:58.782 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader node-1 maintained leadership for 500ms
20:32:58.784 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:58.784 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.784 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:58.785 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:58.785 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:58.786 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:58.786 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.786 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:58.786 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:58.786 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:58.786 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:58.786 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.786 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:58.786 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:58.786 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:32:58.790 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:32:58.790 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:32:58.790 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:58.790 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
20:32:58.790 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:32:58.790 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:32:58.790 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:58.791 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
20:32:58.791 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:32:58.791 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:32:58.791 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:32:58.791 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
20:32:58.964 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:58.964 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:32:58.964 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:58.964 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:32:58.964 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:58.964 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:32:58.964 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.964 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:58.964 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:58.964 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:32:58.964 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:32:58.964 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:32:58.964 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:32:58.964 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:58.964 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:32:58.964 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:32:58.964 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:59.001 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Initial leader: node-2 (term 1)
20:32:59.001 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:32:59.001 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:59.001 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:59.001 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:32:59.001 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:32:59.130 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:32:59.131 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:32:59.131 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:32:59.132 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:32:59.132 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=2)
20:32:59.132 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:32:59.132 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:59.132 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
20:32:59.132 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:32:59.132 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:32:59.132 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:32:59.132 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:32:59.132 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:32:59.213 [main] [node-2] INFO  com.raftdb.integration.ClusterTest - New leader: node-1 (term 2)
20:32:59.214 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:32:59.214 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:59.214 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:59.214 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:32:59.214 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:32:59.214 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:32:59.214 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:32:59.214 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:32:59.214 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:32:59.214 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped

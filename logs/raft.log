19:47:04.897 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:04.903 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:04.904 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:04.904 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:04.904 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:04.904 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:04.904 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:04.904 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:04.905 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:04.905 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:04.905 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:04.905 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:05.121 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:05.121 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:05.126 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:05.128 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:47:05.129 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:05.129 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.129 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:05.129 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:47:05.129 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:05.129 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:47:05.130 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:05.130 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:05.130 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:05.133 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.133 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:05.133 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:05.133 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:47:05.228 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:05.228 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key3, value3)
19:47:05.231 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:05.232 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:05.232 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:47:05.232 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:47:05.232 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:05.232 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:05.232 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:05.232 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:05.232 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:05.232 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:05.233 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
19:47:05.235 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:05.236 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:05.236 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
19:47:05.236 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
19:47:05.252 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:05.253 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(key3)
19:47:05.253 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:05.253 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:05.253 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:47:05.253 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:47:05.253 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:05.253 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:05.254 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:47:05.254 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:05.254 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:05.254 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:05.254 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
19:47:05.290 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:05.291 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:05.291 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
19:47:05.291 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
19:47:05.362 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:05.362 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.363 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:05.363 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:05.363 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:05.363 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:05.363 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.363 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:05.363 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:05.363 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:05.363 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:05.363 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.363 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:05.363 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:05.363 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:05.368 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:05.369 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:05.369 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:05.369 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:05.369 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:05.369 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:05.369 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:05.369 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:05.370 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:05.370 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:05.370 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:05.371 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:05.558 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:05.558 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:05.558 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:05.558 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:05.558 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:05.558 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:05.558 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:05.558 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.558 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.558 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:05.559 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:05.559 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:05.559 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:05.559 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:05.559 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:05.559 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:05.559 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:05.582 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:05.582 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-0, value-0)
19:47:05.582 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:05.582 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:05.582 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-1, value-1)
19:47:05.582 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:05.582 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=1)
19:47:05.582 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:05.582 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-2, value-2)
19:47:05.582 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:05.583 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=1)
19:47:05.583 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.583 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:05.583 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=1)
19:47:05.583 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
19:47:05.583 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:05.583 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=1)
19:47:05.583 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.583 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-3, value-3)
19:47:05.583 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
19:47:05.583 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.583 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:05.583 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:47:05.583 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:05.583 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
19:47:05.583 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=1)
19:47:05.583 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-4, value-4)
19:47:05.583 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
19:47:05.583 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.584 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
19:47:05.583 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=3)
19:47:05.584 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:05.584 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
19:47:05.584 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 4
19:47:05.584 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 3
19:47:05.584 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-5, value-5)
19:47:05.584 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:47:05.584 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.584 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
19:47:05.584 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=4)
19:47:05.584 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=4)
19:47:05.584 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 4
19:47:05.584 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=3)
19:47:05.584 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
19:47:05.584 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.584 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:05.585 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
19:47:05.584 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:47:05.584 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 4
19:47:05.585 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 6
19:47:05.584 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.585 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 6
19:47:05.585 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=5)
19:47:05.585 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=5)
19:47:05.585 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-6, value-6)
19:47:05.585 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:05.585 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:47:05.585 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.585 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.585 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:05.585 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 7
19:47:05.585 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 7
19:47:05.585 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:47:05.585 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:05.585 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:47:05.585 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 6
19:47:05.585 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=5)
19:47:05.585 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:05.585 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
19:47:05.585 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:47:05.585 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
19:47:05.586 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-7, value-7)
19:47:05.586 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
19:47:05.586 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 7
19:47:05.586 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
19:47:05.586 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
19:47:05.586 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.586 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:05.586 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:47:05.586 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
19:47:05.586 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 7
19:47:05.586 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
19:47:05.586 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:05.586 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:47:05.586 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 7
19:47:05.586 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 7
19:47:05.586 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 7
19:47:05.586 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:47:05.586 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
19:47:05.586 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:05.587 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
19:47:05.586 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
19:47:05.586 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
19:47:05.587 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-8, value-8)
19:47:05.587 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
19:47:05.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=7)
19:47:05.587 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
19:47:05.587 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:47:05.587 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:05.587 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
19:47:05.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=8)
19:47:05.587 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
19:47:05.587 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.587 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.587 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-9, value-9)
19:47:05.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=9)
19:47:05.587 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
19:47:05.587 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:05.587 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 9
19:47:05.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=9)
19:47:05.587 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:47:05.587 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
19:47:05.587 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:05.587 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:47:05.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=8)
19:47:05.587 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
19:47:05.587 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:47:05.588 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.588 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
19:47:05.588 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 10
19:47:05.588 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 10
19:47:05.588 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
19:47:05.588 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:05.588 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 10
19:47:05.588 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=10)
19:47:05.588 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
19:47:05.588 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
19:47:05.588 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.588 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:05.588 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
19:47:05.588 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=9)
19:47:05.588 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:05.588 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:47:05.588 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
19:47:05.588 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:05.588 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
19:47:05.588 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
19:47:05.588 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
19:47:05.588 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 11
19:47:05.588 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:47:05.588 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
19:47:05.588 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=11
19:47:05.588 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.589 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
19:47:05.588 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
19:47:05.589 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 12
19:47:05.588 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
19:47:05.588 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
19:47:05.588 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:05.588 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:05.589 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
19:47:05.589 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
19:47:05.589 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 11
19:47:05.589 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:47:05.589 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:05.589 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
19:47:05.589 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=12)
19:47:05.589 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
19:47:05.589 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
19:47:05.589 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:47:05.589 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
19:47:05.589 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-13, value-13)
19:47:05.589 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
19:47:05.589 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:05.589 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
19:47:05.589 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=13)
19:47:05.589 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=12)
19:47:05.589 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:47:05.589 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=12)
19:47:05.589 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:47:05.590 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
19:47:05.590 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.590 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:05.590 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=13)
19:47:05.590 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.590 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
19:47:05.590 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-14, value-14)
19:47:05.590 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:47:05.590 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:05.590 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:47:05.590 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
19:47:05.590 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 14
19:47:05.590 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=13)
19:47:05.590 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:47:05.590 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.590 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 14
19:47:05.590 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=13
19:47:05.590 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=12)
19:47:05.590 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 14
19:47:05.590 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=12
19:47:05.590 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
19:47:05.590 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=14)
19:47:05.590 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
19:47:05.590 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:47:05.590 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
19:47:05.591 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
19:47:05.591 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
19:47:05.590 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=14
19:47:05.591 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:47:05.591 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-16, value-16)
19:47:05.590 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.591 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
19:47:05.590 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
19:47:05.590 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
19:47:05.591 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:47:05.591 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=15)
19:47:05.591 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 15
19:47:05.590 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:47:05.591 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
19:47:05.591 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.591 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=15)
19:47:05.591 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:47:05.591 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:47:05.591 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
19:47:05.591 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=16)
19:47:05.591 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
19:47:05.591 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-17, value-17)
19:47:05.591 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=16
19:47:05.591 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
19:47:05.591 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 16
19:47:05.591 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
19:47:05.591 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=15
19:47:05.591 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
19:47:05.592 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
19:47:05.591 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=15
19:47:05.592 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 18
19:47:05.591 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=16)
19:47:05.592 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
19:47:05.591 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.591 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.592 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:47:05.591 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:47:05.592 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 18
19:47:05.592 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
19:47:05.592 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-18, value-18)
19:47:05.592 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=18
19:47:05.592 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=16)
19:47:05.592 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 18
19:47:05.592 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
19:47:05.592 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=18
19:47:05.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.592 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 18
19:47:05.592 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
19:47:05.592 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
19:47:05.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
19:47:05.592 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-19, value-19)
19:47:05.592 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=19)
19:47:05.592 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=19)
19:47:05.593 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 19
19:47:05.592 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 18
19:47:05.593 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=19)
19:47:05.593 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:47:05.593 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.593 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
19:47:05.593 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:47:05.593 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
19:47:05.593 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
19:47:05.593 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
19:47:05.593 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:47:05.593 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=19)
19:47:05.593 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
19:47:05.593 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.593 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:47:05.593 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:47:05.593 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=19
19:47:05.593 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
19:47:05.593 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
19:47:05.593 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=19)
19:47:05.593 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
19:47:05.593 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 20
19:47:05.593 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
19:47:05.593 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
19:47:05.593 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
19:47:05.593 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
19:47:05.593 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 20
19:47:05.593 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
19:47:05.593 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:47:05.593 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
19:47:05.593 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
19:47:05.594 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
19:47:05.594 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
19:47:05.594 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
19:47:05.594 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
19:47:05.613 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:47:05.613 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:47:05.613 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
19:47:05.614 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
19:47:05.614 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
19:47:05.614 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
19:47:05.697 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:05.697 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.697 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:05.697 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:05.697 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:05.697 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:05.697 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.697 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:05.697 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:05.697 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:05.697 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:05.697 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.698 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:05.698 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:05.698 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:05.699 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:05.699 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:05.699 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:05.699 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:05.699 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:05.700 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:05.700 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:05.700 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:05.700 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:05.700 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:05.700 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:05.700 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:05.969 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:05.969 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:05.970 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:05.970 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:05.970 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:05.970 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.970 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:05.970 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:05.970 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:05.970 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:05.970 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.970 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:05.970 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:05.970 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:05.970 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:05.970 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:05.970 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:06.016 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:06.016 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key2, value2)
19:47:06.017 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:06.017 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.017 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:06.017 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:06.017 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:06.017 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:06.018 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.018 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:06.018 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:06.018 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
19:47:06.021 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:06.021 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:06.022 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
19:47:06.022 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
19:47:06.125 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:06.125 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.125 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:06.125 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:06.125 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:06.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:06.126 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.126 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:06.126 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:06.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:06.126 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:06.126 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.126 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:06.126 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:06.126 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:06.128 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:06.129 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:06.129 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:06.129 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:06.129 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:06.129 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:06.129 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:06.129 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:06.129 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:06.129 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:06.129 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:06.129 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:06.308 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:06.309 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:06.309 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:06.309 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:06.309 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:06.309 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:06.309 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:06.309 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.309 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.309 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:06.309 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:06.309 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:06.309 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:06.309 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:06.309 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:06.309 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:06.309 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:06.334 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:06.334 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
19:47:06.334 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:06.334 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:06.334 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.335 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.335 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:06.335 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:06.335 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:06.335 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:06.335 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:06.335 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:06.335 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:47:06.365 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:06.365 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:06.365 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:47:06.365 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:47:06.441 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Killing leader: node-3
19:47:06.441 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:06.441 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.441 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:06.441 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:06.441 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:06.583 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:06.584 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:06.584 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:06.584 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=2)
19:47:06.584 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:06.584 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.584 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
19:47:06.584 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:47:06.584 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:06.584 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:06.584 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:06.584 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:06.584 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
19:47:06.650 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - New leader: node-1
19:47:06.651 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
19:47:06.651 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
19:47:06.651 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:06.652 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:06.652 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=2, entries=1)
19:47:06.652 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:06.652 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:47:06.652 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:06.652 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:47:06.689 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:06.689 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:06.690 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:47:06.735 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:06.758 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:06.758 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.758 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:06.759 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:06.759 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:06.759 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:06.759 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.759 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:06.759 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:06.759 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:06.760 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:06.760 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:06.760 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:06.760 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:06.760 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:06.760 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:06.760 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:06.760 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:06.761 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:06.761 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:06.761 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:06.761 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:06.929 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:06.929 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:06.929 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:06.929 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:06.929 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:06.929 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.929 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:06.929 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:06.929 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:06.929 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:06.929 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.929 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:06.929 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:06.929 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:06.929 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:06.929 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:06.929 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:06.972 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:06.972 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
19:47:06.973 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:06.973 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:06.973 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.973 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.973 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:06.973 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:06.973 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:06.974 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:06.974 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:06.974 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:47:06.974 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:06.974 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
19:47:06.975 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:06.975 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:06.975 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.975 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.975 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:06.975 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:06.975 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:06.975 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:06.976 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:47:06.976 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:06.976 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:06.976 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:06.976 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:47:06.976 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:47:06.976 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:47:06.976 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:06.976 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
19:47:06.976 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:47:06.976 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
19:47:06.976 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.976 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.977 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:06.977 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:06.977 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:06.977 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:06.977 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:47:06.977 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:47:06.977 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:47:06.977 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:47:06.977 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:06.977 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:06.977 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:47:06.977 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:06.977 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
19:47:06.977 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
19:47:06.977 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
19:47:06.977 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.978 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.978 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:06.978 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:06.978 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:06.978 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:47:06.978 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:47:06.978 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:06.978 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:06.978 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
19:47:06.978 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:47:06.978 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:47:06.978 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:06.978 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
19:47:06.978 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
19:47:06.978 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
19:47:06.978 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.979 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.979 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:06.979 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:06.979 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:06.979 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
19:47:06.979 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:47:06.979 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:06.979 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:06.979 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:47:06.979 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:47:06.979 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
19:47:06.979 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:06.979 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
19:47:06.979 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
19:47:06.979 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
19:47:06.979 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.979 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:06.979 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:06.979 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:47:06.979 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.979 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
19:47:06.979 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:06.979 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:06.979 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:06.979 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:47:06.980 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:47:06.980 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:47:06.980 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:06.980 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:47:06.980 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:06.980 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
19:47:06.980 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:47:06.980 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:47:06.980 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
19:47:06.980 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
19:47:06.980 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.980 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:47:06.980 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.980 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
19:47:06.980 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:47:06.980 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:47:06.980 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
19:47:06.980 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:47:06.980 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:47:06.980 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
19:47:06.980 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
19:47:06.981 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
19:47:06.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.981 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:06.981 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:06.981 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:06.981 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:06.981 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
19:47:06.981 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:47:06.981 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:06.981 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
19:47:06.981 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:47:06.981 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:47:06.981 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:47:06.981 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
19:47:06.981 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
19:47:06.981 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
19:47:06.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.981 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:47:06.981 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:47:06.981 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:06.981 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:06.981 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
19:47:06.981 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:47:06.981 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:06.982 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
19:47:06.982 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:47:06.982 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:47:06.982 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:47:06.982 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
19:47:06.982 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
19:47:06.982 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
19:47:06.982 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.982 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:47:06.982 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:06.982 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.982 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
19:47:06.982 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:47:06.982 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:06.982 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:47:06.982 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:47:06.982 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:06.982 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
19:47:06.982 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:47:07.035 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:47:07.035 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:47:07.035 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:47:07.035 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:47:07.088 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:07.088 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.089 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.089 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:07.089 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:07.089 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:07.089 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.089 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.089 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:07.089 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:07.089 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:07.089 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.089 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.089 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:07.089 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:07.091 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:07.091 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:07.091 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.092 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:07.092 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:07.092 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:07.092 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.092 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:07.092 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:07.092 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:07.092 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.092 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:07.248 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:07.248 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:07.248 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:07.248 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:47:07.248 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:47:07.248 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.248 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.248 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.248 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.248 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:07.248 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:07.248 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:47:07.248 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:47:07.248 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:07.248 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:07.248 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:07.248 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:07.303 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Leader: node-1
19:47:07.303 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:07.303 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
19:47:07.303 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:07.303 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:07.303 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:47:07.303 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:47:07.303 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.303 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:07.303 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:07.303 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.303 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:07.303 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:07.303 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:07.303 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:07.303 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:47:07.303 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:47:07.303 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.303 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.303 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:47:07.304 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - PUT committed
19:47:07.354 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:07.353 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:07.354 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:47:07.354 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:47:07.407 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - Data replicated to all nodes
19:47:07.408 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:07.408 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.408 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.408 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:07.408 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:07.408 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:07.408 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.408 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.408 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:07.408 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:07.408 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:07.408 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.408 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.408 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:07.408 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:07.410 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:07.410 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:07.410 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.410 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:07.410 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:07.410 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:07.410 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.410 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:07.410 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:07.410 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:07.410 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.410 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:07.617 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:07.618 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:07.618 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:07.618 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:07.618 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.618 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.618 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:07.618 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:07.618 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:07.618 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:07.618 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:07.618 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.618 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.619 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:07.619 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:07.619 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:07.619 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:07.724 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:07.724 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.724 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.725 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:07.725 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:07.725 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:07.725 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.725 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.725 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:07.725 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:07.725 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:07.725 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.725 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.725 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:07.725 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:07.726 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:07.726 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:07.726 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.726 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:07.727 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:07.727 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:07.727 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.727 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:07.727 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:07.727 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:07.727 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.727 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:07.727 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
19:47:07.727 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
19:47:07.727 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.727 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
19:47:07.727 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
19:47:07.727 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
19:47:07.727 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.727 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
19:47:07.888 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:07.888 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:07.888 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
19:47:07.888 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
19:47:07.888 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.888 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 VoteRequest(term=1)
19:47:07.888 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.888 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.888 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.888 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 VoteRequest(term=1)
19:47:07.888 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:07.888 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
19:47:07.888 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.888 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:47:07.888 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.888 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:07.888 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.888 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-5 VoteResponse(granted=true)
19:47:07.888 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
19:47:07.888 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:07.888 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.888 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
19:47:07.888 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-4 VoteResponse(granted=true)
19:47:07.889 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:07.889 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:07.889 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:47:07.889 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:07.889 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:07.932 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:07.932 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(stable-key, initial)
19:47:07.932 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:07.933 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:07.933 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:07.933 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
19:47:07.933 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:07.933 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
19:47:07.933 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:07.933 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.933 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.933 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:07.933 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:07.933 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.933 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:07.933 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.933 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:07.933 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
19:47:07.933 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:07.933 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
19:47:07.933 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:47:07.940 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:07.940 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:07.940 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:07.940 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:07.941 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:47:07.941 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:47:07.941 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:47:07.941 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:47:08.036 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:08.036 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-0, value-0)
19:47:08.036 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:08.036 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:08.036 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.036 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:08.037 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:08.037 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:08.037 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
19:47:08.037 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:08.037 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:08.037 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
19:47:08.037 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:47:08.037 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:08.037 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-1, value-1)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=3)
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=3)
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:08.037 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:08.037 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:08.037 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:08.037 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:47:08.037 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:08.037 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:08.037 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:08.037 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=3
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:47:08.037 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:08.037 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=3
19:47:08.037 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:47:08.037 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:47:08.037 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:47:08.037 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:47:08.037 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:47:08.037 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:08.037 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-2, value-2)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.038 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:08.038 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=4)
19:47:08.038 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:08.038 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=4)
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:08.038 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:47:08.038 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:08.038 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:08.038 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:08.038 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
19:47:08.038 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:47:08.038 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:47:08.038 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:08.038 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:08.038 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:08.038 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=4
19:47:08.038 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:08.038 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:08.038 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=4
19:47:08.038 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:47:08.038 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:47:08.038 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:47:08.038 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:08.038 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-3, value-3)
19:47:08.038 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
19:47:08.038 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.038 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=5)
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:08.038 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:08.038 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=5)
19:47:08.038 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:08.038 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:08.038 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:08.038 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
19:47:08.038 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:47:08.038 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:47:08.039 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:08.038 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:08.038 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:08.039 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:08.038 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:08.038 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:47:08.039 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:47:08.039 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=5
19:47:08.039 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:08.039 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:08.039 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-4, value-4)
19:47:08.039 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=5
19:47:08.039 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:47:08.039 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=6)
19:47:08.039 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:08.039 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=6)
19:47:08.039 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=6)
19:47:08.039 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:08.039 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:08.039 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:08.039 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
19:47:08.039 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=6
19:47:08.039 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:08.039 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=6)
19:47:08.039 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:47:08.039 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:08.039 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:47:08.039 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:08.039 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.040 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:08.040 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=6
19:47:08.040 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:47:08.091 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:08.091 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:08.091 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:08.091 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:08.091 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:47:08.091 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:47:08.091 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:47:08.091 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:47:08.145 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:08.145 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.145 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.145 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:08.145 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:08.145 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:08.145 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.145 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.145 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:08.145 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:08.145 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:08.145 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.145 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.145 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:08.146 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:08.146 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
19:47:08.146 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.146 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.146 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
19:47:08.146 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
19:47:08.146 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
19:47:08.146 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.146 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.146 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
19:47:08.146 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
19:47:08.154 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:08.155 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:08.155 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:08.155 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:08.155 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:08.155 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.156 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:08.346 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:08.349 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:08.350 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:08.350 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:08.350 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:08.350 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:08.350 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:08.350 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:08.473 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:08.473 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test, data)
19:47:08.473 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:08.473 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test, data)
19:47:08.474 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Data files created at target/test-data/node-1
19:47:08.475 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:08.475 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.475 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.475 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:08.476 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:08.480 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:08.480 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:08.480 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:08.480 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:08.480 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:08.480 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.481 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:08.481 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:08.481 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
19:47:08.481 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
19:47:08.481 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:08.481 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:08.481 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.482 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:08.482 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:08.482 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
19:47:08.482 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
19:47:08.482 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:08.482 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:08.482 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.482 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:08.672 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:08.673 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:08.673 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:08.673 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:08.673 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:08.673 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:08.673 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:08.674 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:08.674 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:08.674 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.674 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:08.674 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:08.674 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.674 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:08.674 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:08.674 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:08.674 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:08.674 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:08.674 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:08.674 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:08.674 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:08.674 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:08.675 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:08.694 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Leader: node-3
19:47:08.694 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:08.694 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
19:47:08.694 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:08.694 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:08.694 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.695 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:08.695 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:08.695 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:08.695 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:08.695 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:08.695 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:08.695 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:08.695 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:08.695 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:47:08.695 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:08.695 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key2, value2)
19:47:08.695 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:08.695 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:08.695 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.695 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:08.696 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:08.696 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:08.696 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:08.696 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:08.696 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:08.696 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:08.696 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:08.696 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:08.696 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:47:08.696 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:47:08.696 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
19:47:08.696 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:47:08.696 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:08.696 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key3, value3)
19:47:08.696 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:47:08.696 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
19:47:08.696 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.696 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:08.696 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:08.696 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:08.696 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:08.696 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:08.696 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:08.696 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:08.696 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:47:08.696 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:47:08.696 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:08.696 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:08.696 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
19:47:08.696 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
19:47:08.697 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
19:47:08.729 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:08.730 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:08.730 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
19:47:08.730 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
19:47:08.802 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Stopping all nodes...
19:47:08.802 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:08.802 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.802 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.802 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:08.802 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:08.802 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:08.802 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.802 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.802 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:08.803 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:08.803 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:08.803 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.803 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.803 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:08.803 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:08.803 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting all nodes...
19:47:08.803 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:08.804 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
19:47:08.804 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:08.804 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:08.804 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
19:47:08.804 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
19:47:08.804 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
19:47:08.804 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
19:47:08.804 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=3
19:47:08.804 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:08.804 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.804 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:08.804 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:08.804 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
19:47:08.804 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
19:47:08.804 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
19:47:08.804 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
19:47:08.804 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
19:47:08.804 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
19:47:08.805 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
19:47:08.805 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=3
19:47:08.805 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:08.805 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.805 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:08.805 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:08.805 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
19:47:08.805 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
19:47:08.805 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
19:47:08.805 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
19:47:08.805 [main] [node-3] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
19:47:08.805 [main] [node-3] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
19:47:08.805 [main] [node-3] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
19:47:08.805 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=3
19:47:08.805 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:08.805 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.805 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:09.039 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:09.039 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
19:47:09.039 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:09.039 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:09.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=2)
19:47:09.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=2)
19:47:09.040 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:09.040 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:09.040 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.040 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:47:09.040 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
19:47:09.040 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:47:09.040 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:09.040 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:09.040 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:09.040 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:09.040 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:09.040 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:09.040 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.041 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:47:09.041 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
19:47:09.041 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:47:09.119 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - New leader after restart: node-2
19:47:09.122 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - All nodes recovered successfully
19:47:09.122 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:09.122 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.122 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.122 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:09.122 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:09.122 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:09.122 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.123 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.123 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:09.123 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:09.123 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:09.123 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.123 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.123 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:09.123 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:09.125 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:09.126 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:09.126 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:09.126 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:09.126 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:09.126 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.126 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:09.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:09.126 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
19:47:09.126 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
19:47:09.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:09.126 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:09.126 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:09.126 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:09.126 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
19:47:09.126 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
19:47:09.126 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:09.126 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:09.126 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.126 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:09.373 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:09.375 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:09.376 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:09.376 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:09.376 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:09.376 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:09.376 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:09.377 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:09.377 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:09.377 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.377 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:09.377 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:09.377 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.377 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:09.377 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:09.378 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:09.378 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:09.378 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:09.378 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:09.378 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:09.378 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:09.378 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:09.378 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:09.434 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:09.434 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, restart)
19:47:09.434 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:09.434 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:09.434 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:09.434 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:09.435 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:09.435 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:09.435 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:09.435 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:09.435 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:09.435 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:09.435 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:09.435 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
19:47:09.483 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:09.483 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:09.484 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
19:47:09.484 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
19:47:09.544 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting follower: node-1
19:47:09.545 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:09.545 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.545 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.545 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:09.545 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:09.648 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:09.648 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during, downtime)
19:47:09.648 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:09.648 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:09.648 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:09.649 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:09.649 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:09.649 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:47:09.649 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:09.649 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
19:47:09.649 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:09.650 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
19:47:09.650 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:09.650 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:09.650 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
19:47:09.650 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
19:47:09.650 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 1 to recover state machine
19:47:09.650 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
19:47:09.650 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=1
19:47:09.650 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:09.650 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.650 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:09.683 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:09.683 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:09.683 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:09.683 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
19:47:09.683 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:09.683 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:09.684 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:09.684 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:09.684 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
19:47:09.756 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Follower node-1 caught up after restart
19:47:09.756 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:09.756 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.756 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.756 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:09.756 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:09.756 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:09.756 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.756 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.756 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:09.756 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:09.756 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:09.756 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.756 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.756 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:09.756 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:09.760 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:09.760 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:09.760 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:09.760 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:09.760 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:09.760 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.760 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:09.959 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:09.961 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:09.963 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:09.963 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:09.963 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:09.963 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:09.963 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:09.963 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:09.969 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:09.970 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.970 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.970 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:09.970 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:09.970 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:09.970 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
19:47:09.971 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:09.971 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:09.971 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=0
19:47:09.971 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:09.971 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.971 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:09.971 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Term persisted: 1 -> 1
19:47:09.971 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:09.971 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.971 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.971 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:09.971 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:09.975 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:09.975 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:09.975 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:09.975 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:09.975 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:09.975 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.975 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:10.131 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:10.133 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:10.134 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:10.134 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:10.134 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:10.134 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:10.134 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:10.134 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:10.188 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:10.189 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
19:47:10.189 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:10.189 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:47:10.190 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:10.190 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
19:47:10.190 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:10.190 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:47:10.191 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:10.191 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
19:47:10.191 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:10.191 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:47:10.191 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:10.191 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
19:47:10.191 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:10.191 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:47:10.192 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:10.192 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
19:47:10.192 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:10.192 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:47:10.192 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:10.192 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
19:47:10.192 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:10.192 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:47:10.193 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:47:10.193 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
19:47:10.193 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:47:10.193 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:47:10.193 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:47:10.193 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
19:47:10.193 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:10.193 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:47:10.194 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:47:10.194 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
19:47:10.194 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:10.194 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:47:10.194 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:47:10.194 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
19:47:10.194 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:10.194 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:47:10.195 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 10, term 1
19:47:10.195 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
19:47:10.197 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=10, lastTerm=1, size=184 bytes
19:47:10.197 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 10, 0 entries remaining
19:47:10.197 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
19:47:10.197 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 0 log entries remaining
19:47:10.198 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Snapshot test passed
19:47:10.198 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:10.199 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:10.199 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:10.199 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:10.199 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:10.201 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:10.202 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:10.202 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:10.202 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:10.202 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:10.202 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:10.202 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:10.465 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:10.468 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:10.469 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:10.469 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:10.469 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:10.469 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:10.469 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:10.469 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:10.517 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:10.517 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
19:47:10.517 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:10.518 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:47:10.518 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:10.518 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
19:47:10.518 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:10.518 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:47:10.518 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:10.519 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
19:47:10.519 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:10.519 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:47:10.519 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:10.519 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
19:47:10.519 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:10.519 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:47:10.519 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:10.519 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
19:47:10.519 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:10.520 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:47:10.520 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:10.520 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
19:47:10.520 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:10.520 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:47:10.520 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:47:10.520 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
19:47:10.521 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:47:10.521 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:47:10.521 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:47:10.521 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
19:47:10.521 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:10.521 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:47:10.521 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:47:10.521 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
19:47:10.521 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:10.521 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:47:10.522 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:47:10.522 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
19:47:10.522 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:10.522 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:47:10.522 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 9, term 1
19:47:10.522 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
19:47:10.523 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=9, lastTerm=1, size=184 bytes
19:47:10.524 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 9, 1 entries remaining
19:47:10.524 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 1 entries
19:47:10.524 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 1 log entries remaining
19:47:10.524 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:47:10.524 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
19:47:10.525 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:47:10.525 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
19:47:10.525 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:47:10.525 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
19:47:10.525 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
19:47:10.525 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
19:47:10.525 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:47:10.525 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
19:47:10.525 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
19:47:10.525 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
19:47:10.525 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:47:10.525 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
19:47:10.525 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:47:10.526 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
19:47:10.526 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:47:10.526 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
19:47:10.526 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
19:47:10.526 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
19:47:10.526 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:10.526 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:10.526 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:10.526 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:10.526 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:10.526 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:10.527 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
19:47:10.527 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:10.527 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=9, lastTerm=1
19:47:10.527 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:10.528 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 184 bytes
19:47:10.528 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 10 entries
19:47:10.528 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=9, term=1
19:47:10.528 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=9, term=1
19:47:10.528 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 6 log entries from disk
19:47:10.528 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 6 log entries, lastIndex=15
19:47:10.528 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 10 to 15 to recover state machine
19:47:10.529 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=15
19:47:10.529 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=15
19:47:10.529 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:10.529 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:10.529 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:10.722 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:10.724 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:10.725 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:10.725 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:10.725 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:10.725 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:10.725 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:10.725 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:10.741 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Recovery from snapshot test passed
19:47:10.741 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:10.741 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:10.741 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:10.741 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:10.741 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:10.743 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:10.744 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:10.744 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:10.744 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:10.744 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:10.744 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:10.744 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:10.744 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:10.744 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
19:47:10.744 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
19:47:10.744 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:10.744 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:10.744 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:10.744 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:10.744 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:10.744 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
19:47:10.744 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
19:47:10.744 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:10.744 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:10.744 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:10.744 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:10.995 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:10.997 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:10.998 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:10.998 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:10.998 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:10.998 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
19:47:10.998 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
19:47:10.999 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:10.999 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:10.999 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:10.999 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:10.999 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:10.999 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:10.999 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:10.999 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:10.999 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:10.999 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:10.999 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:47:10.999 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:47:10.999 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:10.999 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:10.999 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:10.999 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:11.056 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:11.056 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
19:47:11.056 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:11.056 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:11.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.057 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.057 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:11.057 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:11.057 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.057 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:11.057 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:11.057 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:11.057 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:47:11.057 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:11.057 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
19:47:11.057 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:11.057 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:11.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.057 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.057 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:11.057 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:11.057 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.057 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:11.057 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:11.057 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:11.057 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:47:11.057 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:11.057 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:11.057 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:11.057 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:47:11.057 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:47:11.057 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:11.057 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
19:47:11.057 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:47:11.057 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
19:47:11.058 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.058 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.058 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.058 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:11.058 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:11.058 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:47:11.058 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:11.058 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.058 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:11.058 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:11.058 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:47:11.058 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:47:11.058 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:47:11.058 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:47:11.058 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:11.058 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
19:47:11.058 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
19:47:11.058 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
19:47:11.058 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.058 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.058 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.058 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:11.058 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.058 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:11.058 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:11.058 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:11.058 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
19:47:11.058 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:47:11.058 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:11.058 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:47:11.058 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:47:11.058 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:47:11.058 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:11.058 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
19:47:11.058 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
19:47:11.058 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
19:47:11.058 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.058 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.058 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.058 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.058 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:11.058 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:11.058 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:11.058 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:11.058 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
19:47:11.058 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:47:11.058 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:11.058 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:11.058 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:47:11.058 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:47:11.058 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:47:11.059 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:11.059 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
19:47:11.059 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
19:47:11.059 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
19:47:11.059 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.059 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.059 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:11.059 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.059 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:11.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:11.059 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:11.059 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
19:47:11.059 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:47:11.059 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:11.059 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
19:47:11.059 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:47:11.059 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:47:11.059 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:47:11.059 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
19:47:11.059 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
19:47:11.059 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.059 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
19:47:11.059 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.059 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:47:11.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:11.059 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.059 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
19:47:11.059 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:47:11.059 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:47:11.059 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:11.059 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:47:11.059 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
19:47:11.059 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:47:11.059 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:47:11.059 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:47:11.059 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
19:47:11.059 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
19:47:11.059 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.059 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
19:47:11.059 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.059 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.059 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:11.059 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:11.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:11.059 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:11.059 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
19:47:11.059 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
19:47:11.059 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:47:11.059 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:11.060 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:11.060 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:47:11.060 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:47:11.060 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:47:11.060 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
19:47:11.060 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
19:47:11.060 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
19:47:11.060 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.060 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.060 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.060 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:47:11.060 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:11.060 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.060 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
19:47:11.060 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:47:11.060 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:47:11.060 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:11.060 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:11.060 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
19:47:11.060 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:47:11.060 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:47:11.060 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:47:11.060 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
19:47:11.060 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
19:47:11.060 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
19:47:11.060 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.060 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.060 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.060 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:47:11.060 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:11.060 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.060 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:47:11.060 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
19:47:11.060 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:47:11.060 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:11.060 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
19:47:11.060 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:47:11.060 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:11.060 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:11.060 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:47:11.105 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:47:11.105 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:47:11.105 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:47:11.105 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:47:11.166 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:11.166 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:11.167 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:11.167 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:11.167 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:11.273 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:47:11.273 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
19:47:11.273 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=11)
19:47:11.273 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
19:47:11.273 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.274 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.274 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
19:47:11.274 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
19:47:11.274 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:47:11.274 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
19:47:11.274 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:47:11.274 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
19:47:11.274 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=11)
19:47:11.274 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=12)
19:47:11.274 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.274 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.274 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
19:47:11.274 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:47:11.274 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
19:47:11.274 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
19:47:11.274 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
19:47:11.274 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
19:47:11.275 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:47:11.275 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
19:47:11.275 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=11)
19:47:11.275 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=13)
19:47:11.275 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.275 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.275 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
19:47:11.275 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:47:11.275 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
19:47:11.275 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
19:47:11.275 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
19:47:11.275 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
19:47:11.275 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:47:11.275 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
19:47:11.275 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=11)
19:47:11.275 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=14)
19:47:11.275 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.275 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.275 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
19:47:11.275 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
19:47:11.275 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
19:47:11.275 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:47:11.275 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
19:47:11.275 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
19:47:11.276 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:47:11.276 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
19:47:11.276 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=11)
19:47:11.276 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=15)
19:47:11.276 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.276 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.276 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
19:47:11.276 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
19:47:11.276 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
19:47:11.276 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
19:47:11.276 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
19:47:11.276 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
19:47:11.276 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
19:47:11.276 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(key15, value15)
19:47:11.276 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-1 (nextIndex=11)
19:47:11.276 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
19:47:11.276 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.276 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.276 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
19:47:11.276 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
19:47:11.276 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
19:47:11.276 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
19:47:11.276 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
19:47:11.276 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
19:47:11.277 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
19:47:11.277 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(key16, value16)
19:47:11.277 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 7 entries to node-1 (nextIndex=11)
19:47:11.277 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
19:47:11.277 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.277 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.277 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:47:11.277 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:47:11.277 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
19:47:11.277 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
19:47:11.277 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
19:47:11.277 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
19:47:11.277 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
19:47:11.277 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(key17, value17)
19:47:11.277 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 8 entries to node-1 (nextIndex=11)
19:47:11.277 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=18)
19:47:11.277 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.277 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.277 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
19:47:11.277 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
19:47:11.277 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=18
19:47:11.277 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
19:47:11.277 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
19:47:11.277 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
19:47:11.277 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
19:47:11.277 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(key18, value18)
19:47:11.277 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 9 entries to node-1 (nextIndex=11)
19:47:11.277 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=19)
19:47:11.277 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.277 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.278 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
19:47:11.278 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:47:11.278 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
19:47:11.278 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
19:47:11.278 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
19:47:11.278 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
19:47:11.278 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
19:47:11.278 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(key19, value19)
19:47:11.278 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 10 entries to node-1 (nextIndex=11)
19:47:11.278 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
19:47:11.278 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.278 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.278 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
19:47:11.278 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
19:47:11.278 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
19:47:11.278 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
19:47:11.278 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
19:47:11.278 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
19:47:11.278 [main] [node-2] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 19, term 1
19:47:11.278 [main] [node-2] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 20 entries, 384 bytes
19:47:11.279 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=19, lastTerm=1, size=384 bytes
19:47:11.279 [main] [node-2] INFO  com.raftdb.log.LogManager - Compacted log to index 19, 1 entries remaining
19:47:11.279 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Rewrote log with 1 entries
19:47:11.279 [main] [node-2] INFO  com.raftdb.core.RaftNode - Snapshot complete: 384 bytes, 1 log entries remaining
19:47:11.280 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:11.280 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:11.280 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:11.280 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:11.280 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:11.280 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:11.280 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:11.305 [replication-node-2] [node-2] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 384 bytes
19:47:11.306 [replication-node-2] [node-2] INFO  c.r.replication.ReplicationManager - Sending snapshot to node-1 (lastIndex=19, size=384)
19:47:11.307 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 InstallSnapshot(term=1, lastIndex=19, size=384)
19:47:11.307 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:47:11.308 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:11.308 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
19:47:11.308 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:11.308 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:11.308 [] [node-1] INFO  com.raftdb.core.RaftNode - Installing snapshot: lastIndex=19, lastTerm=1, size=384
19:47:11.308 [] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=19, lastTerm=1, size=384 bytes
19:47:11.308 [] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 20 entries
19:47:11.308 [] [node-1] INFO  com.raftdb.log.LogManager - Reset log to snapshot: index=19, term=1
19:47:11.308 [] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
19:47:11.308 [] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot installed successfully
19:47:11.309 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 InstallSnapshotResponse(term=1)
19:47:11.309 [] [node-2] INFO  c.r.replication.ReplicationManager - Snapshot to node-1 complete, nextIndex=20
19:47:11.355 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=20)
19:47:11.355 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.355 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.355 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
19:47:11.355 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:47:11.355 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
19:47:11.355 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
19:47:11.386 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Snapshot replication test passed
19:47:11.389 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:11.389 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:11.389 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:11.389 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:11.389 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:11.390 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:11.390 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:11.390 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:11.390 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:11.390 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:11.390 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:11.390 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:11.390 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:11.390 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:11.390 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:11.402 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:11.402 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:11.402 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:11.402 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:11.402 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:11.402 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:11.402 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:11.612 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:11.613 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:11.614 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:11.614 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:11.614 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:11.614 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:11.614 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:11.614 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:11.718 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:11.718 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(string, hello)
19:47:11.719 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:11.719 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(string, hello)
19:47:11.719 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:11.719 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(number, 12345)
19:47:11.719 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:11.719 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(number, 12345)
19:47:11.719 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:11.719 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(special, )
19:47:11.720 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:11.720 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(special, )
19:47:11.720 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:11.720 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(empty, )
19:47:11.720 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:11.720 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(empty, )
19:47:11.721 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:11.721 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: DELETE(empty)
19:47:11.721 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:11.721 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: DELETE(empty)
19:47:11.721 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 5, term 1
19:47:11.721 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 3 entries, 69 bytes
19:47:11.722 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=5, lastTerm=1, size=69 bytes
19:47:11.722 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 5, 0 entries remaining
19:47:11.723 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
19:47:11.723 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 69 bytes, 0 log entries remaining
19:47:11.723 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:11.723 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:11.723 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:11.723 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:11.723 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:11.723 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:11.723 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
19:47:11.723 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:11.723 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=5, lastTerm=1
19:47:11.723 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:11.723 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 69 bytes
19:47:11.723 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 3 entries
19:47:11.723 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=5, term=1
19:47:11.724 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=5, term=1
19:47:11.724 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=5
19:47:11.724 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:11.724 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:11.724 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:11.940 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:11.941 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:11.941 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:11.941 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:11.941 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:11.942 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:11.942 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:11.942 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:12.034 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - State machine snapshot test passed
19:47:12.035 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:12.035 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.035 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:12.035 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:12.035 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:12.041 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:12.042 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:12.042 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:12.042 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:12.168 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19001
19:47:12.168 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:12.168 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:12.168 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19001
19:47:12.168 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:12.169 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:47:12.169 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:47:12.169 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:12.169 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19002
19:47:12.169 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:12.169 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:12.169 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19002
19:47:12.170 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:12.170 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:47:12.170 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:47:12.170 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:12.170 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19003
19:47:12.170 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:12.170 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:12.170 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19003
19:47:12.352 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:12.358 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:12.362 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:12.363 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:12.366 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:12.366 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:12.367 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:12.366 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:12.369 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:12.369 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:12.377 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19001
19:47:12.377 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19003
19:47:12.378 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19002
19:47:12.378 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19003
19:47:12.472 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:12.473 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:12.473 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:12.473 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:12.473 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:12.473 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19002
19:47:12.473 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19001
19:47:12.526 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:47:12.526 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:47:12.526 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
19:47:12.526 [grpc-default-executor-11] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:47:12.526 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
19:47:12.526 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:47:12.531 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=false
19:47:12.531 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=false
19:47:12.531 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=false
19:47:12.531 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=false
19:47:12.531 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=false
19:47:12.531 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=false
19:47:12.611 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:12.612 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:12.612 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:12.612 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:12.612 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:12.614 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:12.615 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:12.615 [grpc-default-executor-0] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.615 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:12.615 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:12.615 [grpc-default-executor-3] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.615 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:12.615 [grpc-default-executor-0] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
19:47:12.615 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:12.615 [grpc-default-executor-3] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
19:47:12.616 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=2) -> granted=true
19:47:12.616 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:12.616 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:12.616 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:12.616 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:12.617 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=2) -> granted=true
19:47:12.690 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Leader elected: node-1
19:47:12.691 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:12.691 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.691 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:12.698 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:12.698 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:12.698 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:12.698 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.698 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:12.699 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:47:12.700 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:12.700 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:12.700 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.700 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:12.701 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:47:12.701 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:12.813 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:12.814 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:12.814 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:12.814 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:12.815 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19011
19:47:12.815 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:12.815 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:12.815 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19011
19:47:12.816 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:12.816 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:47:12.817 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:47:12.817 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:12.818 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19012
19:47:12.818 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:12.818 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:12.819 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19012
19:47:12.819 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:12.819 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:47:12.820 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:47:12.821 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:12.822 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19013
19:47:12.822 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:12.824 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:12.824 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19013
19:47:12.979 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:12.981 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:12.982 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:12.982 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:12.982 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:12.982 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19013
19:47:12.983 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19011
19:47:12.992 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:12.992 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:12.993 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:12.993 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.993 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:12.993 [grpc-default-executor-0] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.993 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:12.993 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:12.993 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:12.993 [grpc-default-executor-0] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:12.995 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
19:47:12.995 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:12.995 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:12.996 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:12.996 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:12.996 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
19:47:13.051 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:13.052 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(grpc-key, grpc-value)
19:47:13.052 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:13.053 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:13.053 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:13.053 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:13.059 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:13.059 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.059 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.061 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:13.063 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.063 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.063 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:47:13.064 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:13.064 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:47:13.064 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:13.064 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
19:47:13.066 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:47:13.066 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:13.066 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:47:13.104 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:13.105 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:13.106 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
19:47:13.110 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
19:47:13.170 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Data replicated to all nodes
19:47:13.170 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:13.170 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.170 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:13.172 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:13.172 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:13.172 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:13.172 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.172 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:13.174 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:47:13.174 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:13.174 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:13.174 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.174 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:13.175 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:47:13.175 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:13.279 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:13.280 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:13.280 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:13.280 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:13.281 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19021
19:47:13.281 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:13.281 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:13.281 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19021
19:47:13.281 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:13.281 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:47:13.281 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:47:13.281 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:13.282 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19022
19:47:13.282 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:13.282 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:13.282 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19022
19:47:13.282 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:13.283 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:47:13.283 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:47:13.283 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:13.283 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19023
19:47:13.283 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:13.284 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:13.284 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19023
19:47:13.468 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:13.468 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:13.469 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:13.469 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:13.469 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:13.472 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19021
19:47:13.472 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19023
19:47:13.495 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:13.495 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:13.495 [grpc-default-executor-6] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.495 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:13.495 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:13.495 [grpc-default-executor-9] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.495 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:13.495 [grpc-default-executor-6] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:13.496 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:13.496 [grpc-default-executor-9] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:13.497 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
19:47:13.497 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:13.497 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:13.497 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:13.497 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:13.497 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
19:47:13.597 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Initial leader: node-2 at term 1
19:47:13.597 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:13.598 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
19:47:13.598 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:13.598 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:13.598 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:13.598 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:13.601 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:13.601 [grpc-default-executor-10] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:13.601 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.601 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.601 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.601 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.603 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:47:13.603 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:13.603 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:13.603 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:47:13.604 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:47:13.604 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:47:13.604 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:13.604 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:47:13.652 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:13.652 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:13.652 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:47:13.652 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:47:13.705 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:13.705 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.705 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:13.706 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:47:13.706 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:13.706 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-2
19:47:13.706 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Stopped leader: node-2
19:47:13.901 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:13.902 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:47:13.902 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:13.902 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:13.902 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19023
19:47:13.902 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19022
19:47:13.906 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:13.906 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:13.906 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.906 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:13.906 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
19:47:13.907 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: Vote request to node-2 failed
19:47:13.907 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=2) -> granted=true
19:47:13.907 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:13.907 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:13.907 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:13.907 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:13.910 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - New leader: node-1 at term 2
19:47:13.910 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
19:47:13.910 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
19:47:13.910 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:13.910 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:13.911 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:13.911 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:13.911 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:13.911 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:13.911 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:13.911 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:47:13.959 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:13.960 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:13.960 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:47:14.011 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:14.017 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:14.017 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.017 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:14.017 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:14.017 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:14.017 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:14.017 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.018 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:14.018 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:47:14.018 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:14.124 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:14.125 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:14.125 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:14.125 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:14.125 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19031
19:47:14.125 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:14.125 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:14.126 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19031
19:47:14.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:14.126 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:47:14.126 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:47:14.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:14.126 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19032
19:47:14.126 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:14.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:14.126 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19032
19:47:14.126 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:14.126 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:47:14.126 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:47:14.127 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:14.127 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19033
19:47:14.127 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:14.127 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:14.127 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19033
19:47:14.290 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:14.291 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:14.291 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:14.291 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:14.291 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:14.292 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19033
19:47:14.292 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19032
19:47:14.298 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:14.298 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:14.298 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:14.298 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:14.298 [grpc-default-executor-9] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.298 [grpc-default-executor-2] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.298 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:14.298 [grpc-default-executor-9] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:14.298 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:14.298 [grpc-default-executor-2] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:14.299 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
19:47:14.299 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
19:47:14.299 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:14.299 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:14.299 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:14.299 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:14.347 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:14.347 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
19:47:14.348 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:14.348 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:14.350 [grpc-default-executor-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.350 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:14.350 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.350 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:14.350 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:14.350 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:14.351 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:14.352 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.352 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:14.352 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:14.352 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.352 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:14.352 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:14.352 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:47:14.352 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:14.352 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
19:47:14.353 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:14.353 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:14.353 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.354 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.355 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.355 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:14.355 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:14.355 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.355 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:14.355 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:14.356 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:47:14.356 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:47:14.356 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.357 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:47:14.357 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:14.357 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:47:14.357 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.357 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:14.357 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:14.357 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
19:47:14.357 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
19:47:14.357 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
19:47:14.359 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.359 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:14.359 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:14.359 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:47:14.359 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.359 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:14.359 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:14.359 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:47:14.361 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.361 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:47:14.361 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:14.361 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.361 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:47:14.361 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:47:14.361 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:14.362 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
19:47:14.362 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
19:47:14.362 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
19:47:14.364 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.364 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.364 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:14.364 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:14.364 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:14.364 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:14.364 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:47:14.364 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:47:14.365 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.365 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.365 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
19:47:14.365 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:14.366 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
19:47:14.366 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:47:14.366 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:14.366 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
19:47:14.366 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
19:47:14.366 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
19:47:14.367 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.367 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:14.367 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.367 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:14.367 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:14.367 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:14.367 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:47:14.367 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:47:14.368 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.368 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.368 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
19:47:14.368 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:47:14.368 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:14.368 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:14.368 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:47:14.368 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:14.368 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
19:47:14.368 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
19:47:14.368 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
19:47:14.370 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.370 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.370 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:14.370 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:14.370 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:14.370 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:14.370 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:47:14.370 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:47:14.371 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.371 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:47:14.371 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:14.371 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.371 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
19:47:14.371 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:47:14.371 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:47:14.371 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
19:47:14.371 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
19:47:14.371 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
19:47:14.372 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.372 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.373 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:47:14.373 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:47:14.373 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:14.373 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:14.373 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:47:14.373 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:47:14.373 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.373 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.373 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
19:47:14.373 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:47:14.373 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
19:47:14.373 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:47:14.373 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:47:14.373 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
19:47:14.373 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
19:47:14.374 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
19:47:14.374 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.374 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.374 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:14.374 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:14.374 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:14.375 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:14.375 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:47:14.375 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:47:14.375 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.375 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.375 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
19:47:14.375 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
19:47:14.375 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:14.375 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:14.375 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:47:14.375 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:47:14.375 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
19:47:14.375 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
19:47:14.375 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
19:47:14.376 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.376 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.376 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:47:14.376 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:47:14.376 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:14.376 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:14.376 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:47:14.376 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:47:14.377 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.377 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.377 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
19:47:14.377 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
19:47:14.377 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:14.377 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:14.377 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:47:14.377 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:47:14.377 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
19:47:14.377 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
19:47:14.377 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
19:47:14.378 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.378 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.378 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:47:14.378 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:47:14.378 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:14.378 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:14.378 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:47:14.378 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:47:14.379 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.379 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.379 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
19:47:14.379 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
19:47:14.379 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:14.379 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:14.379 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:47:14.379 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:47:14.379 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key-10, value-10)
19:47:14.379 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
19:47:14.379 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=11)
19:47:14.380 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.380 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.380 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
19:47:14.380 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
19:47:14.380 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:47:14.380 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:47:14.380 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:47:14.380 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:47:14.380 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.380 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.380 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
19:47:14.380 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
19:47:14.380 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:47:14.380 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:47:14.380 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
19:47:14.381 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:47:14.381 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key-11, value-11)
19:47:14.381 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=12)
19:47:14.381 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=12)
19:47:14.382 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.382 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.382 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
19:47:14.382 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:47:14.382 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
19:47:14.382 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:47:14.382 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
19:47:14.382 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
19:47:14.382 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.382 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
19:47:14.382 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
19:47:14.382 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
19:47:14.382 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.382 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
19:47:14.383 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:47:14.383 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key-12, value-12)
19:47:14.383 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=13)
19:47:14.383 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=13)
19:47:14.384 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.384 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
19:47:14.384 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:47:14.384 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.384 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
19:47:14.384 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:47:14.384 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
19:47:14.384 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
19:47:14.384 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.384 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.385 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
19:47:14.385 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=13
19:47:14.385 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
19:47:14.385 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
19:47:14.385 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
19:47:14.385 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:47:14.385 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key-13, value-13)
19:47:14.385 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=14)
19:47:14.385 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=14)
19:47:14.386 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.386 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
19:47:14.386 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
19:47:14.386 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.386 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
19:47:14.386 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
19:47:14.386 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
19:47:14.386 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
19:47:14.387 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.387 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.387 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=14
19:47:14.387 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
19:47:14.387 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:47:14.387 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:47:14.387 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
19:47:14.387 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:47:14.387 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key-14, value-14)
19:47:14.387 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=15)
19:47:14.387 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=15)
19:47:14.388 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.388 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.388 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
19:47:14.388 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
19:47:14.388 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
19:47:14.388 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
19:47:14.388 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
19:47:14.388 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
19:47:14.393 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.393 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.393 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
19:47:14.393 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=15
19:47:14.393 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
19:47:14.393 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
19:47:14.393 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
19:47:14.393 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
19:47:14.393 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(key-15, value-15)
19:47:14.393 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
19:47:14.393 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=16)
19:47:14.394 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.395 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.395 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
19:47:14.395 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
19:47:14.395 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
19:47:14.395 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
19:47:14.395 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
19:47:14.395 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
19:47:14.397 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.397 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.397 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
19:47:14.397 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=16
19:47:14.397 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
19:47:14.397 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
19:47:14.397 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
19:47:14.397 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
19:47:14.397 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(key-16, value-16)
19:47:14.397 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
19:47:14.397 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=17)
19:47:14.399 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.399 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.399 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:47:14.399 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:47:14.399 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:47:14.399 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:47:14.400 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
19:47:14.400 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
19:47:14.400 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
19:47:14.400 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=17)
19:47:14.400 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.400 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.400 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=17
19:47:14.400 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
19:47:14.400 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
19:47:14.400 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
19:47:14.400 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
19:47:14.401 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
19:47:14.401 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(key-17, value-17)
19:47:14.401 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:47:14.401 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=18)
19:47:14.401 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:47:14.401 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=18)
19:47:14.401 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.401 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.402 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.402 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
19:47:14.402 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
19:47:14.402 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.402 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
19:47:14.402 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
19:47:14.402 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
19:47:14.402 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
19:47:14.403 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.403 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.403 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=18
19:47:14.403 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=18
19:47:14.403 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
19:47:14.403 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
19:47:14.403 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
19:47:14.403 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
19:47:14.403 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(key-18, value-18)
19:47:14.403 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=19)
19:47:14.403 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=19)
19:47:14.404 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.404 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.404 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
19:47:14.404 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
19:47:14.404 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:47:14.404 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:47:14.404 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
19:47:14.404 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
19:47:14.405 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.405 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.405 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=19
19:47:14.405 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
19:47:14.405 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
19:47:14.405 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
19:47:14.406 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
19:47:14.406 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(key-19, value-19)
19:47:14.408 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
19:47:14.408 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=20)
19:47:14.412 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.412 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
19:47:14.412 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
19:47:14.412 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
19:47:14.412 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.412 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
19:47:14.412 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
19:47:14.413 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
19:47:14.413 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.414 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
19:47:14.414 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
19:47:14.414 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
19:47:14.415 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.415 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
19:47:14.456 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:47:14.456 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:47:14.456 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
19:47:14.456 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
19:47:14.524 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - All 20 writes replicated
19:47:14.524 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:14.524 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.524 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:14.525 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:14.525 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:14.525 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:14.525 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.525 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:14.525 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:47:14.525 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:14.525 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:14.525 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.525 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:14.525 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:47:14.525 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:14.630 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:14.630 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:14.631 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:14.631 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:14.631 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19041
19:47:14.631 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:14.631 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:14.631 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19041
19:47:14.631 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:14.632 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:47:14.632 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:47:14.632 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:14.632 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19042
19:47:14.632 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:14.632 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:14.632 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19042
19:47:14.632 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:14.632 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:47:14.632 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:47:14.632 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:14.632 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19043
19:47:14.633 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:14.633 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:14.633 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19043
19:47:14.801 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:14.802 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:14.802 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:14.802 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:14.802 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:14.802 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19043
19:47:14.802 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19041
19:47:14.806 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:14.806 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:14.806 [grpc-default-executor-2] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.806 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:14.806 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:14.806 [grpc-default-executor-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.806 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:14.806 [grpc-default-executor-2] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:14.806 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:14.806 [grpc-default-executor-1] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:14.807 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
19:47:14.807 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:14.807 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:14.807 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:14.807 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:14.807 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
19:47:14.841 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:14.841 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(restart-test, initial)
19:47:14.841 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:14.842 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:14.843 [grpc-default-executor-10] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.843 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.843 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:14.843 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:14.843 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.843 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:14.843 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:14.843 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:47:14.843 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:14.843 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
19:47:14.861 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:14.861 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:14.861 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
19:47:14.861 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
19:47:14.954 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Restarting follower: node-1 on port 19041
19:47:14.954 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:14.954 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.955 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:14.958 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:14.958 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:14.958 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-1
19:47:15.064 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:15.064 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during-downtime, value)
19:47:15.064 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:15.064 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:15.065 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:15.065 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:15.066 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:47:15.066 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:15.066 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:15.066 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
19:47:15.066 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:15.067 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-2
19:47:15.067 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:15.067 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:15.067 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
19:47:15.067 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
19:47:15.067 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 1 to recover state machine
19:47:15.067 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
19:47:15.067 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-2, lastLogIndex=1
19:47:15.067 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19041
19:47:15.067 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:15.067 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:15.067 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Restarted node node-1 on port 19041
19:47:15.112 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:15.113 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:15.113 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
19:47:15.162 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:15.208 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:15.258 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:15.261 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:15.262 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:47:15.262 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:15.262 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:15.262 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19043
19:47:15.262 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19042
19:47:15.266 [grpc-default-executor-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:15.266 [grpc-default-executor-10] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:15.266 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.266 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.266 [grpc-default-executor-10] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.266 [grpc-default-executor-2] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.267 [grpc-default-executor-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:15.267 [grpc-default-executor-10] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:15.267 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:47:15.267 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:47:15.268 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=2) -> granted=false
19:47:15.268 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=2) -> granted=false
19:47:15.418 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:15.419 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-2
19:47:15.419 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
19:47:15.419 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:15.420 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=null
19:47:15.420 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=null
19:47:15.420 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.420 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.420 [grpc-default-executor-1] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.420 [grpc-default-executor-3] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.420 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
19:47:15.420 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
19:47:15.420 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:47:15.420 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:47:15.421 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=3) -> granted=false
19:47:15.421 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=3) -> granted=false
19:47:15.578 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:15.579 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-1
19:47:15.579 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
19:47:15.579 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:15.579 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19041
19:47:15.579 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19042
19:47:15.584 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=null
19:47:15.584 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=null
19:47:15.585 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.585 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.585 [grpc-default-executor-3] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.585 [grpc-default-executor-1] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.585 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-3
19:47:15.585 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-3
19:47:15.585 [grpc-default-executor-3] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 4
19:47:15.585 [grpc-default-executor-1] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 4
19:47:15.586 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=4) -> granted=true
19:47:15.586 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:15.586 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=4) -> granted=true
19:47:15.586 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 4
19:47:15.586 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 4
19:47:15.586 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:15.587 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Missing entry at index 2
19:47:15.587 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 failed, nextIndex decremented to 2
19:47:15.640 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:15.642 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:15.642 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:15.642 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:15.642 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
19:47:15.643 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
19:47:15.643 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:15.686 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Restarted node caught up successfully
19:47:15.686 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:15.686 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.687 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:15.688 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:47:15.688 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:15.688 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:15.688 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.688 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:15.689 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:47:15.689 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:15.689 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:15.689 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.689 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:15.689 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:15.690 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:15.797 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:15.797 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:15.798 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:15.798 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:15.798 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19051
19:47:15.798 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:15.798 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:15.798 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19051
19:47:15.798 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:15.798 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:47:15.798 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:47:15.799 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:15.799 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19052
19:47:15.799 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:15.799 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:15.799 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19052
19:47:15.799 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:15.799 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:47:15.799 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:47:15.799 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:15.800 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19053
19:47:15.800 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:15.800 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:15.800 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19053
19:47:15.800 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
19:47:15.800 [main] [node-4] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-4
19:47:15.800 [main] [node-4] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-4
19:47:15.800 [main] [node-4] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:15.800 [main] [node-4] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19054
19:47:15.800 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:15.800 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
19:47:15.800 [main] [node-4] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-4 on port 19054
19:47:15.800 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
19:47:15.801 [main] [node-5] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-5
19:47:15.801 [main] [node-5] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-5
19:47:15.801 [main] [node-5] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:15.801 [main] [node-5] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19055
19:47:15.801 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:15.801 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
19:47:15.801 [main] [node-5] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-5 on port 19055
19:47:15.957 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:15.958 [election-node-5] [node-5] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:15.959 [election-node-5] [node-5] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
19:47:15.959 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:15.959 [election-node-5] [node-5] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
19:47:15.959 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19053
19:47:15.960 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-4 at localhost:19054
19:47:15.961 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19051
19:47:15.961 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19052
19:47:15.966 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:15.966 [grpc-default-executor-9] [node-4] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:15.966 [grpc-default-executor-9] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.966 [grpc-default-executor-10] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:15.966 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.966 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.966 [grpc-default-executor-9] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.966 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.966 [grpc-default-executor-10] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.966 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:15.966 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.966 [grpc-default-executor-3] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.966 [grpc-default-executor-9] [node-4] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
19:47:15.966 [grpc-default-executor-9] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
19:47:15.966 [grpc-default-executor-10] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
19:47:15.966 [grpc-default-executor-10] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
19:47:15.967 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
19:47:15.967 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
19:47:15.967 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
19:47:15.967 [grpc-default-executor-3] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
19:47:15.967 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-3 VoteRequest(term=1) -> granted=true
19:47:15.967 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
19:47:15.967 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-1 VoteRequest(term=1) -> granted=true
19:47:15.967 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
19:47:15.967 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-2 VoteRequest(term=1) -> granted=true
19:47:15.967 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-4 VoteRequest(term=1) -> granted=true
19:47:15.967 [] [node-5] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:15.967 [] [node-5] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:15.967 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:16.013 [main] [node-5] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:16.013 [main] [node-5] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(five-node-test, value)
19:47:16.013 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:16.013 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
19:47:16.013 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:16.013 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:16.015 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:16.015 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:16.015 [grpc-default-executor-11] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:16.015 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:16.015 [grpc-default-executor-11] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:16.015 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:16.015 [grpc-default-executor-9] [node-4] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:16.016 [grpc-default-executor-9] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:16.017 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-2 AppendEntries(entries=1) -> success=true
19:47:16.017 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-3 AppendEntries(entries=1) -> success=true
19:47:16.017 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-1 AppendEntries(entries=1) -> success=true
19:47:16.017 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:16.017 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-4 AppendEntries(entries=1) -> success=true
19:47:16.017 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:16.017 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:16.017 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:16.017 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
19:47:16.017 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:47:16.019 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:16.019 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:16.019 [grpc-default-executor-11] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:16.019 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:16.020 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:47:16.020 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:47:16.020 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:47:16.020 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:47:16.123 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:16.123 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:16.123 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:16.124 [grpc-default-executor-3] [node-1] ERROR com.raftdb.rpc.GrpcTransport - Error handling AppendEntries
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@6533d75b[Not completed, task = java.util.concurrent.Executors$RunnableAdapter@4d3dc3[Wrapped task = com.raftdb.election.ElectionManager$$Lambda/0x000018000118cad0@7013b959]] rejected from java.util.concurrent.ScheduledThreadPoolExecutor@1fe8d51b[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 1]
	at java.base/java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2032)
	at java.base/java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:787)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:345)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:549)
	at java.base/java.util.concurrent.Executors$DelegatedScheduledExecutorService.schedule(Executors.java:780)
	at com.raftdb.election.ElectionManager.resetElectionTimer(ElectionManager.java:109)
	at com.raftdb.core.RaftNode.handleAppendEntries(RaftNode.java:536)
	at com.raftdb.rpc.GrpcTransport$RaftServiceImpl.appendEntries(GrpcTransport.java:255)
	at com.raftdb.rpc.proto.RaftServiceGrpc$MethodHandlers.invoke(RaftServiceGrpc.java:374)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:351)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
19:47:16.127 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:16.127 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:16.127 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-1
19:47:16.127 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:16.127 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:16.127 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:16.127 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:47:16.127 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:16.127 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-2
19:47:16.127 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Stopped two followers: node-1 and node-2
19:47:16.229 [main] [node-5] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:16.229 [main] [node-5] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failures, still-working)
19:47:16.229 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:16.229 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
19:47:16.229 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:16.229 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:16.230 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:16.230 [grpc-default-executor-7] [node-4] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:16.230 [grpc-default-executor-7] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:16.230 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:16.231 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-3 AppendEntries(entries=1) -> success=true
19:47:16.231 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-4 AppendEntries(entries=1) -> success=true
19:47:16.231 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:16.231 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
19:47:16.231 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:16.231 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:16.231 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
19:47:16.269 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:16.269 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:16.270 [grpc-default-executor-7] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:16.270 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:16.270 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
19:47:16.270 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
19:47:16.320 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:16.320 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:16.333 [main] [node-5] INFO  c.raftdb.integration.GrpcClusterTest - Five-node cluster survived two failures
19:47:16.333 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:16.333 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:16.333 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:16.334 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:47:16.334 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:16.334 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
19:47:16.334 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:16.334 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:16.334 [main] [node-4] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-4
19:47:16.334 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
19:47:16.334 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
19:47:16.334 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:16.335 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:16.335 [main] [node-5] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-5
19:47:16.335 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
19:47:16.438 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:16.439 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:16.439 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:16.439 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:16.439 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19061
19:47:16.439 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:16.440 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:16.440 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19061
19:47:16.673 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:16.674 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:16.674 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:16.674 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:16.674 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:16.674 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:16.674 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:16.674 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:16.756 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:16.756 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(single, node)
19:47:16.756 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:16.756 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(single, node)
19:47:16.756 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Single node cluster works
19:47:16.756 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:16.756 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:16.756 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:16.756 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:16.756 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:16.864 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:16.864 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:16.864 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:16.864 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:16.864 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:16.864 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:16.864 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:16.864 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:16.864 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:16.864 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:16.864 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:16.864 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:17.023 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:17.023 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:17.023 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:17.023 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:47:17.023 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.023 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:47:17.024 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.023 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.024 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.024 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:17.024 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:17.024 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:47:17.024 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:47:17.024 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:17.024 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:17.024 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:17.024 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:17.075 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-1 (term 1)
19:47:17.279 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - All nodes agree on leader: node-1
19:47:17.279 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:17.279 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.279 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.279 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:17.279 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:17.279 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:17.279 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.279 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.279 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:17.279 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:17.280 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:17.280 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.280 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.280 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:17.280 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:17.283 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:17.283 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:17.283 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.284 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:17.284 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:17.284 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:17.284 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.284 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:17.284 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:17.284 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:17.284 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.284 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:17.284 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
19:47:17.284 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
19:47:17.284 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.284 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
19:47:17.284 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
19:47:17.284 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
19:47:17.284 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.284 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
19:47:17.464 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:17.464 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:17.464 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
19:47:17.464 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:17.464 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.464 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.464 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:17.464 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:17.464 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
19:47:17.464 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:17.465 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.465 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.466 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:17.466 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:17.466 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
19:47:17.466 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:17.466 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:17.466 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:17.466 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 VoteRequest(term=1)
19:47:17.466 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.466 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.466 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:17.466 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-4 VoteResponse(granted=true)
19:47:17.466 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 VoteRequest(term=1)
19:47:17.467 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.467 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.467 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:17.467 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-5 VoteResponse(granted=true)
19:47:17.494 [main] [node-5] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-3 (term 1)
19:47:17.495 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:17.495 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.495 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.495 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:17.495 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:17.495 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:17.495 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.495 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.495 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:17.495 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:17.495 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:17.496 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.496 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.498 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:17.498 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:17.498 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
19:47:17.498 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.498 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.498 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
19:47:17.498 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
19:47:17.499 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
19:47:17.499 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.499 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.499 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
19:47:17.499 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
19:47:17.502 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:17.502 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:17.502 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.502 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:17.502 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:17.502 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:17.502 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.502 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:17.502 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:17.502 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:17.502 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.502 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:17.669 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:17.669 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:17.669 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:17.669 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:17.669 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:17.669 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.669 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.669 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.669 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:17.669 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:17.669 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.682 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:17.682 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:17.682 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:17.682 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:17.682 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:17.682 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:18.218 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader node-3 maintained leadership for 500ms
19:47:18.218 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:18.218 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.218 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:18.218 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:18.218 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:18.218 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:18.218 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.218 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:18.218 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:18.218 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:18.218 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:18.218 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.218 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:18.218 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:18.219 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:18.221 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:18.221 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:18.221 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:18.221 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:18.222 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:18.222 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:18.222 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:18.222 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:18.222 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:18.222 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:18.222 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:18.222 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:18.392 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:18.392 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:18.393 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:18.393 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:47:18.393 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:18.393 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:47:18.393 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.393 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:18.393 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:18.393 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:47:18.393 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.393 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:18.393 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:18.393 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:47:18.393 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:18.393 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:18.393 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:18.424 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Initial leader: node-1 (term 1)
19:47:18.424 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:18.424 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.424 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:18.425 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:18.425 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:18.590 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:18.591 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:18.591 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:18.591 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=2)
19:47:18.591 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:18.592 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.592 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
19:47:18.592 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:18.592 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
19:47:18.592 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:18.592 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:18.592 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:18.592 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:18.637 [main] [node-1] INFO  com.raftdb.integration.ClusterTest - New leader: node-3 (term 2)
19:47:18.638 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:18.638 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.638 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:18.638 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:18.639 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:18.639 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:18.639 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.639 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:18.639 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:18.639 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:10.554 [main] [] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
20:09:10.556 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:10.557 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
20:09:10.557 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
20:09:10.557 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:10.557 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:10.558 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:10.558 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
20:09:10.558 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
20:09:10.559 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:10.559 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
20:09:10.559 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
20:09:10.559 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:10.559 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:10.559 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:10.559 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
20:09:10.560 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
20:09:10.560 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:10.560 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
20:09:10.560 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
20:09:10.560 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:10.560 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:10.560 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:10.560 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
20:09:10.813 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:10.813 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:10.816 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:10.816 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:10.817 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:09:10.817 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:09:10.817 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:10.817 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:10.818 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:10.818 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:10.823 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
20:09:10.823 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
20:09:10.823 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:09:10.823 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
20:09:10.844 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:10.844 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:10.845 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:10.845 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:10.845 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:10.846 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:09:10.846 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
20:09:10.939 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:09:10.940 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:09:10.940 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:09:10.939 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:09:10.940 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:09:10.940 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:09:10.945 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=false
20:09:10.945 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=false
20:09:10.945 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=false
20:09:10.945 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=false
20:09:10.945 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=false
20:09:10.945 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=false
20:09:10.978 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:10.978 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:09:10.979 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:09:10.979 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:09:10.979 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:10.981 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:09:10.981 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:09:10.981 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:10.981 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:10.981 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:10.981 [grpc-default-executor-4] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:10.982 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:09:10.982 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:09:10.982 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:09:10.982 [grpc-default-executor-4] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:09:10.983 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=2) -> granted=true
20:09:10.983 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=2) -> granted=true
20:09:10.983 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:10.983 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:09:10.983 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:09:10.983 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:10.991 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=name
20:09:10.992 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
20:09:10.992 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:10.995 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=name
20:09:10.996 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 2
20:09:10.996 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(name, Alice)
20:09:10.997 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:10.997 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:10.999 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:10.999 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:10.999 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:10.999 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:11.000 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:11.000 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:11.000 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:09:11.000 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:11.000 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:11.000 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:11.001 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(name, Alice)
20:09:11.003 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=age
20:09:11.003 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
20:09:11.003 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(age, 25)
20:09:11.003 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:11.003 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:09:11.004 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:11.004 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:11.004 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:11.004 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:11.004 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:11.004 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:11.005 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(name, Alice)
20:09:11.005 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(name, Alice)
20:09:11.005 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:11.005 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:11.005 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:09:11.005 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:09:11.005 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:11.005 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:11.006 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(age, 25)
20:09:11.007 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=name
20:09:11.034 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=age
20:09:11.035 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=nonexistent
20:09:11.036 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Basic put/get test passed
20:09:11.040 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:11.040 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:11.040 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:11.041 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:11.042 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(age, 25)
20:09:11.041 [grpc-default-executor-4] [node-1] ERROR com.raftdb.rpc.GrpcTransport - Error handling AppendEntries
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@236a98ed[Not completed, task = java.util.concurrent.Executors$RunnableAdapter@2a8b09e3[Wrapped task = com.raftdb.election.ElectionManager$$Lambda/0x0000030001217398@2ea3ceca]] rejected from java.util.concurrent.ScheduledThreadPoolExecutor@3f1d2e23[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 1]
	at java.base/java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2032)
	at java.base/java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:787)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:345)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:549)
	at java.base/java.util.concurrent.Executors$DelegatedScheduledExecutorService.schedule(Executors.java:780)
	at com.raftdb.election.ElectionManager.resetElectionTimer(ElectionManager.java:109)
	at com.raftdb.core.RaftNode.handleAppendEntries(RaftNode.java:552)
	at com.raftdb.rpc.GrpcTransport$RaftServiceImpl.appendEntries(GrpcTransport.java:279)
	at com.raftdb.rpc.proto.RaftServiceGrpc$MethodHandlers.invoke(RaftServiceGrpc.java:374)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:351)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
20:09:11.047 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:09:11.047 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:11.047 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:11.047 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:11.047 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:11.049 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:09:11.049 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:11.049 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:11.049 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:11.049 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:11.050 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:09:11.050 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:11.165 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
20:09:11.165 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:11.166 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
20:09:11.166 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
20:09:11.166 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:11.166 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:11.166 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:11.166 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
20:09:11.167 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
20:09:11.167 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:11.167 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
20:09:11.167 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
20:09:11.167 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:11.167 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:11.167 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:11.167 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
20:09:11.168 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
20:09:11.168 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:11.168 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
20:09:11.168 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
20:09:11.168 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:11.168 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:11.168 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:11.168 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
20:09:11.376 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:11.377 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:11.377 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:11.377 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:11.377 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:11.378 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
20:09:11.378 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:09:11.382 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:11.382 [grpc-default-executor-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:11.382 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:11.382 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:11.382 [grpc-default-executor-4] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:11.382 [grpc-default-executor-2] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:11.383 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:11.383 [grpc-default-executor-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:11.383 [grpc-default-executor-4] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:11.383 [grpc-default-executor-2] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:11.384 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
20:09:11.384 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
20:09:11.384 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:11.384 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:11.384 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:11.384 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:11.488 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=temp
20:09:11.489 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:11.489 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(temp, value)
20:09:11.489 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:11.489 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:11.489 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:11.489 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:11.495 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:11.495 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:11.496 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:11.496 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:11.496 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:11.496 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:11.497 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:09:11.497 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
20:09:11.497 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:11.497 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
20:09:11.497 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:09:11.497 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:09:11.497 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:11.497 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:11.497 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(temp, value)
20:09:11.499 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=temp
20:09:11.501 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=DELETE, key=temp
20:09:11.501 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:11.501 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(temp)
20:09:11.501 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:11.501 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:11.502 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:11.502 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:11.503 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:11.503 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:11.503 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:11.503 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:11.503 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(temp, value)
20:09:11.503 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(temp, value)
20:09:11.504 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
20:09:11.504 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:09:11.504 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:11.504 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:09:11.504 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(temp)
20:09:11.504 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:09:11.506 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=temp
20:09:11.507 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Delete test passed
20:09:11.507 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:11.508 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:11.508 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:11.508 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:09:11.509 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:11.509 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:11.509 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:11.509 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:11.509 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:09:11.509 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:11.509 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:11.509 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:11.509 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:11.509 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:09:11.510 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:11.617 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
20:09:11.618 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:11.618 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
20:09:11.618 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
20:09:11.618 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:11.618 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:11.618 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:11.618 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
20:09:11.619 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
20:09:11.619 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:11.619 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
20:09:11.619 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
20:09:11.619 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:11.619 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:11.619 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:11.619 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
20:09:11.620 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
20:09:11.620 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:11.620 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
20:09:11.620 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
20:09:11.620 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:11.620 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:11.620 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:11.620 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
20:09:11.777 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:11.778 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:11.778 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:11.778 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:11.778 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:11.779 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
20:09:11.779 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:09:11.783 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:11.783 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:11.783 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:11.783 [grpc-default-executor-2] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:11.783 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:11.783 [grpc-default-executor-5] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:11.783 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:11.783 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:11.784 [grpc-default-executor-5] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:11.784 [grpc-default-executor-2] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:11.784 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
20:09:11.784 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
20:09:11.785 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:11.785 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:11.785 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:11.785 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:11.833 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=redirect-test
20:09:11.833 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-1
20:09:11.833 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:11.835 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=redirect-test
20:09:11.836 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:11.836 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(redirect-test, value)
20:09:11.836 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:11.836 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:11.836 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:11.836 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:11.837 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:11.837 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:11.837 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:11.837 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:11.837 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:11.837 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:11.838 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
20:09:11.838 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:09:11.838 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
20:09:11.838 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:09:11.838 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:11.838 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:09:11.838 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:11.838 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:11.838 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(redirect-test, value)
20:09:11.839 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=redirect-test
20:09:11.840 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Auto-redirect test passed
20:09:11.840 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:11.840 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:11.841 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:11.841 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:09:11.841 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:11.841 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:11.841 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:11.841 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:11.841 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:09:11.841 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:11.841 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:11.841 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:11.841 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:11.841 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:09:11.841 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:11.950 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
20:09:11.950 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:11.950 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
20:09:11.951 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
20:09:11.951 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:11.951 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:11.951 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:11.951 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
20:09:11.951 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
20:09:11.951 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:11.952 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
20:09:11.952 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
20:09:11.952 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:11.952 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:11.952 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:11.952 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
20:09:11.952 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
20:09:11.952 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:11.953 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
20:09:11.953 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
20:09:11.953 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:11.953 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:11.953 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:11.953 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
20:09:12.118 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:12.119 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:12.120 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:09:12.120 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:12.120 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:12.120 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
20:09:12.120 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:09:12.125 [grpc-default-executor-6] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:12.125 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:12.125 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:12.125 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:12.125 [grpc-default-executor-6] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:12.125 [grpc-default-executor-4] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:12.126 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:09:12.126 [grpc-default-executor-4] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:12.126 [grpc-default-executor-6] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:09:12.126 [grpc-default-executor-6] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:12.126 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=true
20:09:12.126 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:12.126 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:12.126 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:12.126 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=true
20:09:12.126 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:12.163 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=before
20:09:12.164 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.164 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.166 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=before
20:09:12.167 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.167 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.169 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=before
20:09:12.169 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:12.169 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, leader-change)
20:09:12.169 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:12.170 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:12.170 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.170 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.170 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:12.170 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:12.171 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
20:09:12.171 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
20:09:12.171 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:09:12.171 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:09:12.171 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:12.171 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:12.171 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, leader-change)
20:09:12.172 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=before
20:09:12.173 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:12.173 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:12.173 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:12.174 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:09:12.174 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:12.411 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:12.415 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:09:12.415 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:09:12.415 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:12.416 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
20:09:12.416 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
20:09:12.426 [grpc-default-executor-6] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:09:12.426 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:12.426 [grpc-default-executor-6] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:12.427 [grpc-default-executor-6] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:09:12.427 [grpc-default-executor-6] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:09:12.428 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: Vote request to node-3 failed
20:09:12.429 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=2) -> granted=true
20:09:12.429 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:12.429 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:09:12.429 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:09:12.429 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:12.487 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Request to localhost:18003 failed: UNAVAILABLE: io exception
20:09:12.488 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=after
20:09:12.488 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
20:09:12.488 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.489 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=after
20:09:12.489 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
20:09:12.489 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after, leader-change)
20:09:12.489 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:12.489 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:09:12.490 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.490 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:12.491 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:12.491 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:09:12.491 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
20:09:12.491 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, leader-change)
20:09:12.491 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after, leader-change)
20:09:12.492 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=after
20:09:12.493 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=before
20:09:12.494 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Leader change retry test passed
20:09:12.494 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:12.494 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:12.494 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:12.495 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:09:12.495 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:12.495 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:12.495 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:12.495 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:12.495 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:09:12.495 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:12.602 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
20:09:12.602 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:12.602 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
20:09:12.602 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
20:09:12.602 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:12.602 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:12.602 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:12.602 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
20:09:12.603 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
20:09:12.603 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:12.603 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
20:09:12.603 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
20:09:12.603 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:12.603 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:12.603 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:12.603 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
20:09:12.603 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
20:09:12.603 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:12.604 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
20:09:12.604 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
20:09:12.604 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:12.604 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:12.604 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:12.604 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
20:09:12.764 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:12.765 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:12.765 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:09:12.765 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:12.765 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:12.765 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:09:12.765 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
20:09:12.770 [grpc-default-executor-6] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:12.770 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:12.770 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:12.770 [grpc-default-executor-6] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:12.770 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:12.770 [grpc-default-executor-0] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:12.771 [grpc-default-executor-6] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:09:12.771 [grpc-default-executor-6] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:12.771 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:09:12.771 [grpc-default-executor-0] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:12.771 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=true
20:09:12.771 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:12.771 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:12.771 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=true
20:09:12.771 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:12.772 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:12.823 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-1
20:09:12.823 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-0
20:09:12.823 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-6
20:09:12.823 [grpc-default-executor-17] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-8
20:09:12.823 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-2
20:09:12.823 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-3
20:09:12.823 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-4
20:09:12.823 [grpc-default-executor-13] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-5
20:09:12.823 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-7
20:09:12.823 [grpc-default-executor-10] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-9
20:09:12.824 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.824 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.824 [pool-4-thread-10] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.824 [pool-4-thread-10] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.824 [pool-4-thread-6] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.824 [pool-4-thread-6] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.824 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.824 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.824 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.824 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.825 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.825 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.825 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.825 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.825 [pool-4-thread-9] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.825 [pool-4-thread-9] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.825 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.825 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.825 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.825 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.826 [grpc-default-executor-13] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-5
20:09:12.826 [grpc-default-executor-10] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-6
20:09:12.826 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-2
20:09:12.827 [pool-4-thread-6] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.827 [pool-4-thread-6] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.827 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.827 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.827 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.827 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.828 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-6
20:09:12.829 [grpc-default-executor-13] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-9
20:09:12.829 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-8
20:09:12.829 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-4
20:09:12.829 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-5
20:09:12.829 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-1
20:09:12.829 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-3
20:09:12.829 [grpc-default-executor-8] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-0
20:09:12.829 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.829 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-2
20:09:12.829 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.829 [grpc-default-executor-7] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-7
20:09:12.829 [grpc-default-executor-13] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:12.829 [grpc-default-executor-13] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-9, value-9)
20:09:12.830 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:12.830 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:12.830 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:12.830 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-8, value-8)
20:09:12.830 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.830 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.830 [grpc-default-executor-8] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-10
20:09:12.830 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.830 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.830 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:09:12.830 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-10, value-10)
20:09:12.830 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.830 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.830 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=1)
20:09:12.830 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.830 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.830 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.830 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.830 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=1)
20:09:12.830 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=1)
20:09:12.830 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:09:12.831 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-4, value-4)
20:09:12.831 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=1)
20:09:12.831 [grpc-default-executor-9] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-7
20:09:12.831 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-3
20:09:12.831 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=1)
20:09:12.831 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:09:12.831 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-5, value-5)
20:09:12.831 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.831 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:12.831 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-11
20:09:12.832 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:09:12.832 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.832 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.831 [grpc-default-executor-16] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.831 [grpc-default-executor-9] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-0
20:09:12.832 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-1 (nextIndex=1)
20:09:12.832 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.832 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.831 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=1)
20:09:12.832 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-2 (nextIndex=1)
20:09:12.832 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:09:12.832 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
20:09:12.832 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-11, value-11)
20:09:12.832 [grpc-default-executor-16] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:09:12.832 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
20:09:12.832 [grpc-default-executor-17] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-1
20:09:12.833 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-1 (nextIndex=1)
20:09:12.833 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-2 (nextIndex=1)
20:09:12.833 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.833 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.833 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 4
20:09:12.833 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.833 [grpc-default-executor-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:09:12.833 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
20:09:12.833 [grpc-default-executor-14] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.833 [grpc-default-executor-14] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 4
20:09:12.833 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
20:09:12.833 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:09:12.833 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:12.834 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=3) -> success=true
20:09:12.834 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:09:12.834 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 3
20:09:12.834 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.834 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.834 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-12
20:09:12.834 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:09:12.834 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=3) -> success=true
20:09:12.834 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
20:09:12.834 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-12, value-12)
20:09:12.834 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-9, value-9)
20:09:12.834 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:09:12.834 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=4)
20:09:12.834 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-8, value-8)
20:09:12.835 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-10, value-10)
20:09:12.834 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 6 entries, last index now 6
20:09:12.835 [grpc-default-executor-14] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-14
20:09:12.835 [grpc-default-executor-17] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 6 entries, last index now 6
20:09:12.835 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-2 (nextIndex=2)
20:09:12.835 [grpc-default-executor-16] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-13
20:09:12.835 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-15
20:09:12.835 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:09:12.835 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-15, value-15)
20:09:12.835 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.835 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:09:12.835 [grpc-default-executor-13] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.835 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:09:12.835 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=4) -> success=true
20:09:12.835 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=5)
20:09:12.835 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
20:09:12.835 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=3) -> success=true
20:09:12.836 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-4, value-4)
20:09:12.836 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.836 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 6 entries, last index now 6
20:09:12.836 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.836 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.836 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 6 entries, last index now 6
20:09:12.836 [grpc-default-executor-13] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 6
20:09:12.836 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=6) -> success=true
20:09:12.836 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=6) -> success=true
20:09:12.836 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:09:12.836 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 6
20:09:12.836 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=5)
20:09:12.836 [grpc-default-executor-10] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.836 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.837 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-5, value-5)
20:09:12.837 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-11, value-11)
20:09:12.837 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 7
20:09:12.837 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:12.837 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-16
20:09:12.837 [grpc-default-executor-16] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-17
20:09:12.837 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.837 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:09:12.837 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 6 entries, last index now 7
20:09:12.837 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:12.837 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.837 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=6) -> success=true
20:09:12.837 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=5) -> success=true
20:09:12.837 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
20:09:12.837 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
20:09:12.837 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=6) -> success=true
20:09:12.837 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-16, value-16)
20:09:12.837 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
20:09:12.837 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.837 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 8
20:09:12.838 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=7)
20:09:12.838 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-14
20:09:12.838 [grpc-default-executor-14] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-18
20:09:12.838 [grpc-default-executor-16] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:09:12.838 [grpc-default-executor-16] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-17, value-17)
20:09:12.838 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-9, value-9)
20:09:12.838 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-8, value-8)
20:09:12.838 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-10, value-10)
20:09:12.838 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-9, value-9)
20:09:12.838 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-8, value-8)
20:09:12.838 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-10, value-10)
20:09:12.838 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=7)
20:09:12.838 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=7)
20:09:12.839 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.838 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=7)
20:09:12.839 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.839 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
20:09:12.839 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 8
20:09:12.839 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.839 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.839 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.839 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 8
20:09:12.839 [grpc-default-executor-12] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-19
20:09:12.839 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-12, value-12)
20:09:12.839 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:09:12.839 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=6) -> success=true
20:09:12.840 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
20:09:12.839 [pool-4-thread-9] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.840 [pool-4-thread-9] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.840 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-4, value-4)
20:09:12.840 [grpc-default-executor-13] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-20
20:09:12.840 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-15, value-15)
20:09:12.840 [grpc-default-executor-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:09:12.840 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.840 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.840 [grpc-default-executor-9] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-21
20:09:12.841 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 10
20:09:12.841 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:09:12.840 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:09:12.841 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 10
20:09:12.841 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:09:12.841 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=4) -> success=true
20:09:12.841 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
20:09:12.841 [pool-4-thread-6] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.841 [pool-4-thread-6] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.841 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-5, value-5)
20:09:12.841 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 10
20:09:12.840 [grpc-default-executor-12] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-13
20:09:12.841 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-11, value-11)
20:09:12.840 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 10
20:09:12.841 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.841 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.841 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-4, value-4)
20:09:12.842 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-5, value-5)
20:09:12.841 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-14
20:09:12.842 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-11, value-11)
20:09:12.841 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-18
20:09:12.842 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=4) -> success=true
20:09:12.842 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:09:12.842 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
20:09:12.842 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 10
20:09:12.842 [grpc-default-executor-9] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-19
20:09:12.842 [grpc-default-executor-12] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-22
20:09:12.842 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.842 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-16, value-16)
20:09:12.842 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.842 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-14, value-14)
20:09:12.843 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.843 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
20:09:12.843 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=3) -> success=true
20:09:12.843 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=4) -> success=true
20:09:12.842 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-17, value-17)
20:09:12.843 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=11)
20:09:12.843 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=11)
20:09:12.843 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-20
20:09:12.843 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.843 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.843 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:09:12.843 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-20, value-20)
20:09:12.843 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.843 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.843 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=11)
20:09:12.843 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
20:09:12.844 [pool-4-thread-9] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.844 [pool-4-thread-9] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.845 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-21
20:09:12.845 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-23
20:09:12.845 [grpc-default-executor-9] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-13
20:09:12.845 [grpc-default-executor-9] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-19
20:09:12.846 [grpc-default-executor-17] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.846 [grpc-default-executor-17] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
20:09:12.846 [grpc-default-executor-17] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:09:12.846 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.846 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.846 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.846 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
20:09:12.846 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:09:12.846 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.846 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.846 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-22
20:09:12.846 [grpc-default-executor-12] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.846 [grpc-default-executor-12] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
20:09:12.846 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:09:12.846 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-19, value-19)
20:09:12.846 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.846 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.846 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-12, value-12)
20:09:12.846 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-15, value-15)
20:09:12.847 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-18
20:09:12.846 [grpc-default-executor-16] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.847 [grpc-default-executor-16] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
20:09:12.847 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=11)
20:09:12.847 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=11)
20:09:12.847 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-16, value-16)
20:09:12.847 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-17, value-17)
20:09:12.847 [grpc-default-executor-12] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-25
20:09:12.847 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-24
20:09:12.848 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-12, value-12)
20:09:12.848 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-15, value-15)
20:09:12.848 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-16, value-16)
20:09:12.848 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-17, value-17)
20:09:12.848 [pool-4-thread-9] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.848 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
20:09:12.848 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-21
20:09:12.848 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
20:09:12.848 [pool-4-thread-9] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.848 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:09:12.848 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
20:09:12.848 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 12
20:09:12.848 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-21, value-21)
20:09:12.848 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-26
20:09:12.848 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.848 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.849 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-14, value-14)
20:09:12.849 [pool-4-thread-10] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.849 [pool-4-thread-10] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.849 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=11)
20:09:12.849 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-20, value-20)
20:09:12.849 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=13)
20:09:12.849 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.849 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 13
20:09:12.849 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-23
20:09:12.849 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-27
20:09:12.849 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.849 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.849 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:09:12.849 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-27, value-27)
20:09:12.850 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=11)
20:09:12.850 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=13)
20:09:12.850 [grpc-default-executor-17] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-24
20:09:12.850 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-25
20:09:12.850 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=3) -> success=true
20:09:12.850 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.850 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.850 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=13
20:09:12.850 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
20:09:12.850 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.850 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.850 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-19, value-19)
20:09:12.850 [grpc-default-executor-6] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.850 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 13
20:09:12.850 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
20:09:12.850 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.851 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=11
20:09:12.851 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
20:09:12.851 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=12
20:09:12.851 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-26
20:09:12.851 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 14
20:09:12.851 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
20:09:12.851 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
20:09:12.851 [pool-4-thread-10] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.851 [pool-4-thread-10] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.851 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-28
20:09:12.851 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.851 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-26, value-26)
20:09:12.851 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.851 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.851 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-29
20:09:12.851 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-14, value-14)
20:09:12.851 [grpc-default-executor-13] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.851 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=3) -> success=true
20:09:12.851 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-20, value-20)
20:09:12.851 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=13
20:09:12.851 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
20:09:12.851 [grpc-default-executor-13] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 14
20:09:12.851 [grpc-default-executor-13] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
20:09:12.851 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-22
20:09:12.851 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-14, value-14)
20:09:12.851 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-23
20:09:12.851 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-20, value-20)
20:09:12.851 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
20:09:12.852 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.852 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-29, value-29)
20:09:12.852 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 15
20:09:12.852 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=13)
20:09:12.852 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
20:09:12.852 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=14
20:09:12.852 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=14)
20:09:12.852 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
20:09:12.852 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=14)
20:09:12.852 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-21, value-21)
20:09:12.852 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
20:09:12.852 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
20:09:12.852 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-28, value-28)
20:09:12.852 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=3) -> success=true
20:09:12.852 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=15
20:09:12.852 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
20:09:12.852 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=15)
20:09:12.852 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-24
20:09:12.852 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-27, value-27)
20:09:12.852 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=5) -> success=true
20:09:12.852 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=15
20:09:12.852 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.852 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.852 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.852 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.853 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-25
20:09:12.852 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=14)
20:09:12.853 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.853 [grpc-default-executor-13] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-30
20:09:12.852 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
20:09:12.853 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:09:12.853 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 17
20:09:12.853 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:09:12.853 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:09:12.853 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 17
20:09:12.853 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:09:12.853 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 17
20:09:12.853 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-24, value-24)
20:09:12.853 [grpc-default-executor-13] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 17
20:09:12.853 [grpc-default-executor-13] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
20:09:12.853 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-19, value-19)
20:09:12.853 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-21, value-21)
20:09:12.853 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-19, value-19)
20:09:12.854 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.854 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.854 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.854 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.853 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=16)
20:09:12.854 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=16)
20:09:12.854 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=16)
20:09:12.854 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-31
20:09:12.854 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=4) -> success=true
20:09:12.854 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=17
20:09:12.854 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 17
20:09:12.854 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=3) -> success=true
20:09:12.854 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.854 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=17
20:09:12.854 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-26, value-26)
20:09:12.855 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=5) -> success=true
20:09:12.855 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-29, value-29)
20:09:12.855 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-33
20:09:12.855 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
20:09:12.855 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-33, value-33)
20:09:12.855 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-32
20:09:12.855 [grpc-default-executor-13] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-30
20:09:12.855 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.855 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.855 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=18)
20:09:12.855 [grpc-default-executor-12] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-34
20:09:12.855 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 21 term 1
20:09:12.855 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 21: PUT(concurrent-32, value-32)
20:09:12.855 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.855 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 18
20:09:12.855 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:09:12.855 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=18)
20:09:12.855 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=18)
20:09:12.855 [grpc-default-executor-17] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.855 [grpc-default-executor-17] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 19
20:09:12.855 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=18)
20:09:12.856 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:09:12.856 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 19
20:09:12.856 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:09:12.855 [grpc-default-executor-13] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-35
20:09:12.856 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-21, value-21)
20:09:12.856 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-27, value-27)
20:09:12.856 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.856 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.856 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 19
20:09:12.856 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-27, value-27)
20:09:12.856 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.856 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.857 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=5) -> success=true
20:09:12.857 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=18
20:09:12.857 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
20:09:12.857 [pool-4-thread-9] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.857 [pool-4-thread-9] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.857 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=4) -> success=true
20:09:12.857 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-28, value-28)
20:09:12.857 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=19
20:09:12.857 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
20:09:12.857 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-24, value-24)
20:09:12.857 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=4) -> success=true
20:09:12.857 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-31
20:09:12.857 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-36
20:09:12.857 [grpc-default-executor-13] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-37
20:09:12.857 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 22 term 1
20:09:12.857 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 22: PUT(concurrent-31, value-31)
20:09:12.858 [grpc-default-executor-17] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:09:12.858 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 21
20:09:12.858 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
20:09:12.858 [grpc-default-executor-12] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 21
20:09:12.858 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-30
20:09:12.858 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=19)
20:09:12.858 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=20)
20:09:12.858 [grpc-default-executor-6] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.858 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
20:09:12.858 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
20:09:12.858 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-26, value-26)
20:09:12.858 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-29, value-29)
20:09:12.858 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.858 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=19
20:09:12.858 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-34
20:09:12.859 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 23 term 1
20:09:12.859 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 23: PUT(concurrent-36, value-36)
20:09:12.859 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.859 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 21
20:09:12.859 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=20)
20:09:12.859 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-26, value-26)
20:09:12.859 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-29, value-29)
20:09:12.860 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.860 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.859 [grpc-default-executor-13] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 24 term 1
20:09:12.860 [grpc-default-executor-13] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 24: PUT(concurrent-37, value-37)
20:09:12.860 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=3) -> success=true
20:09:12.860 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.860 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.860 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.860 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=21
20:09:12.860 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 21
20:09:12.860 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=20)
20:09:12.861 [grpc-default-executor-11] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-35
20:09:12.861 [grpc-default-executor-11] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 25 term 1
20:09:12.865 [grpc-default-executor-11] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 25: PUT(concurrent-35, value-35)
20:09:12.861 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-33, value-33)
20:09:12.866 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 21: PUT(concurrent-32, value-32)
20:09:12.860 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=22)
20:09:12.866 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=4) -> success=true
20:09:12.866 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-2 (nextIndex=20)
20:09:12.866 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=22)
20:09:12.866 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=22)
20:09:12.866 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=21
20:09:12.867 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=4) -> success=true
20:09:12.867 [grpc-default-executor-14] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:09:12.867 [grpc-default-executor-14] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 23
20:09:12.867 [grpc-default-executor-14] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
20:09:12.867 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-38
20:09:12.868 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 26 term 1
20:09:12.868 [grpc-default-executor-18] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-34
20:09:12.868 [grpc-default-executor-16] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 23
20:09:12.868 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-39
20:09:12.868 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-40
20:09:12.868 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-28, value-28)
20:09:12.868 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 26: PUT(concurrent-38, value-38)
20:09:12.868 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.869 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 22
20:09:12.869 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
20:09:12.868 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-24, value-24)
20:09:12.869 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=22)
20:09:12.869 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=22)
20:09:12.869 [grpc-default-executor-10] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.869 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 24
20:09:12.869 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 21
20:09:12.869 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.869 [pool-4-thread-7] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.869 [grpc-default-executor-15] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:09:12.870 [grpc-default-executor-15] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 24
20:09:12.870 [grpc-default-executor-15] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 21
20:09:12.870 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-33, value-33)
20:09:12.870 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 21: PUT(concurrent-32, value-32)
20:09:12.870 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.870 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.870 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.870 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.870 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.870 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.870 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=23
20:09:12.870 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 21 to 23
20:09:12.870 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.870 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 6 entries, last index now 25
20:09:12.870 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=3) -> success=true
20:09:12.870 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 22: PUT(concurrent-31, value-31)
20:09:12.871 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=22
20:09:12.871 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 23: PUT(concurrent-36, value-36)
20:09:12.871 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=3) -> success=true
20:09:12.871 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=24
20:09:12.871 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 23 to 24
20:09:12.870 [grpc-default-executor-15] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.871 [grpc-default-executor-15] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 25
20:09:12.871 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 24: PUT(concurrent-37, value-37)
20:09:12.871 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.871 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 26
20:09:12.871 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 25
20:09:12.871 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-28, value-28)
20:09:12.871 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-24, value-24)
20:09:12.871 [grpc-default-executor-15] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-41
20:09:12.871 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-33, value-33)
20:09:12.871 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 21: PUT(concurrent-32, value-32)
20:09:12.871 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-42
20:09:12.872 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-40
20:09:12.872 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=6) -> success=true
20:09:12.872 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=5) -> success=true
20:09:12.872 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=25
20:09:12.872 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 24 to 25
20:09:12.872 [grpc-default-executor-14] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-43
20:09:12.872 [grpc-default-executor-8] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.872 [grpc-default-executor-8] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 26
20:09:12.872 [grpc-default-executor-14] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 27 term 1
20:09:12.872 [grpc-default-executor-14] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 27: PUT(concurrent-43, value-43)
20:09:12.872 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.872 [pool-4-thread-2] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.872 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.872 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.872 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 25: PUT(concurrent-35, value-35)
20:09:12.872 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-39
20:09:12.872 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.873 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=25
20:09:12.872 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=5) -> success=true
20:09:12.873 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=26
20:09:12.873 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 25 to 26
20:09:12.872 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=4) -> success=true
20:09:12.873 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=27)
20:09:12.873 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=26)
20:09:12.873 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=5) -> success=true
20:09:12.873 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=26
20:09:12.873 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=27)
20:09:12.873 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=27)
20:09:12.873 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 26: PUT(concurrent-38, value-38)
20:09:12.873 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.873 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.874 [grpc-default-executor-8] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-42
20:09:12.874 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.874 [pool-4-thread-5] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.874 [grpc-default-executor-13] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-45
20:09:12.874 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-46
20:09:12.874 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-44
20:09:12.874 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-41
20:09:12.874 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 28 term 1
20:09:12.874 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 28: PUT(concurrent-41, value-41)
20:09:12.874 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=27)
20:09:12.874 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=27)
20:09:12.875 [grpc-default-executor-15] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-40
20:09:12.875 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.875 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 27
20:09:12.875 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 26
20:09:12.875 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.875 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.875 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.875 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.875 [pool-4-thread-6] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.875 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 22: PUT(concurrent-31, value-31)
20:09:12.875 [pool-4-thread-6] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.875 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 23: PUT(concurrent-36, value-36)
20:09:12.875 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.875 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.876 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.876 [grpc-default-executor-15] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 27
20:09:12.876 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.876 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.876 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-47
20:09:12.875 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 24: PUT(concurrent-37, value-37)
20:09:12.876 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 25: PUT(concurrent-35, value-35)
20:09:12.876 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 26: PUT(concurrent-38, value-38)
20:09:12.876 [grpc-default-executor-13] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-39
20:09:12.876 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 27
20:09:12.876 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 26
20:09:12.876 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 27
20:09:12.876 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
20:09:12.876 [grpc-default-executor-13] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 29 term 1
20:09:12.876 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=27
20:09:12.876 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 26 to 27
20:09:12.876 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-42
20:09:12.876 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 22: PUT(concurrent-31, value-31)
20:09:12.876 [grpc-default-executor-17] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-48
20:09:12.877 [grpc-default-executor-11] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.877 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 23: PUT(concurrent-36, value-36)
20:09:12.877 [grpc-default-executor-11] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 28
20:09:12.877 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-49
20:09:12.877 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 27: PUT(concurrent-43, value-43)
20:09:12.877 [grpc-default-executor-15] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.877 [grpc-default-executor-15] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 28
20:09:12.876 [grpc-default-executor-13] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 29: PUT(concurrent-39, value-39)
20:09:12.877 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 24: PUT(concurrent-37, value-37)
20:09:12.877 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 25: PUT(concurrent-35, value-35)
20:09:12.877 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 26: PUT(concurrent-38, value-38)
20:09:12.877 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=28)
20:09:12.877 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=27)
20:09:12.877 [pool-4-thread-9] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.877 [pool-4-thread-9] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.877 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
20:09:12.877 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
20:09:12.877 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=28
20:09:12.877 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.878 [pool-4-thread-3] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.878 [grpc-default-executor-17] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 30 term 1
20:09:12.878 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.878 [grpc-default-executor-17] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 30: PUT(concurrent-48, value-48)
20:09:12.878 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.878 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 27 to 28
20:09:12.878 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
20:09:12.878 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
20:09:12.878 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=27
20:09:12.878 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=28
20:09:12.878 [grpc-default-executor-18] [] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-46
20:09:12.878 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=2) -> success=true
20:09:12.878 [grpc-default-executor-18] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 31 term 1
20:09:12.878 [grpc-default-executor-18] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 31: PUT(concurrent-46, value-46)
20:09:12.878 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-47
20:09:12.878 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 32 term 1
20:09:12.878 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 32: PUT(concurrent-47, value-47)
20:09:12.879 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 28: PUT(concurrent-41, value-41)
20:09:12.878 [grpc-default-executor-16] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-45
20:09:12.879 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=29)
20:09:12.879 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=29)
20:09:12.879 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=29)
20:09:12.878 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-44
20:09:12.880 [grpc-default-executor-16] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.880 [grpc-default-executor-16] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 29
20:09:12.880 [grpc-default-executor-16] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 27
20:09:12.879 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=29)
20:09:12.880 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-49
20:09:12.880 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=29)
20:09:12.880 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 27: PUT(concurrent-43, value-43)
20:09:12.879 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=29)
20:09:12.881 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.881 [pool-4-thread-8] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.880 [grpc-default-executor-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.881 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 29
20:09:12.881 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 27
20:09:12.881 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.882 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.882 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=2) -> success=true
20:09:12.882 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=29
20:09:12.882 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 28 to 29
20:09:12.882 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.882 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:09:12.882 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 3 log entries
20:09:12.882 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 32
20:09:12.882 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 28
20:09:12.882 [grpc-default-executor-14] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 32
20:09:12.882 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 3 log entries
20:09:12.882 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 29: PUT(concurrent-39, value-39)
20:09:12.882 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 27: PUT(concurrent-43, value-43)
20:09:12.882 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 28: PUT(concurrent-41, value-41)
20:09:12.882 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 32
20:09:12.882 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 28
20:09:12.883 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 32
20:09:12.883 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-45
20:09:12.883 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 33 term 1
20:09:12.883 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 33: PUT(concurrent-45, value-45)
20:09:12.883 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=3) -> success=true
20:09:12.883 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=29
20:09:12.883 [grpc-default-executor-16] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 32
20:09:12.883 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=4) -> success=true
20:09:12.883 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=32
20:09:12.883 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 29 to 32
20:09:12.883 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 28: PUT(concurrent-41, value-41)
20:09:12.883 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=4) -> success=true
20:09:12.883 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.883 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=32
20:09:12.883 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=30)
20:09:12.883 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 32
20:09:12.883 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 30: PUT(concurrent-48, value-48)
20:09:12.883 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=4) -> success=true
20:09:12.883 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=33)
20:09:12.884 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-44
20:09:12.883 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 31: PUT(concurrent-46, value-46)
20:09:12.884 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-49
20:09:12.884 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 32: PUT(concurrent-47, value-47)
20:09:12.884 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.884 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.884 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.884 [pool-4-thread-1] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:09:12.885 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:09:12.885 [pool-4-thread-4] [] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:09:12.885 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.885 [grpc-default-executor-17] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:12.885 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 33
20:09:12.885 [grpc-default-executor-17] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 33
20:09:12.885 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 32
20:09:12.885 [grpc-default-executor-17] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 32
20:09:12.885 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 29: PUT(concurrent-39, value-39)
20:09:12.885 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 30: PUT(concurrent-48, value-48)
20:09:12.885 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 29: PUT(concurrent-39, value-39)
20:09:12.885 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 31: PUT(concurrent-46, value-46)
20:09:12.885 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 30: PUT(concurrent-48, value-48)
20:09:12.885 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 32: PUT(concurrent-47, value-47)
20:09:12.885 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 31: PUT(concurrent-46, value-46)
20:09:12.885 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 32: PUT(concurrent-47, value-47)
20:09:12.885 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=4) -> success=true
20:09:12.885 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
20:09:12.886 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=33
20:09:12.886 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 32 to 33
20:09:12.886 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=33
20:09:12.886 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 33: PUT(concurrent-45, value-45)
20:09:12.893 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:12.894 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:12.894 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:12.894 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:09:12.894 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:12.894 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:12.894 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:12.894 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:12.895 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:09:12.895 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:12.895 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:12.895 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:12.895 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:12.895 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:09:12.895 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:13.005 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
20:09:13.005 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:13.005 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
20:09:13.005 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
20:09:13.005 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:13.005 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:13.005 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:13.005 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
20:09:13.064 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:13.064 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:09:13.064 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:09:13.145 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:13.145 [election-node-2] [node-2] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: target/kv-client-test-data/node-2/meta.dat.tmp
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:213)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:244)
	at java.base/java.nio.file.spi.FileSystemProvider.newOutputStream(FileSystemProvider.java:426)
	at java.base/java.nio.file.Files.newOutputStream(Files.java:215)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:89)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:172)
	at com.raftdb.core.RaftState.persist(RaftState.java:52)
	at com.raftdb.core.RaftState.incrementTerm(RaftState.java:86)
	at com.raftdb.election.ElectionManager.startElection(ElectionManager.java:147)
	at com.raftdb.election.ElectionManager.onElectionTimeout(ElectionManager.java:139)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:545)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:309)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
20:09:13.197 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:13.198 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:13.198 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:13.198 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:13.198 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:09:13.198 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:13.199 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:13.199 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:13.219 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=single
20:09:13.219 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:13.219 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(single, node)
20:09:13.219 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:13.219 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(single, node)
20:09:13.221 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=single
20:09:13.221 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Single node client test passed
20:09:13.222 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:13.222 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:13.222 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:13.222 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:09:13.222 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:13.331 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:13.331 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:13.331 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:13.331 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:13.331 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:13.331 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:13.331 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:13.331 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:13.331 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:13.332 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:13.332 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:13.332 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:13.332 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:13.332 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:13.332 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:13.557 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:13.558 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:13.558 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:13.559 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:09:13.559 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:13.559 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:09:13.559 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:13.559 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:13.559 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:13.559 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:13.559 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:13.559 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:09:13.559 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:09:13.559 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:13.559 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:13.559 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:13.559 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:13.649 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:13.649 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key3, value3)
20:09:13.649 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:13.650 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:13.650 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:09:13.650 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:09:13.650 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:13.650 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:09:13.650 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:13.650 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:13.650 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:13.650 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:09:13.650 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:13.650 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(key3)
20:09:13.650 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:13.650 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:13.650 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:09:13.651 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:09:13.651 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:13.651 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:13.651 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:13.651 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:13.651 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:09:13.651 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:13.651 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:09:13.651 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:09:13.651 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:09:13.651 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:09:13.662 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:13.662 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:13.662 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:09:13.662 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:09:13.762 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:13.762 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:13.763 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:13.763 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:13.763 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:13.763 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:13.763 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:13.763 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:13.763 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:13.763 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:13.763 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:13.763 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:13.763 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:13.763 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:13.763 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:13.765 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:13.765 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:13.765 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:13.765 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:13.766 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:13.766 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:13.766 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:13.766 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:13.766 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:13.766 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:13.766 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:13.766 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:13.766 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:13.766 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:13.766 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:13.921 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:13.922 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:13.922 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:13.922 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:09:13.922 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:13.922 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:13.922 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:09:13.922 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:13.922 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:13.922 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:09:13.922 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:13.922 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:13.923 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:13.923 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:13.923 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:13.923 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:13.923 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:09:13.976 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:13.976 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-0, value-0)
20:09:13.977 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:13.977 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:13.978 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:13.978 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-1, value-1)
20:09:13.978 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:09:13.978 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-2, value-2)
20:09:13.978 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:09:13.978 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-3, value-3)
20:09:13.978 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:09:13.978 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-4, value-4)
20:09:13.978 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:09:13.978 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-5, value-5)
20:09:13.978 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:09:13.978 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-6, value-6)
20:09:13.978 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:09:13.978 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-7, value-7)
20:09:13.978 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:09:13.978 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-8, value-8)
20:09:13.979 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:09:13.979 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:09:13.979 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 10 entries to node-2 (nextIndex=1)
20:09:13.979 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:09:13.979 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:13.979 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-9, value-9)
20:09:13.979 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=10)
20:09:13.979 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 10 entries to node-2 (nextIndex=1)
20:09:13.979 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 10 entries to node-3 (nextIndex=1)
20:09:13.979 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:13.979 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 10 entries, last index now 10
20:09:13.979 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:13.979 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:09:13.979 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 10 entries to node-3 (nextIndex=1)
20:09:13.979 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=10)
20:09:13.979 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:09:13.979 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 10
20:09:13.979 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
20:09:13.979 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 9 entries to node-2 (nextIndex=2)
20:09:13.979 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 10
20:09:13.979 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 10 entries, last index now 10
20:09:13.979 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=10)
20:09:13.980 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 10 entries to node-3 (nextIndex=2)
20:09:13.979 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
20:09:13.980 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=10)
20:09:13.979 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=11)
20:09:13.980 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 10 entries, last index now 11
20:09:13.979 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 9 entries to node-2 (nextIndex=2)
20:09:13.980 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:09:13.980 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=9)
20:09:13.980 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=9)
20:09:13.980 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:09:13.980 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:09:13.980 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
20:09:13.980 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 9 entries, last index now 10
20:09:13.979 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=10)
20:09:13.980 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 10 entries, last index now 10
20:09:13.980 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 10 entries, last index now 11
20:09:13.980 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:09:13.980 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:09:13.980 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
20:09:13.980 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
20:09:13.980 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 9 entries, last index now 10
20:09:13.980 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:09:13.980 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
20:09:13.980 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:09:13.980 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 11 entries to node-3 (nextIndex=2)
20:09:13.980 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 11 entries to node-3 (nextIndex=2)
20:09:13.980 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:09:13.980 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=12)
20:09:13.980 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:09:13.980 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:09:13.980 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:09:13.980 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
20:09:13.980 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=11)
20:09:13.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:09:13.981 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:09:13.981 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 11 entries, last index now 12
20:09:13.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:09:13.981 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
20:09:13.981 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
20:09:13.981 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
20:09:13.981 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
20:09:13.981 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
20:09:13.981 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:09:13.981 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
20:09:13.981 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:09:13.981 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:09:13.981 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 12
20:09:13.981 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:09:13.981 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
20:09:13.981 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=12)
20:09:13.981 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-13, value-13)
20:09:13.981 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=13)
20:09:13.981 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:09:13.981 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:09:13.981 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=11)
20:09:13.981 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:09:13.981 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:09:13.981 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 12
20:09:13.981 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=11)
20:09:13.981 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:09:13.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
20:09:13.981 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 14
20:09:13.981 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:09:13.980 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=11)
20:09:13.981 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:09:13.982 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:09:13.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:09:13.982 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 12
20:09:13.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:09:13.981 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:09:13.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
20:09:13.981 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
20:09:13.982 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=13)
20:09:13.982 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:09:13.982 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=14
20:09:13.982 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 14
20:09:13.982 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 14
20:09:13.982 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 11 entries, last index now 12
20:09:13.982 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=13)
20:09:13.982 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-14, value-14)
20:09:13.982 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:09:13.982 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
20:09:13.982 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:09:13.982 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 12
20:09:13.982 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 14
20:09:13.982 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 14
20:09:13.982 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:09:13.982 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:09:13.982 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:09:13.982 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:09:13.982 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:09:13.982 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=15)
20:09:13.982 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=13)
20:09:13.982 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=13)
20:09:13.982 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
20:09:13.982 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
20:09:13.982 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:09:13.982 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=15)
20:09:13.982 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=15)
20:09:13.982 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
20:09:13.982 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
20:09:13.982 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
20:09:13.982 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
20:09:13.982 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 15
20:09:13.982 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-16, value-16)
20:09:13.982 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:09:13.982 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=15)
20:09:13.982 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:09:13.982 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:09:13.982 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:09:13.982 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
20:09:13.982 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=4)
20:09:13.982 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:09:13.982 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
20:09:13.983 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:09:13.983 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 16
20:09:13.983 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
20:09:13.982 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
20:09:13.982 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:09:13.983 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:09:13.982 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
20:09:13.983 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 16
20:09:13.982 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
20:09:13.983 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=16
20:09:13.982 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 16
20:09:13.983 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
20:09:13.983 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-17, value-17)
20:09:13.983 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
20:09:13.983 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=16)
20:09:13.983 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:09:13.983 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=2)
20:09:13.983 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
20:09:13.983 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:09:13.983 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
20:09:13.983 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:09:13.983 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:09:13.983 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 18
20:09:13.983 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:09:13.983 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
20:09:13.983 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:09:13.983 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
20:09:13.983 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=15)
20:09:13.983 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
20:09:13.983 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:09:13.983 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=5)
20:09:13.983 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=18
20:09:13.983 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 16
20:09:13.983 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:09:13.983 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=15)
20:09:13.983 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:09:13.983 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 18
20:09:13.983 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:09:13.983 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-18, value-18)
20:09:13.983 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:09:13.983 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 18
20:09:13.983 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
20:09:13.983 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=17)
20:09:13.983 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:09:13.983 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 19
20:09:13.983 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=17)
20:09:13.984 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
20:09:13.983 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=19)
20:09:13.984 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=19
20:09:13.984 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=3)
20:09:13.984 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
20:09:13.984 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=17)
20:09:13.983 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:09:13.984 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=19)
20:09:13.984 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:09:13.984 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=20)
20:09:13.983 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=5)
20:09:13.984 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 19
20:09:13.984 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=4)
20:09:13.984 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 19
20:09:13.984 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:09:13.983 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:09:13.983 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-19, value-19)
20:09:13.984 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:09:13.984 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:09:13.984 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=3)
20:09:13.984 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:09:13.984 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:09:13.984 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=19)
20:09:13.984 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:09:13.984 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:09:13.984 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
20:09:13.984 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
20:09:13.984 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 20
20:09:13.984 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
20:09:13.984 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:09:13.984 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
20:09:13.984 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
20:09:13.984 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=19)
20:09:13.984 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
20:09:13.984 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:09:13.984 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
20:09:13.984 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=20)
20:09:13.984 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:09:13.984 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
20:09:13.984 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=2)
20:09:13.984 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
20:09:13.984 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
20:09:13.984 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
20:09:13.984 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
20:09:13.984 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:09:13.984 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
20:09:13.985 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:09:13.984 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:09:13.985 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:09:13.984 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
20:09:13.985 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:09:13.984 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:09:13.984 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:09:13.985 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:09:13.985 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:09:13.985 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:09:13.985 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:09:13.985 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:09:13.985 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:09:13.985 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:09:13.985 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:09:14.028 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:09:14.028 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:09:14.028 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:09:14.028 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:09:14.096 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:14.097 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:14.097 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:14.097 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:14.097 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:14.097 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:14.097 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:14.097 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:14.097 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:14.097 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:14.097 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:14.097 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:14.097 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:14.097 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:14.097 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:14.100 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:14.100 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:14.100 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:14.100 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:14.100 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:14.100 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:14.100 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:14.100 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:14.100 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:14.100 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:14.101 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:14.101 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:14.101 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:14.101 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:14.101 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:14.265 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:14.269 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:14.269 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:14.269 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:09:14.269 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:14.269 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:14.269 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:14.269 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:09:14.269 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:14.269 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:14.269 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:14.270 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:14.270 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:09:14.270 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:14.270 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:14.270 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:14.270 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:09:14.309 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:14.309 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key2, value2)
20:09:14.310 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:14.310 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:14.310 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:09:14.310 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:09:14.310 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:14.310 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:09:14.310 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:14.310 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:14.310 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:09:14.310 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:09:14.322 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:14.322 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:14.323 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:09:14.323 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:09:14.413 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:14.413 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:14.413 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:14.413 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:14.414 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:14.414 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:14.414 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:14.414 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:14.414 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:14.414 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:14.414 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:14.414 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:14.414 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:14.414 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:14.414 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:14.417 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:14.417 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:14.417 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:14.417 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:14.417 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:14.417 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:14.417 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:14.417 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:14.417 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:14.417 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:14.417 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:14.417 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:14.417 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:14.417 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:14.417 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:14.661 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:14.661 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:14.662 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:14.663 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:09:14.663 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:14.663 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:14.663 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:14.663 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:09:14.663 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:14.663 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:14.663 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:14.663 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:14.664 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:09:14.665 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:14.665 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:14.665 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:14.665 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:09:14.735 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:14.735 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
20:09:14.736 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:14.736 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:14.736 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:09:14.736 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:09:14.736 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:14.736 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:09:14.736 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:14.736 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:14.736 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:09:14.737 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:09:14.769 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:14.769 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:14.769 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:09:14.769 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:09:14.841 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Killing leader: node-3
20:09:14.841 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:14.841 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:14.841 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:14.841 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:14.841 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:14.848 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:14.848 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:09:14.848 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:14.848 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=2)
20:09:14.848 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:14.848 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:14.848 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:09:14.848 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:09:14.848 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:14.848 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:09:14.848 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:09:14.848 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:14.848 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
20:09:14.947 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - New leader: node-2
20:09:14.947 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
20:09:14.947 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
20:09:14.947 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:09:14.947 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:14.947 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=2, entries=1)
20:09:14.948 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:14.948 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:09:14.948 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:14.948 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:09:14.949 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:14.949 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:14.949 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:09:15.000 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:15.053 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:15.053 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:15.053 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:15.054 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:15.054 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:15.054 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:15.054 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:15.054 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:15.054 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:15.054 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:15.054 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:15.055 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:15.055 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:15.055 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:15.055 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:15.055 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:15.055 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:15.055 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:15.055 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:15.055 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:15.055 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:15.055 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:15.055 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:15.055 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:15.055 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:15.055 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:15.232 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:15.232 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:15.232 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:15.232 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:09:15.232 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:15.232 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:09:15.232 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:15.232 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:15.232 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:15.232 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:09:15.232 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:09:15.232 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:09:15.232 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:09:15.232 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:15.233 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:15.233 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:15.233 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:15.263 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:15.263 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
20:09:15.263 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:15.263 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:15.263 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:15.263 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:15.263 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:15.263 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:15.263 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:09:15.263 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:15.263 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:15.263 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:15.264 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:09:15.264 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:15.264 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
20:09:15.264 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:09:15.264 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:15.264 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:15.264 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:15.264 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:15.264 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:15.264 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:09:15.264 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:15.264 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:15.264 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:15.264 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:09:15.264 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:09:15.264 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:09:15.264 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
20:09:15.264 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:09:15.264 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:09:15.264 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:09:15.264 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:09:15.264 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:15.264 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:15.264 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:09:15.264 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:15.264 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:09:15.264 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:09:15.264 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:15.264 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:09:15.264 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:09:15.264 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:09:15.264 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:09:15.264 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:09:15.265 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:09:15.265 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
20:09:15.265 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:09:15.265 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
20:09:15.265 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:15.265 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:15.265 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:09:15.265 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:09:15.265 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:15.265 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:15.265 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:09:15.265 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:09:15.265 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:09:15.265 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:09:15.265 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:09:15.265 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:09:15.265 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:09:15.265 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
20:09:15.265 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:09:15.265 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
20:09:15.265 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:15.265 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:15.265 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:09:15.265 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:09:15.265 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:09:15.265 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:09:15.265 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:09:15.265 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:09:15.265 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:09:15.265 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:09:15.265 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:09:15.265 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:09:15.265 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:09:15.265 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
20:09:15.265 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:09:15.266 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
20:09:15.266 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:15.266 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:15.266 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:09:15.266 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:09:15.266 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:09:15.266 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:09:15.266 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:09:15.266 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:09:15.266 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:09:15.266 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:09:15.266 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:09:15.266 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
20:09:15.266 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
20:09:15.266 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
20:09:15.266 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:09:15.266 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
20:09:15.266 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:15.266 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:15.266 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:09:15.266 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:09:15.266 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:09:15.266 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:09:15.266 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
20:09:15.266 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:09:15.266 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
20:09:15.266 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:09:15.266 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:09:15.266 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:09:15.266 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:09:15.266 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
20:09:15.266 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
20:09:15.267 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
20:09:15.267 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:15.267 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:15.267 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:09:15.267 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:09:15.267 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:09:15.267 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
20:09:15.267 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:09:15.267 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:09:15.267 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:09:15.267 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
20:09:15.267 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:09:15.267 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:09:15.267 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:09:15.267 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
20:09:15.267 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
20:09:15.267 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
20:09:15.267 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:15.267 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:15.267 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:09:15.267 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:09:15.267 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:09:15.267 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
20:09:15.267 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:09:15.267 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:09:15.267 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:09:15.267 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:09:15.267 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:09:15.267 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
20:09:15.267 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:09:15.267 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
20:09:15.267 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
20:09:15.268 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
20:09:15.268 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:15.268 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:15.268 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:09:15.268 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:09:15.268 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:09:15.268 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:09:15.268 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
20:09:15.268 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:09:15.268 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
20:09:15.268 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:09:15.268 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:09:15.268 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:09:15.287 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:09:15.287 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:09:15.287 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:09:15.287 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:09:15.376 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:15.376 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:15.376 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:15.376 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:15.376 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:15.376 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:15.376 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:15.376 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:15.376 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:15.376 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:15.376 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:15.376 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:15.376 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:15.376 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:15.376 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:15.378 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:15.378 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:15.378 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:15.378 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:15.378 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:15.378 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:15.378 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:15.378 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:15.378 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:15.378 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:15.378 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:15.378 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:15.378 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:15.378 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:15.378 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:15.585 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:15.585 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:15.585 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:15.585 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:15.585 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:15.585 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:15.585 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:09:15.585 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:09:15.585 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:15.585 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:09:15.585 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:15.585 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:09:15.585 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=false)
20:09:15.585 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:09:15.585 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:09:15.585 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=false)
20:09:15.585 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:09:15.585 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:09:15.585 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:09:15.585 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=false)
20:09:15.585 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:15.586 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:15.586 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:15.586 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:15.589 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Leader: node-2
20:09:15.589 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:15.589 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
20:09:15.589 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:15.589 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:15.589 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:15.589 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:15.589 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:15.589 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:15.589 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:09:15.589 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:15.589 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:15.589 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:15.589 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:09:15.589 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - PUT committed
20:09:15.641 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:15.641 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:15.641 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:09:15.641 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:09:15.695 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - Data replicated to all nodes
20:09:15.695 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:15.695 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:15.695 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:15.695 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:15.695 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:15.695 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:15.695 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:15.695 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:15.695 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:15.695 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:15.695 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:15.695 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:15.695 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:15.696 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:15.696 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:15.697 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:15.697 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:15.697 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:15.697 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:15.697 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:15.697 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:15.697 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:15.697 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:15.697 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:15.697 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:15.698 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:15.698 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:15.698 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:15.698 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:15.698 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:15.938 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:15.939 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:15.939 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:15.939 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:09:15.939 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:15.939 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:15.940 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:15.939 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:09:15.940 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:09:15.940 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:15.940 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:15.940 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:15.940 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:15.940 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:15.940 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:15.940 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:09:15.940 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:16.015 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:16.015 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:16.015 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:16.015 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:16.015 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:16.015 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:16.015 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:16.015 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:16.015 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:16.015 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:16.015 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:16.015 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:16.015 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:16.015 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:16.015 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:16.016 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:16.016 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:16.016 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:16.016 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:16.017 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:16.017 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:16.017 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:16.017 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:16.017 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:16.017 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:16.017 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:16.017 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:16.017 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:16.017 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:16.017 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:16.017 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:09:16.017 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
20:09:16.017 [main] [node-4] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-4
20:09:16.017 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:16.017 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 initialized as FOLLOWER
20:09:16.017 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:09:16.017 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
20:09:16.017 [main] [node-5] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-5
20:09:16.017 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:16.017 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 initialized as FOLLOWER
20:09:16.203 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:16.203 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:16.203 [election-node-4] [node-4] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:09:16.204 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 VoteRequest(term=1)
20:09:16.204 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:16.204 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 VoteRequest(term=1)
20:09:16.204 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:16.204 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:16.204 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:16.204 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
20:09:16.204 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 VoteRequest(term=1)
20:09:16.204 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
20:09:16.204 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 VoteRequest(term=1)
20:09:16.204 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-2 VoteResponse(granted=true)
20:09:16.204 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:16.204 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:09:16.205 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:16.204 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-1 VoteResponse(granted=true)
20:09:16.205 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
20:09:16.204 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:16.205 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-3 VoteResponse(granted=true)
20:09:16.205 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:16.205 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:09:16.205 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
20:09:16.205 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-5 VoteResponse(granted=true)
20:09:16.205 [] [node-4] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:16.205 [] [node-4] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:16.205 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:16.226 [main] [node-4] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:16.226 [main] [node-4] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(stable-key, initial)
20:09:16.226 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:16.226 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:16.227 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:16.227 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
20:09:16.227 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 AppendEntries(term=1, entries=1)
20:09:16.227 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:16.227 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:09:16.227 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 AppendEntries(term=1, entries=1)
20:09:16.227 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:16.227 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:09:16.227 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:16.228 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 AppendEntries(term=1, entries=1)
20:09:16.228 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:16.228 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:16.228 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 AppendEntries(term=1, entries=1)
20:09:16.228 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:16.228 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
20:09:16.229 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:09:16.259 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:16.259 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:16.259 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:16.260 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:16.260 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:09:16.261 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:09:16.261 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:09:16.261 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:09:16.336 [main] [node-4] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:16.336 [main] [node-4] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-0, value-0)
20:09:16.336 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:09:16.337 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:16.337 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:16.337 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
20:09:16.337 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 AppendEntries(term=1, entries=1)
20:09:16.337 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 AppendEntries(term=1, entries=1)
20:09:16.337 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:16.338 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:16.338 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:09:16.338 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:09:16.338 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 AppendEntries(term=1, entries=1)
20:09:16.338 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:16.338 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:16.338 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:09:16.338 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:16.338 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 AppendEntries(term=1, entries=1)
20:09:16.338 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:16.338 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
20:09:16.338 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:09:16.339 [main] [node-4] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:09:16.339 [main] [node-4] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-1, value-1)
20:09:16.339 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:09:16.339 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:09:16.339 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:09:16.339 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=3)
20:09:16.339 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 AppendEntries(term=1, entries=1)
20:09:16.339 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:09:16.339 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:16.339 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:09:16.339 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 AppendEntries(term=1, entries=1)
20:09:16.339 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:09:16.340 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:16.340 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:09:16.340 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:09:16.340 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 AppendEntries(term=1, entries=1)
20:09:16.340 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:09:16.340 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:16.340 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:09:16.340 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 AppendEntries(term=1, entries=1)
20:09:16.340 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:09:16.340 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:16.340 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=3
20:09:16.340 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:09:16.340 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:09:16.340 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:09:16.340 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:09:16.340 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:09:16.341 [main] [node-4] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:09:16.341 [main] [node-4] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-2, value-2)
20:09:16.341 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:09:16.341 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
20:09:16.341 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 AppendEntries(term=1, entries=1)
20:09:16.341 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
20:09:16.341 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 AppendEntries(term=1, entries=1)
20:09:16.341 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=4)
20:09:16.341 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:09:16.341 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 AppendEntries(term=1, entries=1)
20:09:16.341 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 AppendEntries(term=1, entries=1)
20:09:16.341 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:16.341 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:09:16.341 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:09:16.342 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:09:16.342 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:09:16.342 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:16.342 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:16.342 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:09:16.342 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=4
20:09:16.342 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:09:16.342 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:16.342 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:09:16.342 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
20:09:16.342 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:09:16.342 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:09:16.342 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:09:16.342 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:09:16.342 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:09:16.342 [main] [node-4] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:09:16.342 [main] [node-4] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-3, value-3)
20:09:16.342 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:09:16.342 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
20:09:16.342 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 AppendEntries(term=1, entries=1)
20:09:16.342 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
20:09:16.342 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 AppendEntries(term=1, entries=1)
20:09:16.342 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:09:16.343 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 AppendEntries(term=1, entries=1)
20:09:16.343 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:09:16.343 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:09:16.343 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:09:16.343 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:09:16.343 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
20:09:16.343 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=5)
20:09:16.343 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:09:16.343 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:09:16.343 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:09:16.343 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:09:16.343 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 AppendEntries(term=1, entries=1)
20:09:16.343 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:09:16.343 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:09:16.343 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:09:16.343 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:09:16.343 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:09:16.343 [main] [node-4] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:09:16.343 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:09:16.343 [main] [node-4] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-4, value-4)
20:09:16.343 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=5
20:09:16.343 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:09:16.343 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:09:16.343 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
20:09:16.343 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 AppendEntries(term=1, entries=1)
20:09:16.344 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
20:09:16.344 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:09:16.344 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 AppendEntries(term=1, entries=1)
20:09:16.344 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:09:16.344 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 AppendEntries(term=1, entries=1)
20:09:16.344 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:09:16.344 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:09:16.344 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:09:16.344 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:09:16.344 [replication-node-4] [node-4] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=6)
20:09:16.344 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:09:16.344 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:09:16.344 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
20:09:16.344 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
20:09:16.344 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:09:16.344 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:09:16.344 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:09:16.344 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 AppendEntries(term=1, entries=1)
20:09:16.344 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:09:16.344 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:09:16.344 [] [node-4] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:09:16.344 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:09:16.344 [] [node-4] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=6
20:09:16.344 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:09:16.359 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:09:16.359 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:09:16.359 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:09:16.359 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:09:16.359 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:09:16.359 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:09:16.359 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:09:16.359 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:09:16.447 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:16.447 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:16.447 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:16.447 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:16.447 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:16.447 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:16.447 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:16.447 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:16.447 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:16.447 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:16.447 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:16.447 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:16.447 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:16.447 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:16.447 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:16.447 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:09:16.447 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:16.447 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:16.447 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
20:09:16.447 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:09:16.447 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:09:16.447 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:16.448 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:16.448 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
20:09:16.449 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:09:16.455 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:16.455 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:16.455 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:16.455 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:16.455 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:16.455 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:16.455 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:16.455 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:16.755 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:16.758 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:16.758 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:16.758 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:16.759 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:09:16.759 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:16.759 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:16.759 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:16.873 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:16.873 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test, data)
20:09:16.874 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:16.874 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test, data)
20:09:16.875 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Data files created at target/test-data/node-1
20:09:16.875 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:16.875 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:16.876 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:16.876 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:16.876 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:16.880 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:16.880 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:16.880 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:16.880 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:16.880 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:16.880 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:16.880 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:16.880 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:16.880 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:16.880 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:16.880 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:16.881 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:09:16.881 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
20:09:16.881 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:16.881 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:16.881 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:16.881 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:16.881 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:16.881 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:16.881 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:09:16.881 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
20:09:16.881 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:16.881 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:16.881 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:17.052 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:17.054 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:17.055 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:17.055 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:17.055 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:17.055 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:09:17.055 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:09:17.056 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:17.056 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:17.056 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:17.056 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:17.056 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:17.056 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:17.057 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:17.057 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:17.057 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:09:17.057 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:17.057 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:17.057 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:17.057 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:17.057 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:17.057 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:17.057 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:09:17.086 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Leader: node-1
20:09:17.087 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:17.087 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
20:09:17.087 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:17.087 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:17.088 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:09:17.088 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:09:17.088 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:17.088 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:17.088 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:09:17.088 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:17.088 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:17.088 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:17.089 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:17.089 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:09:17.089 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:17.089 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key2, value2)
20:09:17.089 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:17.089 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:17.089 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:09:17.089 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:09:17.089 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:17.089 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:17.089 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:17.089 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:09:17.089 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:17.089 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:09:17.089 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:17.089 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:09:17.089 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:17.089 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:17.089 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:09:17.089 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key3, value3)
20:09:17.089 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:09:17.089 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:09:17.089 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:09:17.090 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:09:17.090 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:09:17.090 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:09:17.090 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:17.090 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:09:17.090 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:17.090 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:09:17.090 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:09:17.090 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:09:17.090 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:17.090 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:09:17.090 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:09:17.090 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:17.090 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:09:17.090 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:09:17.112 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:17.112 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:17.112 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:09:17.112 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:09:17.196 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Stopping all nodes...
20:09:17.196 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:17.197 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:17.197 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:17.197 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:17.197 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:17.197 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:17.197 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:17.197 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:17.197 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:17.197 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:17.197 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:17.197 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:17.197 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:17.197 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:17.197 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:17.197 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting all nodes...
20:09:17.198 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:17.198 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:17.198 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:17.198 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:09:17.198 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:17.198 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:17.199 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:09:17.199 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:09:17.199 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
20:09:17.199 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:09:17.199 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
20:09:17.199 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:17.200 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:17.200 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:17.200 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:17.200 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:17.200 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:09:17.200 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:09:17.200 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
20:09:17.201 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:09:17.201 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:09:17.201 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
20:09:17.201 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:09:17.201 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
20:09:17.201 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:17.201 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:17.201 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:17.201 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:17.201 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:17.201 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:09:17.201 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:09:17.201 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
20:09:17.201 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:09:17.201 [main] [node-3] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:09:17.201 [main] [node-3] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
20:09:17.201 [main] [node-3] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:09:17.202 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=3
20:09:17.202 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:17.202 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:17.431 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:17.432 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:09:17.433 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:09:17.433 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:17.433 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=2)
20:09:17.433 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=2)
20:09:17.433 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:09:17.433 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:17.433 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:17.434 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:09:17.434 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:17.434 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:17.434 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:09:17.434 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:09:17.434 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:09:17.434 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:17.434 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:09:17.434 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:09:17.434 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:17.434 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:09:17.434 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:09:17.434 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:09:17.515 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - New leader after restart: node-3
20:09:17.517 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - All nodes recovered successfully
20:09:17.517 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:17.517 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:17.517 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:17.517 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:17.517 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:17.517 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:17.517 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:17.517 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:17.517 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:17.517 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:17.517 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:17.517 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:17.517 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:17.517 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:17.517 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:17.519 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:17.519 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:17.519 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:17.519 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:17.519 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:17.519 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:17.519 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:17.520 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:17.520 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:17.520 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:17.520 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:17.520 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:09:17.520 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
20:09:17.520 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:17.520 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:17.520 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:17.520 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:17.520 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:17.520 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:17.520 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:09:17.520 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
20:09:17.520 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:17.520 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:17.520 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:17.676 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:17.677 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:17.677 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:09:17.678 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:17.678 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:17.678 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:09:17.678 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:09:17.678 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:17.678 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:17.678 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:17.678 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:17.678 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:17.678 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:17.679 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:09:17.679 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:17.679 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:09:17.679 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:17.679 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:17.679 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:17.679 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:09:17.679 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:17.679 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:09:17.679 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:17.731 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:17.731 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, restart)
20:09:17.731 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:17.731 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:17.731 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:09:17.731 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:09:17.731 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:17.731 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:17.731 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:17.731 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:17.731 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:09:17.731 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:09:17.731 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:17.731 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:17.732 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:09:17.781 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:17.781 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:17.781 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:09:17.781 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:09:17.838 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting follower: node-1
20:09:17.838 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:17.838 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:17.838 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:17.838 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:17.838 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:17.944 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:17.944 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during, downtime)
20:09:17.945 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:09:17.945 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:17.945 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:09:17.945 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:17.945 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:17.945 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:09:17.945 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:17.945 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
20:09:17.945 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:17.945 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:17.945 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:17.945 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
20:09:17.946 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:17.946 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:17.946 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
20:09:17.946 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
20:09:17.946 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 1 to recover state machine
20:09:17.946 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
20:09:17.946 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=1
20:09:17.946 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:17.946 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:17.982 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:09:17.982 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:09:17.982 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:17.982 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
20:09:17.982 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:17.982 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:17.982 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:17.983 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:09:17.983 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
20:09:18.051 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Follower node-1 caught up after restart
20:09:18.051 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:18.051 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:18.051 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:18.052 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:18.052 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:18.052 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:18.052 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:18.052 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:18.052 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:18.052 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:18.052 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:18.052 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:18.052 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:18.052 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:18.052 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:18.054 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:18.054 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:18.054 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:18.054 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:18.054 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:18.054 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:18.054 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:18.054 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:18.323 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:18.327 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:18.327 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:18.327 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:18.327 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:09:18.327 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:18.327 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:18.327 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:18.371 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:18.371 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:18.371 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:18.371 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:18.371 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:18.371 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:18.371 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:18.371 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:18.372 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:09:18.372 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:18.372 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:18.372 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=0
20:09:18.372 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:18.372 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:18.372 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Term persisted: 1 -> 1
20:09:18.372 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:18.372 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:18.372 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:18.373 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:18.373 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:18.377 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:18.377 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:18.377 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:18.378 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:18.378 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:18.378 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:18.378 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:18.378 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:18.549 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:18.550 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:18.551 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:18.552 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:18.552 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:09:18.552 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:18.552 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:18.552 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:18.582 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:18.582 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
20:09:18.582 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:18.583 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
20:09:18.583 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:18.583 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
20:09:18.583 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:18.583 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
20:09:18.583 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:09:18.583 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
20:09:18.583 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:09:18.584 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
20:09:18.584 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:09:18.584 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
20:09:18.584 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:09:18.584 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
20:09:18.584 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:09:18.584 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
20:09:18.584 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:09:18.584 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
20:09:18.584 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:09:18.584 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
20:09:18.584 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:09:18.584 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
20:09:18.585 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:09:18.585 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
20:09:18.585 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:09:18.585 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
20:09:18.585 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:09:18.585 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
20:09:18.585 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:09:18.585 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
20:09:18.585 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:09:18.585 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
20:09:18.585 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:09:18.585 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
20:09:18.585 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:09:18.585 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
20:09:18.585 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:09:18.585 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
20:09:18.586 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 10, term 1
20:09:18.586 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
20:09:18.587 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=10, lastTerm=1, size=184 bytes
20:09:18.587 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 10, 0 entries remaining
20:09:18.587 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
20:09:18.587 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 0 log entries remaining
20:09:18.588 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Snapshot test passed
20:09:18.588 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:18.588 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:18.588 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:18.588 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:18.588 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:18.591 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:18.591 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:18.591 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:18.592 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:18.592 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:18.592 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:18.592 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:18.592 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:18.825 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:18.827 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:18.828 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:18.828 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:18.828 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:09:18.828 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:18.828 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:18.828 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:18.906 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:18.906 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
20:09:18.906 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:18.906 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
20:09:18.907 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:18.907 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
20:09:18.907 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:18.907 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
20:09:18.907 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:09:18.907 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
20:09:18.907 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:09:18.907 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
20:09:18.907 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:09:18.907 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
20:09:18.907 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:09:18.907 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
20:09:18.907 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:09:18.907 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
20:09:18.907 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:09:18.907 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
20:09:18.907 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:09:18.907 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
20:09:18.907 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:09:18.907 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
20:09:18.907 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:09:18.907 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
20:09:18.908 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:09:18.908 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
20:09:18.908 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:09:18.908 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
20:09:18.908 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:09:18.908 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
20:09:18.908 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:09:18.908 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
20:09:18.908 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:09:18.908 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
20:09:18.908 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:09:18.908 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
20:09:18.908 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:09:18.908 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
20:09:18.908 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 10, term 1
20:09:18.908 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
20:09:18.908 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=10, lastTerm=1, size=184 bytes
20:09:18.909 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 10, 0 entries remaining
20:09:18.909 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
20:09:18.909 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 0 log entries remaining
20:09:18.909 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:09:18.909 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
20:09:18.909 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
20:09:18.909 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
20:09:18.909 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:09:18.909 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
20:09:18.909 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
20:09:18.909 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
20:09:18.909 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:09:18.909 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
20:09:18.909 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
20:09:18.909 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
20:09:18.909 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:09:18.909 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
20:09:18.909 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
20:09:18.909 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
20:09:18.910 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:09:18.910 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
20:09:18.910 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
20:09:18.910 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
20:09:18.910 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:18.910 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:18.910 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:18.910 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:18.910 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:18.910 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:18.910 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:18.910 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:18.910 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:09:18.910 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:18.910 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=10, lastTerm=1
20:09:18.910 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:18.910 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 184 bytes
20:09:18.910 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 10 entries
20:09:18.910 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=10, term=1
20:09:18.910 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=10, term=1
20:09:18.910 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 5 log entries from disk
20:09:18.910 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 5 log entries, lastIndex=15
20:09:18.910 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 11 to 15 to recover state machine
20:09:18.910 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=15
20:09:18.910 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=15
20:09:18.910 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:18.910 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:19.084 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:19.086 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:09:19.087 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:09:19.087 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:09:19.087 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:09:19.087 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:09:19.087 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:09:19.087 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:19.121 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Recovery from snapshot test passed
20:09:19.122 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:19.122 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:19.122 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:19.122 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:19.122 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:19.125 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:19.125 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:19.125 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:19.126 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:19.126 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:19.126 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:19.126 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:19.127 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:19.127 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:19.127 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:19.127 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:19.127 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:09:19.127 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
20:09:19.127 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:19.127 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:19.127 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:19.127 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:19.127 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:19.127 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:19.127 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:09:19.127 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
20:09:19.127 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:19.127 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:19.127 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:19.284 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:19.285 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:19.285 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:09:19.285 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:19.285 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:19.285 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:09:19.285 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:09:19.285 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:19.285 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:19.285 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:19.285 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:19.285 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:19.285 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:19.286 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:09:19.286 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:09:19.286 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:09:19.286 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:19.286 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:19.286 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:19.286 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:19.286 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:09:19.286 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:09:19.286 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:09:19.338 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:19.338 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
20:09:19.339 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:19.339 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:19.339 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:19.339 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.339 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:19.339 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.339 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:19.339 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:19.339 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:09:19.339 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:19.339 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:19.339 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.339 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.339 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:19.339 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:19.339 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:19.339 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:19.339 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
20:09:19.339 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:19.339 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
20:09:19.339 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:09:19.339 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:19.339 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:19.339 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.340 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.340 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:19.340 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.340 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:19.340 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:19.340 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:19.340 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:09:19.340 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:19.340 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:09:19.340 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
20:09:19.340 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
20:09:19.340 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
20:09:19.340 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:09:19.340 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
20:09:19.340 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:09:19.340 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:19.340 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:09:19.340 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.340 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.340 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:09:19.340 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:19.340 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:09:19.340 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:09:19.340 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
20:09:19.340 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
20:09:19.340 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.340 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:09:19.340 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:19.340 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:09:19.340 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
20:09:19.340 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:09:19.340 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
20:09:19.340 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:09:19.340 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
20:09:19.340 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:19.340 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.340 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.340 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:09:19.340 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.340 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:19.340 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:09:19.340 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:19.340 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:09:19.340 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:09:19.340 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
20:09:19.340 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:09:19.340 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
20:09:19.340 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
20:09:19.341 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:09:19.341 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
20:09:19.341 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:09:19.341 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
20:09:19.341 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:19.341 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.341 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.341 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:09:19.341 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:09:19.341 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:09:19.341 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:09:19.341 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
20:09:19.341 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
20:09:19.341 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.341 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:09:19.341 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:09:19.341 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:09:19.341 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
20:09:19.341 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:09:19.341 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
20:09:19.341 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:09:19.341 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
20:09:19.341 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:19.341 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.341 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.341 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:09:19.341 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.341 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:09:19.341 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:09:19.341 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:09:19.341 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:09:19.341 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
20:09:19.341 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
20:09:19.341 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:09:19.341 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:09:19.341 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
20:09:19.341 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
20:09:19.341 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:09:19.341 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
20:09:19.341 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
20:09:19.341 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:19.341 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
20:09:19.341 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.341 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.341 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:09:19.341 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:09:19.341 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
20:09:19.341 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
20:09:19.342 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:09:19.342 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.342 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
20:09:19.342 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:09:19.342 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:09:19.342 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
20:09:19.342 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
20:09:19.342 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:09:19.342 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
20:09:19.342 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
20:09:19.342 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
20:09:19.342 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:19.342 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.342 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.342 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:09:19.342 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:09:19.342 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.342 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
20:09:19.342 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:09:19.342 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:09:19.342 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:09:19.342 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
20:09:19.342 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
20:09:19.342 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
20:09:19.342 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
20:09:19.342 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:09:19.342 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
20:09:19.342 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
20:09:19.342 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:19.342 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
20:09:19.342 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.342 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.342 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:09:19.342 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:09:19.342 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
20:09:19.342 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:09:19.342 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
20:09:19.342 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.342 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:09:19.342 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:09:19.342 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
20:09:19.342 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
20:09:19.342 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:09:19.342 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
20:09:19.342 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
20:09:19.342 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
20:09:19.342 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:19.343 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
20:09:19.343 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.343 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.343 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:09:19.343 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:09:19.343 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.343 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
20:09:19.343 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:09:19.343 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:09:19.343 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:09:19.343 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
20:09:19.343 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
20:09:19.343 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
20:09:19.343 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
20:09:19.390 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:09:19.390 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:09:19.391 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
20:09:19.391 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
20:09:19.444 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:19.444 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:19.444 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:19.444 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:19.444 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:19.546 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:09:19.546 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
20:09:19.546 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=11)
20:09:19.546 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
20:09:19.546 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.546 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.546 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
20:09:19.546 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
20:09:19.546 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
20:09:19.546 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
20:09:19.546 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:09:19.546 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
20:09:19.546 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=11)
20:09:19.547 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=12)
20:09:19.547 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.547 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.547 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
20:09:19.547 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
20:09:19.547 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
20:09:19.547 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
20:09:19.547 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
20:09:19.547 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
20:09:19.547 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:09:19.547 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
20:09:19.547 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=11)
20:09:19.547 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=13)
20:09:19.547 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.547 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.547 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
20:09:19.547 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
20:09:19.547 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
20:09:19.547 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
20:09:19.547 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
20:09:19.547 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
20:09:19.547 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:09:19.547 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
20:09:19.547 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=11)
20:09:19.547 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=14)
20:09:19.548 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.548 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.548 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
20:09:19.548 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:09:19.548 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
20:09:19.548 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
20:09:19.548 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
20:09:19.548 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
20:09:19.548 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:09:19.548 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
20:09:19.548 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=11)
20:09:19.548 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=15)
20:09:19.548 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.548 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.548 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
20:09:19.548 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
20:09:19.548 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
20:09:19.548 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
20:09:19.548 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
20:09:19.548 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
20:09:19.548 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
20:09:19.548 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(key15, value15)
20:09:19.548 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-1 (nextIndex=11)
20:09:19.548 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
20:09:19.548 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.548 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.548 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
20:09:19.548 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:09:19.549 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
20:09:19.549 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
20:09:19.549 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
20:09:19.549 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
20:09:19.549 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
20:09:19.549 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(key16, value16)
20:09:19.549 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 7 entries to node-1 (nextIndex=11)
20:09:19.549 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
20:09:19.549 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.549 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.549 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
20:09:19.549 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
20:09:19.549 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
20:09:19.549 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
20:09:19.549 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
20:09:19.549 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
20:09:19.549 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
20:09:19.549 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(key17, value17)
20:09:19.549 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 8 entries to node-1 (nextIndex=11)
20:09:19.549 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=18)
20:09:19.549 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.549 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.549 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
20:09:19.549 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
20:09:19.549 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=18
20:09:19.549 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
20:09:19.549 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
20:09:19.549 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
20:09:19.549 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
20:09:19.549 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(key18, value18)
20:09:19.549 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 9 entries to node-1 (nextIndex=11)
20:09:19.549 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=19)
20:09:19.549 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.549 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.549 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
20:09:19.549 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
20:09:19.549 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
20:09:19.549 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
20:09:19.549 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
20:09:19.549 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
20:09:19.549 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
20:09:19.549 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(key19, value19)
20:09:19.549 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 10 entries to node-1 (nextIndex=11)
20:09:19.549 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
20:09:19.549 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:09:19.550 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.550 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:09:19.550 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
20:09:19.550 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
20:09:19.550 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
20:09:19.550 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
20:09:19.550 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
20:09:19.550 [main] [node-2] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 19, term 1
20:09:19.550 [main] [node-2] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 20 entries, 384 bytes
20:09:19.550 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=19, lastTerm=1, size=384 bytes
20:09:19.550 [main] [node-2] INFO  com.raftdb.log.LogManager - Compacted log to index 19, 1 entries remaining
20:09:19.550 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Rewrote log with 1 entries
20:09:19.550 [main] [node-2] INFO  com.raftdb.core.RaftNode - Snapshot complete: 384 bytes, 1 log entries remaining
20:09:19.551 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:19.551 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:19.551 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:19.551 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:19.551 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:19.551 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:19.551 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:19.551 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:19.591 [replication-node-2] [node-2] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 384 bytes
20:09:19.592 [replication-node-2] [node-2] INFO  c.r.replication.ReplicationManager - Sending snapshot to node-1 (lastIndex=19, size=384)
20:09:19.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 InstallSnapshot(term=1, lastIndex=19, size=384)
20:09:19.593 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:09:19.593 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
20:09:19.593 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:19.593 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:19.593 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:19.593 [] [node-1] INFO  com.raftdb.core.RaftNode - Installing snapshot: lastIndex=19, lastTerm=1, size=384
20:09:19.593 [] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=19, lastTerm=1, size=384 bytes
20:09:19.593 [] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 20 entries
20:09:19.593 [] [node-1] INFO  com.raftdb.log.LogManager - Reset log to snapshot: index=19, term=1
20:09:19.593 [] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
20:09:19.593 [] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot installed successfully
20:09:19.594 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 InstallSnapshotResponse(term=1)
20:09:19.594 [] [node-2] INFO  c.r.replication.ReplicationManager - Snapshot to node-1 complete, nextIndex=20
20:09:19.641 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=20)
20:09:19.641 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:09:19.641 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:19.641 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:09:19.641 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:09:19.641 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
20:09:19.642 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
20:09:19.657 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Snapshot replication test passed
20:09:19.657 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:19.657 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:19.657 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:19.657 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:19.657 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:19.657 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:19.657 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:19.657 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:19.657 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:19.657 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:19.657 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:19.657 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:19.657 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:19.657 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:19.658 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:19.659 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:19.659 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:19.659 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:19.660 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:19.660 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:19.660 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:19.660 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:19.660 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:19.836 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:19.836 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:19.837 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:19.837 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:19.837 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:09:19.837 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:19.837 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:19.837 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:19.871 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:19.871 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(string, hello)
20:09:19.871 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:19.871 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(string, hello)
20:09:19.871 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:19.871 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(number, 12345)
20:09:19.872 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:19.872 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(number, 12345)
20:09:19.872 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:09:19.872 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(special, )
20:09:19.872 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:09:19.872 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(special, )
20:09:19.872 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:09:19.872 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(empty, )
20:09:19.872 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:09:19.872 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(empty, )
20:09:19.873 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:09:19.873 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: DELETE(empty)
20:09:19.873 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:09:19.873 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: DELETE(empty)
20:09:19.873 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 4, term 1
20:09:19.873 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 3 entries, 69 bytes
20:09:19.873 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=4, lastTerm=1, size=69 bytes
20:09:19.873 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 4, 1 entries remaining
20:09:19.873 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 1 entries
20:09:19.873 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 69 bytes, 1 log entries remaining
20:09:19.874 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:19.874 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:19.874 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:19.874 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:19.874 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:19.874 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:19.874 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:19.874 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:19.874 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:09:19.874 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:09:19.874 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=4, lastTerm=1
20:09:19.874 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:09:19.874 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 69 bytes
20:09:19.874 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 3 entries
20:09:19.874 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=4, term=1
20:09:19.874 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=4, term=1
20:09:19.874 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
20:09:19.874 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=5
20:09:19.874 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 5 to 5 to recover state machine
20:09:19.874 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=5
20:09:19.874 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=5
20:09:19.874 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:19.875 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:20.119 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:20.119 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:09:20.120 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:09:20.120 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:09:20.120 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:09:20.120 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:09:20.120 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:09:20.120 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:20.186 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - State machine snapshot test passed
20:09:20.186 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:20.186 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:20.186 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:20.186 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:20.186 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:20.191 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:20.195 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19001
20:09:20.195 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:20.196 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:09:20.196 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:09:20.196 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:20.196 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:20.196 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:20.196 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19001
20:09:20.196 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:20.197 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19002
20:09:20.197 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:20.197 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:09:20.197 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:09:20.197 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:20.197 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:20.197 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:20.197 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19002
20:09:20.197 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:20.198 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19003
20:09:20.198 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:20.198 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
20:09:20.198 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
20:09:20.198 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:20.198 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:20.198 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:20.198 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19003
20:09:20.405 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:20.406 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:20.406 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:20.406 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:20.406 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:20.406 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19003
20:09:20.406 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19002
20:09:20.411 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:20.411 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:20.411 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:20.411 [grpc-default-executor-1] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:20.411 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:20.411 [grpc-default-executor-0] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:20.411 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:20.411 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:20.411 [grpc-default-executor-0] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:20.411 [grpc-default-executor-1] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:20.412 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
20:09:20.412 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:20.412 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:20.412 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:20.412 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:20.412 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
20:09:20.515 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Leader elected: node-1
20:09:20.515 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:20.515 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:20.515 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:20.516 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:09:20.516 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:20.516 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:20.516 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:20.516 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:20.517 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:09:20.517 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:20.517 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:20.517 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:20.517 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:20.517 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:09:20.517 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:20.624 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:20.624 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19011
20:09:20.624 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:20.624 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:09:20.624 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:09:20.624 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:20.624 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:20.625 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:20.625 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19011
20:09:20.625 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:20.625 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19012
20:09:20.625 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:20.625 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:09:20.625 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:09:20.625 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:20.625 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:20.625 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:20.625 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19012
20:09:20.625 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:20.625 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19013
20:09:20.625 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:20.626 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
20:09:20.626 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
20:09:20.626 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:20.626 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:20.626 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:20.626 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19013
20:09:20.835 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:20.835 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:20.836 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:20.836 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:20.836 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:09:20.836 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:20.836 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:09:20.836 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:20.836 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:20.836 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:20.836 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19013
20:09:20.836 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19011
20:09:20.836 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19011
20:09:20.836 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19012
20:09:20.841 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:09:20.841 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:09:20.841 [grpc-default-executor-7] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:20.841 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:20.841 [grpc-default-executor-7] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:20.841 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:09:20.841 [grpc-default-executor-9] [node-1] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: target/grpc-test-data/node-1/meta.dat.tmp -> target/grpc-test-data/node-1/meta.dat
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixFileSystem.move(UnixFileSystem.java:823)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:289)
	at java.base/java.nio.file.Files.move(Files.java:1319)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:98)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:172)
	at com.raftdb.core.RaftState.persist(RaftState.java:52)
	at com.raftdb.core.RaftState.tryVoteFor(RaftState.java:105)
	at com.raftdb.election.ElectionManager.handleVoteRequest(ElectionManager.java:282)
	at com.raftdb.core.RaftNode.handleVoteRequest(RaftNode.java:525)
	at com.raftdb.rpc.GrpcTransport$RaftServiceImpl.requestVote(GrpcTransport.java:264)
	at com.raftdb.rpc.proto.RaftServiceGrpc$MethodHandlers.invoke(RaftServiceGrpc.java:370)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:351)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
20:09:20.841 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=false
20:09:20.841 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=false
20:09:20.841 [grpc-default-executor-9] [node-1] ERROR com.raftdb.rpc.GrpcTransport - Error handling VoteRequest
java.lang.RuntimeException: java.nio.file.NoSuchFileException: target/grpc-test-data/node-1/meta.dat.tmp -> target/grpc-test-data/node-1/meta.dat
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:175)
	at com.raftdb.core.RaftState.persist(RaftState.java:52)
	at com.raftdb.core.RaftState.tryVoteFor(RaftState.java:105)
	at com.raftdb.election.ElectionManager.handleVoteRequest(ElectionManager.java:282)
	at com.raftdb.core.RaftNode.handleVoteRequest(RaftNode.java:525)
	at com.raftdb.rpc.GrpcTransport$RaftServiceImpl.requestVote(GrpcTransport.java:264)
	at com.raftdb.rpc.proto.RaftServiceGrpc$MethodHandlers.invoke(RaftServiceGrpc.java:370)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:351)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.file.NoSuchFileException: target/grpc-test-data/node-1/meta.dat.tmp -> target/grpc-test-data/node-1/meta.dat
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixFileSystem.move(UnixFileSystem.java:823)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:289)
	at java.base/java.nio.file.Files.move(Files.java:1319)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:98)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:172)
	... 14 common frames omitted
20:09:20.842 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=false
20:09:20.842 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: Vote request to node-1 failed
20:09:21.069 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:21.070 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:09:21.070 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:09:21.070 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:09:21.070 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:21.072 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:09:21.072 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:09:21.072 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:21.072 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:21.072 [grpc-default-executor-9] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:21.072 [grpc-default-executor-8] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:21.072 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:09:21.072 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:09:21.072 [grpc-default-executor-8] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:09:21.072 [grpc-default-executor-9] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:09:21.073 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=2) -> granted=true
20:09:21.073 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=2) -> granted=true
20:09:21.073 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:21.073 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:09:21.073 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:09:21.073 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:21.151 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 2
20:09:21.152 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(grpc-key, grpc-value)
20:09:21.152 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:21.152 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:21.154 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:21.154 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:21.154 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:21.154 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:21.155 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:21.155 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:09:21.155 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:21.155 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:21.155 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:21.158 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
20:09:21.176 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:21.176 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:21.176 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
20:09:21.177 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
20:09:21.265 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Data replicated to all nodes
20:09:21.266 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:21.266 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:21.266 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:21.269 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:09:21.269 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:21.269 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:21.269 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:21.269 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:21.274 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:09:21.274 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:21.274 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:21.274 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:21.274 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:21.275 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:09:21.275 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:21.381 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:21.381 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19021
20:09:21.381 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:21.382 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:09:21.382 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:09:21.382 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:21.382 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:21.382 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:21.382 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19021
20:09:21.382 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:21.382 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19022
20:09:21.382 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:21.383 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:09:21.383 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:09:21.383 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:21.383 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:21.383 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:21.383 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19022
20:09:21.383 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:21.383 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19023
20:09:21.383 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:21.383 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
20:09:21.383 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
20:09:21.384 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:21.384 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:21.384 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:21.384 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19023
20:09:21.538 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:21.540 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:21.541 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:09:21.541 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:21.541 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:21.541 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19023
20:09:21.541 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19021
20:09:21.546 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:21.546 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:21.546 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:21.547 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:21.547 [grpc-default-executor-9] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:21.547 [grpc-default-executor-5] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:21.547 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:09:21.547 [grpc-default-executor-9] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:09:21.547 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:09:21.547 [grpc-default-executor-5] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:09:21.548 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
20:09:21.548 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:21.548 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:21.548 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:21.548 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:21.549 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
20:09:21.594 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Initial leader: node-2 at term 1
20:09:21.594 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:21.594 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
20:09:21.595 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:21.595 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:21.596 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:21.596 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:21.596 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:21.596 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:21.596 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:21.596 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:21.596 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:21.596 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:09:21.596 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:21.596 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:21.597 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:09:21.600 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:21.600 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:21.601 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:09:21.601 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:09:21.700 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:21.700 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:21.700 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:21.701 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:09:21.701 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:21.701 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-2
20:09:21.701 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Stopped leader: node-2
20:09:21.825 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:21.826 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:09:21.826 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:09:21.826 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:21.826 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19023
20:09:21.826 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19022
20:09:21.828 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: Vote request to node-2 failed
20:09:21.829 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:09:21.829 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:21.829 [grpc-default-executor-5] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:21.830 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:09:21.830 [grpc-default-executor-5] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
20:09:21.830 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=2) -> granted=true
20:09:21.830 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:21.830 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:09:21.830 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:09:21.830 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:21.911 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - New leader: node-1 at term 2
20:09:21.912 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
20:09:21.912 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
20:09:21.912 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:21.912 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:21.913 [grpc-default-executor-8] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:21.913 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:21.914 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:09:21.914 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:09:21.914 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:21.914 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:09:21.935 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:21.936 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:21.936 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:09:21.985 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:22.015 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:22.015 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:22.015 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:22.016 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:09:22.016 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:22.016 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:22.016 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:22.016 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:22.017 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:09:22.017 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:22.125 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:22.126 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19031
20:09:22.126 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:22.126 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:09:22.126 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:09:22.126 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:22.126 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:22.126 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:22.126 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19031
20:09:22.127 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:22.127 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19032
20:09:22.127 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:22.127 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:09:22.127 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:09:22.127 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:22.127 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:22.127 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:22.127 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19032
20:09:22.128 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:22.128 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19033
20:09:22.128 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:22.130 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
20:09:22.130 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
20:09:22.130 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:22.130 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:22.131 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:22.131 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19033
20:09:22.321 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:22.322 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:22.322 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:09:22.322 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:22.322 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:22.322 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19033
20:09:22.322 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19031
20:09:22.326 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:22.326 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:22.326 [grpc-default-executor-5] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:22.326 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:22.326 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:22.326 [grpc-default-executor-8] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:22.326 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:09:22.326 [grpc-default-executor-5] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:09:22.326 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:09:22.326 [grpc-default-executor-8] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:09:22.327 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
20:09:22.327 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:22.327 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:22.327 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:22.327 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:22.327 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
20:09:22.338 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:22.338 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
20:09:22.338 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:22.339 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:09:22.339 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.339 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.339 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:22.339 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:22.340 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.340 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.340 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:22.340 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:09:22.340 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:22.340 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:22.340 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:09:22.340 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:22.340 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
20:09:22.340 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:22.340 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:09:22.341 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.341 [grpc-default-executor-8] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.341 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:22.341 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:22.341 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:22.341 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:22.341 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:09:22.341 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:09:22.341 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.341 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:09:22.341 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:22.341 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.341 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:09:22.341 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:09:22.341 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:09:22.342 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
20:09:22.342 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:09:22.342 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:09:22.342 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.342 [grpc-default-executor-8] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.342 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:09:22.342 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:09:22.342 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:22.342 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:22.342 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:09:22.342 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:09:22.343 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.343 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.343 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:09:22.343 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:09:22.343 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:09:22.343 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:09:22.343 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:09:22.343 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:09:22.343 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
20:09:22.343 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
20:09:22.343 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:09:22.343 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.344 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.344 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:09:22.344 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:09:22.344 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:22.344 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:09:22.344 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:09:22.344 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:09:22.344 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.344 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:09:22.344 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:09:22.344 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.344 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:09:22.344 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:09:22.344 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:09:22.344 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
20:09:22.344 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
20:09:22.344 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:09:22.345 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.345 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.345 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:09:22.345 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:09:22.345 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:09:22.345 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:09:22.345 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:09:22.345 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:09:22.345 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.345 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.345 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:09:22.345 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:09:22.345 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:09:22.345 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:09:22.345 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:09:22.345 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:09:22.345 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
20:09:22.345 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
20:09:22.345 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:09:22.346 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.346 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.346 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:09:22.346 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:09:22.346 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:09:22.346 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:09:22.346 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:09:22.346 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:09:22.346 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.346 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.346 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:09:22.346 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
20:09:22.346 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:09:22.346 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:09:22.346 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:09:22.346 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:09:22.346 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
20:09:22.347 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
20:09:22.347 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
20:09:22.347 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.347 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:09:22.347 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:09:22.347 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:09:22.347 [grpc-default-executor-7] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.347 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:09:22.347 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:09:22.347 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:09:22.347 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.347 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
20:09:22.347 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:09:22.347 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.347 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:09:22.347 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
20:09:22.348 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:09:22.348 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
20:09:22.348 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
20:09:22.348 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
20:09:22.348 [grpc-default-executor-8] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.348 [grpc-default-executor-7] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.348 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:09:22.348 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:09:22.348 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:09:22.348 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:09:22.348 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:09:22.348 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:09:22.348 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.349 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.349 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
20:09:22.349 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:09:22.349 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
20:09:22.349 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:09:22.349 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:09:22.349 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
20:09:22.349 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
20:09:22.349 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
20:09:22.349 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.349 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:09:22.349 [grpc-default-executor-7] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.349 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:09:22.349 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:09:22.349 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:09:22.349 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:09:22.349 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:09:22.350 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.350 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.350 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
20:09:22.350 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
20:09:22.350 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:09:22.350 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:09:22.350 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:09:22.350 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:09:22.350 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
20:09:22.350 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
20:09:22.350 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
20:09:22.350 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.350 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:09:22.350 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:09:22.350 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.350 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:09:22.350 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:09:22.350 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:09:22.350 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:09:22.351 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.351 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
20:09:22.351 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:09:22.351 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:09:22.351 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.351 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
20:09:22.351 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:09:22.351 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key-10, value-10)
20:09:22.351 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
20:09:22.351 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=11)
20:09:22.351 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.351 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
20:09:22.351 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:09:22.351 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.351 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
20:09:22.351 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:09:22.351 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:09:22.351 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:09:22.352 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.352 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.352 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=11
20:09:22.352 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
20:09:22.352 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
20:09:22.352 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
20:09:22.352 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
20:09:22.352 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:09:22.352 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key-11, value-11)
20:09:22.352 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=12)
20:09:22.352 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=12)
20:09:22.353 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.353 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
20:09:22.353 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
20:09:22.353 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.353 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
20:09:22.353 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
20:09:22.353 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
20:09:22.353 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
20:09:22.353 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.353 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.353 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=12
20:09:22.353 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
20:09:22.353 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
20:09:22.353 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
20:09:22.353 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
20:09:22.353 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:09:22.353 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key-12, value-12)
20:09:22.353 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=13)
20:09:22.353 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=13)
20:09:22.354 [grpc-default-executor-7] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.354 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.354 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
20:09:22.354 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
20:09:22.354 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
20:09:22.354 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
20:09:22.354 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
20:09:22.354 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
20:09:22.354 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.354 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=13
20:09:22.354 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
20:09:22.354 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.354 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
20:09:22.354 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
20:09:22.354 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:09:22.354 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key-13, value-13)
20:09:22.354 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=14)
20:09:22.354 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=14)
20:09:22.355 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.355 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
20:09:22.355 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:09:22.355 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.355 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
20:09:22.355 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:09:22.355 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
20:09:22.355 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
20:09:22.355 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.355 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.355 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
20:09:22.355 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=14
20:09:22.355 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
20:09:22.355 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
20:09:22.355 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
20:09:22.355 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:09:22.355 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key-14, value-14)
20:09:22.355 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=15)
20:09:22.355 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=15)
20:09:22.356 [grpc-default-executor-7] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.356 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.356 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
20:09:22.356 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
20:09:22.356 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
20:09:22.356 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
20:09:22.356 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
20:09:22.356 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
20:09:22.356 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.356 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.356 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
20:09:22.356 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=15
20:09:22.356 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
20:09:22.356 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
20:09:22.356 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
20:09:22.357 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
20:09:22.357 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(key-15, value-15)
20:09:22.357 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
20:09:22.357 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=16)
20:09:22.357 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.357 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
20:09:22.357 [grpc-default-executor-7] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.357 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:09:22.357 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
20:09:22.357 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:09:22.357 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
20:09:22.357 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
20:09:22.357 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.357 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.357 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
20:09:22.357 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=16
20:09:22.358 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
20:09:22.358 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
20:09:22.358 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
20:09:22.358 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
20:09:22.358 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(key-16, value-16)
20:09:22.358 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
20:09:22.358 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=17)
20:09:22.358 [grpc-default-executor-8] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.358 [grpc-default-executor-7] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.358 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
20:09:22.358 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
20:09:22.358 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
20:09:22.358 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
20:09:22.358 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
20:09:22.358 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
20:09:22.359 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.359 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=17
20:09:22.359 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.359 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
20:09:22.359 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
20:09:22.359 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
20:09:22.359 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
20:09:22.359 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(key-17, value-17)
20:09:22.359 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=18)
20:09:22.359 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=18)
20:09:22.359 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.359 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.359 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
20:09:22.359 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
20:09:22.359 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
20:09:22.359 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
20:09:22.359 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
20:09:22.359 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
20:09:22.360 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.360 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.360 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=18
20:09:22.360 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=18
20:09:22.360 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
20:09:22.360 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
20:09:22.360 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
20:09:22.360 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
20:09:22.360 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(key-18, value-18)
20:09:22.360 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=19)
20:09:22.360 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=19)
20:09:22.360 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.360 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
20:09:22.360 [grpc-default-executor-7] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.360 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
20:09:22.360 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
20:09:22.360 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
20:09:22.360 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
20:09:22.360 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
20:09:22.361 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.361 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=19
20:09:22.361 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
20:09:22.361 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.361 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
20:09:22.361 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
20:09:22.361 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
20:09:22.361 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(key-19, value-19)
20:09:22.361 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
20:09:22.361 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=20)
20:09:22.362 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.362 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.362 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:09:22.362 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:09:22.362 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
20:09:22.362 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
20:09:22.362 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
20:09:22.362 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
20:09:22.362 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:09:22.362 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.362 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
20:09:22.363 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
20:09:22.363 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
20:09:22.363 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
20:09:22.363 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
20:09:22.384 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:09:22.384 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:09:22.384 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
20:09:22.384 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
20:09:22.468 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - All 20 writes replicated
20:09:22.469 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:22.469 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:22.469 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:22.469 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:09:22.470 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:22.470 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:22.470 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:22.470 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:22.470 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:09:22.470 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:22.470 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:22.470 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:22.470 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:22.470 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:09:22.470 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:22.576 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:22.578 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19041
20:09:22.578 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:22.580 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:09:22.580 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:09:22.580 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:22.580 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:22.580 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:22.580 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19041
20:09:22.580 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:22.581 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19042
20:09:22.581 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:22.581 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:09:22.582 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:09:22.582 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:22.582 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:22.582 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:22.582 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19042
20:09:22.582 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:22.582 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19043
20:09:22.582 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:22.583 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
20:09:22.583 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
20:09:22.583 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:22.583 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:22.583 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:22.583 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19043
20:09:22.758 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:22.759 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:22.759 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:22.759 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:22.759 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:22.760 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19043
20:09:22.760 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19042
20:09:22.763 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:22.763 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:22.763 [grpc-default-executor-5] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:22.763 [grpc-default-executor-8] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:22.763 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:22.763 [grpc-default-executor-8] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:22.764 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:22.764 [grpc-default-executor-5] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:22.764 [grpc-default-executor-8] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:22.764 [grpc-default-executor-8] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:22.764 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
20:09:22.764 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:22.764 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:22.764 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:22.764 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:22.764 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
20:09:22.794 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:22.794 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(restart-test, initial)
20:09:22.794 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:22.794 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:22.796 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.796 [grpc-default-executor-8] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:22.796 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:22.796 [grpc-default-executor-8] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:22.797 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
20:09:22.797 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:09:22.797 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:09:22.797 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:22.797 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:22.797 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:22.797 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
20:09:22.819 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:22.819 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:22.819 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
20:09:22.819 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
20:09:22.903 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Restarting follower: node-2 on port 19042
20:09:22.903 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:22.903 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:22.903 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:22.904 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:09:22.904 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:22.904 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-2
20:09:23.009 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:23.009 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during-downtime, value)
20:09:23.009 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:23.009 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:23.010 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:23.010 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:23.010 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:09:23.010 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:09:23.010 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:23.010 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
20:09:23.011 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:23.012 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19042
20:09:23.012 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:23.012 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:09:23.012 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:09:23.012 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:09:23.012 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
20:09:23.012 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
20:09:23.012 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 1 to recover state machine
20:09:23.012 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
20:09:23.012 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=1
20:09:23.012 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:23.012 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:23.012 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Restarted node node-2 on port 19042
20:09:23.015 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:23.016 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:23.016 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
20:09:23.066 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:23.119 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:23.169 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:23.195 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:23.196 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:09:23.196 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:09:23.196 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:23.196 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19041
20:09:23.196 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19043
20:09:23.200 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:09:23.200 [grpc-default-executor-7] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:09:23.200 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:23.200 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:23.200 [grpc-default-executor-5] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:23.200 [grpc-default-executor-7] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:23.200 [grpc-default-executor-7] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:09:23.200 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=true, logUpToDate=false
20:09:23.200 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:09:23.200 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=true, logUpToDate=false
20:09:23.201 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=2) -> granted=false
20:09:23.201 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=2) -> granted=false
20:09:23.369 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:23.369 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-2
20:09:23.369 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
20:09:23.369 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:23.369 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19041
20:09:23.369 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19042
20:09:23.373 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=null
20:09:23.373 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:23.373 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=null
20:09:23.373 [grpc-default-executor-8] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:23.373 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:23.373 [grpc-default-executor-7] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:23.373 [grpc-default-executor-8] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-3
20:09:23.373 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-3
20:09:23.373 [grpc-default-executor-8] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 3
20:09:23.373 [grpc-default-executor-7] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 3
20:09:23.374 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=3) -> granted=true
20:09:23.374 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=3) -> granted=true
20:09:23.374 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:23.374 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 3
20:09:23.374 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 3
20:09:23.374 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:23.374 [grpc-default-executor-8] [node-2] DEBUG com.raftdb.core.RaftNode - Missing entry at index 2
20:09:23.375 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 failed, nextIndex decremented to 2
20:09:23.429 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:23.430 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:23.430 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:23.430 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:23.430 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
20:09:23.430 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
20:09:23.430 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:09:23.431 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Restarted node caught up successfully
20:09:23.431 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:23.431 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:23.431 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:23.432 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:09:23.432 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:23.432 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:23.432 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:23.432 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:23.432 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:09:23.432 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:23.432 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:23.432 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:23.432 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:23.432 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:09:23.432 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:23.540 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:23.540 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19051
20:09:23.540 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:23.541 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:09:23.541 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:09:23.541 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:23.541 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:23.541 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:23.541 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19051
20:09:23.541 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:23.541 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19052
20:09:23.541 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:23.541 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:09:23.542 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:09:23.542 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:23.542 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:23.542 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:23.542 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19052
20:09:23.542 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:23.542 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19053
20:09:23.542 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:23.542 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
20:09:23.542 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
20:09:23.542 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:23.542 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:23.542 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:23.542 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19053
20:09:23.542 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:09:23.543 [main] [node-4] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19054
20:09:23.543 [main] [node-4] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-4
20:09:23.543 [main] [node-4] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-4
20:09:23.543 [main] [node-4] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-4
20:09:23.543 [main] [node-4] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:23.543 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:23.543 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 initialized as FOLLOWER
20:09:23.543 [main] [node-4] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-4 on port 19054
20:09:23.543 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:09:23.543 [main] [node-5] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19055
20:09:23.543 [main] [node-5] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-5
20:09:23.543 [main] [node-5] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-5
20:09:23.543 [main] [node-5] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-5
20:09:23.543 [main] [node-5] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:23.543 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:23.543 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 initialized as FOLLOWER
20:09:23.543 [main] [node-5] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-5 on port 19055
20:09:23.715 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:23.716 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:23.716 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:23.716 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:23.716 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:09:23.717 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-4 at localhost:19054
20:09:23.717 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19052
20:09:23.717 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-5 at localhost:19055
20:09:23.717 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19053
20:09:23.720 [grpc-default-executor-7] [node-5] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:23.721 [grpc-default-executor-7] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:23.721 [grpc-default-executor-7] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:23.721 [grpc-default-executor-8] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:23.721 [grpc-default-executor-9] [node-4] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:23.721 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:23.721 [grpc-default-executor-8] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:23.721 [grpc-default-executor-9] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:23.721 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:23.721 [grpc-default-executor-8] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:23.721 [grpc-default-executor-0] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:23.721 [grpc-default-executor-9] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:23.721 [grpc-default-executor-7] [node-5] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:23.721 [grpc-default-executor-7] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:23.721 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:23.721 [grpc-default-executor-0] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:23.721 [grpc-default-executor-8] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:23.721 [grpc-default-executor-8] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:23.721 [grpc-default-executor-9] [node-4] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:23.721 [grpc-default-executor-9] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:09:23.721 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
20:09:23.721 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
20:09:23.721 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:09:23.721 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-5 VoteRequest(term=1) -> granted=true
20:09:23.721 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:09:23.721 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-4 VoteRequest(term=1) -> granted=true
20:09:23.721 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:23.721 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:23.721 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:23.751 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:23.751 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(five-node-test, value)
20:09:23.751 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:09:23.751 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
20:09:23.751 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
20:09:23.751 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:09:23.752 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:23.752 [grpc-default-executor-0] [node-4] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:23.752 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:23.752 [grpc-default-executor-0] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:23.752 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:23.752 [grpc-default-executor-2] [node-5] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:23.752 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:23.752 [grpc-default-executor-2] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:09:23.753 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-4 AppendEntries(entries=1) -> success=true
20:09:23.753 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:09:23.753 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-5 AppendEntries(entries=1) -> success=true
20:09:23.753 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:09:23.753 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
20:09:23.753 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:23.753 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
20:09:23.753 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
20:09:23.753 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:23.753 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:09:23.753 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
20:09:23.777 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:23.777 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:23.777 [grpc-default-executor-8] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:23.777 [grpc-default-executor-7] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:09:23.778 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
20:09:23.778 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
20:09:23.778 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
20:09:23.778 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
20:09:23.858 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:23.859 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:23.859 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:23.859 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:09:23.859 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:23.859 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-2
20:09:23.859 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:23.859 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:23.859 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:23.860 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:09:23.860 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:23.860 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-3
20:09:23.860 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Stopped two followers: node-2 and node-3
20:09:23.966 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:09:23.966 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failures, still-working)
20:09:23.966 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:23.966 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
20:09:23.966 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
20:09:23.966 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:23.967 [grpc-default-executor-8] [node-4] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:23.967 [grpc-default-executor-4] [node-5] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:09:23.967 [grpc-default-executor-8] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:23.967 [grpc-default-executor-4] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:09:23.967 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-4 AppendEntries(entries=1) -> success=true
20:09:23.967 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-5 AppendEntries(entries=1) -> success=true
20:09:23.968 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
20:09:23.968 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:09:23.967 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
20:09:23.968 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
20:09:23.973 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:23.973 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:23.973 [grpc-default-executor-4] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:23.973 [grpc-default-executor-8] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:09:23.973 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
20:09:23.973 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
20:09:24.025 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:09:24.025 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:09:24.073 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Five-node cluster survived two failures
20:09:24.073 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:24.074 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:24.074 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:24.074 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:09:24.074 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:24.074 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:09:24.074 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:24.074 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:24.075 [main] [node-4] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-4
20:09:24.075 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:09:24.075 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:09:24.075 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:24.075 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:24.075 [main] [node-5] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-5
20:09:24.075 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:09:24.182 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:24.183 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19061
20:09:24.183 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:24.183 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:09:24.183 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:09:24.183 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:09:24.183 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:24.183 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:24.183 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19061
20:09:24.411 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:24.412 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:09:24.412 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:09:24.412 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:24.412 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:09:24.412 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:24.412 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:24.412 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:24.496 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:09:24.496 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(single, node)
20:09:24.496 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:09:24.496 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(single, node)
20:09:24.496 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Single node cluster works
20:09:24.497 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:24.497 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:24.497 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:24.497 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:09:24.497 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:24.604 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:24.604 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:24.604 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:24.604 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:24.604 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:24.604 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:24.604 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:24.604 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:24.604 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:24.604 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:24.604 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:24.604 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:24.604 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:24.604 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:24.605 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:24.758 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:24.758 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:24.758 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:24.758 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:09:24.758 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:24.758 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:24.758 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:24.758 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:09:24.759 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:24.759 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:24.759 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:09:24.759 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:24.759 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:24.759 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:24.759 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:24.759 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:24.759 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:09:24.809 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-3 (term 1)
20:09:25.017 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - All nodes agree on leader: node-3
20:09:25.017 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:25.017 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.017 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:25.017 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:25.017 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:25.017 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:25.017 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.017 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:25.017 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:25.017 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:25.017 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:25.017 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.017 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:25.017 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:25.017 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:25.018 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:25.018 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:25.018 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:25.018 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:25.018 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:25.018 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:25.018 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:25.018 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:25.018 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:25.018 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:25.018 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:25.018 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:25.018 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:25.018 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:25.018 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:25.018 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:09:25.018 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
20:09:25.018 [main] [node-4] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-4
20:09:25.018 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:25.019 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 initialized as FOLLOWER
20:09:25.019 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:09:25.019 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
20:09:25.019 [main] [node-5] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-5
20:09:25.019 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:25.019 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 initialized as FOLLOWER
20:09:25.176 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:25.176 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:25.176 [election-node-4] [node-4] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:25.176 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:25.176 [election-node-4] [node-4] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:09:25.176 [election-node-5] [node-5] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:09:25.176 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-4 VoteRequest(term=1)
20:09:25.176 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-3 VoteRequest(term=1)
20:09:25.176 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-3 VoteRequest(term=1)
20:09:25.176 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-1 VoteRequest(term=1)
20:09:25.176 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-4 for term 1
20:09:25.176 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-2 VoteRequest(term=1)
20:09:25.176 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-2 VoteRequest(term=1)
20:09:25.176 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:25.176 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
20:09:25.176 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-1 VoteRequest(term=1)
20:09:25.176 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-5 - canVote=false, logUpToDate=true
20:09:25.176 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
20:09:25.176 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-4 VoteResponse(granted=false)
20:09:25.176 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-1 VoteResponse(granted=true)
20:09:25.176 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:25.176 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-4 -> node-5 VoteRequest(term=1)
20:09:25.176 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.176 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-4 - canVote=false, logUpToDate=true
20:09:25.176 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-5 - canVote=false, logUpToDate=true
20:09:25.176 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-5 VoteResponse(granted=false)
20:09:25.176 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-3 VoteResponse(granted=false)
20:09:25.176 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:25.176 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.176 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-3 VoteResponse(granted=true)
20:09:25.176 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-4 - canVote=false, logUpToDate=true
20:09:25.176 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:09:25.176 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.176 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-4 - canVote=false, logUpToDate=true
20:09:25.176 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-2 VoteResponse(granted=false)
20:09:25.176 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-2 VoteResponse(granted=true)
20:09:25.176 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:09:25.176 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-4 <- node-1 VoteResponse(granted=false)
20:09:25.176 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:09:25.176 [] [node-5] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:25.176 [] [node-5] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:25.176 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:25.228 [main] [node-5] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-5 (term 1)
20:09:25.229 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:25.229 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.229 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:25.229 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:25.229 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:25.229 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:25.229 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.229 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:25.229 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:25.229 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:25.229 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:25.229 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.229 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:25.229 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:25.229 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:25.229 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:09:25.229 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.229 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:25.229 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
20:09:25.229 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:09:25.229 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:09:25.229 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.229 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:25.229 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
20:09:25.229 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:09:25.230 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:25.230 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:25.230 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:25.230 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:25.230 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:25.230 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:25.230 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:25.230 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:25.230 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:25.230 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:25.230 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:25.230 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:25.230 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:25.230 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:25.230 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:25.412 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:25.413 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:25.413 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:25.413 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:09:25.413 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:09:25.413 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:25.413 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.413 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:25.413 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.413 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:25.413 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:09:25.413 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:09:25.413 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:09:25.413 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:25.413 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:09:25.413 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:09:25.413 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:25.936 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader node-3 maintained leadership for 500ms
20:09:25.936 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:25.936 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.936 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:25.936 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:25.936 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:25.936 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:25.936 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.936 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:25.936 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:25.936 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:25.936 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:25.936 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:25.936 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:25.936 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:25.936 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:09:25.938 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:09:25.938 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:09:25.938 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:09:25.938 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:25.938 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:09:25.938 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:09:25.938 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:09:25.938 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:09:25.938 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:25.938 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:09:25.938 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:09:25.938 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:09:25.938 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:09:25.938 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:09:25.938 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:09:26.153 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:26.153 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:26.153 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:26.153 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:26.153 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:26.153 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:09:26.153 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:26.153 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:26.153 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:26.153 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:09:26.153 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:09:26.153 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:09:26.153 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:09:26.153 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:09:26.153 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:09:26.153 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:09:26.153 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:09:26.153 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:09:26.153 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=false)
20:09:26.153 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:09:26.153 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=false)
20:09:26.153 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=false)
20:09:26.153 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=false)
20:09:26.153 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:09:26.153 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:09:26.153 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=false)
20:09:26.153 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=false)
20:09:26.353 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:26.353 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:09:26.353 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:26.353 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=2)
20:09:26.353 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:26.353 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:26.353 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
20:09:26.353 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:09:26.353 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:26.353 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:09:26.353 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:09:26.353 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:26.353 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=2)
20:09:26.353 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:26.353 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:26.354 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
20:09:26.354 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:09:26.448 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Initial leader: node-1 (term 2)
20:09:26.448 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:09:26.448 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:26.448 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:26.448 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:09:26.448 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:09:26.570 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:09:26.570 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
20:09:26.570 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:09:26.571 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=3)
20:09:26.571 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:09:26.571 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:09:26.571 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:26.571 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 3
20:09:26.571 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:09:26.571 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:09:26.571 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 3
20:09:26.571 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 3
20:09:26.571 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:09:26.660 [main] [node-1] INFO  com.raftdb.integration.ClusterTest - New leader: node-2 (term 3)
20:09:26.660 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:09:26.660 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:26.660 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:26.660 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:09:26.660 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:09:26.660 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:09:26.660 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:09:26.660 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:09:26.660 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:09:26.660 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:24.753 [main] [] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
20:12:24.755 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:24.756 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
20:12:24.756 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
20:12:24.756 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:24.757 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:24.757 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:24.757 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
20:12:24.758 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
20:12:24.758 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:24.758 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
20:12:24.758 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
20:12:24.758 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:24.758 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:24.759 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:24.759 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
20:12:24.759 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
20:12:24.759 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:24.759 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
20:12:24.760 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
20:12:24.760 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:24.760 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:24.760 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:24.760 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
20:12:24.925 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:24.927 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:24.928 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:24.928 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:24.929 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:24.933 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
20:12:24.933 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:12:24.946 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:24.947 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:24.947 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:12:24.947 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:24.947 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:24.948 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
20:12:24.948 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
20:12:25.005 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:25.005 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:25.006 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:25.006 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:25.006 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:25.006 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
20:12:25.006 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:12:25.055 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:12:25.055 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:12:25.055 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:12:25.055 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:12:25.055 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:12:25.055 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:12:25.060 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=false
20:12:25.060 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=false
20:12:25.060 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=false
20:12:25.060 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=false
20:12:25.061 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=false
20:12:25.061 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=false
20:12:25.197 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:25.198 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:12:25.198 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:12:25.198 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:25.199 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:25.201 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:12:25.201 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:12:25.201 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:25.201 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:25.201 [grpc-default-executor-5] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:25.201 [grpc-default-executor-0] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:25.202 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:12:25.202 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:12:25.202 [grpc-default-executor-5] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:12:25.202 [grpc-default-executor-0] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
20:12:25.203 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=2) -> granted=true
20:12:25.203 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=2) -> granted=true
20:12:25.203 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:25.203 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:12:25.203 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:12:25.203 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:25.297 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=name
20:12:25.298 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-2
20:12:25.299 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:12:25.301 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=name
20:12:25.302 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 2
20:12:25.302 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(name, Alice)
20:12:25.303 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:25.303 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:25.305 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:25.305 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:25.305 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:25.305 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:25.306 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:25.306 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:25.306 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:25.306 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:25.306 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:25.307 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:25.307 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:25.307 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:25.307 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:25.307 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(name, Alice)
20:12:25.308 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:25.308 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:25.309 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=age
20:12:25.310 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
20:12:25.310 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(age, 25)
20:12:25.310 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:25.310 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:25.312 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:25.312 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:25.312 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:25.312 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:25.312 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:25.312 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:25.312 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(name, Alice)
20:12:25.312 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(name, Alice)
20:12:25.313 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:25.313 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:25.313 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:12:25.313 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:25.313 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:25.313 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(age, 25)
20:12:25.314 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=name
20:12:25.340 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=age
20:12:25.342 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=nonexistent
20:12:25.342 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Basic put/get test passed
20:12:25.346 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:25.346 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:25.347 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:25.350 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:12:25.351 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:25.351 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:25.351 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:25.351 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:25.352 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:12:25.352 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:25.352 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:25.352 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:25.352 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:25.353 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:12:25.353 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:25.464 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
20:12:25.464 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:25.465 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
20:12:25.465 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
20:12:25.465 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:25.465 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:25.465 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:25.465 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
20:12:25.466 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
20:12:25.466 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:25.466 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
20:12:25.466 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
20:12:25.466 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:25.466 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:25.466 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:25.466 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
20:12:25.467 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
20:12:25.467 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:25.467 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
20:12:25.467 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
20:12:25.467 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:25.467 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:25.468 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:25.468 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
20:12:25.650 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:25.650 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:25.651 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:25.651 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:25.651 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:25.651 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:12:25.651 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
20:12:25.654 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:25.654 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:25.654 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:25.654 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:25.654 [grpc-default-executor-0] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:25.654 [grpc-default-executor-3] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:25.655 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:25.655 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:25.655 [grpc-default-executor-0] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:25.655 [grpc-default-executor-3] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:25.656 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=true
20:12:25.656 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=true
20:12:25.656 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:25.656 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:25.656 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:25.656 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:25.681 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=temp
20:12:25.682 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:12:25.682 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:12:25.685 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=temp
20:12:25.686 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:12:25.686 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:12:25.689 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=temp
20:12:25.689 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:25.689 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(temp, value)
20:12:25.689 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:25.690 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:25.691 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:25.691 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:25.691 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:25.691 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:25.691 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
20:12:25.691 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:25.692 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:25.692 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
20:12:25.692 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(temp, value)
20:12:25.692 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:25.693 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=temp
20:12:25.694 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=DELETE, key=temp
20:12:25.695 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:25.695 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(temp)
20:12:25.695 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:25.695 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:25.696 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:25.696 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:25.696 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:25.696 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:25.696 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:25.696 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:25.696 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(temp, value)
20:12:25.696 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(temp, value)
20:12:25.697 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
20:12:25.697 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
20:12:25.697 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:25.697 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:12:25.697 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:25.697 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:25.697 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(temp)
20:12:25.698 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=temp
20:12:25.699 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Delete test passed
20:12:25.700 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:25.700 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:25.700 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:25.701 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:12:25.701 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:25.701 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:25.701 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:25.701 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:25.701 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:12:25.701 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:25.702 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:25.702 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:25.702 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:25.702 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:12:25.702 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:25.810 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
20:12:25.810 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:25.811 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
20:12:25.811 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
20:12:25.811 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:25.811 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:25.811 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:25.811 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
20:12:25.812 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
20:12:25.812 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:25.812 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
20:12:25.812 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
20:12:25.812 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:25.812 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:25.812 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:25.812 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
20:12:25.813 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
20:12:25.813 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:25.813 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
20:12:25.813 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
20:12:25.813 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:25.813 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:25.813 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:25.813 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
20:12:25.969 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:25.970 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:25.970 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:25.970 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:25.970 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:25.971 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:12:25.971 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
20:12:25.974 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:25.975 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:25.975 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:25.975 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:25.975 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:25.975 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:12:25.976 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
20:12:25.976 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:12:25.976 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:25.976 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:25.976 [grpc-default-executor-1] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:25.976 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:25.977 [grpc-default-executor-1] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:25.977 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=false
20:12:25.978 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=true
20:12:25.978 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:25.978 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:25.978 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:25.978 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:25.980 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:12:25.980 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:12:25.981 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=false
20:12:25.981 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=false
20:12:26.024 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=redirect-test
20:12:26.024 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:12:26.024 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18001
20:12:26.025 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=redirect-test
20:12:26.026 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:12:26.026 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18002
20:12:26.029 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=redirect-test
20:12:26.030 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:12:26.030 [main] [node-3] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:12:26.032 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=redirect-test
20:12:26.033 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:26.033 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(redirect-test, value)
20:12:26.033 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:26.033 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:26.033 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:26.034 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:26.034 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:26.034 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:26.035 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:26.035 [grpc-default-executor-10] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:26.035 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:26.035 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
20:12:26.035 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:26.035 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:26.035 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
20:12:26.035 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:26.036 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
20:12:26.036 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(redirect-test, value)
20:12:26.036 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:26.036 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
20:12:26.037 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=redirect-test
20:12:26.037 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Auto-redirect test passed
20:12:26.038 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:26.038 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:26.038 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:26.039 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:12:26.039 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:26.039 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:26.039 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:26.039 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:26.041 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:12:26.041 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:26.041 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:26.041 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:26.041 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:26.041 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:12:26.041 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:26.150 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
20:12:26.150 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:26.150 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
20:12:26.150 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
20:12:26.150 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:26.150 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:26.151 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:26.151 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
20:12:26.151 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
20:12:26.151 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:26.151 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
20:12:26.151 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
20:12:26.152 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:26.152 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:26.152 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:26.152 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
20:12:26.152 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
20:12:26.152 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:26.152 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
20:12:26.153 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
20:12:26.153 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:26.153 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:26.153 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:26.153 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
20:12:26.372 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:26.373 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:26.374 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:26.374 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:26.374 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:26.374 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
20:12:26.374 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:12:26.378 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:26.378 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:26.378 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:26.378 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:26.378 [grpc-default-executor-1] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:26.378 [grpc-default-executor-0] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:26.379 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:26.379 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:26.379 [grpc-default-executor-0] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:26.379 [grpc-default-executor-1] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:26.380 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
20:12:26.380 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
20:12:26.380 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:26.380 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:26.380 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:26.380 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:26.469 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=before
20:12:26.470 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:26.470 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, leader-change)
20:12:26.470 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:26.470 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:26.471 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:26.471 [grpc-default-executor-10] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:26.471 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:26.471 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:26.472 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
20:12:26.472 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:12:26.472 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:26.472 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:26.472 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:26.472 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:26.472 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, leader-change)
20:12:26.473 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=before
20:12:26.474 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:26.474 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:26.474 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:26.475 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:12:26.475 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:26.694 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:26.707 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:26.707 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:26.707 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:26.707 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:18001
20:12:26.707 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:12:26.711 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:12:26.711 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:26.711 [grpc-default-executor-7] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:26.711 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:12:26.711 [grpc-default-executor-7] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:12:26.712 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: Vote request to node-1 failed
20:12:26.712 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=2) -> granted=true
20:12:26.712 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:26.712 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:12:26.712 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:12:26.712 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:26.787 [main] [node-1] DEBUG com.raftdb.client.RaftKVClient - Request to localhost:18001 failed: UNAVAILABLE: io exception
20:12:26.790 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=after
20:12:26.790 [main] [node-1] DEBUG com.raftdb.client.RaftKVClient - Not leader, got hint: node-3
20:12:26.790 [main] [node-1] DEBUG com.raftdb.client.RaftKVClient - Switched to server: localhost:18003
20:12:26.792 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=after
20:12:26.792 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
20:12:26.792 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after, leader-change)
20:12:26.793 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:26.793 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:26.794 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:26.794 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:26.794 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
20:12:26.794 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:12:26.794 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
20:12:26.795 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, leader-change)
20:12:26.795 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after, leader-change)
20:12:26.796 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=after
20:12:26.797 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=before
20:12:26.797 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Leader change retry test passed
20:12:26.798 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:26.798 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:26.798 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:26.798 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:12:26.799 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:26.799 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:26.799 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:26.799 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:26.799 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:12:26.799 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:26.907 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
20:12:26.907 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:26.908 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
20:12:26.908 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
20:12:26.908 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:26.908 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:26.908 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:26.908 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
20:12:26.908 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18002 with 1 additional services
20:12:26.908 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:26.908 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-2
20:12:26.909 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-2
20:12:26.909 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:26.909 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:26.909 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:26.909 [main] [node-2] INFO  com.raftdb.integration.KVClientTest - Started node node-2 on port 18002
20:12:26.909 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18003 with 1 additional services
20:12:26.909 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:26.909 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-3
20:12:26.909 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-3
20:12:26.909 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:26.909 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:26.909 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:26.909 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Started node node-3 on port 18003
20:12:27.105 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:27.106 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:27.106 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:27.106 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:27.106 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:27.106 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:18003
20:12:27.106 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:18002
20:12:27.110 [grpc-default-executor-10] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:27.110 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:27.110 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:27.110 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:27.110 [grpc-default-executor-10] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:27.110 [grpc-default-executor-7] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:27.110 [grpc-default-executor-10] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:27.110 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:27.110 [grpc-default-executor-10] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:27.110 [grpc-default-executor-7] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:27.111 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
20:12:27.111 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
20:12:27.111 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:27.111 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:27.111 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:27.111 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:27.622 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-2
20:12:27.622 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-4
20:12:27.622 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-0
20:12:27.622 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-1
20:12:27.622 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-3
20:12:27.623 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:27.623 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-2, value-2)
20:12:27.623 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:27.623 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-4, value-4)
20:12:27.623 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=1)
20:12:27.624 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:27.624 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-0, value-0)
20:12:27.624 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=1)
20:12:27.624 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=1)
20:12:27.624 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:12:27.624 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-1, value-1)
20:12:27.624 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=1)
20:12:27.624 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=1)
20:12:27.624 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=1)
20:12:27.625 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:12:27.625 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-3, value-3)
20:12:27.625 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=1)
20:12:27.625 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:12:27.625 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 3 log entries
20:12:27.625 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
20:12:27.625 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=1)
20:12:27.625 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=1)
20:12:27.625 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=1)
20:12:27.625 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.625 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
20:12:27.625 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 3
20:12:27.625 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.625 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 4
20:12:27.625 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 4
20:12:27.625 [grpc-default-executor-11] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.625 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 4
20:12:27.626 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=3) -> success=true
20:12:27.626 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:12:27.626 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 3
20:12:27.626 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=3) -> success=true
20:12:27.626 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:12:27.626 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=4) -> success=true
20:12:27.626 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
20:12:27.626 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=2) -> success=true
20:12:27.626 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:27.626 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-2, value-2)
20:12:27.626 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=4) -> success=true
20:12:27.626 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:12:27.626 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=4) -> success=true
20:12:27.626 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-4, value-4)
20:12:27.626 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.626 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-0, value-0)
20:12:27.626 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 5
20:12:27.626 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-1, value-1)
20:12:27.626 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.626 [grpc-default-executor-8] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 5
20:12:27.626 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 5
20:12:27.626 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 5
20:12:27.627 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=5) -> success=true
20:12:27.627 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:12:27.627 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:12:27.627 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-3, value-3)
20:12:27.627 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=5) -> success=true
20:12:27.627 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
20:12:27.627 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=5) -> success=true
20:12:27.627 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=5) -> success=true
20:12:27.628 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-5
20:12:27.628 [grpc-default-executor-8] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-7
20:12:27.628 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-6
20:12:27.628 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:12:27.628 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-5, value-5)
20:12:27.628 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
20:12:27.628 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:12:27.628 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-7, value-7)
20:12:27.628 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=6)
20:12:27.628 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=6)
20:12:27.628 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-9
20:12:27.628 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-8
20:12:27.628 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:12:27.628 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-6, value-6)
20:12:27.628 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=6)
20:12:27.628 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=6)
20:12:27.628 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:12:27.628 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-9, value-9)
20:12:27.628 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=6)
20:12:27.628 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=6)
20:12:27.628 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:12:27.628 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-8, value-8)
20:12:27.629 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=6)
20:12:27.629 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=6)
20:12:27.629 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.629 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:27.629 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=6)
20:12:27.629 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.629 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 7
20:12:27.629 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:27.629 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:27.629 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.629 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 8
20:12:27.629 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-2, value-2)
20:12:27.629 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-4, value-4)
20:12:27.629 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-0, value-0)
20:12:27.629 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-1, value-1)
20:12:27.629 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-3, value-3)
20:12:27.629 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:12:27.629 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 7
20:12:27.629 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:27.629 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.630 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:12:27.630 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
20:12:27.630 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.630 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=2) -> success=true
20:12:27.630 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 9
20:12:27.630 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:27.630 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
20:12:27.630 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:12:27.630 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
20:12:27.630 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:12:27.630 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-7, value-7)
20:12:27.630 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.630 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:12:27.630 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
20:12:27.630 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
20:12:27.630 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 10
20:12:27.630 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 10
20:12:27.630 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-2, value-2)
20:12:27.630 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-4, value-4)
20:12:27.630 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=4) -> success=true
20:12:27.630 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-0, value-0)
20:12:27.630 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
20:12:27.630 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=3) -> success=true
20:12:27.630 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 9
20:12:27.630 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
20:12:27.630 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-1, value-1)
20:12:27.630 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-6, value-6)
20:12:27.630 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-3, value-3)
20:12:27.630 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-9, value-9)
20:12:27.631 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=5) -> success=true
20:12:27.631 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=3) -> success=true
20:12:27.631 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=4) -> success=true
20:12:27.631 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=5) -> success=true
20:12:27.631 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
20:12:27.631 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:12:27.631 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=2) -> success=true
20:12:27.631 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
20:12:27.631 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=5) -> success=true
20:12:27.631 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-8, value-8)
20:12:27.631 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-10
20:12:27.631 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:12:27.631 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
20:12:27.631 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-11
20:12:27.631 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:12:27.632 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
20:12:27.632 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=11)
20:12:27.632 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=11)
20:12:27.632 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
20:12:27.632 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-12
20:12:27.632 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
20:12:27.632 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:12:27.632 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
20:12:27.632 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-13
20:12:27.632 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:12:27.632 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-13, value-13)
20:12:27.632 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=11)
20:12:27.632 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=11)
20:12:27.632 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=11)
20:12:27.632 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=11)
20:12:27.632 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-14
20:12:27.632 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:12:27.632 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-14, value-14)
20:12:27.632 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=11)
20:12:27.633 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=11)
20:12:27.633 [grpc-default-executor-7] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:12:27.633 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
20:12:27.633 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:12:27.633 [grpc-default-executor-11] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:12:27.633 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
20:12:27.633 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:12:27.633 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:12:27.633 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
20:12:27.633 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:12:27.633 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 14
20:12:27.633 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 14
20:12:27.633 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-7, value-7)
20:12:27.633 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:12:27.633 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-6, value-6)
20:12:27.633 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-7, value-7)
20:12:27.633 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 14
20:12:27.633 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-6, value-6)
20:12:27.633 [grpc-default-executor-12] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:12:27.633 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-9, value-9)
20:12:27.633 [grpc-default-executor-12] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 14
20:12:27.633 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-8, value-8)
20:12:27.633 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-9, value-9)
20:12:27.633 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-8, value-8)
20:12:27.633 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 14
20:12:27.633 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.633 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 15
20:12:27.634 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=2) -> success=true
20:12:27.634 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
20:12:27.634 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 12
20:12:27.634 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=2) -> success=true
20:12:27.634 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:12:27.634 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:12:27.634 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=2) -> success=true
20:12:27.634 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
20:12:27.634 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=4) -> success=true
20:12:27.634 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=4) -> success=true
20:12:27.634 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
20:12:27.634 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 14
20:12:27.634 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:12:27.634 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:12:27.634 [grpc-default-executor-12] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.634 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=4) -> success=true
20:12:27.634 [grpc-default-executor-12] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 15
20:12:27.634 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=14
20:12:27.634 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=4) -> success=true
20:12:27.634 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=2) -> success=true
20:12:27.634 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=5) -> success=true
20:12:27.634 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=15
20:12:27.635 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=5) -> success=true
20:12:27.635 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
20:12:27.635 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
20:12:27.635 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:12:27.635 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-15
20:12:27.635 [grpc-default-executor-12] [node-3] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-16
20:12:27.635 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-17
20:12:27.635 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
20:12:27.635 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
20:12:27.635 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-18
20:12:27.635 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
20:12:27.635 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
20:12:27.635 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-18, value-18)
20:12:27.635 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=16)
20:12:27.635 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=16)
20:12:27.636 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=16)
20:12:27.636 [grpc-default-executor-12] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
20:12:27.636 [grpc-default-executor-12] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-16, value-16)
20:12:27.636 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=concurrent-19
20:12:27.636 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
20:12:27.636 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-19, value-19)
20:12:27.636 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=16)
20:12:27.636 [grpc-default-executor-11] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.636 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=16)
20:12:27.636 [grpc-default-executor-11] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
20:12:27.636 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=16)
20:12:27.636 [grpc-default-executor-11] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:12:27.636 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
20:12:27.636 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-17, value-17)
20:12:27.636 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:12:27.636 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:12:27.636 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:12:27.636 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=16)
20:12:27.636 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-3 (nextIndex=16)
20:12:27.636 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.636 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-2 (nextIndex=16)
20:12:27.636 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 17
20:12:27.636 [grpc-default-executor-11] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:12:27.636 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 17
20:12:27.637 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:12:27.637 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:12:27.637 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 17
20:12:27.637 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:12:27.637 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:12:27.637 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:12:27.637 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
20:12:27.637 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:12:27.637 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
20:12:27.637 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:12:27.637 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:12:27.637 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:12:27.637 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:12:27.637 [grpc-default-executor-7] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:12:27.637 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=2) -> success=true
20:12:27.637 [grpc-default-executor-11] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 19
20:12:27.637 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
20:12:27.637 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
20:12:27.637 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.637 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 20
20:12:27.637 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-18, value-18)
20:12:27.637 [grpc-default-executor-7] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
20:12:27.637 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 2 log entries
20:12:27.638 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 19
20:12:27.638 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=2) -> success=true
20:12:27.638 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=17
20:12:27.638 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=2) -> success=true
20:12:27.638 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:27.638 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 20
20:12:27.638 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 20
20:12:27.638 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=4) -> success=true
20:12:27.638 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=19
20:12:27.638 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=5) -> success=true
20:12:27.638 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 19
20:12:27.638 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
20:12:27.638 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=4) -> success=true
20:12:27.638 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
20:12:27.638 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-16, value-16)
20:12:27.638 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-19, value-19)
20:12:27.638 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=4) -> success=true
20:12:27.638 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-17, value-17)
20:12:27.638 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=5) -> success=true
20:12:27.638 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=5) -> success=true
20:12:27.638 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
20:12:27.641 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-0
20:12:27.642 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-1
20:12:27.643 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-2
20:12:27.644 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-3
20:12:27.644 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-4
20:12:27.645 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-5
20:12:27.646 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-6
20:12:27.646 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-7
20:12:27.647 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-8
20:12:27.648 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-9
20:12:27.648 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-10
20:12:27.649 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-11
20:12:27.650 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-12
20:12:27.651 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-13
20:12:27.651 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-14
20:12:27.652 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-15
20:12:27.653 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-16
20:12:27.654 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-17
20:12:27.654 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-18
20:12:27.655 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=concurrent-19
20:12:27.656 [main] [node-3] INFO  com.raftdb.integration.KVClientTest - Concurrent writes test passed with 20/20 successful writes
20:12:27.657 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:27.657 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:27.657 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:27.657 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:12:27.657 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:27.657 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:27.657 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:27.658 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:27.658 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:12:27.658 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:27.658 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:27.658 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:27.658 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:27.658 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:12:27.658 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:27.766 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:18001 with 1 additional services
20:12:27.766 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:27.766 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/kv-client-test-data/node-1
20:12:27.766 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/kv-client-test-data/node-1
20:12:27.766 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:27.766 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:27.766 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:27.766 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Started node node-1 on port 18001
20:12:27.843 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:27.843 [election-node-3] [node-3] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: target/kv-client-test-data/node-3/meta.dat.tmp
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:213)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:244)
	at java.base/java.nio.file.spi.FileSystemProvider.newOutputStream(FileSystemProvider.java:426)
	at java.base/java.nio.file.Files.newOutputStream(Files.java:215)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:89)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:172)
	at com.raftdb.core.RaftState.persist(RaftState.java:52)
	at com.raftdb.core.RaftState.incrementTerm(RaftState.java:86)
	at com.raftdb.election.ElectionManager.startElection(ElectionManager.java:147)
	at com.raftdb.election.ElectionManager.onElectionTimeout(ElectionManager.java:139)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:545)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:309)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
20:12:27.938 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:27.938 [election-node-3] [node-3] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: target/kv-client-test-data/node-3/meta.dat.tmp
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:213)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:244)
	at java.base/java.nio.file.spi.FileSystemProvider.newOutputStream(FileSystemProvider.java:426)
	at java.base/java.nio.file.Files.newOutputStream(Files.java:215)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:89)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:172)
	at com.raftdb.core.RaftState.persist(RaftState.java:52)
	at com.raftdb.core.RaftState.incrementTerm(RaftState.java:86)
	at com.raftdb.election.ElectionManager.startElection(ElectionManager.java:147)
	at com.raftdb.election.ElectionManager.onElectionTimeout(ElectionManager.java:139)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:545)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:309)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
20:12:27.950 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:27.950 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:27.951 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:27.951 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:27.951 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:27.951 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:27.951 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:27.951 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:27.981 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=PUT, key=single
20:12:27.981 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:27.981 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(single, node)
20:12:27.981 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:27.982 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(single, node)
20:12:27.983 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.server.KVServiceImpl - Received request: op=GET, key=single
20:12:27.983 [main] [node-1] INFO  com.raftdb.integration.KVClientTest - Single node client test passed
20:12:27.983 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:27.983 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:27.983 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:27.983 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:12:27.984 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:28.093 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:28.093 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:28.093 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:28.093 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:28.094 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:28.094 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:28.094 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:28.094 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:28.094 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:28.094 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:28.094 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:28.094 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:28.094 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:28.094 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:28.094 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:28.312 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:28.312 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:28.312 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:28.313 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:12:28.313 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:28.313 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:12:28.313 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:28.313 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:28.313 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:28.313 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:28.313 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:28.313 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:12:28.313 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:12:28.313 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:28.313 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:28.313 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:28.313 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:28.412 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:28.412 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key3, value3)
20:12:28.412 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:28.412 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:28.412 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:28.412 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:28.413 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:28.413 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:28.413 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:28.413 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:28.413 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:28.413 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:12:28.413 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:28.413 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(key3)
20:12:28.413 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:28.413 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:28.413 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:28.413 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:28.413 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:28.413 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:28.413 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:28.413 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:28.413 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:12:28.413 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:28.413 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:12:28.413 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:12:28.413 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:28.413 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
20:12:28.413 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:28.413 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:12:28.413 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:28.413 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
20:12:28.518 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:28.518 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:28.518 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:28.518 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:28.518 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:28.518 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:28.518 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:28.518 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:28.518 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:28.518 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:28.519 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:28.519 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:28.519 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:28.519 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:28.519 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:28.520 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:28.520 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:28.520 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:28.520 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:28.520 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:28.520 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:28.520 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:28.520 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:28.520 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:28.520 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:28.520 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:28.520 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:28.520 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:28.520 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:28.520 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:28.744 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:28.744 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:28.744 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:28.744 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:12:28.744 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:12:28.745 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:28.745 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:28.745 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:28.745 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:28.745 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:28.745 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:28.745 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:12:28.745 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:12:28.745 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:28.745 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:28.745 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:28.745 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:28.831 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:28.831 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-0, value-0)
20:12:28.831 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:28.831 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:28.831 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:28.831 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:28.831 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-1, value-1)
20:12:28.832 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:28.832 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:28.832 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:28.832 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:28.832 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:28.832 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:28.832 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-2, value-2)
20:12:28.832 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=2)
20:12:28.832 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:12:28.832 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=2)
20:12:28.832 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-3, value-3)
20:12:28.832 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 3
20:12:28.832 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=2)
20:12:28.832 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 3
20:12:28.832 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=2)
20:12:28.832 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:12:28.832 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=2)
20:12:28.832 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 3
20:12:28.832 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=3)
20:12:28.832 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:28.832 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:12:28.832 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 4
20:12:28.832 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:12:28.832 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-4, value-4)
20:12:28.832 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=3)
20:12:28.832 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:28.832 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 4
20:12:28.832 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 4
20:12:28.832 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:12:28.832 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=4)
20:12:28.832 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:12:28.832 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=2)
20:12:28.832 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-5, value-5)
20:12:28.832 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:12:28.832 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 5
20:12:28.832 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:12:28.832 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=5)
20:12:28.832 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:12:28.832 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=5)
20:12:28.833 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:12:28.833 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:28.833 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:12:28.833 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 7
20:12:28.832 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-6, value-6)
20:12:28.833 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=3)
20:12:28.833 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 7
20:12:28.833 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:28.833 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:12:28.832 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:28.833 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-7, value-7)
20:12:28.833 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=5)
20:12:28.833 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:12:28.833 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=5)
20:12:28.833 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-8, value-8)
20:12:28.833 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:12:28.833 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=5)
20:12:28.833 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-9, value-9)
20:12:28.833 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:12:28.833 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 5 entries, last index now 9
20:12:28.833 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
20:12:28.833 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:12:28.833 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
20:12:28.833 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=5)
20:12:28.833 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:28.833 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
20:12:28.833 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:28.833 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
20:12:28.833 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:12:28.833 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:28.833 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 9 entries to node-1 (nextIndex=5)
20:12:28.833 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:12:28.834 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=9)
20:12:28.834 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 9 entries to node-3 (nextIndex=5)
20:12:28.834 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 9 entries, last index now 13
20:12:28.834 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=13
20:12:28.834 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 13
20:12:28.833 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
20:12:28.834 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
20:12:28.834 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=9)
20:12:28.834 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:12:28.834 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 9 entries, last index now 13
20:12:28.834 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:12:28.834 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
20:12:28.833 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
20:12:28.834 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-3 (nextIndex=8)
20:12:28.834 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 13
20:12:28.834 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 13
20:12:28.834 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=6)
20:12:28.834 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:12:28.834 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 6 entries, last index now 13
20:12:28.834 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:12:28.834 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
20:12:28.834 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
20:12:28.834 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:12:28.834 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:12:28.834 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:12:28.834 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
20:12:28.834 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-3 (nextIndex=8)
20:12:28.834 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:12:28.834 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
20:12:28.834 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:12:28.834 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
20:12:28.834 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=4)
20:12:28.834 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:12:28.834 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:12:28.834 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
20:12:28.835 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 13
20:12:28.835 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:12:28.834 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=6)
20:12:28.835 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-13, value-13)
20:12:28.835 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 6 entries, last index now 13
20:12:28.835 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=14)
20:12:28.835 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:12:28.835 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:12:28.835 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:28.835 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:12:28.835 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:12:28.835 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:12:28.835 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:12:28.835 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:12:28.835 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:12:28.835 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:12:28.835 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:12:28.835 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:12:28.835 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:12:28.835 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-14, value-14)
20:12:28.835 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:12:28.835 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
20:12:28.835 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
20:12:28.835 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
20:12:28.835 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=14)
20:12:28.835 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
20:12:28.835 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=14)
20:12:28.835 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
20:12:28.835 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=15)
20:12:28.835 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=14)
20:12:28.835 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-3 (nextIndex=14)
20:12:28.835 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
20:12:28.835 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=14
20:12:28.836 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
20:12:28.836 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:28.836 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-16, value-16)
20:12:28.836 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
20:12:28.836 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=16
20:12:28.836 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=3)
20:12:28.836 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=2)
20:12:28.836 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=3)
20:12:28.836 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=3)
20:12:28.835 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
20:12:28.836 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
20:12:28.836 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
20:12:28.836 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
20:12:28.841 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-17, value-17)
20:12:28.841 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 16
20:12:28.836 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
20:12:28.836 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
20:12:28.841 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 16
20:12:28.841 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
20:12:28.841 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-18, value-18)
20:12:28.841 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 16
20:12:28.841 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 16
20:12:28.841 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=17)
20:12:28.841 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
20:12:28.841 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=17)
20:12:28.841 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
20:12:28.841 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-19, value-19)
20:12:28.841 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=17)
20:12:28.841 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:28.841 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=3)
20:12:28.841 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=17)
20:12:28.841 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=17)
20:12:28.841 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=4)
20:12:28.841 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 19
20:12:28.841 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-3 (nextIndex=17)
20:12:28.841 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
20:12:28.841 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
20:12:28.841 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
20:12:28.841 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=17)
20:12:28.841 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
20:12:28.841 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=4)
20:12:28.841 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 19
20:12:28.841 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:12:28.841 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:12:28.841 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=4)
20:12:28.841 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=4)
20:12:28.841 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
20:12:28.841 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=17)
20:12:28.841 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:12:28.841 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
20:12:28.841 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:12:28.841 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 20
20:12:28.841 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:12:28.841 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=19
20:12:28.841 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
20:12:28.841 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=4)
20:12:28.841 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:12:28.841 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
20:12:28.842 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
20:12:28.842 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
20:12:28.842 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:12:28.841 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
20:12:28.842 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:12:28.842 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
20:12:28.842 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:12:28.842 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
20:12:28.841 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=4)
20:12:28.842 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:12:28.842 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 20
20:12:28.846 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:12:28.846 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:12:28.846 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:12:28.846 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:12:28.846 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:12:28.846 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:12:28.846 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
20:12:28.846 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
20:12:28.846 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
20:12:28.846 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
20:12:28.945 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:28.945 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:28.945 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:28.945 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:28.945 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:28.945 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:28.945 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:28.945 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:28.945 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:28.945 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:28.945 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:28.945 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:28.945 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:28.945 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:28.945 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:28.946 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:28.946 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:28.946 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:28.946 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:28.946 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:28.946 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:28.946 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:28.946 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:28.946 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:28.946 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:28.946 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:28.946 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:28.946 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:28.946 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:28.946 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:29.135 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:29.136 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:29.136 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:29.136 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:12:29.136 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:29.136 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:29.136 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:12:29.136 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:29.136 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:29.136 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:29.136 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:12:29.136 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:29.136 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:29.136 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:12:29.136 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:29.136 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:29.136 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:29.157 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:29.157 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key2, value2)
20:12:29.157 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:29.157 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:29.157 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:29.158 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:29.158 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:29.158 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:29.158 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:29.158 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:29.158 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:29.158 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:29.158 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:12:29.191 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:29.191 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:29.192 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:12:29.192 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
20:12:29.262 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:29.262 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:29.262 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:29.262 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:29.262 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:29.262 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:29.262 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:29.262 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:29.262 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:29.262 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:29.262 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:29.262 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:29.262 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:29.262 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:29.262 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:29.264 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:29.264 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:29.264 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:29.264 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:29.264 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:29.264 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:29.264 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:29.264 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:29.264 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:29.264 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:29.264 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:29.264 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:29.264 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:29.264 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:29.264 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:29.464 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:29.464 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:29.464 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:29.465 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:12:29.465 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:12:29.465 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:29.465 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:29.465 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:29.465 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:29.465 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:29.465 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:29.465 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:12:29.465 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:29.465 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:12:29.465 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:29.465 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:29.465 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:29.466 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:29.466 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
20:12:29.467 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:29.467 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:29.467 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
20:12:29.467 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
20:12:29.467 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:29.467 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:29.467 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:29.467 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:29.467 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:29.467 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:12:29.520 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:29.520 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:29.520 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:12:29.520 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:12:29.570 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - Killing leader: node-1
20:12:29.570 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:29.570 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:29.570 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:29.570 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:29.571 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:29.768 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:29.769 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:29.769 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:29.769 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=2)
20:12:29.769 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:29.769 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:29.769 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:12:29.769 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:12:29.769 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
20:12:29.769 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:29.769 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:12:29.769 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:12:29.769 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:29.777 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - New leader: node-3
20:12:29.777 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
20:12:29.777 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
20:12:29.777 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:29.777 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:29.777 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=2, entries=1)
20:12:29.777 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:29.777 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:12:29.777 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:29.777 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:12:29.824 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:29.824 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:29.824 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:12:29.874 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:29.881 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:29.881 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:29.881 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:29.881 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:29.881 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:29.881 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:29.881 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:29.881 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:29.881 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:29.881 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:29.883 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:29.883 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:29.883 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:29.883 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:29.883 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:29.883 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:29.883 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:29.883 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:29.883 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:29.883 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:29.883 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:29.883 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:29.883 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:29.883 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:29.883 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:30.060 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:30.060 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:30.061 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:30.061 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:12:30.061 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:12:30.061 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:30.061 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.061 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:30.061 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.061 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:30.061 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:12:30.061 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:30.061 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:30.061 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:30.061 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:30.061 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:30.061 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:12:30.094 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:30.094 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
20:12:30.094 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:30.095 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:30.095 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:30.095 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:30.095 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:30.095 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:30.095 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:30.095 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:30.095 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:30.095 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:30.095 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:12:30.095 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:30.095 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
20:12:30.095 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:30.095 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:30.095 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:30.095 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:30.095 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:30.095 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:30.095 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:30.096 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:30.096 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:30.096 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:30.096 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:12:30.096 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:12:30.096 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:12:30.096 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:12:30.096 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:30.096 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
20:12:30.096 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:12:30.096 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:12:30.096 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:30.096 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:30.096 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:30.096 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:30.096 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:30.096 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:30.096 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:12:30.096 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:12:30.096 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:12:30.096 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:30.096 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:30.096 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:12:30.096 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:12:30.096 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:12:30.096 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
20:12:30.096 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:12:30.096 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
20:12:30.096 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:30.096 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:30.096 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:30.096 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:30.096 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:30.097 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:12:30.097 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:12:30.097 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:30.097 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
20:12:30.097 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:30.097 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:12:30.097 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:12:30.097 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:12:30.097 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:30.097 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
20:12:30.097 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:12:30.097 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
20:12:30.097 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:30.097 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:30.097 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:30.097 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:30.097 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:30.097 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:12:30.097 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:12:30.097 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:12:30.097 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:30.097 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
20:12:30.097 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:12:30.097 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:12:30.098 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:12:30.098 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
20:12:30.098 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:12:30.098 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
20:12:30.098 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:30.098 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:30.098 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:30.098 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:30.098 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:30.098 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:30.098 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:12:30.098 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
20:12:30.098 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:30.098 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:12:30.098 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:30.098 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:12:30.098 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:12:30.098 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:12:30.098 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
20:12:30.098 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
20:12:30.098 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
20:12:30.098 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:30.098 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:12:30.098 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:30.098 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:30.098 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
20:12:30.098 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:12:30.098 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:12:30.099 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:30.098 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:12:30.099 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
20:12:30.099 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:12:30.099 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:12:30.099 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:12:30.099 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
20:12:30.099 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
20:12:30.099 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
20:12:30.099 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:30.099 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:30.099 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:12:30.099 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:12:30.099 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:12:30.099 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:12:30.099 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
20:12:30.099 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
20:12:30.099 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:12:30.099 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:12:30.099 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:12:30.099 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:12:30.099 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:12:30.099 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:12:30.100 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
20:12:30.100 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
20:12:30.100 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
20:12:30.100 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:30.100 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:30.100 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:12:30.100 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:12:30.100 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:12:30.100 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:12:30.100 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
20:12:30.100 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:12:30.100 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
20:12:30.100 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:12:30.100 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:12:30.100 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:12:30.100 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:12:30.100 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
20:12:30.100 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
20:12:30.100 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
20:12:30.100 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:30.100 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:30.100 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:12:30.100 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:12:30.100 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:12:30.100 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:12:30.100 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
20:12:30.100 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
20:12:30.100 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:12:30.101 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:12:30.101 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:12:30.101 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:12:30.101 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:12:30.114 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:12:30.114 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:12:30.114 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:12:30.114 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:12:30.207 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:30.209 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.209 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:30.209 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:30.209 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:30.209 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:30.209 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.209 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:30.209 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:30.209 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:30.209 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:30.209 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.209 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:30.209 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:30.209 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:30.210 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:30.210 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:30.210 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:30.210 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:30.210 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:30.210 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:30.210 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:30.210 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:30.210 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:30.210 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:30.210 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:30.210 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:30.210 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:30.210 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:30.210 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:30.379 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:30.386 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:30.386 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:30.386 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:12:30.386 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:12:30.386 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:30.386 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:30.386 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.386 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.386 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:30.386 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:30.386 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:12:30.386 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:12:30.386 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:30.387 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:30.387 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:30.387 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:30.416 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Leader: node-2
20:12:30.417 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:30.417 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
20:12:30.417 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:30.417 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:30.417 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:30.417 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:30.417 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:30.417 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:30.417 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:30.417 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:30.417 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:30.417 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:30.417 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:12:30.417 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - PUT committed
20:12:30.441 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:30.441 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:30.441 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:12:30.441 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:12:30.523 [main] [node-2] INFO  c.raftdb.integration.KVOperationTest - Data replicated to all nodes
20:12:30.523 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:30.523 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.523 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:30.523 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:30.524 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:30.524 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:30.524 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.524 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:30.524 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:30.524 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:30.524 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:30.524 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.524 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:30.524 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:30.524 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:30.525 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:30.525 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:30.525 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:30.525 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:30.525 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:30.525 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:30.525 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:30.525 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:30.525 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:30.525 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:30.525 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:30.525 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:30.525 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:30.525 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:30.525 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:30.728 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:30.728 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:30.728 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:30.728 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:30.728 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:30.728 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:12:30.728 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:30.728 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:12:30.728 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:12:30.728 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:12:30.728 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:30.728 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:30.728 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:12:30.728 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:12:30.728 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:12:30.728 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.728 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=false)
20:12:30.728 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:30.728 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=false)
20:12:30.729 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:30.729 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
20:12:30.729 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:30.729 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=false)
20:12:30.729 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:30.737 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:30.737 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.737 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:30.737 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:30.737 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:30.737 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:30.737 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.737 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:30.737 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:30.737 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:30.737 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:30.737 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.737 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:30.737 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:30.737 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:30.738 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:30.738 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:30.738 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:30.738 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:30.738 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:30.738 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:30.738 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:30.738 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:30.738 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:30.738 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:30.738 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:30.738 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:30.738 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:30.738 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:30.738 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:30.738 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:12:30.738 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
20:12:30.738 [main] [node-4] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-4
20:12:30.738 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:30.738 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 initialized as FOLLOWER
20:12:30.738 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:12:30.738 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
20:12:30.738 [main] [node-5] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-5
20:12:30.738 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:30.738 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 initialized as FOLLOWER
20:12:30.934 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:30.934 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:30.934 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:30.934 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:30.934 [election-node-5] [node-5] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:12:30.934 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:12:30.934 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:12:30.934 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:30.934 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.934 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-1 VoteRequest(term=1)
20:12:30.934 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-5 VoteRequest(term=1)
20:12:30.934 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:12:30.934 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-2 VoteRequest(term=1)
20:12:30.935 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:30.935 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-3 VoteRequest(term=1)
20:12:30.935 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-4 VoteRequest(term=1)
20:12:30.934 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:30.934 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:12:30.935 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:12:30.935 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-5 VoteResponse(granted=false)
20:12:30.934 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-5 - canVote=false, logUpToDate=true
20:12:30.935 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-4 VoteRequest(term=1)
20:12:30.935 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-5 - canVote=false, logUpToDate=true
20:12:30.935 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
20:12:30.935 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-2 VoteResponse(granted=false)
20:12:30.935 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.935 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:30.935 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:12:30.935 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:30.935 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=false)
20:12:30.935 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
20:12:30.935 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:12:30.935 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-3 VoteResponse(granted=true)
20:12:30.935 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:12:30.935 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-1 VoteResponse(granted=false)
20:12:30.935 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-5 <- node-4 VoteResponse(granted=true)
20:12:30.935 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:12:30.935 [] [node-4] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:12:30.935 [] [node-5] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:30.935 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-4 VoteResponse(granted=false)
20:12:30.935 [] [node-5] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:30.935 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:30.949 [main] [node-5] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:30.949 [main] [node-5] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(stable-key, initial)
20:12:30.949 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:30.949 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:30.949 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-1 AppendEntries(term=1, entries=1)
20:12:30.949 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:30.949 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:30.949 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-2 AppendEntries(term=1, entries=1)
20:12:30.949 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
20:12:30.949 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:30.949 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-4 AppendEntries(term=1, entries=1)
20:12:30.949 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:30.949 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:30.949 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-3 AppendEntries(term=1, entries=1)
20:12:30.949 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:30.949 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
20:12:30.949 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:30.949 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:30.949 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:30.949 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:30.949 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:12:30.990 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:30.990 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:30.990 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:30.990 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:30.991 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:12:30.991 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:12:30.991 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:12:30.991 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
20:12:31.055 [main] [node-5] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:31.055 [main] [node-5] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-0, value-0)
20:12:31.055 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:31.055 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:31.055 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-1 AppendEntries(term=1, entries=1)
20:12:31.055 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:31.055 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
20:12:31.055 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-2 AppendEntries(term=1, entries=1)
20:12:31.055 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-4 AppendEntries(term=1, entries=1)
20:12:31.055 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:31.055 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-3 AppendEntries(term=1, entries=1)
20:12:31.055 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:31.055 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:31.055 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:31.055 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:31.055 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:12:31.055 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:12:31.055 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:31.055 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
20:12:31.055 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:31.056 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:12:31.056 [main] [node-5] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:31.056 [main] [node-5] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-1, value-1)
20:12:31.056 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:12:31.056 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:12:31.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-1 AppendEntries(term=1, entries=1)
20:12:31.056 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:12:31.056 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:31.056 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:31.056 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=3)
20:12:31.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-2 AppendEntries(term=1, entries=1)
20:12:31.056 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:12:31.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-3 AppendEntries(term=1, entries=1)
20:12:31.056 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:31.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-4 AppendEntries(term=1, entries=1)
20:12:31.056 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:31.056 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:12:31.056 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:31.056 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:31.056 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:31.056 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:12:31.056 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:12:31.056 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:31.056 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:12:31.056 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:31.056 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:12:31.056 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:31.056 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=3
20:12:31.056 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
20:12:31.056 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:12:31.056 [main] [node-5] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:12:31.056 [main] [node-5] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-2, value-2)
20:12:31.056 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:12:31.056 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
20:12:31.056 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
20:12:31.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-1 AppendEntries(term=1, entries=1)
20:12:31.056 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=4)
20:12:31.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-3 AppendEntries(term=1, entries=1)
20:12:31.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-2 AppendEntries(term=1, entries=1)
20:12:31.056 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:31.056 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:31.056 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:31.056 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:31.056 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:12:31.056 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:31.056 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:12:31.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-4 AppendEntries(term=1, entries=1)
20:12:31.056 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
20:12:31.056 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:31.056 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:31.056 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:12:31.056 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:12:31.056 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:31.057 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:12:31.056 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:31.057 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:12:31.057 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:31.057 [main] [node-5] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:12:31.057 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=4
20:12:31.057 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
20:12:31.057 [main] [node-5] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-3, value-3)
20:12:31.057 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:12:31.057 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
20:12:31.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-1 AppendEntries(term=1, entries=1)
20:12:31.057 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
20:12:31.057 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:31.057 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:31.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-2 AppendEntries(term=1, entries=1)
20:12:31.057 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:12:31.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-3 AppendEntries(term=1, entries=1)
20:12:31.057 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:31.057 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=5)
20:12:31.057 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:31.057 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:31.057 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:31.057 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:12:31.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-4 AppendEntries(term=1, entries=1)
20:12:31.057 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:31.057 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
20:12:31.057 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:31.057 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:12:31.057 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:12:31.057 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:12:31.057 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=5
20:12:31.057 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:12:31.057 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:12:31.057 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:12:31.057 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
20:12:31.057 [main] [node-5] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:12:31.057 [main] [node-5] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-4, value-4)
20:12:31.057 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:12:31.057 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
20:12:31.057 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
20:12:31.057 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=6)
20:12:31.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-1 AppendEntries(term=1, entries=1)
20:12:31.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-2 AppendEntries(term=1, entries=1)
20:12:31.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-3 AppendEntries(term=1, entries=1)
20:12:31.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-5 -> node-4 AppendEntries(term=1, entries=1)
20:12:31.057 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:31.057 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:31.057 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:31.057 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:31.057 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:31.057 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:31.057 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
20:12:31.057 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
20:12:31.058 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:12:31.058 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:31.058 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:12:31.058 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:12:31.058 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:12:31.057 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:31.058 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:12:31.058 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:31.058 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:31.058 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=6
20:12:31.058 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
20:12:31.090 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:31.090 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:31.090 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:31.090 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:31.090 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:12:31.090 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:12:31.090 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:12:31.090 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
20:12:31.163 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:31.164 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:31.164 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:31.164 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:31.164 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:31.164 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:31.164 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:31.164 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:31.164 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:31.164 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:31.164 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:31.164 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:31.164 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:31.164 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:31.164 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:31.164 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:12:31.164 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:31.164 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:31.164 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
20:12:31.164 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:12:31.164 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:12:31.164 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:31.164 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:31.164 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
20:12:31.164 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:12:31.167 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:31.167 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:31.167 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:31.167 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:31.167 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:31.167 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:31.167 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:31.167 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:31.367 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:31.368 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:31.368 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:31.368 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:31.368 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:31.368 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:31.368 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:31.368 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:31.483 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:31.483 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test, data)
20:12:31.483 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:31.483 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test, data)
20:12:31.483 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Data files created at target/test-data/node-1
20:12:31.484 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:31.484 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:31.484 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:31.484 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:31.484 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:31.485 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:31.486 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:31.486 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:31.486 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:31.486 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:31.486 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:31.486 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:31.486 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:31.486 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:31.486 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:31.486 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:31.486 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:12:31.486 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
20:12:31.486 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:31.486 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:31.486 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:31.486 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:31.486 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:31.486 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:31.486 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:12:31.486 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
20:12:31.486 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:31.486 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:31.486 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:31.700 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:31.701 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:31.701 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:12:31.701 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:31.701 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:31.701 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:12:31.701 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:12:31.702 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:31.702 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:31.702 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:31.702 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:31.702 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:31.702 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:31.702 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:12:31.702 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:31.702 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:12:31.702 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:31.702 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:31.702 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:31.702 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:31.702 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:12:31.702 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:31.702 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:12:31.803 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Leader: node-2
20:12:31.803 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:31.803 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
20:12:31.803 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:31.803 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:31.803 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:31.803 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:31.803 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:31.803 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:31.803 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:31.804 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:31.804 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:31.804 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:31.804 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:31.804 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:31.804 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:31.804 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:31.804 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:31.804 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:31.804 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:31.804 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:31.804 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:12:31.804 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:31.804 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key2, value2)
20:12:31.804 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:31.804 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:31.804 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:31.804 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:31.804 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:31.804 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:31.804 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:31.804 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:31.804 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:31.804 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:31.805 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:31.805 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:31.805 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:12:31.805 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:12:31.805 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:12:31.805 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
20:12:31.805 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:31.805 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key3, value3)
20:12:31.805 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:12:31.805 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:12:31.805 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
20:12:31.805 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
20:12:31.805 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:31.805 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:31.805 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:31.805 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:12:31.805 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:31.805 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:31.805 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:12:31.805 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:31.805 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:12:31.805 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:31.805 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:12:31.805 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
20:12:31.854 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:31.854 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:31.854 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:12:31.854 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
20:12:31.907 [main] [node-2] INFO  c.raftdb.integration.PersistenceTest - Stopping all nodes...
20:12:31.908 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:31.908 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:31.908 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:31.908 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:31.908 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:31.908 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:31.908 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:31.908 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:31.908 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:31.908 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:31.908 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:31.908 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:31.908 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:31.908 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:31.908 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:31.908 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting all nodes...
20:12:31.908 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:31.908 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:31.908 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:31.908 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-2
20:12:31.908 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:31.908 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:31.909 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:12:31.909 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:12:31.909 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
20:12:31.909 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:12:31.909 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-2, lastLogIndex=3
20:12:31.909 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:31.909 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:31.909 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:31.909 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:31.909 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:31.909 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-2
20:12:31.909 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:12:31.909 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
20:12:31.909 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:12:31.909 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:12:31.909 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
20:12:31.909 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:12:31.909 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-2, lastLogIndex=3
20:12:31.909 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:31.909 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:31.909 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:31.909 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:31.909 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:31.909 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-2
20:12:31.909 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:12:31.909 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
20:12:31.909 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
20:12:31.909 [main] [node-3] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
20:12:31.909 [main] [node-3] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
20:12:31.909 [main] [node-3] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
20:12:31.909 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-2, lastLogIndex=3
20:12:31.909 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:31.909 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:32.155 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:32.156 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:12:32.156 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:32.156 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:32.156 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=2)
20:12:32.156 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=2)
20:12:32.156 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:12:32.156 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:32.156 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:32.157 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:12:32.157 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:32.157 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:32.157 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:32.157 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
20:12:32.157 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:12:32.157 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:32.157 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:12:32.157 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:12:32.157 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:32.157 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:32.157 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
20:12:32.157 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:12:32.225 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - New leader after restart: node-1
20:12:32.225 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - All nodes recovered successfully
20:12:32.225 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:32.225 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:32.225 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:32.225 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:32.225 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:32.225 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:32.225 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:32.226 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:32.226 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:32.226 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:32.226 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:32.226 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:32.226 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:32.226 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:32.226 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:32.227 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:32.227 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:32.227 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:32.228 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:32.228 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:32.228 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:32.228 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:32.228 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:32.228 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:32.228 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:32.228 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:32.228 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:12:32.228 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
20:12:32.228 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:32.228 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:32.228 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:32.228 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:32.228 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:32.228 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:32.228 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:12:32.228 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
20:12:32.228 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:32.228 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:32.228 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:32.502 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:32.503 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:32.504 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:32.504 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:32.504 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:32.504 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:12:32.504 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:12:32.504 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:32.504 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:32.504 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:32.504 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:32.504 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:32.504 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:32.505 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:32.505 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:32.505 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:12:32.505 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:32.505 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:32.505 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:32.505 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:32.505 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:32.505 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:32.505 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:12:32.539 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:32.539 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, restart)
20:12:32.539 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:32.539 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:32.539 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:32.539 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:32.539 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:32.539 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:32.540 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:32.540 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:32.540 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:32.540 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:32.540 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:32.540 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:32.540 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:12:32.559 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:32.559 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:32.560 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:12:32.560 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
20:12:32.643 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting follower: node-1
20:12:32.643 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:32.643 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:32.643 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:32.643 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:32.643 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:32.749 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:32.749 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during, downtime)
20:12:32.749 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:32.749 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:32.750 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:32.750 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:32.750 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:32.750 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:12:32.750 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:32.750 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
20:12:32.750 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:32.750 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:32.750 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:32.751 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
20:12:32.751 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:32.751 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:32.751 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
20:12:32.751 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
20:12:32.751 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 1 to recover state machine
20:12:32.751 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
20:12:32.751 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=1
20:12:32.751 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:32.751 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:32.756 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:32.757 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:32.757 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:32.757 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
20:12:32.757 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:32.757 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:32.757 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:32.757 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:32.757 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
20:12:32.857 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Follower node-1 caught up after restart
20:12:32.857 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:32.857 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:32.857 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:32.857 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:32.857 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:32.857 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:32.857 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:32.857 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:32.857 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:32.857 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:32.857 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:32.857 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:32.857 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:32.857 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:32.857 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:32.859 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:32.859 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:32.859 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:32.860 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:32.860 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:32.860 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:32.860 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:32.860 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:33.034 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:33.034 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:33.034 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:33.034 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:33.035 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:33.035 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:33.035 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:33.035 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:33.065 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:33.065 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:33.065 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:33.065 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:33.065 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:33.065 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:33.065 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:33.065 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:33.065 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:12:33.066 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:33.066 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:33.066 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=0
20:12:33.066 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:33.066 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:33.066 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Term persisted: 1 -> 1
20:12:33.066 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:33.066 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:33.066 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:33.066 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:33.066 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:33.068 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:33.068 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:33.068 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:33.069 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:33.069 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:33.069 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:33.069 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:33.069 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:33.224 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:33.224 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:33.225 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:33.225 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:33.225 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:33.225 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:33.225 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:33.225 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:33.277 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:33.277 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
20:12:33.280 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:33.280 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
20:12:33.280 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:33.280 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
20:12:33.280 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:33.280 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
20:12:33.281 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:33.281 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
20:12:33.281 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:33.281 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
20:12:33.281 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:12:33.281 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
20:12:33.281 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:33.281 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
20:12:33.281 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:12:33.281 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
20:12:33.281 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:12:33.281 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
20:12:33.281 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:12:33.281 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
20:12:33.281 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:33.281 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
20:12:33.281 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:12:33.281 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
20:12:33.281 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:12:33.281 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
20:12:33.281 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:12:33.281 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
20:12:33.281 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:12:33.281 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
20:12:33.282 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:12:33.282 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
20:12:33.282 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:12:33.282 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
20:12:33.282 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:12:33.282 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
20:12:33.282 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:12:33.282 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
20:12:33.282 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 10, term 1
20:12:33.282 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
20:12:33.283 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=10, lastTerm=1, size=184 bytes
20:12:33.283 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 10, 0 entries remaining
20:12:33.283 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
20:12:33.283 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 0 log entries remaining
20:12:33.283 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Snapshot test passed
20:12:33.283 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:33.283 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:33.283 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:33.283 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:33.283 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:33.285 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:33.285 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:33.285 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:33.285 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:33.285 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:33.285 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:33.285 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:33.285 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:33.528 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:33.528 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:33.529 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:33.529 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:33.529 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:33.529 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:33.529 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:33.529 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:33.594 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:33.594 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
20:12:33.594 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:33.594 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
20:12:33.594 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:33.594 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
20:12:33.594 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:33.594 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
20:12:33.594 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:33.594 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
20:12:33.594 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:33.594 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
20:12:33.595 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:12:33.595 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
20:12:33.595 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:33.595 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
20:12:33.595 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:12:33.595 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
20:12:33.595 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:12:33.595 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
20:12:33.595 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:12:33.595 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
20:12:33.595 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:33.595 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
20:12:33.595 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:12:33.595 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
20:12:33.595 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:12:33.595 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
20:12:33.596 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:12:33.596 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
20:12:33.596 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:12:33.596 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
20:12:33.596 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:12:33.596 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
20:12:33.596 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:12:33.596 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
20:12:33.596 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:12:33.596 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
20:12:33.596 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:12:33.596 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
20:12:33.596 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 10, term 1
20:12:33.596 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
20:12:33.597 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=10, lastTerm=1, size=184 bytes
20:12:33.597 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 10, 0 entries remaining
20:12:33.597 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
20:12:33.597 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 0 log entries remaining
20:12:33.597 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:12:33.597 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
20:12:33.597 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
20:12:33.597 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
20:12:33.597 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:12:33.597 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
20:12:33.597 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
20:12:33.597 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
20:12:33.597 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:12:33.597 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
20:12:33.598 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
20:12:33.598 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
20:12:33.598 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:12:33.598 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
20:12:33.598 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
20:12:33.598 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
20:12:33.598 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:12:33.598 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
20:12:33.598 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
20:12:33.598 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
20:12:33.598 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:33.598 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:33.598 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:33.598 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:33.598 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:33.598 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:33.598 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:33.598 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:33.598 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:12:33.598 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:33.598 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=10, lastTerm=1
20:12:33.598 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:33.599 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 184 bytes
20:12:33.599 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 10 entries
20:12:33.599 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=10, term=1
20:12:33.599 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=10, term=1
20:12:33.599 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 5 log entries from disk
20:12:33.599 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 5 log entries, lastIndex=15
20:12:33.599 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 11 to 15 to recover state machine
20:12:33.599 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=15
20:12:33.599 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=15
20:12:33.599 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:33.599 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:33.806 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:33.807 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:33.807 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:33.807 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:33.807 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:33.807 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:12:33.807 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:12:33.807 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:33.911 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Recovery from snapshot test passed
20:12:33.911 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:33.914 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:33.914 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:33.914 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:33.914 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:33.916 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:33.916 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:33.916 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:33.917 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:33.917 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:33.917 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:33.917 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:33.917 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:33.917 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:33.917 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:33.917 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:33.917 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
20:12:33.917 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
20:12:33.917 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:33.917 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:33.917 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:33.917 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:33.917 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:33.917 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:33.917 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
20:12:33.917 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
20:12:33.917 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:33.917 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:33.917 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:34.096 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:34.096 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:34.097 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:34.097 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:34.097 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:34.097 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
20:12:34.097 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
20:12:34.097 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:34.097 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:34.097 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:34.097 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:34.098 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:34.098 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:34.098 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:34.098 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:34.098 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:34.098 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:12:34.098 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:34.098 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:34.098 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
20:12:34.098 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:34.098 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:34.098 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:34.125 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:34.125 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
20:12:34.125 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:34.125 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:34.125 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:34.125 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.125 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.125 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.125 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:34.125 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:34.125 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:34.125 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:34.125 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:34.125 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:34.125 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
20:12:34.126 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:34.126 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
20:12:34.126 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:34.126 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:34.126 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:34.126 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.126 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.126 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:34.126 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:34.126 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.126 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:34.126 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:34.126 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:34.126 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:34.126 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
20:12:34.126 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
20:12:34.126 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
20:12:34.126 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:12:34.126 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:34.126 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
20:12:34.126 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:12:34.126 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
20:12:34.126 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:34.126 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.127 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.127 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:34.127 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.127 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:34.127 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:34.127 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:34.127 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:12:34.127 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
20:12:34.127 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
20:12:34.127 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
20:12:34.127 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:34.127 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:34.127 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
20:12:34.127 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:12:34.127 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
20:12:34.127 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:12:34.127 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
20:12:34.127 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:34.127 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.127 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.127 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.127 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:34.127 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:34.127 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:34.127 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:34.127 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:12:34.127 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
20:12:34.127 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
20:12:34.127 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
20:12:34.127 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:34.127 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:34.127 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
20:12:34.128 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:12:34.128 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
20:12:34.128 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:12:34.128 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
20:12:34.128 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:34.128 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.128 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.128 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:34.128 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:34.128 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:12:34.128 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.128 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:12:34.128 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:34.128 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
20:12:34.128 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
20:12:34.128 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:34.128 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
20:12:34.128 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:12:34.128 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
20:12:34.128 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
20:12:34.128 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:12:34.128 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
20:12:34.128 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:34.128 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.128 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.128 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:34.128 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:34.128 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.128 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:12:34.128 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
20:12:34.128 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:34.128 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:34.128 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:34.129 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
20:12:34.129 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
20:12:34.129 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
20:12:34.129 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:12:34.129 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
20:12:34.129 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
20:12:34.129 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:34.129 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
20:12:34.129 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.129 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.129 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:12:34.129 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:34.129 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
20:12:34.129 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:12:34.129 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.129 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
20:12:34.129 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:12:34.129 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
20:12:34.129 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:34.129 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
20:12:34.129 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
20:12:34.129 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:12:34.129 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
20:12:34.129 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
20:12:34.129 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:34.129 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
20:12:34.129 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.129 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.129 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:12:34.129 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:12:34.129 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
20:12:34.129 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
20:12:34.129 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:12:34.129 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.129 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
20:12:34.129 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:12:34.130 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:12:34.130 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
20:12:34.130 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:12:34.130 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
20:12:34.130 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
20:12:34.130 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
20:12:34.130 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
20:12:34.130 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:34.130 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.130 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.130 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:12:34.130 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:12:34.130 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.130 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
20:12:34.130 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
20:12:34.130 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:12:34.130 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:12:34.130 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:12:34.130 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
20:12:34.130 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
20:12:34.130 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
20:12:34.130 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:12:34.130 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
20:12:34.130 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
20:12:34.130 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
20:12:34.130 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:34.130 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.130 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.130 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.130 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:12:34.130 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:12:34.130 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:12:34.130 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:12:34.130 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
20:12:34.130 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
20:12:34.130 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
20:12:34.130 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:12:34.130 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:12:34.130 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
20:12:34.131 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
20:12:34.153 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:12:34.153 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:12:34.153 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
20:12:34.153 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
20:12:34.232 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:34.232 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:34.232 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:34.232 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:34.232 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:34.340 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:12:34.340 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
20:12:34.340 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=11)
20:12:34.340 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=11)
20:12:34.340 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.340 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.340 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
20:12:34.340 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
20:12:34.340 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
20:12:34.340 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
20:12:34.340 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:12:34.340 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
20:12:34.341 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=11)
20:12:34.341 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=12)
20:12:34.341 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.341 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.341 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
20:12:34.341 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
20:12:34.341 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
20:12:34.341 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
20:12:34.341 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
20:12:34.341 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
20:12:34.341 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:12:34.341 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
20:12:34.341 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=11)
20:12:34.341 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=13)
20:12:34.341 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.341 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.341 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
20:12:34.341 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
20:12:34.341 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=13
20:12:34.341 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
20:12:34.341 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
20:12:34.342 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
20:12:34.342 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:12:34.342 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
20:12:34.342 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=11)
20:12:34.342 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=14)
20:12:34.342 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.342 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.342 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
20:12:34.342 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:12:34.342 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=14
20:12:34.342 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
20:12:34.342 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
20:12:34.342 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
20:12:34.342 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:12:34.342 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
20:12:34.342 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=11)
20:12:34.342 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=15)
20:12:34.342 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.343 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.343 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
20:12:34.343 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
20:12:34.343 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=15
20:12:34.343 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
20:12:34.343 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
20:12:34.343 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
20:12:34.343 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
20:12:34.343 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(key15, value15)
20:12:34.343 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-1 (nextIndex=11)
20:12:34.343 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=16)
20:12:34.343 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.343 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.343 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
20:12:34.343 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:12:34.343 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
20:12:34.343 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=16
20:12:34.343 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
20:12:34.343 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
20:12:34.343 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
20:12:34.343 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(key16, value16)
20:12:34.343 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 7 entries to node-1 (nextIndex=11)
20:12:34.343 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=17)
20:12:34.343 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.343 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.343 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
20:12:34.343 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
20:12:34.343 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=17
20:12:34.343 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
20:12:34.343 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
20:12:34.343 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
20:12:34.343 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
20:12:34.343 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(key17, value17)
20:12:34.343 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 8 entries to node-1 (nextIndex=11)
20:12:34.343 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=18)
20:12:34.344 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.344 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.344 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
20:12:34.344 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
20:12:34.344 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=18
20:12:34.344 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
20:12:34.344 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
20:12:34.344 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
20:12:34.344 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
20:12:34.344 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(key18, value18)
20:12:34.344 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 9 entries to node-1 (nextIndex=11)
20:12:34.344 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=19)
20:12:34.344 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.344 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.344 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
20:12:34.344 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
20:12:34.344 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=19
20:12:34.344 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
20:12:34.344 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
20:12:34.344 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
20:12:34.344 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
20:12:34.344 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(key19, value19)
20:12:34.344 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 10 entries to node-1 (nextIndex=11)
20:12:34.344 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=20)
20:12:34.344 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
20:12:34.344 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.344 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:12:34.344 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
20:12:34.344 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
20:12:34.344 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
20:12:34.344 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
20:12:34.344 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
20:12:34.344 [main] [node-3] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 19, term 1
20:12:34.344 [main] [node-3] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 20 entries, 384 bytes
20:12:34.345 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=19, lastTerm=1, size=384 bytes
20:12:34.345 [main] [node-3] INFO  com.raftdb.log.LogManager - Compacted log to index 19, 1 entries remaining
20:12:34.345 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Rewrote log with 1 entries
20:12:34.345 [main] [node-3] INFO  com.raftdb.core.RaftNode - Snapshot complete: 384 bytes, 1 log entries remaining
20:12:34.346 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:34.346 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:34.346 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:34.346 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:34.346 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:34.346 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:34.346 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:34.346 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:34.349 [replication-node-3] [node-3] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 384 bytes
20:12:34.350 [replication-node-3] [node-3] INFO  c.r.replication.ReplicationManager - Sending snapshot to node-1 (lastIndex=19, size=384)
20:12:34.351 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 InstallSnapshot(term=1, lastIndex=19, size=384)
20:12:34.351 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:12:34.351 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
20:12:34.351 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:34.351 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:34.351 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:34.351 [] [node-1] INFO  com.raftdb.core.RaftNode - Installing snapshot: lastIndex=19, lastTerm=1, size=384
20:12:34.351 [] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=19, lastTerm=1, size=384 bytes
20:12:34.351 [] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 20 entries
20:12:34.351 [] [node-1] INFO  com.raftdb.log.LogManager - Reset log to snapshot: index=19, term=1
20:12:34.351 [] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
20:12:34.351 [] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot installed successfully
20:12:34.352 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 InstallSnapshotResponse(term=1)
20:12:34.352 [] [node-3] INFO  c.r.replication.ReplicationManager - Snapshot to node-1 complete, nextIndex=20
20:12:34.399 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=20)
20:12:34.399 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
20:12:34.400 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:34.400 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:12:34.400 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:12:34.400 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
20:12:34.400 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
20:12:34.450 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Snapshot replication test passed
20:12:34.450 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:34.450 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:34.450 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:34.450 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:34.450 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:34.450 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:34.450 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:34.450 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:34.450 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:34.450 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:34.450 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:34.450 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:34.450 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:34.450 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:34.450 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:34.453 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:34.453 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:34.453 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:34.453 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:34.453 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:34.454 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:34.454 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:34.454 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:34.622 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:34.626 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:34.626 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:34.626 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:34.626 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:34.626 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:34.626 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:34.626 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:34.659 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:34.659 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(string, hello)
20:12:34.659 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:34.659 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(string, hello)
20:12:34.659 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:34.659 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(number, 12345)
20:12:34.659 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:34.659 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(number, 12345)
20:12:34.659 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:34.659 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(special, )
20:12:34.660 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:34.660 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(special, )
20:12:34.660 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:12:34.660 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(empty, )
20:12:34.660 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:34.660 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(empty, )
20:12:34.660 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:12:34.660 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: DELETE(empty)
20:12:34.660 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:12:34.661 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: DELETE(empty)
20:12:34.661 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 5, term 1
20:12:34.661 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 3 entries, 69 bytes
20:12:34.661 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=5, lastTerm=1, size=69 bytes
20:12:34.661 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 5, 0 entries remaining
20:12:34.661 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
20:12:34.661 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 69 bytes, 0 log entries remaining
20:12:34.661 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:34.661 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:34.661 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:34.662 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:34.662 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:34.662 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:34.662 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:34.662 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:34.662 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
20:12:34.662 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
20:12:34.662 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=5, lastTerm=1
20:12:34.662 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
20:12:34.662 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 69 bytes
20:12:34.662 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 3 entries
20:12:34.662 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=5, term=1
20:12:34.662 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=5, term=1
20:12:34.662 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=5
20:12:34.662 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:34.662 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:34.814 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:34.819 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:34.819 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:34.819 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:34.819 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:34.819 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:12:34.819 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:12:34.819 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:34.869 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - State machine snapshot test passed
20:12:34.869 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:34.869 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:34.869 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:34.869 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:34.869 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:34.873 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:34.875 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19001
20:12:34.875 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:34.875 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:12:34.875 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:12:34.875 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:34.875 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:34.876 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:34.876 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19001
20:12:34.876 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:34.876 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19002
20:12:34.876 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:34.876 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:12:34.876 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:12:34.876 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:34.876 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:34.876 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:34.876 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19002
20:12:34.877 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:34.877 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19003
20:12:34.877 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:34.877 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
20:12:34.877 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
20:12:34.877 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:34.877 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:34.877 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:34.877 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19003
20:12:35.104 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:35.105 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:35.105 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:35.105 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:35.105 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:35.105 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19002
20:12:35.105 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19001
20:12:35.110 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:35.110 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:35.110 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:35.111 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:35.111 [grpc-default-executor-1] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:35.111 [grpc-default-executor-0] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:35.111 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:35.111 [grpc-default-executor-0] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:35.111 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:35.111 [grpc-default-executor-1] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
20:12:35.111 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=true
20:12:35.112 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=true
20:12:35.112 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:35.112 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:35.112 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:35.112 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:35.190 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Leader elected: node-3
20:12:35.191 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:35.191 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:35.191 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:35.191 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:12:35.192 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:35.192 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:35.192 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:35.192 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:35.192 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:12:35.192 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:35.192 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:35.192 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:35.192 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:35.193 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:12:35.193 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:35.296 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:35.297 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19011
20:12:35.297 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:35.297 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:12:35.297 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:12:35.297 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:35.297 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:35.297 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:35.297 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19011
20:12:35.297 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:35.297 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19012
20:12:35.297 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:35.298 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:12:35.298 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:12:35.298 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:35.298 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:35.298 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:35.298 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19012
20:12:35.298 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:35.298 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19013
20:12:35.298 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:35.298 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
20:12:35.299 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
20:12:35.299 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:35.299 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:35.299 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:35.299 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19013
20:12:35.453 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:35.454 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:35.454 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:35.455 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:35.455 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:35.455 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19013
20:12:35.455 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19012
20:12:35.458 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:35.458 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:35.458 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:35.458 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:35.458 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:35.458 [grpc-default-executor-4] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:35.458 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:35.458 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:35.458 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:35.458 [grpc-default-executor-4] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:35.459 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
20:12:35.459 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
20:12:35.459 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:35.459 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:35.459 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:35.459 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:35.505 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:35.505 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(grpc-key, grpc-value)
20:12:35.506 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:35.506 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:35.507 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:35.507 [grpc-default-executor-4] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:35.507 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:35.507 [grpc-default-executor-4] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:35.507 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
20:12:35.507 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:12:35.507 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:35.507 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:35.507 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:35.507 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:35.507 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
20:12:35.511 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:35.511 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:35.511 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
20:12:35.511 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
20:12:35.610 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Data replicated to all nodes
20:12:35.610 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:35.610 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:35.610 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:35.612 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:12:35.613 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:35.613 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:35.613 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:35.613 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:35.613 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:12:35.613 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:35.613 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:35.613 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:35.613 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:35.613 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:12:35.613 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:35.718 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:35.718 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19021
20:12:35.718 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:35.719 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:12:35.719 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:12:35.719 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:35.719 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:35.719 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:35.719 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19021
20:12:35.719 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:35.719 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19022
20:12:35.719 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:35.719 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:12:35.719 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:12:35.719 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:35.719 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:35.719 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:35.719 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19022
20:12:35.720 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:35.720 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19023
20:12:35.720 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:35.720 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
20:12:35.720 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
20:12:35.720 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:35.720 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:35.720 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:35.720 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19023
20:12:35.891 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:35.892 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:35.893 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:12:35.893 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:35.893 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:35.893 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19021
20:12:35.893 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19023
20:12:35.896 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:35.896 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:35.896 [grpc-default-executor-2] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:35.896 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:35.896 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:35.896 [grpc-default-executor-0] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:35.897 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:12:35.897 [grpc-default-executor-2] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:35.897 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:12:35.897 [grpc-default-executor-0] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:35.897 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
20:12:35.897 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
20:12:35.897 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:35.897 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:35.897 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:35.897 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:35.929 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Initial leader: node-2 at term 1
20:12:35.929 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:35.929 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
20:12:35.929 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:35.929 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:35.930 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:35.930 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:35.930 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:35.930 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:35.931 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:35.931 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:35.931 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:35.931 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:35.931 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:35.931 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:35.931 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:12:35.953 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:35.953 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:35.953 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:12:35.953 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
20:12:36.037 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:36.037 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:36.037 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:36.037 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:12:36.037 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:36.037 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-2
20:12:36.037 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Stopped leader: node-2
20:12:36.200 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:36.201 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:12:36.201 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:36.201 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:36.202 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19021
20:12:36.202 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19022
20:12:36.204 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: Vote request to node-2 failed
20:12:36.205 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:12:36.205 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:36.205 [grpc-default-executor-2] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:36.206 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
20:12:36.206 [grpc-default-executor-2] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:12:36.206 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=2) -> granted=true
20:12:36.206 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:36.206 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:12:36.206 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:12:36.206 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:36.248 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - New leader: node-3 at term 2
20:12:36.248 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
20:12:36.248 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
20:12:36.248 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:36.248 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:36.249 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.249 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:36.250 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.250 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:36.250 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:36.250 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:12:36.258 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:36.259 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:36.259 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
20:12:36.311 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:36.355 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:36.355 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:36.355 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:36.356 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:12:36.356 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:36.356 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:36.356 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:36.356 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:36.357 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:12:36.357 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:36.467 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:36.468 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19031
20:12:36.468 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:36.468 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:12:36.468 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:12:36.468 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:36.468 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:36.468 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:36.468 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19031
20:12:36.468 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:36.469 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19032
20:12:36.469 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:36.469 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:12:36.469 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:12:36.469 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:36.469 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:36.469 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:36.469 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19032
20:12:36.469 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:36.470 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19033
20:12:36.470 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:36.470 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
20:12:36.470 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
20:12:36.470 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:36.470 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:36.470 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:36.470 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19033
20:12:36.645 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:36.645 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:36.645 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:12:36.645 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:36.645 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:36.645 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19031
20:12:36.645 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19033
20:12:36.648 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:36.648 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:36.648 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:36.648 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:36.648 [grpc-default-executor-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:36.648 [grpc-default-executor-2] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:36.649 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:12:36.649 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:12:36.649 [grpc-default-executor-1] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:36.649 [grpc-default-executor-2] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:36.649 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
20:12:36.649 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:36.649 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
20:12:36.649 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:36.649 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:36.649 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:36.676 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:36.676 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
20:12:36.676 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:36.676 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
20:12:36.678 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.678 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.678 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:36.678 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:36.678 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.678 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.678 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
20:12:36.678 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:36.678 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:36.678 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:36.678 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:12:36.678 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:36.678 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
20:12:36.678 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:36.678 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
20:12:36.679 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.679 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.679 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:36.679 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:36.679 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:36.679 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:36.679 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:12:36.679 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
20:12:36.680 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.680 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:12:36.680 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.680 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:36.680 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
20:12:36.680 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:12:36.680 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
20:12:36.680 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
20:12:36.680 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
20:12:36.680 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
20:12:36.681 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.681 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.681 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:36.681 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
20:12:36.681 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:36.681 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:36.681 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:12:36.681 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
20:12:36.681 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.681 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.681 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
20:12:36.681 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
20:12:36.681 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:36.681 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
20:12:36.681 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:12:36.682 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
20:12:36.682 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
20:12:36.682 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
20:12:36.682 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
20:12:36.682 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.682 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.682 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:36.682 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
20:12:36.682 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:36.682 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
20:12:36.682 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:12:36.682 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
20:12:36.683 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.683 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.683 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
20:12:36.683 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
20:12:36.683 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:36.683 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
20:12:36.683 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:12:36.683 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
20:12:36.683 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
20:12:36.683 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
20:12:36.683 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
20:12:36.684 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.684 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.684 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:36.684 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
20:12:36.684 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:36.684 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
20:12:36.684 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:12:36.684 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
20:12:36.684 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.684 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.684 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
20:12:36.684 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
20:12:36.684 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:12:36.685 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
20:12:36.685 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:12:36.685 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
20:12:36.685 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
20:12:36.685 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
20:12:36.685 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
20:12:36.685 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.685 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:36.685 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:36.685 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.685 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
20:12:36.685 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
20:12:36.685 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:12:36.685 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
20:12:36.686 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.686 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.686 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
20:12:36.686 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
20:12:36.686 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:36.686 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
20:12:36.686 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:12:36.686 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
20:12:36.686 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
20:12:36.686 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
20:12:36.686 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
20:12:36.686 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.686 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:12:36.686 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:36.686 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.686 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
20:12:36.686 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
20:12:36.686 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:12:36.686 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
20:12:36.687 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.687 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
20:12:36.687 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
20:12:36.687 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.687 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
20:12:36.687 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:12:36.687 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
20:12:36.687 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
20:12:36.687 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
20:12:36.687 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
20:12:36.688 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.688 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.688 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:12:36.688 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:12:36.688 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
20:12:36.688 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
20:12:36.688 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:12:36.688 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
20:12:36.688 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.688 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
20:12:36.688 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
20:12:36.688 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.688 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
20:12:36.688 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:12:36.688 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
20:12:36.688 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
20:12:36.688 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
20:12:36.688 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
20:12:36.689 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.689 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.689 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:12:36.689 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
20:12:36.689 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:12:36.689 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
20:12:36.689 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:12:36.689 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
20:12:36.689 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.689 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.689 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
20:12:36.689 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
20:12:36.689 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:12:36.689 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
20:12:36.689 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:12:36.689 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
20:12:36.689 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
20:12:36.689 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
20:12:36.689 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
20:12:36.690 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.690 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.690 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:12:36.690 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
20:12:36.690 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:12:36.690 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
20:12:36.690 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:12:36.690 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
20:12:36.690 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.690 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.690 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
20:12:36.690 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
20:12:36.690 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:12:36.690 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
20:12:36.690 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:12:36.690 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
20:12:36.690 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key-10, value-10)
20:12:36.690 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
20:12:36.691 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=11)
20:12:36.691 [grpc-default-executor-0] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.691 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.691 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
20:12:36.691 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
20:12:36.691 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:12:36.691 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
20:12:36.691 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:12:36.691 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
20:12:36.691 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.691 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
20:12:36.691 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.691 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
20:12:36.691 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=11
20:12:36.691 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
20:12:36.691 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
20:12:36.691 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key-11, value-11)
20:12:36.691 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=12)
20:12:36.692 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=12)
20:12:36.692 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.692 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
20:12:36.692 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
20:12:36.692 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
20:12:36.692 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.692 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
20:12:36.692 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
20:12:36.692 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
20:12:36.692 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.692 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.692 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
20:12:36.692 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
20:12:36.692 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=12
20:12:36.692 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
20:12:36.692 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
20:12:36.692 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key-12, value-12)
20:12:36.692 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=13)
20:12:36.692 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=13)
20:12:36.693 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.693 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
20:12:36.693 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
20:12:36.693 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.693 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
20:12:36.693 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
20:12:36.693 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
20:12:36.693 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
20:12:36.693 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.693 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.693 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=13
20:12:36.693 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
20:12:36.693 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
20:12:36.693 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
20:12:36.693 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
20:12:36.694 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key-13, value-13)
20:12:36.694 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=14)
20:12:36.694 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=14)
20:12:36.694 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.694 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
20:12:36.694 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:12:36.694 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.694 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
20:12:36.694 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
20:12:36.694 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
20:12:36.694 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
20:12:36.694 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.694 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
20:12:36.694 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
20:12:36.694 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.694 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
20:12:36.695 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=14
20:12:36.695 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
20:12:36.695 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key-14, value-14)
20:12:36.695 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=15)
20:12:36.695 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=15)
20:12:36.695 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.695 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.695 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
20:12:36.695 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
20:12:36.695 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
20:12:36.695 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
20:12:36.695 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
20:12:36.695 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
20:12:36.696 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.696 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.696 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
20:12:36.696 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=15
20:12:36.696 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
20:12:36.696 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
20:12:36.696 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
20:12:36.696 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
20:12:36.696 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(key-15, value-15)
20:12:36.696 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
20:12:36.696 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=16)
20:12:36.696 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.696 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.696 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
20:12:36.696 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:12:36.696 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
20:12:36.696 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
20:12:36.696 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
20:12:36.696 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
20:12:36.697 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.697 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.697 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=16
20:12:36.697 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
20:12:36.697 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
20:12:36.697 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
20:12:36.697 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
20:12:36.697 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(key-16, value-16)
20:12:36.697 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
20:12:36.697 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=17)
20:12:36.697 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.697 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.697 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
20:12:36.697 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
20:12:36.697 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
20:12:36.697 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
20:12:36.697 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
20:12:36.697 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
20:12:36.698 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.698 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.698 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
20:12:36.698 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
20:12:36.698 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=17
20:12:36.698 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
20:12:36.698 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
20:12:36.698 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(key-17, value-17)
20:12:36.698 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=18)
20:12:36.698 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=18)
20:12:36.698 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.698 [grpc-default-executor-4] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.698 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
20:12:36.698 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
20:12:36.698 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
20:12:36.698 [grpc-default-executor-4] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
20:12:36.698 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
20:12:36.698 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
20:12:36.698 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.698 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=18
20:12:36.699 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.699 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
20:12:36.699 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=18
20:12:36.699 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
20:12:36.699 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
20:12:36.699 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(key-18, value-18)
20:12:36.699 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=19)
20:12:36.699 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=19)
20:12:36.699 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.699 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
20:12:36.699 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
20:12:36.699 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
20:12:36.699 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.699 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
20:12:36.699 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
20:12:36.699 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
20:12:36.699 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.699 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=19
20:12:36.700 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
20:12:36.700 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
20:12:36.700 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
20:12:36.700 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.700 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(key-19, value-19)
20:12:36.700 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
20:12:36.700 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-3 (nextIndex=19)
20:12:36.700 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
20:12:36.700 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=20)
20:12:36.700 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=20)
20:12:36.700 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.700 [grpc-default-executor-4] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:36.700 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:12:36.700 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:12:36.700 [grpc-default-executor-4] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
20:12:36.700 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
20:12:36.700 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
20:12:36.701 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
20:12:36.701 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
20:12:36.701 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
20:12:36.701 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=2) -> success=true
20:12:36.701 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
20:12:36.701 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
20:12:36.701 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
20:12:36.701 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
20:12:36.701 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.701 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
20:12:36.701 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
20:12:36.756 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:12:36.756 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
20:12:36.756 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
20:12:36.756 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
20:12:36.809 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - All 20 writes replicated
20:12:36.809 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:36.809 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:36.809 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:36.811 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:12:36.811 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:36.811 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:36.811 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:36.811 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:36.812 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:12:36.812 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:36.812 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:36.812 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:36.812 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:36.812 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:12:36.812 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:36.918 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:36.921 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19041
20:12:36.922 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:36.922 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:12:36.922 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:12:36.922 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:36.922 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:36.922 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:36.922 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19041
20:12:36.922 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:36.923 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19042
20:12:36.923 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:36.924 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:12:36.924 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:12:36.924 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:36.924 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:36.924 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:36.924 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19042
20:12:36.924 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:36.926 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19043
20:12:36.926 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:36.927 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
20:12:36.927 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
20:12:36.927 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:36.927 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:36.927 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:36.927 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19043
20:12:37.125 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:37.126 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:37.128 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:12:37.128 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:37.128 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:37.128 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19043
20:12:37.128 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19041
20:12:37.134 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:37.135 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:37.135 [grpc-default-executor-5] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:37.135 [grpc-default-executor-5] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:37.135 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:37.135 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:37.135 [grpc-default-executor-6] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:37.136 [grpc-default-executor-5] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
20:12:37.136 [grpc-default-executor-5] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:37.136 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:12:37.135 [election-node-3] [node-3] ERROR com.raftdb.core.RaftNode - Failed to persist meta
java.nio.file.NoSuchFileException: target/grpc-test-data/node-3/meta.dat.tmp -> target/grpc-test-data/node-3/meta.dat
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixFileSystem.move(UnixFileSystem.java:823)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:289)
	at java.base/java.nio.file.Files.move(Files.java:1319)
	at com.raftdb.persistence.PersistenceManager.saveMeta(PersistenceManager.java:98)
	at com.raftdb.core.RaftNode.lambda$initialize$0(RaftNode.java:172)
	at com.raftdb.core.RaftState.persist(RaftState.java:52)
	at com.raftdb.core.RaftState.incrementTerm(RaftState.java:86)
	at com.raftdb.election.ElectionManager.startElection(ElectionManager.java:147)
	at com.raftdb.election.ElectionManager.onElectionTimeout(ElectionManager.java:139)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:545)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:309)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
20:12:37.136 [grpc-default-executor-6] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:37.137 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
20:12:37.137 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
20:12:37.137 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:37.138 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:37.138 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:37.138 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:37.139 [] [node-2] INFO  c.r.replication.ReplicationManager - Discovered higher term 2 from node-3
20:12:37.140 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
20:12:37.140 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:37.140 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:37.330 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:37.332 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
20:12:37.333 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:37.333 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:37.333 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19043
20:12:37.334 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19042
20:12:37.339 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:12:37.339 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=2) -> granted=false
20:12:37.339 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
20:12:37.339 [grpc-default-executor-6] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
20:12:37.340 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=2) -> granted=true
20:12:37.340 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:37.340 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:12:37.340 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:12:37.340 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:37.341 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 2
20:12:37.341 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(restart-test, initial)
20:12:37.341 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:37.341 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:37.342 [grpc-default-executor-5] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:37.342 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:37.342 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:37.342 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:37.342 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:12:37.343 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:37.343 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:37.343 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
20:12:37.343 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
20:12:37.343 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:37.402 [grpc-default-executor-5] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:37.402 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:37.402 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
20:12:37.404 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
20:12:37.457 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Restarting follower: node-2 on port 19042
20:12:37.457 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:37.457 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:37.457 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:37.458 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:12:37.458 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:37.458 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-2
20:12:37.569 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
20:12:37.569 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during-downtime, value)
20:12:37.569 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:37.570 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:37.577 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:37.577 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:37.578 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:12:37.578 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
20:12:37.578 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:37.578 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
20:12:37.579 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:37.579 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19042
20:12:37.579 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:37.579 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=2, votedFor=node-1
20:12:37.579 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:12:37.579 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:12:37.580 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
20:12:37.580 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
20:12:37.580 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 1 to recover state machine
20:12:37.580 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
20:12:37.580 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=2, votedFor=node-1, lastLogIndex=1
20:12:37.580 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:37.580 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:37.580 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Restarted node node-2 on port 19042
20:12:37.594 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:37.595 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:37.595 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
20:12:37.645 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:37.690 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:37.747 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:37.793 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:37.823 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:37.826 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
20:12:37.827 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
20:12:37.827 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:37.828 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19041
20:12:37.828 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19043
20:12:37.845 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:37.856 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=null
20:12:37.856 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:37.856 [grpc-default-executor-2] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:37.857 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=null
20:12:37.858 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:37.858 [grpc-default-executor-6] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:37.858 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-2
20:12:37.864 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=true, logUpToDate=false
20:12:37.874 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-2
20:12:37.879 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=true, logUpToDate=false
20:12:37.881 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=3) -> granted=false
20:12:37.883 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=3) -> granted=false
20:12:38.073 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:38.077 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-2
20:12:38.077 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
20:12:38.077 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:38.077 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19041
20:12:38.078 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19042
20:12:38.079 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:38.091 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:12:38.091 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=4) -> granted=false
20:12:38.091 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-1
20:12:38.091 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
20:12:38.092 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:38.092 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=null
20:12:38.092 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:38.092 [grpc-default-executor-0] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:38.092 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-3
20:12:38.092 [grpc-default-executor-0] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 4
20:12:38.092 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=false
20:12:38.093 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=4) -> granted=true
20:12:38.093 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:38.093 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 4
20:12:38.093 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 4
20:12:38.093 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:38.093 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=4) -> granted=false
20:12:38.093 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-2
20:12:38.093 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=true, logUpToDate=false
20:12:38.093 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=4) -> granted=false
20:12:38.093 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Missing entry at index 2
20:12:38.094 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 failed, nextIndex decremented to 2
20:12:38.144 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:38.153 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:38.153 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:38.153 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:38.160 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
20:12:38.162 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 AppendEntries(entries=1) -> success=true
20:12:38.162 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
20:12:38.204 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Restarted node caught up successfully
20:12:38.205 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:38.205 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:38.205 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:38.208 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:12:38.208 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:38.208 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:38.208 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:38.208 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:38.209 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:12:38.209 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:38.209 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:38.209 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:38.210 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:38.210 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:12:38.210 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:38.314 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:38.315 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19051
20:12:38.315 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:38.315 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:12:38.315 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:12:38.315 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:38.315 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:38.315 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:38.316 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19051
20:12:38.316 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:38.316 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19052
20:12:38.316 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:38.316 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
20:12:38.316 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
20:12:38.316 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:38.316 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:38.316 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:38.316 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19052
20:12:38.317 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:38.317 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19053
20:12:38.317 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:38.317 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
20:12:38.317 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
20:12:38.317 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:38.317 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:38.319 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:38.319 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19053
20:12:38.319 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:12:38.326 [main] [node-4] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19054
20:12:38.327 [main] [node-4] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-4
20:12:38.327 [main] [node-4] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-4
20:12:38.327 [main] [node-4] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-4
20:12:38.327 [main] [node-4] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:38.327 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:38.328 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 initialized as FOLLOWER
20:12:38.328 [main] [node-4] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-4 on port 19054
20:12:38.328 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:12:38.329 [main] [node-5] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19055
20:12:38.329 [main] [node-5] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-5
20:12:38.329 [main] [node-5] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-5
20:12:38.329 [main] [node-5] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-5
20:12:38.329 [main] [node-5] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:38.329 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:38.329 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 initialized as FOLLOWER
20:12:38.329 [main] [node-5] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-5 on port 19055
20:12:38.486 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:38.489 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:38.501 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:38.502 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:38.502 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:12:38.504 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-4 at localhost:19054
20:12:38.504 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-5 at localhost:19055
20:12:38.504 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19052
20:12:38.512 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19053
20:12:38.513 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:38.514 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:38.518 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
20:12:38.518 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:38.518 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:12:38.522 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-4 at localhost:19054
20:12:38.522 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-5 at localhost:19055
20:12:38.522 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19051
20:12:38.522 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19052
20:12:38.537 [grpc-default-executor-4] [node-4] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:38.537 [grpc-default-executor-4] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:38.537 [grpc-default-executor-4] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:38.538 [grpc-default-executor-4] [node-4] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:38.538 [grpc-default-executor-4] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:38.539 [grpc-default-executor-8] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:12:38.539 [grpc-default-executor-0] [node-5] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:38.539 [grpc-default-executor-0] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:38.539 [grpc-default-executor-13] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
20:12:38.539 [grpc-default-executor-0] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:38.540 [grpc-default-executor-11] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:38.540 [grpc-default-executor-11] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:38.540 [grpc-default-executor-11] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:38.540 [grpc-default-executor-1] [node-4] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:12:38.540 [grpc-default-executor-0] [node-5] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:38.540 [grpc-default-executor-0] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:38.540 [grpc-default-executor-11] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:38.540 [grpc-default-executor-11] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:38.541 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=false
20:12:38.541 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-4 VoteRequest(term=1) -> granted=true
20:12:38.541 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:12:38.541 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=false
20:12:38.541 [grpc-default-executor-14] [node-5] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:12:38.541 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-4 VoteRequest(term=1) -> granted=false
20:12:38.541 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-5 VoteRequest(term=1) -> granted=true
20:12:38.541 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
20:12:38.541 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:12:38.541 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:38.541 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:38.541 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:38.542 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-5 VoteRequest(term=1) -> granted=false
20:12:38.542 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
20:12:38.543 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=false
20:12:38.647 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:38.648 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(five-node-test, value)
20:12:38.648 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
20:12:38.648 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
20:12:38.648 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
20:12:38.648 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
20:12:38.650 [grpc-default-executor-5] [node-4] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:38.650 [grpc-default-executor-5] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:38.650 [grpc-default-executor-3] [node-5] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:38.650 [grpc-default-executor-3] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:38.650 [grpc-default-executor-14] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:38.651 [grpc-default-executor-14] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:38.651 [grpc-default-executor-5] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:38.651 [grpc-default-executor-5] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
20:12:38.652 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-4 AppendEntries(entries=1) -> success=true
20:12:38.652 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
20:12:38.653 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
20:12:38.653 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
20:12:38.653 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:38.653 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
20:12:38.653 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
20:12:38.653 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-5 AppendEntries(entries=1) -> success=true
20:12:38.653 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
20:12:38.654 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
20:12:38.704 [grpc-default-executor-13] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:38.704 [grpc-default-executor-12] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:38.705 [grpc-default-executor-14] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:38.705 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
20:12:38.705 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
20:12:38.706 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
20:12:38.707 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
20:12:38.707 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
20:12:38.761 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:38.761 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:38.762 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:38.763 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
20:12:38.763 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:38.763 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-2
20:12:38.763 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:38.763 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:38.764 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:38.766 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
20:12:38.766 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:38.766 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-3
20:12:38.767 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Stopped two followers: node-2 and node-3
20:12:38.875 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
20:12:38.875 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failures, still-working)
20:12:38.876 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:38.876 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
20:12:38.876 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
20:12:38.876 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:38.879 [grpc-default-executor-9] [node-5] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:38.879 [grpc-default-executor-11] [node-4] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
20:12:38.880 [grpc-default-executor-11] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:38.880 [grpc-default-executor-9] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
20:12:38.882 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-5 AppendEntries(entries=1) -> success=true
20:12:38.882 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-4 AppendEntries(entries=1) -> success=true
20:12:38.882 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
20:12:38.882 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
20:12:38.882 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
20:12:38.882 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
20:12:38.896 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:38.897 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:38.900 [grpc-default-executor-4] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:38.900 [grpc-default-executor-9] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
20:12:38.900 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
20:12:38.901 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
20:12:38.945 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
20:12:38.945 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
20:12:38.986 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Five-node cluster survived two failures
20:12:38.986 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:38.986 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:38.986 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:38.993 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:12:38.993 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:38.993 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:12:38.993 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:38.993 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:38.998 [main] [node-4] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-4
20:12:38.998 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:12:38.998 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:12:38.998 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:38.998 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:38.998 [main] [node-5] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-5
20:12:38.999 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:12:39.108 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:39.109 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19061
20:12:39.109 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:39.109 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
20:12:39.110 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
20:12:39.110 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
20:12:39.110 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:39.110 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:39.110 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19061
20:12:39.296 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:39.298 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
20:12:39.298 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
20:12:39.298 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:39.298 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
20:12:39.298 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:39.298 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:39.298 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:39.315 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
20:12:39.315 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(single, node)
20:12:39.315 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
20:12:39.316 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(single, node)
20:12:39.316 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Single node cluster works
20:12:39.316 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:39.316 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:39.317 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:39.317 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
20:12:39.317 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:39.423 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:39.423 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:39.423 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:39.423 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:39.423 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:39.423 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:39.423 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:39.423 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:39.423 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:39.423 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:39.423 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:39.423 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:39.423 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:39.423 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:39.423 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:39.582 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:39.584 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:39.584 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:39.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:12:39.592 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:39.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:12:39.592 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:39.592 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:39.592 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:39.592 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:39.592 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:39.593 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:12:39.592 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:12:39.593 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:39.593 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:39.593 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:39.593 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:39.647 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-2 (term 1)
20:12:39.850 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - All nodes agree on leader: node-2
20:12:39.850 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:39.850 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:39.850 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:39.850 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:39.850 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:39.850 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:39.850 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:39.850 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:39.850 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:39.850 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:39.850 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:39.850 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:39.850 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:39.850 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:39.850 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:39.852 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:39.852 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:39.852 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:39.852 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:39.852 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:39.852 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:39.852 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:39.852 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:39.852 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:39.852 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:39.852 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:39.852 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:39.852 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:39.852 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:39.852 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:39.852 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
20:12:39.852 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
20:12:39.852 [main] [node-4] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-4
20:12:39.852 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:39.852 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 initialized as FOLLOWER
20:12:39.852 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
20:12:39.852 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
20:12:39.852 [main] [node-5] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-5
20:12:39.852 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:39.852 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 initialized as FOLLOWER
20:12:40.018 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:40.018 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:40.018 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
20:12:40.018 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:12:40.018 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:40.018 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.018 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:40.018 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:12:40.018 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:40.018 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.018 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:12:40.018 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 VoteRequest(term=1)
20:12:40.018 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 VoteRequest(term=1)
20:12:40.018 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:40.019 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:40.019 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.019 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:40.019 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-5 VoteResponse(granted=true)
20:12:40.019 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:40.019 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.019 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:40.019 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
20:12:40.019 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:12:40.019 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
20:12:40.019 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:40.019 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-4 VoteResponse(granted=true)
20:12:40.019 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:40.019 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:40.062 [main] [node-5] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-2 (term 1)
20:12:40.063 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:40.063 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.063 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:40.063 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:40.063 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:40.063 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:40.063 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.063 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:40.063 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:40.063 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:40.063 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:40.063 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.063 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:40.063 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:40.063 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:40.063 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
20:12:40.063 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.063 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:40.063 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
20:12:40.063 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
20:12:40.063 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
20:12:40.063 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.063 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:40.063 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
20:12:40.064 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
20:12:40.065 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:40.065 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:40.065 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:40.065 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:40.066 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:40.066 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:40.066 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:40.066 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:40.066 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:40.066 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:40.066 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:40.066 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:40.066 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:40.066 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:40.066 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:40.316 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:40.316 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:40.316 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:40.316 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
20:12:40.316 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:40.316 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.316 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
20:12:40.316 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:40.316 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:40.316 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.316 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
20:12:40.316 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
20:12:40.316 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:40.316 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
20:12:40.316 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:40.316 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:40.316 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:40.887 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader node-1 maintained leadership for 500ms
20:12:40.888 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:40.888 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.888 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:40.888 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:40.888 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:40.888 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:40.888 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.888 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:40.888 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:40.888 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:40.888 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:40.888 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:40.888 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:40.888 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:40.888 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
20:12:40.891 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
20:12:40.891 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
20:12:40.891 [main] [node-1] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-1
20:12:40.891 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:40.891 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 initialized as FOLLOWER
20:12:40.891 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
20:12:40.891 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
20:12:40.891 [main] [node-2] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-2
20:12:40.891 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:40.891 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 initialized as FOLLOWER
20:12:40.891 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
20:12:40.891 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
20:12:40.891 [main] [node-3] INFO  com.raftdb.core.RaftNode - Initializing RaftNode node-3
20:12:40.891 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
20:12:40.891 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 initialized as FOLLOWER
20:12:41.055 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:41.056 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
20:12:41.056 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:41.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
20:12:41.056 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:41.056 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:41.056 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:41.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
20:12:41.056 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:41.056 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
20:12:41.056 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:41.056 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:41.056 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
20:12:41.056 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
20:12:41.056 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
20:12:41.056 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
20:12:41.056 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:41.098 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Initial leader: node-2 (term 1)
20:12:41.098 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
20:12:41.098 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:41.098 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:41.098 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
20:12:41.098 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
20:12:41.222 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
20:12:41.222 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
20:12:41.222 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
20:12:41.222 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=2)
20:12:41.222 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
20:12:41.222 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:41.222 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: java.lang.RuntimeException: Node not found: node-2
20:12:41.222 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
20:12:41.222 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
20:12:41.222 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
20:12:41.222 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
20:12:41.222 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
20:12:41.222 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
20:12:41.308 [main] [node-2] INFO  com.raftdb.integration.ClusterTest - New leader: node-3 (term 2)
20:12:41.309 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
20:12:41.309 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:41.309 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:41.309 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
20:12:41.309 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
20:12:41.309 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
20:12:41.309 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
20:12:41.309 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
20:12:41.309 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
20:12:41.309 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped

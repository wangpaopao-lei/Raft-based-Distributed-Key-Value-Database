19:47:04.897 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:04.903 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:04.904 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:04.904 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:04.904 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:04.904 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:04.904 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:04.904 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:04.905 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:04.905 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:04.905 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:04.905 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:05.121 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:05.121 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:05.126 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:05.128 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:47:05.129 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:05.129 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.129 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:05.129 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:47:05.129 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:05.129 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:47:05.130 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:05.130 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:05.130 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:05.133 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.133 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:05.133 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:05.133 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:47:05.228 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:05.228 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key3, value3)
19:47:05.231 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:05.232 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:05.232 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:47:05.232 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:47:05.232 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:05.232 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:05.232 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:05.232 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:05.232 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:05.232 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:05.233 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
19:47:05.235 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:05.236 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:05.236 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
19:47:05.236 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key3, value3)
19:47:05.252 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:05.253 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: DELETE(key3)
19:47:05.253 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:05.253 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:05.253 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:47:05.253 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:47:05.253 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:05.253 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:05.254 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:47:05.254 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:05.254 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:05.254 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:05.254 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
19:47:05.290 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:05.291 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:05.291 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
19:47:05.291 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: DELETE(key3)
19:47:05.362 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:05.362 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.363 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:05.363 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:05.363 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:05.363 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:05.363 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.363 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:05.363 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:05.363 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:05.363 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:05.363 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.363 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:05.363 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:05.363 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:05.368 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:05.369 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:05.369 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:05.369 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:05.369 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:05.369 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:05.369 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:05.369 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:05.370 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:05.370 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:05.370 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:05.371 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:05.558 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:05.558 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:05.558 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:05.558 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:05.558 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:05.558 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:05.558 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:05.558 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.558 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.558 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:05.559 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:05.559 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:05.559 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:05.559 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:05.559 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:05.559 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:05.559 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:05.582 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:05.582 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(concurrent-0, value-0)
19:47:05.582 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:05.582 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:05.582 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(concurrent-1, value-1)
19:47:05.582 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:05.582 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=1)
19:47:05.582 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:05.582 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(concurrent-2, value-2)
19:47:05.582 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:05.583 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=1)
19:47:05.583 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.583 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:05.583 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=1)
19:47:05.583 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 2
19:47:05.583 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:05.583 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=1)
19:47:05.583 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.583 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(concurrent-3, value-3)
19:47:05.583 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
19:47:05.583 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.583 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:05.583 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:47:05.583 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:05.583 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
19:47:05.583 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-2 (nextIndex=1)
19:47:05.583 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(concurrent-4, value-4)
19:47:05.583 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 2
19:47:05.583 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.584 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=4)
19:47:05.583 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=3)
19:47:05.584 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:05.584 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 3
19:47:05.584 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 4
19:47:05.584 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 3
19:47:05.584 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(concurrent-5, value-5)
19:47:05.584 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:47:05.584 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.584 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
19:47:05.584 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=4)
19:47:05.584 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=4)
19:47:05.584 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 4
19:47:05.584 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=3)
19:47:05.584 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
19:47:05.584 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.584 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:05.585 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
19:47:05.584 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:47:05.584 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 4
19:47:05.585 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 6
19:47:05.584 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.585 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 6
19:47:05.585 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=5)
19:47:05.585 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=5)
19:47:05.585 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(concurrent-6, value-6)
19:47:05.585 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:05.585 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:47:05.585 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.585 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.585 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:05.585 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 7
19:47:05.585 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 7
19:47:05.585 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:47:05.585 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:05.585 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:47:05.585 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 6
19:47:05.585 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=5)
19:47:05.585 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:05.585 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
19:47:05.585 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:47:05.585 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
19:47:05.586 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(concurrent-7, value-7)
19:47:05.586 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
19:47:05.586 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 7
19:47:05.586 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
19:47:05.586 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
19:47:05.586 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.586 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:05.586 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:47:05.586 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(concurrent-0, value-0)
19:47:05.586 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 7
19:47:05.586 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
19:47:05.586 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:05.586 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(concurrent-1, value-1)
19:47:05.586 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 7
19:47:05.586 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 7
19:47:05.586 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 7
19:47:05.586 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:47:05.586 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
19:47:05.586 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:05.587 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
19:47:05.586 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
19:47:05.586 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(concurrent-2, value-2)
19:47:05.587 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(concurrent-8, value-8)
19:47:05.587 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
19:47:05.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=7)
19:47:05.587 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
19:47:05.587 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:47:05.587 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:05.587 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(concurrent-3, value-3)
19:47:05.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=8)
19:47:05.587 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
19:47:05.587 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.587 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.587 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(concurrent-9, value-9)
19:47:05.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=9)
19:47:05.587 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 9
19:47:05.587 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:05.587 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 9
19:47:05.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=9)
19:47:05.587 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:47:05.587 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
19:47:05.587 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:05.587 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:47:05.587 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=8)
19:47:05.587 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
19:47:05.587 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:47:05.588 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.588 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(concurrent-10, value-10)
19:47:05.588 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 10
19:47:05.588 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 10
19:47:05.588 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
19:47:05.588 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:05.588 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 10
19:47:05.588 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=10)
19:47:05.588 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
19:47:05.588 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(concurrent-4, value-4)
19:47:05.588 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.588 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:05.588 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
19:47:05.588 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=9)
19:47:05.588 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:05.588 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:47:05.588 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(concurrent-5, value-5)
19:47:05.588 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:05.588 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=11)
19:47:05.588 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
19:47:05.588 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
19:47:05.588 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 11
19:47:05.588 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:47:05.588 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
19:47:05.588 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=11
19:47:05.588 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.589 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
19:47:05.588 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(concurrent-11, value-11)
19:47:05.589 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 12
19:47:05.588 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(concurrent-6, value-6)
19:47:05.588 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
19:47:05.588 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:05.588 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:05.589 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(concurrent-7, value-7)
19:47:05.589 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 12
19:47:05.589 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 11
19:47:05.589 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:47:05.589 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:05.589 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
19:47:05.589 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=12)
19:47:05.589 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(concurrent-12, value-12)
19:47:05.589 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
19:47:05.589 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:47:05.589 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
19:47:05.589 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(concurrent-13, value-13)
19:47:05.589 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
19:47:05.589 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:05.589 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
19:47:05.589 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=13)
19:47:05.589 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=12)
19:47:05.589 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:47:05.589 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=12)
19:47:05.589 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:47:05.590 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
19:47:05.590 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.590 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:05.590 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=13)
19:47:05.590 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=3)
19:47:05.590 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
19:47:05.590 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(concurrent-14, value-14)
19:47:05.590 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:47:05.590 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:05.590 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:47:05.590 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
19:47:05.590 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 14
19:47:05.590 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=13)
19:47:05.590 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:47:05.590 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.590 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 14
19:47:05.590 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=13
19:47:05.590 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=12)
19:47:05.590 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 14
19:47:05.590 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=12
19:47:05.590 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
19:47:05.590 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=14)
19:47:05.590 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(concurrent-8, value-8)
19:47:05.590 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:47:05.590 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(concurrent-15, value-15)
19:47:05.591 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(concurrent-9, value-9)
19:47:05.591 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
19:47:05.590 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=14
19:47:05.591 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:47:05.591 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(concurrent-16, value-16)
19:47:05.590 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.591 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
19:47:05.590 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
19:47:05.590 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
19:47:05.591 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:47:05.591 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=15)
19:47:05.591 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 15
19:47:05.590 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(concurrent-10, value-10)
19:47:05.591 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
19:47:05.591 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.591 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=15)
19:47:05.591 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:47:05.591 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(concurrent-11, value-11)
19:47:05.591 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 16
19:47:05.591 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=16)
19:47:05.591 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
19:47:05.591 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(concurrent-17, value-17)
19:47:05.591 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=16
19:47:05.591 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 15
19:47:05.591 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 16
19:47:05.591 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
19:47:05.591 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=15
19:47:05.591 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
19:47:05.592 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
19:47:05.591 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=15
19:47:05.592 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 18
19:47:05.591 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-2 (nextIndex=16)
19:47:05.592 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
19:47:05.591 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.591 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.592 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:47:05.591 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(concurrent-12, value-12)
19:47:05.592 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 18
19:47:05.592 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
19:47:05.592 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(concurrent-18, value-18)
19:47:05.592 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=18
19:47:05.592 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=16)
19:47:05.592 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 18
19:47:05.592 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
19:47:05.592 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=18
19:47:05.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=3)
19:47:05.592 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 18
19:47:05.592 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(concurrent-13, value-13)
19:47:05.592 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
19:47:05.592 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=4)
19:47:05.592 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(concurrent-19, value-19)
19:47:05.592 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=19)
19:47:05.592 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=19)
19:47:05.593 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 4 entries, last index now 19
19:47:05.592 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 3 entries, last index now 18
19:47:05.593 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=19)
19:47:05.593 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:47:05.593 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.593 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
19:47:05.593 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:47:05.593 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
19:47:05.593 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
19:47:05.593 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
19:47:05.593 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:47:05.593 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=19)
19:47:05.593 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
19:47:05.593 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=2)
19:47:05.593 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:47:05.593 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:47:05.593 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=19
19:47:05.593 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
19:47:05.593 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(concurrent-14, value-14)
19:47:05.593 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-2 (nextIndex=19)
19:47:05.593 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
19:47:05.593 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 20
19:47:05.593 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
19:47:05.593 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
19:47:05.593 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
19:47:05.593 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
19:47:05.593 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 20
19:47:05.593 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(concurrent-15, value-15)
19:47:05.593 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=2)
19:47:05.593 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
19:47:05.593 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
19:47:05.594 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 2 entries, last index now 20
19:47:05.594 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
19:47:05.594 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(concurrent-16, value-16)
19:47:05.594 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(concurrent-17, value-17)
19:47:05.613 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:47:05.613 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:47:05.613 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
19:47:05.614 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(concurrent-18, value-18)
19:47:05.614 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
19:47:05.614 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(concurrent-19, value-19)
19:47:05.697 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:05.697 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.697 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:05.697 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:05.697 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:05.697 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:05.697 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.697 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:05.697 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:05.697 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:05.697 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:05.697 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.698 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:05.698 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:05.698 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:05.699 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:05.699 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:05.699 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:05.699 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:05.699 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:05.700 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:05.700 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:05.700 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:05.700 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:05.700 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:05.700 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:05.700 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:05.969 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:05.969 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:05.970 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:05.970 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:05.970 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:05.970 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.970 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:05.970 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:05.970 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:05.970 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:05.970 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:05.970 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:05.970 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:05.970 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:05.970 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:05.970 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:05.970 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:06.016 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:06.016 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key2, value2)
19:47:06.017 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:06.017 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.017 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:06.017 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:06.017 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:06.017 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:06.018 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.018 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:06.018 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:06.018 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
19:47:06.021 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:06.021 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:06.022 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
19:47:06.022 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key2, value2)
19:47:06.125 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:06.125 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.125 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:06.125 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:06.125 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:06.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:06.126 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.126 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:06.126 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:06.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:06.126 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:06.126 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.126 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:06.126 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:06.126 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:06.128 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:06.129 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:06.129 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:06.129 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:06.129 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:06.129 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:06.129 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:06.129 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:06.129 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:06.129 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:06.129 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:06.129 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:06.308 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:06.309 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:06.309 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:06.309 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:06.309 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:06.309 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:06.309 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:06.309 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.309 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.309 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:06.309 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:06.309 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:06.309 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:06.309 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:06.309 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:06.309 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:06.309 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:06.334 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:06.334 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
19:47:06.334 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:06.334 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:06.334 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.335 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.335 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:06.335 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:06.335 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:06.335 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:06.335 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:06.335 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:06.335 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:47:06.365 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:06.365 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:06.365 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:47:06.365 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:47:06.441 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Killing leader: node-3
19:47:06.441 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:06.441 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.441 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:06.441 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:06.441 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:06.583 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:06.584 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:06.584 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:06.584 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=2)
19:47:06.584 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:06.584 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.584 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
19:47:06.584 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:47:06.584 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:06.584 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:06.584 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:06.584 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:06.584 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-3: java.lang.RuntimeException: Node not found: node-3
19:47:06.650 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - New leader: node-1
19:47:06.651 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
19:47:06.651 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
19:47:06.651 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:06.652 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:06.652 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=2, entries=1)
19:47:06.652 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:06.652 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:47:06.652 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:06.652 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:47:06.689 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:06.689 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:06.690 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:47:06.735 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:06.758 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:06.758 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.758 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:06.759 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:06.759 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:06.759 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:06.759 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.759 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:06.759 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:06.759 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:06.760 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:06.760 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:06.760 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:06.760 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:06.760 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:06.760 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:06.760 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:06.760 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:06.761 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:06.761 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:06.761 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:06.761 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:06.929 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:06.929 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:06.929 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:06.929 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:06.929 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:06.929 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.929 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:06.929 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:06.929 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:06.929 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:06.929 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:06.929 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:06.929 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:06.929 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:06.929 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:06.929 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:06.929 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:06.972 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:06.972 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
19:47:06.973 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:06.973 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:06.973 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.973 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.973 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:06.973 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:06.973 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:06.974 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:06.974 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:06.974 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:47:06.974 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:06.974 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
19:47:06.975 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:06.975 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:06.975 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.975 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.975 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:06.975 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:06.975 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:06.975 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:06.976 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:47:06.976 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:06.976 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:06.976 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:06.976 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:47:06.976 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:47:06.976 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:47:06.976 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:06.976 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
19:47:06.976 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:47:06.976 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
19:47:06.976 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.976 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.977 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:06.977 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:06.977 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:06.977 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:06.977 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:47:06.977 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:47:06.977 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:47:06.977 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:47:06.977 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:06.977 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:06.977 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:47:06.977 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:06.977 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
19:47:06.977 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
19:47:06.977 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
19:47:06.977 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.978 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.978 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:06.978 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:06.978 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:06.978 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:47:06.978 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:47:06.978 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:06.978 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:06.978 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
19:47:06.978 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:47:06.978 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:47:06.978 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:06.978 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
19:47:06.978 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
19:47:06.978 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
19:47:06.978 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.979 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.979 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:06.979 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:06.979 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:06.979 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
19:47:06.979 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:47:06.979 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:06.979 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:06.979 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:47:06.979 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:47:06.979 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
19:47:06.979 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:06.979 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
19:47:06.979 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
19:47:06.979 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
19:47:06.979 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.979 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:06.979 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:06.979 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:47:06.979 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.979 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
19:47:06.979 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:06.979 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:06.979 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:06.979 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:47:06.980 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:47:06.980 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:47:06.980 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:06.980 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:47:06.980 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:06.980 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
19:47:06.980 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:47:06.980 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:47:06.980 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
19:47:06.980 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
19:47:06.980 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.980 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:47:06.980 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.980 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
19:47:06.980 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:47:06.980 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:47:06.980 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
19:47:06.980 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:47:06.980 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:47:06.980 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
19:47:06.980 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
19:47:06.981 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
19:47:06.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.981 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:06.981 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:06.981 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:06.981 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:06.981 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
19:47:06.981 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:47:06.981 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:06.981 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
19:47:06.981 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:47:06.981 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:47:06.981 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:47:06.981 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
19:47:06.981 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
19:47:06.981 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
19:47:06.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.981 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.981 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:47:06.981 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:47:06.981 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:06.981 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:06.981 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
19:47:06.981 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:47:06.981 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:06.982 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
19:47:06.982 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:47:06.982 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:47:06.982 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:47:06.982 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
19:47:06.982 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
19:47:06.982 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
19:47:06.982 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:06.982 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:47:06.982 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:06.982 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:06.982 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
19:47:06.982 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:47:06.982 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:06.982 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:47:06.982 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:47:06.982 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:06.982 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
19:47:06.982 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:47:07.035 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:47:07.035 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:47:07.035 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:47:07.035 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:47:07.088 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:07.088 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.089 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.089 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:07.089 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:07.089 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:07.089 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.089 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.089 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:07.089 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:07.089 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:07.089 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.089 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.089 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:07.089 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:07.091 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:07.091 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:07.091 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.092 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:07.092 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:07.092 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:07.092 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.092 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:07.092 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:07.092 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:07.092 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.092 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:07.248 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:07.248 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:07.248 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:07.248 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:47:07.248 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:47:07.248 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.248 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.248 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.248 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.248 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:07.248 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:07.248 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:47:07.248 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:47:07.248 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:07.248 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:07.248 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:07.248 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:07.303 [main] [node-3] INFO  c.raftdb.integration.KVOperationTest - Leader: node-1
19:47:07.303 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:07.303 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
19:47:07.303 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:07.303 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:07.303 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:47:07.303 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:47:07.303 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.303 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:07.303 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:07.303 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.303 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:07.303 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:07.303 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:07.303 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:07.303 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 AppendEntries(term=1, entries=1)
19:47:07.303 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 AppendEntries(term=1, entries=1)
19:47:07.303 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.303 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.303 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:47:07.304 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - PUT committed
19:47:07.354 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:07.353 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:07.354 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:47:07.354 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:47:07.407 [main] [node-1] INFO  c.raftdb.integration.KVOperationTest - Data replicated to all nodes
19:47:07.408 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:07.408 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.408 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.408 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:07.408 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:07.408 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:07.408 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.408 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.408 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:07.408 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:07.408 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:07.408 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.408 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.408 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:07.408 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:07.410 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:07.410 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:07.410 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.410 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:07.410 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:07.410 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:07.410 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.410 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:07.410 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:07.410 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:07.410 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.410 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:07.617 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:07.618 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:07.618 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:07.618 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:07.618 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.618 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.618 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:07.618 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:07.618 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:07.618 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:07.618 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:07.618 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.618 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.619 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:07.619 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:07.619 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:07.619 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:07.724 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:07.724 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.724 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.725 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:07.725 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:07.725 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:07.725 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.725 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.725 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:07.725 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:07.725 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:07.725 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.725 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:07.725 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:07.725 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:07.726 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:07.726 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:07.726 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.726 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:07.727 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:07.727 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:07.727 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.727 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:07.727 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:07.727 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:07.727 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.727 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:07.727 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
19:47:07.727 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
19:47:07.727 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.727 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
19:47:07.727 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
19:47:07.727 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
19:47:07.727 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:07.727 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
19:47:07.888 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:07.888 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:07.888 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
19:47:07.888 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
19:47:07.888 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.888 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 VoteRequest(term=1)
19:47:07.888 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.888 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.888 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.888 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 VoteRequest(term=1)
19:47:07.888 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:07.888 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
19:47:07.888 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.888 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:47:07.888 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.888 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:07.888 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:07.888 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-5 VoteResponse(granted=true)
19:47:07.888 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
19:47:07.888 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:07.888 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:07.888 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
19:47:07.888 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-4 VoteResponse(granted=true)
19:47:07.889 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:07.889 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:07.889 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:47:07.889 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:07.889 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:07.932 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:07.932 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(stable-key, initial)
19:47:07.932 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:07.933 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:07.933 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:07.933 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
19:47:07.933 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:07.933 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=1)
19:47:07.933 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:07.933 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.933 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.933 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:07.933 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:07.933 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.933 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:07.933 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:07.933 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:07.933 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
19:47:07.933 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:07.933 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=1
19:47:07.933 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:47:07.940 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:07.940 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:07.940 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:07.940 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:07.941 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:47:07.941 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:47:07.941 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:47:07.941 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(stable-key, initial)
19:47:08.036 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:08.036 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-0, value-0)
19:47:08.036 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:08.036 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:08.036 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.036 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=2)
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:08.037 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:08.037 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:08.037 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=2
19:47:08.037 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:08.037 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:08.037 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
19:47:08.037 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:47:08.037 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:08.037 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-1, value-1)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=3)
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=3)
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:08.037 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:08.037 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:08.037 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:08.037 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:47:08.037 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:08.037 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:08.037 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:08.037 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=3
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:47:08.037 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:08.037 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:08.037 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=3
19:47:08.037 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:47:08.037 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:47:08.037 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:47:08.037 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:47:08.037 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-0, value-0)
19:47:08.037 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:08.037 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-2, value-2)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
19:47:08.037 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
19:47:08.037 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.038 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:08.038 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=4)
19:47:08.038 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:08.038 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=4)
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:08.038 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:47:08.038 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:08.038 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:08.038 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:08.038 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
19:47:08.038 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:47:08.038 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:47:08.038 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:08.038 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:08.038 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:08.038 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=4
19:47:08.038 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:08.038 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:08.038 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=4
19:47:08.038 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:47:08.038 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-1, value-1)
19:47:08.038 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:47:08.038 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:08.038 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-3, value-3)
19:47:08.038 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
19:47:08.038 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.038 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=5)
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:08.038 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:08.038 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=5)
19:47:08.038 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:08.038 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:08.038 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:08.038 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:08.038 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
19:47:08.038 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:47:08.038 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:47:08.039 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:08.038 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:08.038 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:08.039 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:08.038 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:08.038 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:47:08.039 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:47:08.039 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=5
19:47:08.039 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:08.039 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:08.039 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-4, value-4)
19:47:08.039 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=5
19:47:08.039 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:47:08.039 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-2, value-2)
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=6)
19:47:08.039 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:08.039 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=6)
19:47:08.039 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=6)
19:47:08.039 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:08.039 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:08.039 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-4 AppendEntries(term=1, entries=1)
19:47:08.039 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
19:47:08.039 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=6
19:47:08.039 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:08.039 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
19:47:08.039 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-5 (nextIndex=6)
19:47:08.039 [] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:47:08.039 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:47:08.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-5 AppendEntries(term=1, entries=1)
19:47:08.039 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:47:08.039 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:08.039 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.039 [] [node-5] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:08.040 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:08.040 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-5 succeeded, matchIndex=6
19:47:08.040 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-3, value-3)
19:47:08.091 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:08.091 [] [node-5] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:08.091 [] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:08.091 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:08.091 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:47:08.091 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:47:08.091 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:47:08.091 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-4, value-4)
19:47:08.145 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:08.145 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.145 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.145 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:08.145 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:08.145 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:08.145 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.145 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.145 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:08.145 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:08.145 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:08.145 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.145 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.145 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:08.146 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:08.146 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
19:47:08.146 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.146 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.146 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
19:47:08.146 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
19:47:08.146 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
19:47:08.146 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.146 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.146 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
19:47:08.146 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
19:47:08.154 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:08.155 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:08.155 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:08.155 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:08.155 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:08.155 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.156 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:08.346 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:08.349 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:08.350 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:08.350 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:08.350 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:08.350 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:08.350 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:08.350 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:08.473 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:08.473 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(test, data)
19:47:08.473 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:08.473 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(test, data)
19:47:08.474 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Data files created at target/test-data/node-1
19:47:08.475 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:08.475 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.475 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.475 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:08.476 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:08.480 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:08.480 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:08.480 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:08.480 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:08.480 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:08.480 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.481 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:08.481 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:08.481 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
19:47:08.481 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
19:47:08.481 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:08.481 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:08.481 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.482 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:08.482 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:08.482 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
19:47:08.482 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
19:47:08.482 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:08.482 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:08.482 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.482 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:08.672 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:08.673 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:08.673 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:08.673 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:08.673 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:08.673 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:08.673 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:08.674 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:08.674 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:08.674 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.674 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:08.674 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:08.674 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.674 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:08.674 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:08.674 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:08.674 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:08.674 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:08.674 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:08.674 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:08.674 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:08.674 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:08.675 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:08.694 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Leader: node-3
19:47:08.694 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:08.694 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key1, value1)
19:47:08.694 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:08.694 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:08.694 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.695 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:08.695 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:08.695 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:08.695 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:08.695 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:08.695 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:08.695 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:08.695 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:08.695 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:47:08.695 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:08.695 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key2, value2)
19:47:08.695 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:08.695 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:08.695 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.695 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:08.696 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:08.696 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:08.696 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:08.696 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:08.696 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:08.696 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:08.696 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:08.696 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:08.696 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:47:08.696 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:47:08.696 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
19:47:08.696 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key1, value1)
19:47:08.696 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:08.696 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key3, value3)
19:47:08.696 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:47:08.696 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
19:47:08.696 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:08.696 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:08.696 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:08.696 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:08.696 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:08.696 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:08.696 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:08.696 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:08.696 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:47:08.696 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:47:08.696 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:08.696 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:08.696 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
19:47:08.696 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key2, value2)
19:47:08.697 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
19:47:08.729 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:08.730 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:08.730 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
19:47:08.730 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key3, value3)
19:47:08.802 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Stopping all nodes...
19:47:08.802 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:08.802 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.802 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.802 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:08.802 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:08.802 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:08.802 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.802 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.802 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:08.803 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:08.803 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:08.803 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:08.803 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:08.803 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:08.803 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:08.803 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting all nodes...
19:47:08.803 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:08.804 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
19:47:08.804 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:08.804 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:08.804 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
19:47:08.804 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
19:47:08.804 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
19:47:08.804 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
19:47:08.804 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=3
19:47:08.804 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:08.804 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.804 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:08.804 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:08.804 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
19:47:08.804 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
19:47:08.804 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
19:47:08.804 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
19:47:08.804 [main] [node-2] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
19:47:08.804 [main] [node-2] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
19:47:08.805 [main] [node-2] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
19:47:08.805 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=3
19:47:08.805 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:08.805 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.805 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:08.805 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:08.805 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
19:47:08.805 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
19:47:08.805 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
19:47:08.805 [main] [node-3] INFO  c.r.persistence.PersistenceManager - Loaded 3 log entries from disk
19:47:08.805 [main] [node-3] INFO  com.raftdb.log.LogManager - Recovered 3 log entries, lastIndex=3
19:47:08.805 [main] [node-3] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 3 to recover state machine
19:47:08.805 [main] [node-3] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=3
19:47:08.805 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=3
19:47:08.805 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:08.805 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:08.805 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:09.039 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:09.039 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-3
19:47:09.039 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:09.039 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:09.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=2)
19:47:09.039 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=2)
19:47:09.040 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:09.040 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:09.040 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.040 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:47:09.040 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
19:47:09.040 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:47:09.040 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:09.040 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:09.040 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:09.040 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:09.040 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:09.040 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:09.040 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.041 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:47:09.041 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 2
19:47:09.041 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:47:09.119 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - New leader after restart: node-2
19:47:09.122 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - All nodes recovered successfully
19:47:09.122 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:09.122 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.122 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.122 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:09.122 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:09.122 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:09.122 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.123 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.123 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:09.123 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:09.123 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:09.123 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.123 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.123 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:09.123 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:09.125 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:09.126 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:09.126 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:09.126 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:09.126 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:09.126 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.126 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:09.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:09.126 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
19:47:09.126 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
19:47:09.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:09.126 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:09.126 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:09.126 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:09.126 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
19:47:09.126 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
19:47:09.126 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:09.126 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:09.126 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.126 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:09.373 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:09.375 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:09.376 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:09.376 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:09.376 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:09.376 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:09.376 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:09.377 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:09.377 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:09.377 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.377 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:09.377 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:09.377 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.377 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:09.377 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:09.378 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:09.378 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:09.378 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:09.378 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:09.378 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:09.378 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:09.378 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:09.378 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:09.434 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:09.434 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before, restart)
19:47:09.434 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:09.434 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:09.434 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:09.434 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:09.435 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:09.435 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:09.435 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:09.435 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:09.435 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:09.435 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:09.435 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:09.435 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
19:47:09.483 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:09.483 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:09.484 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
19:47:09.484 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before, restart)
19:47:09.544 [main] [node-3] INFO  c.raftdb.integration.PersistenceTest - Restarting follower: node-1
19:47:09.545 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:09.545 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.545 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.545 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:09.545 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:09.648 [main] [node-3] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:09.648 [main] [node-3] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during, downtime)
19:47:09.648 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:09.648 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:09.648 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 AppendEntries(term=1, entries=1)
19:47:09.649 [] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:09.649 [] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:09.649 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:47:09.649 [] [node-3] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:09.649 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
19:47:09.649 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:09.650 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-3
19:47:09.650 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:09.650 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:09.650 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
19:47:09.650 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
19:47:09.650 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 1 to recover state machine
19:47:09.650 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
19:47:09.650 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-3, lastLogIndex=1
19:47:09.650 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:09.650 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.650 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:09.683 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:09.683 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 AppendEntries(term=1, entries=1)
19:47:09.683 [] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:09.683 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
19:47:09.683 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:09.683 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:09.684 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:09.684 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:09.684 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during, downtime)
19:47:09.756 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Follower node-1 caught up after restart
19:47:09.756 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:09.756 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.756 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.756 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:09.756 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:09.756 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:09.756 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.756 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.756 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:09.756 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:09.756 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:09.756 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.756 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.756 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:09.756 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:09.760 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:09.760 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:09.760 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:09.760 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:09.760 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:09.760 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.760 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:09.959 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:09.961 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:09.963 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:09.963 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:09.963 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:09.963 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:09.963 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:09.963 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:09.969 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:09.970 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.970 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.970 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:09.970 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:09.970 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:09.970 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
19:47:09.971 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:09.971 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:09.971 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=0
19:47:09.971 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:09.971 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.971 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:09.971 [main] [node-1] INFO  c.raftdb.integration.PersistenceTest - Term persisted: 1 -> 1
19:47:09.971 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:09.971 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:09.971 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:09.971 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:09.971 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:09.975 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:09.975 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:09.975 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:09.975 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:09.975 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:09.975 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:09.975 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:10.131 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:10.133 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:10.134 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:10.134 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:10.134 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:10.134 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:10.134 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:10.134 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:10.188 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:10.189 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
19:47:10.189 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:10.189 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:47:10.190 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:10.190 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
19:47:10.190 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:10.190 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:47:10.191 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:10.191 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
19:47:10.191 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:10.191 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:47:10.191 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:10.191 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
19:47:10.191 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:10.191 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:47:10.192 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:10.192 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
19:47:10.192 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:10.192 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:47:10.192 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:10.192 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
19:47:10.192 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:10.192 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:47:10.193 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:47:10.193 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
19:47:10.193 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:47:10.193 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:47:10.193 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:47:10.193 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
19:47:10.193 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:10.193 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:47:10.194 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:47:10.194 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
19:47:10.194 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:10.194 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:47:10.194 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:47:10.194 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
19:47:10.194 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:10.194 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:47:10.195 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 10, term 1
19:47:10.195 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
19:47:10.197 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=10, lastTerm=1, size=184 bytes
19:47:10.197 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 10, 0 entries remaining
19:47:10.197 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
19:47:10.197 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 0 log entries remaining
19:47:10.198 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Snapshot test passed
19:47:10.198 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:10.199 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:10.199 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:10.199 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:10.199 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:10.201 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:10.202 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:10.202 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:10.202 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:10.202 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:10.202 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:10.202 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:10.465 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:10.468 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:10.469 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:10.469 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:10.469 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:10.469 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:10.469 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:10.469 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:10.517 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:10.517 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
19:47:10.517 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:10.518 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:47:10.518 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:10.518 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
19:47:10.518 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:10.518 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:47:10.518 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:10.519 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
19:47:10.519 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:10.519 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:47:10.519 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:10.519 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
19:47:10.519 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:10.519 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:47:10.519 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:10.519 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
19:47:10.519 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:10.520 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:47:10.520 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:10.520 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
19:47:10.520 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:10.520 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:47:10.520 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:47:10.520 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
19:47:10.521 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:47:10.521 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:47:10.521 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:47:10.521 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
19:47:10.521 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:10.521 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:47:10.521 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:47:10.521 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
19:47:10.521 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:10.521 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:47:10.522 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:47:10.522 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
19:47:10.522 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:10.522 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:47:10.522 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 9, term 1
19:47:10.522 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 10 entries, 184 bytes
19:47:10.523 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=9, lastTerm=1, size=184 bytes
19:47:10.524 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 9, 1 entries remaining
19:47:10.524 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 1 entries
19:47:10.524 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 184 bytes, 1 log entries remaining
19:47:10.524 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:47:10.524 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
19:47:10.525 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:47:10.525 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
19:47:10.525 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:47:10.525 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
19:47:10.525 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
19:47:10.525 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
19:47:10.525 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:47:10.525 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
19:47:10.525 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
19:47:10.525 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
19:47:10.525 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:47:10.525 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
19:47:10.525 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:47:10.526 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
19:47:10.526 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:47:10.526 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
19:47:10.526 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
19:47:10.526 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
19:47:10.526 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:10.526 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:10.526 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:10.526 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:10.526 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:10.526 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:10.527 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
19:47:10.527 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:10.527 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=9, lastTerm=1
19:47:10.527 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:10.528 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 184 bytes
19:47:10.528 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 10 entries
19:47:10.528 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=9, term=1
19:47:10.528 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=9, term=1
19:47:10.528 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 6 log entries from disk
19:47:10.528 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 6 log entries, lastIndex=15
19:47:10.528 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 10 to 15 to recover state machine
19:47:10.529 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=15
19:47:10.529 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=15
19:47:10.529 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:10.529 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:10.529 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:10.722 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:10.724 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:10.725 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:10.725 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:10.725 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:10.725 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:10.725 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:10.725 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:10.741 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Recovery from snapshot test passed
19:47:10.741 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:10.741 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:10.741 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:10.741 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:10.741 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:10.743 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:10.744 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:10.744 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:10.744 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:10.744 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:10.744 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:10.744 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:10.744 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:10.744 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-2
19:47:10.744 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-2
19:47:10.744 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:10.744 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:10.744 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:10.744 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:10.744 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:10.744 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-3
19:47:10.744 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-3
19:47:10.744 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:10.744 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:10.744 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:10.744 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:10.995 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:10.997 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:10.998 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:10.998 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:10.998 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:10.998 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 VoteRequest(term=1)
19:47:10.998 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 VoteRequest(term=1)
19:47:10.999 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:10.999 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:10.999 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:10.999 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:10.999 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:10.999 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:10.999 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:10.999 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:10.999 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:10.999 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:10.999 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-3 VoteResponse(granted=true)
19:47:10.999 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 VoteResponse(granted=true)
19:47:10.999 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:10.999 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:10.999 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:10.999 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:11.056 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:11.056 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key0, value0)
19:47:11.056 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:11.056 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:11.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.056 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.057 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.057 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:11.057 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:11.057 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.057 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:11.057 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:11.057 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:11.057 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:47:11.057 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:11.057 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key1, value1)
19:47:11.057 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:11.057 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:11.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.057 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.057 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.057 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:11.057 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:11.057 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.057 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:11.057 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:11.057 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:11.057 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:47:11.057 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:11.057 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:11.057 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:11.057 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:47:11.057 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key0, value0)
19:47:11.057 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:11.057 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key2, value2)
19:47:11.057 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=3)
19:47:11.057 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
19:47:11.058 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.058 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.058 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.058 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:11.058 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:11.058 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=3
19:47:11.058 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:11.058 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.058 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:11.058 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:11.058 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:47:11.058 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:47:11.058 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key1, value1)
19:47:11.058 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:47:11.058 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:11.058 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key3, value3)
19:47:11.058 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=4)
19:47:11.058 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
19:47:11.058 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.058 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.058 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.058 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:11.058 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.058 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:11.058 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:11.058 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:11.058 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
19:47:11.058 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:47:11.058 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:11.058 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=4
19:47:11.058 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:47:11.058 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key2, value2)
19:47:11.058 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:11.058 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key4, value4)
19:47:11.058 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=5)
19:47:11.058 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
19:47:11.058 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.058 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.058 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.058 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.058 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:11.058 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:11.058 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:11.058 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:11.058 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=5
19:47:11.058 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:47:11.058 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:11.058 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:11.058 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:47:11.058 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:47:11.058 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key3, value3)
19:47:11.059 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:11.059 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key5, value5)
19:47:11.059 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=6)
19:47:11.059 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
19:47:11.059 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.059 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.059 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:11.059 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.059 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:11.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:11.059 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:11.059 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=6
19:47:11.059 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:47:11.059 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:11.059 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
19:47:11.059 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key4, value4)
19:47:11.059 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:47:11.059 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:47:11.059 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key6, value6)
19:47:11.059 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=7)
19:47:11.059 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.059 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
19:47:11.059 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.059 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:47:11.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:11.059 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.059 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=7
19:47:11.059 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:47:11.059 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:47:11.059 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:11.059 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:47:11.059 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
19:47:11.059 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:47:11.059 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key5, value5)
19:47:11.059 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:47:11.059 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key7, value7)
19:47:11.059 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=8)
19:47:11.059 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.059 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
19:47:11.059 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.059 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.059 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:11.059 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:11.059 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:11.059 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:11.059 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=8
19:47:11.059 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
19:47:11.059 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:47:11.059 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:11.060 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:11.060 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key6, value6)
19:47:11.060 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:47:11.060 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:47:11.060 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key8, value8)
19:47:11.060 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=9)
19:47:11.060 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
19:47:11.060 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.060 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.060 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.060 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:47:11.060 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:11.060 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.060 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=9
19:47:11.060 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:47:11.060 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:47:11.060 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:11.060 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:11.060 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
19:47:11.060 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key7, value7)
19:47:11.060 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:47:11.060 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:47:11.060 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key9, value9)
19:47:11.060 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=10)
19:47:11.060 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
19:47:11.060 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.060 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.060 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.060 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:47:11.060 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:11.060 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.060 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:47:11.060 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=10
19:47:11.060 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:47:11.060 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:11.060 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
19:47:11.060 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key8, value8)
19:47:11.060 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:11.060 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:11.060 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:47:11.105 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:47:11.105 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:47:11.105 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:47:11.105 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key9, value9)
19:47:11.166 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:11.166 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:11.167 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:11.167 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:11.167 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:11.273 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:47:11.273 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key10, value10)
19:47:11.273 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=11)
19:47:11.273 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
19:47:11.273 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.274 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.274 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
19:47:11.274 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
19:47:11.274 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:47:11.274 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
19:47:11.274 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:47:11.274 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key11, value11)
19:47:11.274 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 2 entries to node-1 (nextIndex=11)
19:47:11.274 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=12)
19:47:11.274 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.274 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.274 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
19:47:11.274 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:47:11.274 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
19:47:11.274 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
19:47:11.274 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key10, value10)
19:47:11.274 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
19:47:11.275 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:47:11.275 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key12, value12)
19:47:11.275 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 3 entries to node-1 (nextIndex=11)
19:47:11.275 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=13)
19:47:11.275 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.275 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.275 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
19:47:11.275 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:47:11.275 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
19:47:11.275 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
19:47:11.275 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key11, value11)
19:47:11.275 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
19:47:11.275 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:47:11.275 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key13, value13)
19:47:11.275 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 4 entries to node-1 (nextIndex=11)
19:47:11.275 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=14)
19:47:11.275 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.275 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.275 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
19:47:11.275 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
19:47:11.275 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
19:47:11.275 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:47:11.275 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key12, value12)
19:47:11.275 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
19:47:11.276 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:47:11.276 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key14, value14)
19:47:11.276 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 5 entries to node-1 (nextIndex=11)
19:47:11.276 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=15)
19:47:11.276 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.276 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.276 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
19:47:11.276 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
19:47:11.276 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
19:47:11.276 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key13, value13)
19:47:11.276 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
19:47:11.276 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
19:47:11.276 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
19:47:11.276 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(key15, value15)
19:47:11.276 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 6 entries to node-1 (nextIndex=11)
19:47:11.276 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
19:47:11.276 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.276 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.276 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
19:47:11.276 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
19:47:11.276 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
19:47:11.276 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key14, value14)
19:47:11.276 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
19:47:11.276 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
19:47:11.277 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
19:47:11.277 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(key16, value16)
19:47:11.277 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 7 entries to node-1 (nextIndex=11)
19:47:11.277 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
19:47:11.277 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.277 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.277 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:47:11.277 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:47:11.277 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
19:47:11.277 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
19:47:11.277 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key15, value15)
19:47:11.277 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
19:47:11.277 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
19:47:11.277 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(key17, value17)
19:47:11.277 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 8 entries to node-1 (nextIndex=11)
19:47:11.277 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=18)
19:47:11.277 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.277 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.277 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
19:47:11.277 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
19:47:11.277 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=18
19:47:11.277 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key16, value16)
19:47:11.277 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
19:47:11.277 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
19:47:11.277 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
19:47:11.277 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(key18, value18)
19:47:11.277 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 9 entries to node-1 (nextIndex=11)
19:47:11.277 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=19)
19:47:11.277 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.277 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.278 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
19:47:11.278 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:47:11.278 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
19:47:11.278 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key17, value17)
19:47:11.278 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
19:47:11.278 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
19:47:11.278 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
19:47:11.278 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(key19, value19)
19:47:11.278 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 10 entries to node-1 (nextIndex=11)
19:47:11.278 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
19:47:11.278 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-3 AppendEntries(term=1, entries=1)
19:47:11.278 [] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.278 [] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
19:47:11.278 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
19:47:11.278 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
19:47:11.278 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key18, value18)
19:47:11.278 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
19:47:11.278 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
19:47:11.278 [main] [node-2] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 19, term 1
19:47:11.278 [main] [node-2] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 20 entries, 384 bytes
19:47:11.279 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=19, lastTerm=1, size=384 bytes
19:47:11.279 [main] [node-2] INFO  com.raftdb.log.LogManager - Compacted log to index 19, 1 entries remaining
19:47:11.279 [main] [node-2] INFO  c.r.persistence.PersistenceManager - Rewrote log with 1 entries
19:47:11.279 [main] [node-2] INFO  com.raftdb.core.RaftNode - Snapshot complete: 384 bytes, 1 log entries remaining
19:47:11.280 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:11.280 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:11.280 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:11.280 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:11.280 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:11.280 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:11.280 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:11.305 [replication-node-2] [node-2] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 384 bytes
19:47:11.306 [replication-node-2] [node-2] INFO  c.r.replication.ReplicationManager - Sending snapshot to node-1 (lastIndex=19, size=384)
19:47:11.307 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 InstallSnapshot(term=1, lastIndex=19, size=384)
19:47:11.307 [] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:47:11.308 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:11.308 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
19:47:11.308 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:11.308 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:11.308 [] [node-1] INFO  com.raftdb.core.RaftNode - Installing snapshot: lastIndex=19, lastTerm=1, size=384
19:47:11.308 [] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=19, lastTerm=1, size=384 bytes
19:47:11.308 [] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 20 entries
19:47:11.308 [] [node-1] INFO  com.raftdb.log.LogManager - Reset log to snapshot: index=19, term=1
19:47:11.308 [] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
19:47:11.308 [] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot installed successfully
19:47:11.309 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-2 <- node-1 InstallSnapshotResponse(term=1)
19:47:11.309 [] [node-2] INFO  c.r.replication.ReplicationManager - Snapshot to node-1 complete, nextIndex=20
19:47:11.355 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=20)
19:47:11.355 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-2 -> node-1 AppendEntries(term=1, entries=1)
19:47:11.355 [] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:11.355 [] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
19:47:11.355 [] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:47:11.355 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=20
19:47:11.355 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key19, value19)
19:47:11.386 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - Snapshot replication test passed
19:47:11.389 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:11.389 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:11.389 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:11.389 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:11.389 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:11.390 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:11.390 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:11.390 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:11.390 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:11.390 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:11.390 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:11.390 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:11.390 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:11.390 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:11.390 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:11.402 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:11.402 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:11.402 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:11.402 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:11.402 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:11.402 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:11.402 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:11.612 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:11.613 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:11.614 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:11.614 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:11.614 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:11.614 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:11.614 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:11.614 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:11.718 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:11.718 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(string, hello)
19:47:11.719 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:11.719 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(string, hello)
19:47:11.719 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:11.719 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(number, 12345)
19:47:11.719 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:11.719 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(number, 12345)
19:47:11.719 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:11.719 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(special, )
19:47:11.720 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:11.720 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(special, )
19:47:11.720 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:11.720 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(empty, )
19:47:11.720 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:11.720 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(empty, )
19:47:11.721 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:11.721 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: DELETE(empty)
19:47:11.721 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:11.721 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: DELETE(empty)
19:47:11.721 [main] [node-1] INFO  com.raftdb.core.RaftNode - Taking snapshot at index 5, term 1
19:47:11.721 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Created snapshot with 3 entries, 69 bytes
19:47:11.722 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - Saved snapshot: lastIndex=5, lastTerm=1, size=69 bytes
19:47:11.722 [main] [node-1] INFO  com.raftdb.log.LogManager - Compacted log to index 5, 0 entries remaining
19:47:11.723 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Rewrote log with 0 entries
19:47:11.723 [main] [node-1] INFO  com.raftdb.core.RaftNode - Snapshot complete: 69 bytes, 0 log entries remaining
19:47:11.723 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:11.723 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:11.723 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:11.723 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:11.723 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:11.723 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:11.723 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-1
19:47:11.723 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/test-data/node-1
19:47:11.723 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot metadata: lastIndex=5, lastTerm=1
19:47:11.723 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/test-data/node-1
19:47:11.723 [main] [node-1] DEBUG com.raftdb.snapshot.SnapshotManager - Loaded snapshot: 69 bytes
19:47:11.723 [main] [node-1] DEBUG c.r.statemachine.SkipListKVStore - Restored snapshot with 3 entries
19:47:11.723 [main] [node-1] INFO  com.raftdb.log.LogManager - Set snapshot info: index=5, term=1
19:47:11.724 [main] [node-1] INFO  com.raftdb.core.RaftNode - Restored from snapshot: index=5, term=1
19:47:11.724 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-1, lastLogIndex=5
19:47:11.724 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:11.724 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:11.724 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:11.940 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:11.941 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:11.941 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:11.941 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:11.941 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:11.942 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:11.942 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:11.942 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:12.034 [main] [node-1] INFO  com.raftdb.integration.SnapshotTest - State machine snapshot test passed
19:47:12.035 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:12.035 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.035 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:12.035 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:12.035 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:12.041 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:12.042 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:12.042 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:12.042 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:12.168 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19001
19:47:12.168 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:12.168 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:12.168 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19001
19:47:12.168 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:12.169 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:47:12.169 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:47:12.169 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:12.169 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19002
19:47:12.169 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:12.169 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:12.169 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19002
19:47:12.170 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:12.170 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:47:12.170 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:47:12.170 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:12.170 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19003
19:47:12.170 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:12.170 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:12.170 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19003
19:47:12.352 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:12.358 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:12.362 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:12.363 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:12.366 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:12.366 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:12.367 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:12.366 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:12.369 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:12.369 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:12.377 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19001
19:47:12.377 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19003
19:47:12.378 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19002
19:47:12.378 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19003
19:47:12.472 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:12.473 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:12.473 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-3
19:47:12.473 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:12.473 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:12.473 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19002
19:47:12.473 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19001
19:47:12.526 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:47:12.526 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-3 - canVote=false, logUpToDate=true
19:47:12.526 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
19:47:12.526 [grpc-default-executor-11] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:47:12.526 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-2 - canVote=false, logUpToDate=true
19:47:12.526 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=false, logUpToDate=true
19:47:12.531 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=false
19:47:12.531 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=false
19:47:12.531 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=1) -> granted=false
19:47:12.531 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=false
19:47:12.531 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=false
19:47:12.531 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=1) -> granted=false
19:47:12.611 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:12.612 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:12.612 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:12.612 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:12.612 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:12.614 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:12.615 [grpc-default-executor-0] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:12.615 [grpc-default-executor-0] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.615 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:12.615 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:12.615 [grpc-default-executor-3] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.615 [grpc-default-executor-0] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:12.615 [grpc-default-executor-0] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
19:47:12.615 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:12.615 [grpc-default-executor-3] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
19:47:12.616 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=2) -> granted=true
19:47:12.616 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:12.616 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:12.616 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:12.616 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:12.617 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=2) -> granted=true
19:47:12.690 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Leader elected: node-1
19:47:12.691 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:12.691 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.691 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:12.698 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:12.698 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:12.698 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:12.698 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.698 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:12.699 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:47:12.700 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:12.700 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:12.700 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.700 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:12.701 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:47:12.701 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:12.813 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:12.814 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:12.814 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:12.814 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:12.815 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19011
19:47:12.815 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:12.815 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:12.815 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19011
19:47:12.816 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:12.816 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:47:12.817 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:47:12.817 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:12.818 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19012
19:47:12.818 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:12.818 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:12.819 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19012
19:47:12.819 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:12.819 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:47:12.820 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:47:12.821 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:12.822 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19013
19:47:12.822 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:12.824 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:12.824 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19013
19:47:12.979 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:12.981 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:12.982 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:12.982 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:12.982 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:12.982 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19013
19:47:12.983 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19011
19:47:12.992 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:12.992 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:12.993 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:12.993 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.993 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:12.993 [grpc-default-executor-0] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:12.993 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:12.993 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:12.993 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:12.993 [grpc-default-executor-0] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:12.995 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
19:47:12.995 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:12.995 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:12.996 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:12.996 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:12.996 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
19:47:13.051 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:13.052 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(grpc-key, grpc-value)
19:47:13.052 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:13.053 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:13.053 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:13.053 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:13.059 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:13.059 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.059 [grpc-default-executor-0] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.061 [grpc-default-executor-2] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:13.063 [grpc-default-executor-2] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.063 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.063 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:47:13.064 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:13.064 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:47:13.064 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:13.064 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
19:47:13.066 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:47:13.066 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:13.066 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:47:13.104 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:13.105 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:13.106 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
19:47:13.110 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(grpc-key, grpc-value)
19:47:13.170 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Data replicated to all nodes
19:47:13.170 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:13.170 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.170 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:13.172 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:13.172 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:13.172 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:13.172 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.172 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:13.174 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:47:13.174 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:13.174 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:13.174 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.174 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:13.175 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:47:13.175 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:13.279 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:13.280 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:13.280 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:13.280 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:13.281 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19021
19:47:13.281 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:13.281 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:13.281 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19021
19:47:13.281 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:13.281 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:47:13.281 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:47:13.281 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:13.282 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19022
19:47:13.282 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:13.282 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:13.282 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19022
19:47:13.282 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:13.283 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:47:13.283 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:47:13.283 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:13.283 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19023
19:47:13.283 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:13.284 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:13.284 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19023
19:47:13.468 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:13.468 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:13.469 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:13.469 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:13.469 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:13.472 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19021
19:47:13.472 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19023
19:47:13.495 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:13.495 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:13.495 [grpc-default-executor-6] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.495 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:13.495 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:13.495 [grpc-default-executor-9] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.495 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:13.495 [grpc-default-executor-6] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:13.496 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:13.496 [grpc-default-executor-9] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:13.497 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
19:47:13.497 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:13.497 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:13.497 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:13.497 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:13.497 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
19:47:13.597 [main] [node-3] INFO  c.raftdb.integration.GrpcClusterTest - Initial leader: node-2 at term 1
19:47:13.597 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:13.598 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(before-failover, value1)
19:47:13.598 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:13.598 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:13.598 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:13.598 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:13.601 [grpc-default-executor-9] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:13.601 [grpc-default-executor-10] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:13.601 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.601 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.601 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.601 [grpc-default-executor-6] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:13.603 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:47:13.603 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:13.603 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:13.603 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:47:13.604 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:47:13.604 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:47:13.604 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:13.604 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:47:13.652 [grpc-default-executor-9] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:13.652 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:13.652 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:47:13.652 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(before-failover, value1)
19:47:13.705 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:13.705 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.705 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:13.706 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:47:13.706 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:13.706 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-2
19:47:13.706 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Stopped leader: node-2
19:47:13.901 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:13.902 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:47:13.902 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:13.902 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:13.902 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19023
19:47:13.902 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19022
19:47:13.906 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:13.906 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:13.906 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:13.906 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:13.906 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 2
19:47:13.907 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-2: Vote request to node-2 failed
19:47:13.907 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=2) -> granted=true
19:47:13.907 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:13.907 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:13.907 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:13.907 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:13.910 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - New leader: node-1 at term 2
19:47:13.910 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 2
19:47:13.910 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failover, value2)
19:47:13.910 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:13.910 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:13.911 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:13.911 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:13.911 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:13.911 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:13.911 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:13.911 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:47:13.959 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:13.960 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:13.960 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failover, value2)
19:47:14.011 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:14.017 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:14.017 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.017 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:14.017 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:14.017 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:14.017 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:14.017 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.018 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:14.018 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:47:14.018 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:14.124 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:14.125 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:14.125 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:14.125 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:14.125 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19031
19:47:14.125 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:14.125 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:14.126 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19031
19:47:14.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:14.126 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:47:14.126 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:47:14.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:14.126 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19032
19:47:14.126 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:14.126 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:14.126 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19032
19:47:14.126 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:14.126 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:47:14.126 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:47:14.127 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:14.127 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19033
19:47:14.127 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:14.127 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:14.127 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19033
19:47:14.290 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:14.291 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:14.291 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:14.291 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:14.291 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:14.292 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19033
19:47:14.292 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19032
19:47:14.298 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:14.298 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:14.298 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:14.298 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:14.298 [grpc-default-executor-9] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.298 [grpc-default-executor-2] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.298 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:14.298 [grpc-default-executor-9] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:14.298 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:14.298 [grpc-default-executor-2] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:14.299 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=1) -> granted=true
19:47:14.299 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=1) -> granted=true
19:47:14.299 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:14.299 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:14.299 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:14.299 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:14.347 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:14.347 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(key-0, value-0)
19:47:14.348 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:14.348 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:14.350 [grpc-default-executor-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.350 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:14.350 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.350 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:14.350 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:14.350 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:14.351 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:14.352 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.352 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:14.352 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:14.352 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.352 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:14.352 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:14.352 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:47:14.352 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:14.352 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(key-1, value-1)
19:47:14.353 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:14.353 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:14.353 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.354 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.355 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.355 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:14.355 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:14.355 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.355 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:14.355 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:14.356 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:47:14.356 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(key-0, value-0)
19:47:14.356 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.357 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=2
19:47:14.357 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:14.357 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:47:14.357 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.357 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:14.357 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 3 term 1
19:47:14.357 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 3: PUT(key-2, value-2)
19:47:14.357 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=3)
19:47:14.357 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=3)
19:47:14.359 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.359 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:14.359 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:14.359 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:47:14.359 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.359 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 3
19:47:14.359 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:14.359 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(key-1, value-1)
19:47:14.361 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.361 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=3
19:47:14.361 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 2 to 3
19:47:14.361 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.361 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:47:14.361 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=3
19:47:14.361 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 4 term 1
19:47:14.362 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 4: PUT(key-3, value-3)
19:47:14.362 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=4)
19:47:14.362 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=4)
19:47:14.364 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.364 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.364 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:14.364 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:14.364 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 4
19:47:14.364 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 3
19:47:14.364 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:47:14.364 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 3: PUT(key-2, value-2)
19:47:14.365 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.365 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.365 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=4
19:47:14.365 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 3 to 4
19:47:14.366 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=4
19:47:14.366 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:47:14.366 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 5 term 1
19:47:14.366 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 5: PUT(key-4, value-4)
19:47:14.366 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=5)
19:47:14.366 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=5)
19:47:14.367 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.367 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:14.367 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.367 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:14.367 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 5
19:47:14.367 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 4
19:47:14.367 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:47:14.367 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 4: PUT(key-3, value-3)
19:47:14.368 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.368 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.368 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=5
19:47:14.368 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=5
19:47:14.368 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:14.368 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 4 to 5
19:47:14.368 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:47:14.368 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 6 term 1
19:47:14.368 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 6: PUT(key-5, value-5)
19:47:14.368 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=6)
19:47:14.368 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=6)
19:47:14.370 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.370 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.370 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:14.370 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 6
19:47:14.370 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:14.370 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 5
19:47:14.370 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:47:14.370 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 5: PUT(key-4, value-4)
19:47:14.371 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.371 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=6
19:47:14.371 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 5 to 6
19:47:14.371 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.371 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=6
19:47:14.371 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:47:14.371 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 7 term 1
19:47:14.371 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 7: PUT(key-6, value-6)
19:47:14.371 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=7)
19:47:14.371 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=7)
19:47:14.372 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.372 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.373 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:47:14.373 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 7
19:47:14.373 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:14.373 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 6
19:47:14.373 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:47:14.373 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 6: PUT(key-5, value-5)
19:47:14.373 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.373 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.373 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=7
19:47:14.373 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 6 to 7
19:47:14.373 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=7
19:47:14.373 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:47:14.373 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 8 term 1
19:47:14.373 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 8: PUT(key-7, value-7)
19:47:14.373 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=8)
19:47:14.374 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=8)
19:47:14.374 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.374 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.374 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:14.374 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 8
19:47:14.374 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:14.375 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 7
19:47:14.375 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:47:14.375 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 7: PUT(key-6, value-6)
19:47:14.375 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.375 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.375 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=8
19:47:14.375 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=8
19:47:14.375 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:14.375 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 7 to 8
19:47:14.375 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:47:14.375 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 9 term 1
19:47:14.375 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 9: PUT(key-8, value-8)
19:47:14.375 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=9)
19:47:14.375 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=9)
19:47:14.376 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.376 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.376 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:47:14.376 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 9
19:47:14.376 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:14.376 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 8
19:47:14.376 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:47:14.376 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 8: PUT(key-7, value-7)
19:47:14.377 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.377 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.377 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=9
19:47:14.377 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=9
19:47:14.377 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:14.377 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 8 to 9
19:47:14.377 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:47:14.377 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 10 term 1
19:47:14.377 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 10: PUT(key-9, value-9)
19:47:14.377 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=10)
19:47:14.377 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=10)
19:47:14.378 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.378 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.378 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:47:14.378 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 10
19:47:14.378 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:14.378 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 9
19:47:14.378 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:47:14.378 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 9: PUT(key-8, value-8)
19:47:14.379 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.379 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.379 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=10
19:47:14.379 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=10
19:47:14.379 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:14.379 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 9 to 10
19:47:14.379 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:47:14.379 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 11 term 1
19:47:14.379 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 11: PUT(key-10, value-10)
19:47:14.379 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=11)
19:47:14.379 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=11)
19:47:14.380 [grpc-default-executor-9] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.380 [grpc-default-executor-6] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.380 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
19:47:14.380 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 11
19:47:14.380 [grpc-default-executor-9] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:47:14.380 [grpc-default-executor-6] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 10
19:47:14.380 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:47:14.380 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 10: PUT(key-9, value-9)
19:47:14.380 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.380 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.380 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=11
19:47:14.380 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=11
19:47:14.380 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:47:14.380 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 10 to 11
19:47:14.380 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
19:47:14.381 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 12 term 1
19:47:14.381 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 12: PUT(key-11, value-11)
19:47:14.381 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=12)
19:47:14.381 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=12)
19:47:14.382 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.382 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.382 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
19:47:14.382 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:47:14.382 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 12
19:47:14.382 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 11
19:47:14.382 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
19:47:14.382 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 11: PUT(key-10, value-10)
19:47:14.382 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.382 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=12
19:47:14.382 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 11 to 12
19:47:14.382 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
19:47:14.382 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.382 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=12
19:47:14.383 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 13 term 1
19:47:14.383 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 13: PUT(key-12, value-12)
19:47:14.383 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=13)
19:47:14.383 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=13)
19:47:14.384 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.384 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
19:47:14.384 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:47:14.384 [grpc-default-executor-9] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.384 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 13
19:47:14.384 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 12
19:47:14.384 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
19:47:14.384 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 12: PUT(key-11, value-11)
19:47:14.384 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.384 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.385 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=13
19:47:14.385 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=13
19:47:14.385 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
19:47:14.385 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 12 to 13
19:47:14.385 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
19:47:14.385 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 14 term 1
19:47:14.385 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 14: PUT(key-13, value-13)
19:47:14.385 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=14)
19:47:14.385 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=14)
19:47:14.386 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.386 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
19:47:14.386 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
19:47:14.386 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.386 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 14
19:47:14.386 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 13
19:47:14.386 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
19:47:14.386 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 13: PUT(key-12, value-12)
19:47:14.387 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.387 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.387 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=14
19:47:14.387 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=14
19:47:14.387 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:47:14.387 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 13 to 14
19:47:14.387 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
19:47:14.387 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 15 term 1
19:47:14.387 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 15: PUT(key-14, value-14)
19:47:14.387 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=15)
19:47:14.387 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=15)
19:47:14.388 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.388 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.388 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
19:47:14.388 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 15
19:47:14.388 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
19:47:14.388 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 14
19:47:14.388 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
19:47:14.388 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 14: PUT(key-13, value-13)
19:47:14.393 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.393 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.393 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=15
19:47:14.393 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=15
19:47:14.393 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
19:47:14.393 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 14 to 15
19:47:14.393 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
19:47:14.393 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 16 term 1
19:47:14.393 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 16: PUT(key-15, value-15)
19:47:14.393 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=16)
19:47:14.393 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=16)
19:47:14.394 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.395 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.395 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
19:47:14.395 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 16
19:47:14.395 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
19:47:14.395 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 15
19:47:14.395 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
19:47:14.395 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 15: PUT(key-14, value-14)
19:47:14.397 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.397 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.397 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=16
19:47:14.397 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=16
19:47:14.397 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
19:47:14.397 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 15 to 16
19:47:14.397 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
19:47:14.397 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 17 term 1
19:47:14.397 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 17: PUT(key-16, value-16)
19:47:14.397 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
19:47:14.397 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=17)
19:47:14.399 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.399 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.399 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:47:14.399 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:47:14.399 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:47:14.399 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 16
19:47:14.400 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
19:47:14.400 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 16: PUT(key-15, value-15)
19:47:14.400 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=17)
19:47:14.400 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=17)
19:47:14.400 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.400 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.400 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=17
19:47:14.400 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=17
19:47:14.400 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
19:47:14.400 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 16 to 17
19:47:14.400 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
19:47:14.401 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 18 term 1
19:47:14.401 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 18: PUT(key-17, value-17)
19:47:14.401 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:47:14.401 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=18)
19:47:14.401 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 17
19:47:14.401 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=18)
19:47:14.401 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.401 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.402 [grpc-default-executor-6] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.402 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
19:47:14.402 [grpc-default-executor-6] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
19:47:14.402 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.402 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 18
19:47:14.402 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 17
19:47:14.402 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
19:47:14.402 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 17: PUT(key-16, value-16)
19:47:14.403 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.403 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.403 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=18
19:47:14.403 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=18
19:47:14.403 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
19:47:14.403 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 17 to 18
19:47:14.403 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
19:47:14.403 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 19 term 1
19:47:14.403 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 19: PUT(key-18, value-18)
19:47:14.403 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=19)
19:47:14.403 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=19)
19:47:14.404 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.404 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.404 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
19:47:14.404 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 19
19:47:14.404 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:47:14.404 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 18
19:47:14.404 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
19:47:14.404 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 18: PUT(key-17, value-17)
19:47:14.405 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.405 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.405 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=19
19:47:14.405 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 18 to 19
19:47:14.405 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=19
19:47:14.405 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
19:47:14.406 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 20 term 1
19:47:14.406 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 20: PUT(key-19, value-19)
19:47:14.408 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=20)
19:47:14.408 [replication-node-1] [node-1] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=20)
19:47:14.412 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.412 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
19:47:14.412 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
19:47:14.412 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
19:47:14.412 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.412 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 20
19:47:14.412 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 19
19:47:14.413 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 19: PUT(key-18, value-18)
19:47:14.413 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.414 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=20
19:47:14.414 [] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 19 to 20
19:47:14.414 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
19:47:14.415 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 AppendEntries(entries=1) -> success=true
19:47:14.415 [] [node-1] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=20
19:47:14.456 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:47:14.456 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 20
19:47:14.456 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
19:47:14.456 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 20: PUT(key-19, value-19)
19:47:14.524 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - All 20 writes replicated
19:47:14.524 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:14.524 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.524 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:14.525 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:14.525 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:14.525 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:14.525 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.525 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:14.525 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:47:14.525 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:14.525 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:14.525 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.525 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:14.525 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:47:14.525 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:14.630 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:14.630 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:14.631 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:14.631 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:14.631 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19041
19:47:14.631 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:14.631 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:14.631 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19041
19:47:14.631 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:14.632 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:47:14.632 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:47:14.632 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:14.632 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19042
19:47:14.632 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:14.632 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:14.632 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19042
19:47:14.632 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:14.632 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:47:14.632 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:47:14.632 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:14.632 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19043
19:47:14.633 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:14.633 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:14.633 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19043
19:47:14.801 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:14.802 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:14.802 [election-node-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:14.802 [election-node-2] [node-2] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:14.802 [election-node-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:14.802 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19043
19:47:14.802 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19041
19:47:14.806 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:14.806 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:14.806 [grpc-default-executor-2] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.806 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:14.806 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:14.806 [grpc-default-executor-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.806 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:14.806 [grpc-default-executor-2] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:14.806 [grpc-default-executor-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-2
19:47:14.806 [grpc-default-executor-1] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-2 for term 1
19:47:14.807 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 VoteRequest(term=1) -> granted=true
19:47:14.807 [] [node-2] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:14.807 [] [node-2] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:14.807 [] [node-2] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:14.807 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:14.807 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 VoteRequest(term=1) -> granted=true
19:47:14.841 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:14.841 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(restart-test, initial)
19:47:14.841 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:14.842 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:14.843 [grpc-default-executor-10] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.843 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:14.843 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:14.843 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:14.843 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:47:14.843 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:14.843 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:14.843 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-1 AppendEntries(entries=1) -> success=true
19:47:14.843 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:14.843 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
19:47:14.861 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:14.861 [grpc-default-executor-1] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:14.861 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
19:47:14.861 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(restart-test, initial)
19:47:14.954 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Restarting follower: node-1 on port 19041
19:47:14.954 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:14.954 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:14.955 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:14.958 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:14.958 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:14.958 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-1
19:47:15.064 [main] [node-2] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:15.064 [main] [node-2] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(during-downtime, value)
19:47:15.064 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:15.064 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:15.065 [grpc-default-executor-2] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:15.065 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:15.066 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-2 -> node-3 AppendEntries(entries=1) -> success=true
19:47:15.066 [] [node-2] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:15.066 [] [node-2] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:15.066 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
19:47:15.066 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:15.067 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded meta: term=1, votedFor=node-2
19:47:15.067 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:15.067 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:15.067 [main] [node-1] INFO  c.r.persistence.PersistenceManager - Loaded 1 log entries from disk
19:47:15.067 [main] [node-1] INFO  com.raftdb.log.LogManager - Recovered 1 log entries, lastIndex=1
19:47:15.067 [main] [node-1] INFO  com.raftdb.core.RaftNode - Replaying log entries 1 to 1 to recover state machine
19:47:15.067 [main] [node-1] INFO  com.raftdb.core.RaftNode - State machine recovered, commitIndex=1
19:47:15.067 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=1, votedFor=node-2, lastLogIndex=1
19:47:15.067 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19041
19:47:15.067 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:15.067 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:15.067 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Restarted node node-1 on port 19041
19:47:15.112 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:15.113 [grpc-default-executor-2] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:15.113 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
19:47:15.162 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:15.208 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:15.258 [replication-node-2] [node-2] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:15.261 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:15.262 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-2
19:47:15.262 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:15.262 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:15.262 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19043
19:47:15.262 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19042
19:47:15.266 [grpc-default-executor-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:15.266 [grpc-default-executor-10] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=null
19:47:15.266 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.266 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.266 [grpc-default-executor-10] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.266 [grpc-default-executor-2] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.267 [grpc-default-executor-2] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:15.267 [grpc-default-executor-10] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=2, votedFor=node-1
19:47:15.267 [grpc-default-executor-2] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:47:15.267 [grpc-default-executor-10] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:47:15.268 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=2) -> granted=false
19:47:15.268 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=2) -> granted=false
19:47:15.418 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:15.419 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-2
19:47:15.419 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 3
19:47:15.419 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:15.420 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=null
19:47:15.420 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=null
19:47:15.420 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.420 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.420 [grpc-default-executor-1] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.420 [grpc-default-executor-3] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.420 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
19:47:15.420 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=3, votedFor=node-1
19:47:15.420 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:47:15.420 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Rejecting vote for node-1 - canVote=true, logUpToDate=false
19:47:15.421 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-3 VoteRequest(term=3) -> granted=false
19:47:15.421 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-1 -> node-2 VoteRequest(term=3) -> granted=false
19:47:15.578 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:15.579 [election-node-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-1
19:47:15.579 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 4
19:47:15.579 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:15.579 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19041
19:47:15.579 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19042
19:47:15.584 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=null
19:47:15.584 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=null
19:47:15.585 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.585 [grpc-default-executor-1] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.585 [grpc-default-executor-3] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.585 [grpc-default-executor-1] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.585 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-3
19:47:15.585 [grpc-default-executor-1] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=4, votedFor=node-3
19:47:15.585 [grpc-default-executor-3] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 4
19:47:15.585 [grpc-default-executor-1] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 4
19:47:15.586 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-2 VoteRequest(term=4) -> granted=true
19:47:15.586 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:15.586 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 VoteRequest(term=4) -> granted=true
19:47:15.586 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 4
19:47:15.586 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 4
19:47:15.586 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:15.587 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Missing entry at index 2
19:47:15.587 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 failed, nextIndex decremented to 2
19:47:15.640 [replication-node-3] [node-3] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:15.642 [grpc-default-executor-3] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:15.642 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:15.642 [grpc-default-executor-3] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:15.642 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(during-downtime, value)
19:47:15.643 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-3 -> node-1 AppendEntries(entries=1) -> success=true
19:47:15.643 [] [node-3] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=2
19:47:15.686 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Restarted node caught up successfully
19:47:15.686 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:15.686 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.687 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:15.688 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:47:15.688 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:15.688 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:15.688 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.688 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:15.689 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:47:15.689 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:15.689 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:15.689 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.689 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:15.689 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:15.690 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:15.797 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:15.797 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:15.798 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:15.798 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:15.798 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19051
19:47:15.798 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:15.798 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:15.798 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19051
19:47:15.798 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:15.798 [main] [node-2] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-2
19:47:15.798 [main] [node-2] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-2
19:47:15.799 [main] [node-2] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:15.799 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19052
19:47:15.799 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:15.799 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:15.799 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-2 on port 19052
19:47:15.799 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:15.799 [main] [node-3] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-3
19:47:15.799 [main] [node-3] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-3
19:47:15.799 [main] [node-3] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:15.800 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19053
19:47:15.800 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:15.800 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:15.800 [main] [node-3] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-3 on port 19053
19:47:15.800 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
19:47:15.800 [main] [node-4] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-4
19:47:15.800 [main] [node-4] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-4
19:47:15.800 [main] [node-4] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:15.800 [main] [node-4] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19054
19:47:15.800 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:15.800 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
19:47:15.800 [main] [node-4] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-4 on port 19054
19:47:15.800 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
19:47:15.801 [main] [node-5] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-5
19:47:15.801 [main] [node-5] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-5
19:47:15.801 [main] [node-5] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:15.801 [main] [node-5] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19055
19:47:15.801 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:15.801 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
19:47:15.801 [main] [node-5] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-5 on port 19055
19:47:15.957 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:15.958 [election-node-5] [node-5] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:15.959 [election-node-5] [node-5] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
19:47:15.959 [election-node-5] [node-5] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:15.959 [election-node-5] [node-5] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
19:47:15.959 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-3 at localhost:19053
19:47:15.960 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-4 at localhost:19054
19:47:15.961 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-1 at localhost:19051
19:47:15.961 [] [] DEBUG com.raftdb.rpc.GrpcTransport - Creating channel to node-2 at localhost:19052
19:47:15.966 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:15.966 [grpc-default-executor-9] [node-4] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:15.966 [grpc-default-executor-9] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.966 [grpc-default-executor-10] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:15.966 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.966 [grpc-default-executor-10] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.966 [grpc-default-executor-9] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.966 [grpc-default-executor-1] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.966 [grpc-default-executor-10] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.966 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:15.966 [grpc-default-executor-3] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:15.966 [grpc-default-executor-3] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:15.966 [grpc-default-executor-9] [node-4] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
19:47:15.966 [grpc-default-executor-9] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
19:47:15.966 [grpc-default-executor-10] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
19:47:15.966 [grpc-default-executor-10] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
19:47:15.967 [grpc-default-executor-1] [node-3] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
19:47:15.967 [grpc-default-executor-1] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
19:47:15.967 [grpc-default-executor-3] [node-2] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-5
19:47:15.967 [grpc-default-executor-3] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-5 for term 1
19:47:15.967 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-3 VoteRequest(term=1) -> granted=true
19:47:15.967 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
19:47:15.967 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-1 VoteRequest(term=1) -> granted=true
19:47:15.967 [] [node-5] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
19:47:15.967 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-2 VoteRequest(term=1) -> granted=true
19:47:15.967 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-4 VoteRequest(term=1) -> granted=true
19:47:15.967 [] [node-5] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:15.967 [] [node-5] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:15.967 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:16.013 [main] [node-5] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:16.013 [main] [node-5] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(five-node-test, value)
19:47:16.013 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=1)
19:47:16.013 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=1)
19:47:16.013 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=1)
19:47:16.013 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=1)
19:47:16.015 [grpc-default-executor-0] [node-1] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:16.015 [grpc-default-executor-7] [node-2] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:16.015 [grpc-default-executor-11] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:16.015 [grpc-default-executor-7] [node-2] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:16.015 [grpc-default-executor-11] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:16.015 [grpc-default-executor-0] [node-1] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:16.015 [grpc-default-executor-9] [node-4] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:16.016 [grpc-default-executor-9] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 1
19:47:16.017 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-2 AppendEntries(entries=1) -> success=true
19:47:16.017 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-3 AppendEntries(entries=1) -> success=true
19:47:16.017 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-1 AppendEntries(entries=1) -> success=true
19:47:16.017 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-2 succeeded, matchIndex=1
19:47:16.017 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-4 AppendEntries(entries=1) -> success=true
19:47:16.017 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:16.017 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-1 succeeded, matchIndex=1
19:47:16.017 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=1
19:47:16.017 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=1
19:47:16.017 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:47:16.019 [grpc-default-executor-10] [node-2] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:16.019 [grpc-default-executor-9] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:16.019 [grpc-default-executor-11] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:16.019 [grpc-default-executor-7] [node-1] DEBUG com.raftdb.core.RaftNode - Updated commit index to 1
19:47:16.020 [apply-node-2] [node-2] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:47:16.020 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:47:16.020 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:47:16.020 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(five-node-test, value)
19:47:16.123 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:16.123 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:16.123 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:16.124 [grpc-default-executor-3] [node-1] ERROR com.raftdb.rpc.GrpcTransport - Error handling AppendEntries
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@6533d75b[Not completed, task = java.util.concurrent.Executors$RunnableAdapter@4d3dc3[Wrapped task = com.raftdb.election.ElectionManager$$Lambda/0x000018000118cad0@7013b959]] rejected from java.util.concurrent.ScheduledThreadPoolExecutor@1fe8d51b[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 1]
	at java.base/java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2032)
	at java.base/java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:787)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:345)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:549)
	at java.base/java.util.concurrent.Executors$DelegatedScheduledExecutorService.schedule(Executors.java:780)
	at com.raftdb.election.ElectionManager.resetElectionTimer(ElectionManager.java:109)
	at com.raftdb.core.RaftNode.handleAppendEntries(RaftNode.java:536)
	at com.raftdb.rpc.GrpcTransport$RaftServiceImpl.appendEntries(GrpcTransport.java:255)
	at com.raftdb.rpc.proto.RaftServiceGrpc$MethodHandlers.invoke(RaftServiceGrpc.java:374)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:351)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1090)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:614)
	at java.base/java.lang.Thread.run(Thread.java:1474)
19:47:16.127 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:16.127 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:16.127 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-1
19:47:16.127 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:16.127 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:16.127 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:16.127 [main] [node-2] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-2
19:47:16.127 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:16.127 [main] [node-2] INFO  c.raftdb.integration.GrpcTestCluster - Stopped node node-2
19:47:16.127 [main] [node-2] INFO  c.raftdb.integration.GrpcClusterTest - Stopped two followers: node-1 and node-2
19:47:16.229 [main] [node-5] DEBUG com.raftdb.log.LogManager - Appended entry at index 2 term 1
19:47:16.229 [main] [node-5] DEBUG com.raftdb.core.RaftNode - Appended command at index 2: PUT(after-failures, still-working)
19:47:16.229 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-3 (nextIndex=2)
19:47:16.229 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-4 (nextIndex=2)
19:47:16.229 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:16.229 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:16.230 [grpc-default-executor-3] [node-3] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:16.230 [grpc-default-executor-7] [node-4] DEBUG c.r.persistence.PersistenceManager - Appended 1 log entries
19:47:16.230 [grpc-default-executor-7] [node-4] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:16.230 [grpc-default-executor-3] [node-3] DEBUG com.raftdb.core.RaftNode - Appended 1 entries, last index now 2
19:47:16.231 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-3 AppendEntries(entries=1) -> success=true
19:47:16.231 [] [] DEBUG com.raftdb.rpc.GrpcTransport - node-5 -> node-4 AppendEntries(entries=1) -> success=true
19:47:16.231 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-3 succeeded, matchIndex=2
19:47:16.231 [] [node-5] DEBUG c.r.replication.ReplicationManager - Replication to node-4 succeeded, matchIndex=2
19:47:16.231 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:16.231 [] [node-5] INFO  c.r.replication.ReplicationManager - Advancing commit index from 1 to 2
19:47:16.231 [apply-node-5] [node-5] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
19:47:16.269 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:16.269 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:16.270 [grpc-default-executor-7] [node-4] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:16.270 [grpc-default-executor-1] [node-3] DEBUG com.raftdb.core.RaftNode - Updated commit index to 2
19:47:16.270 [apply-node-4] [node-4] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
19:47:16.270 [apply-node-3] [node-3] DEBUG com.raftdb.core.RaftNode - Applying entry 2: PUT(after-failures, still-working)
19:47:16.320 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-1 (nextIndex=2)
19:47:16.320 [replication-node-5] [node-5] DEBUG c.r.replication.ReplicationManager - Replicating 1 entries to node-2 (nextIndex=2)
19:47:16.333 [main] [node-5] INFO  c.raftdb.integration.GrpcClusterTest - Five-node cluster survived two failures
19:47:16.333 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:16.333 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:16.333 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:16.334 [main] [node-3] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-3
19:47:16.334 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:16.334 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
19:47:16.334 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:16.334 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:16.334 [main] [node-4] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-4
19:47:16.334 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
19:47:16.334 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
19:47:16.334 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:16.335 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:16.335 [main] [node-5] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-5
19:47:16.335 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
19:47:16.438 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:16.439 [main] [node-1] INFO  c.r.persistence.PersistenceManager - PersistenceManager initialized at target/grpc-test-data/node-1
19:47:16.439 [main] [node-1] INFO  com.raftdb.snapshot.SnapshotManager - SnapshotManager initialized at target/grpc-test-data/node-1
19:47:16.439 [main] [node-1] INFO  com.raftdb.core.RaftNode - Recovered state: term=0, votedFor=null, lastLogIndex=0
19:47:16.439 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC server started on localhost:19061
19:47:16.439 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:16.440 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:16.440 [main] [node-1] INFO  c.raftdb.integration.GrpcTestCluster - Started node node-1 on port 19061
19:47:16.673 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:16.674 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=null
19:47:16.674 [election-node-1] [node-1] DEBUG c.r.persistence.PersistenceManager - Saved meta: term=1, votedFor=node-1
19:47:16.674 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:16.674 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 1 votes to win (cluster size: 1)
19:47:16.674 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:16.674 [election-node-1] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:16.674 [election-node-1] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:16.756 [main] [node-1] DEBUG com.raftdb.log.LogManager - Appended entry at index 1 term 1
19:47:16.756 [main] [node-1] DEBUG com.raftdb.core.RaftNode - Appended command at index 1: PUT(single, node)
19:47:16.756 [replication-node-1] [node-1] INFO  c.r.replication.ReplicationManager - Advancing commit index from 0 to 1
19:47:16.756 [apply-node-1] [node-1] DEBUG com.raftdb.core.RaftNode - Applying entry 1: PUT(single, node)
19:47:16.756 [main] [node-1] INFO  c.raftdb.integration.GrpcClusterTest - Single node cluster works
19:47:16.756 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:16.756 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:16.756 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:16.756 [main] [node-1] INFO  com.raftdb.rpc.GrpcTransport - gRPC transport shutdown for node-1
19:47:16.756 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:16.864 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:16.864 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:16.864 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:16.864 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:16.864 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:16.864 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:16.864 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:16.864 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:16.864 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:16.864 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:16.864 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:16.864 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:17.023 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:17.023 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:17.023 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:17.023 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:47:17.023 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.023 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:47:17.024 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.023 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.024 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.024 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:17.024 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:17.024 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:47:17.024 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:47:17.024 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:17.024 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:17.024 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:17.024 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:17.075 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-1 (term 1)
19:47:17.279 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - All nodes agree on leader: node-1
19:47:17.279 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:17.279 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.279 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.279 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:17.279 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:17.279 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:17.279 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.279 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.279 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:17.279 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:17.280 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:17.280 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.280 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.280 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:17.280 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:17.283 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:17.283 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:17.283 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.284 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:17.284 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:17.284 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:17.284 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.284 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:17.284 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:17.284 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:17.284 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.284 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:17.284 [main] [node-4] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-4
19:47:17.284 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-4
19:47:17.284 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.284 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 started as FOLLOWER
19:47:17.284 [main] [node-5] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-5
19:47:17.284 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-5
19:47:17.284 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.284 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 started as FOLLOWER
19:47:17.464 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:17.464 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:17.464 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 3 votes to win (cluster size: 5)
19:47:17.464 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:17.464 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.464 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.464 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:17.464 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:17.464 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/3
19:47:17.464 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:17.465 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.465 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.466 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:17.466 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:17.466 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 3/3
19:47:17.466 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:17.466 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:17.466 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:17.466 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-4 VoteRequest(term=1)
19:47:17.466 [] [node-4] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.466 [] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.466 [] [node-4] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:17.466 [] [node-4] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-4 VoteResponse(granted=true)
19:47:17.466 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-5 VoteRequest(term=1)
19:47:17.467 [] [node-5] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.467 [] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.467 [] [node-5] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:17.467 [] [node-5] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-5 VoteResponse(granted=true)
19:47:17.494 [main] [node-5] INFO  com.raftdb.integration.ClusterTest - Leader elected: node-3 (term 1)
19:47:17.495 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:17.495 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.495 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.495 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:17.495 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:17.495 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:17.495 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.495 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.495 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:17.495 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:17.495 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:17.496 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.496 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.498 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:17.498 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:17.498 [main] [node-4] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-4
19:47:17.498 [main] [node-4] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.498 [main] [node-4] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.498 [main] [node-4] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-4
19:47:17.498 [main] [node-4] INFO  com.raftdb.core.RaftNode - RaftNode node-4 stopped
19:47:17.499 [main] [node-5] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-5
19:47:17.499 [main] [node-5] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.499 [main] [node-5] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:17.499 [main] [node-5] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-5
19:47:17.499 [main] [node-5] INFO  com.raftdb.core.RaftNode - RaftNode node-5 stopped
19:47:17.502 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:17.502 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:17.502 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.502 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:17.502 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:17.502 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:17.502 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.502 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:17.502 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:17.502 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:17.502 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:17.502 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:17.669 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:17.669 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:17.669 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:17.669 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=1)
19:47:17.669 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-1 VoteRequest(term=1)
19:47:17.669 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.669 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.669 [] [node-1] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:17.669 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:17.669 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:17.669 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:17.682 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:17.682 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:17.682 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:17.682 [] [node-1] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 1
19:47:17.682 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:17.682 [] [node-1] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-1 VoteResponse(granted=true)
19:47:18.218 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Leader node-3 maintained leadership for 500ms
19:47:18.218 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:18.218 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.218 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:18.218 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:18.218 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:18.218 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:18.218 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.218 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:18.218 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:18.218 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:18.218 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:18.218 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.218 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:18.218 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:18.219 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
19:47:18.221 [main] [node-1] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-1
19:47:18.221 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-1
19:47:18.221 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:18.221 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 started as FOLLOWER
19:47:18.222 [main] [node-2] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-2
19:47:18.222 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-2
19:47:18.222 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:18.222 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 started as FOLLOWER
19:47:18.222 [main] [node-3] INFO  com.raftdb.core.RaftNode - Starting RaftNode node-3
19:47:18.222 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport started for node node-3
19:47:18.222 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager started
19:47:18.222 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 started as FOLLOWER
19:47:18.392 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:18.392 [election-node-1] [node-1] INFO  com.raftdb.election.ElectionManager - Starting election for term 1
19:47:18.393 [election-node-1] [node-1] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:18.393 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-2 VoteRequest(term=1)
19:47:18.393 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:18.393 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-1 -> node-3 VoteRequest(term=1)
19:47:18.393 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.393 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:18.393 [] [node-3] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:18.393 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-2 VoteResponse(granted=true)
19:47:18.393 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.393 [] [node-3] INFO  com.raftdb.election.ElectionManager - Granting vote to node-1 for term 1
19:47:18.393 [] [node-1] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:18.393 [] [node-3] DEBUG com.raftdb.rpc.LocalTransport - node-1 <- node-3 VoteResponse(granted=true)
19:47:18.393 [] [node-1] INFO  com.raftdb.election.ElectionManager - Won election for term 1
19:47:18.393 [] [node-1] INFO  com.raftdb.core.RaftNode - Became LEADER for term 1
19:47:18.393 [] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:18.424 [main] [node-3] INFO  com.raftdb.integration.ClusterTest - Initial leader: node-1 (term 1)
19:47:18.424 [main] [node-1] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-1
19:47:18.424 [main] [node-1] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.424 [main] [node-1] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:18.425 [main] [node-1] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-1
19:47:18.425 [main] [node-1] INFO  com.raftdb.core.RaftNode - RaftNode node-1 stopped
19:47:18.590 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Election timeout, starting election
19:47:18.591 [election-node-3] [node-3] INFO  com.raftdb.election.ElectionManager - Starting election for term 2
19:47:18.591 [election-node-3] [node-3] DEBUG com.raftdb.election.ElectionManager - Need 2 votes to win (cluster size: 3)
19:47:18.591 [] [] DEBUG com.raftdb.rpc.LocalTransport - node-3 -> node-2 VoteRequest(term=2)
19:47:18.591 [] [node-2] DEBUG com.raftdb.core.RaftNode - Became FOLLOWER
19:47:18.592 [] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.592 [] [node-2] INFO  com.raftdb.election.ElectionManager - Granting vote to node-3 for term 2
19:47:18.592 [] [node-2] DEBUG com.raftdb.rpc.LocalTransport - node-3 <- node-2 VoteResponse(granted=true)
19:47:18.592 [] [] WARN  com.raftdb.election.ElectionManager - Failed to get vote from node-1: java.lang.RuntimeException: Node not found: node-1
19:47:18.592 [] [node-3] DEBUG com.raftdb.election.ElectionManager - Received vote, total: 2/2
19:47:18.592 [] [node-3] INFO  com.raftdb.election.ElectionManager - Won election for term 2
19:47:18.592 [] [node-3] INFO  com.raftdb.core.RaftNode - Became LEADER for term 2
19:47:18.592 [] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager started
19:47:18.637 [main] [node-1] INFO  com.raftdb.integration.ClusterTest - New leader: node-3 (term 2)
19:47:18.638 [main] [node-2] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-2
19:47:18.638 [main] [node-2] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.638 [main] [node-2] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:18.638 [main] [node-2] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-2
19:47:18.639 [main] [node-2] INFO  com.raftdb.core.RaftNode - RaftNode node-2 stopped
19:47:18.639 [main] [node-3] INFO  com.raftdb.core.RaftNode - Stopping RaftNode node-3
19:47:18.639 [main] [node-3] INFO  c.r.replication.ReplicationManager - ReplicationManager stopped
19:47:18.639 [main] [node-3] INFO  com.raftdb.election.ElectionManager - ElectionManager stopped
19:47:18.639 [main] [node-3] INFO  com.raftdb.rpc.LocalTransport - LocalTransport shutdown for node node-3
19:47:18.639 [main] [node-3] INFO  com.raftdb.core.RaftNode - RaftNode node-3 stopped
